/*! For license information please see app-4d6bd0063a5e8e012768.js.LICENSE.txt */
(()=>{var t,e,i,n={311:t=>{"use strict";t.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27none%27 stroke=%27%23212529%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27%3e%3cpath d=%27m2 5 6 6 6-6%27/%3e%3c/svg%3e"},540:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},563:(t,e,i)=>{const n=i(8556);function a(t,e,i){const a=[],s=i&&i.debug||!1,r=!i||"boolean"!=typeof i.nested||i.nested;let o,l=i&&i.startIndex||0;for(;o=n(t,e,{debug:s,startIndex:l});)l=r?o.start+1+e.length:o.end,a.push(o);return s&&console.log("findTagsByName found",a.length,"tags"),a}t.exports=a,t.exports.default=a},644:t=>{"use strict";t.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23fff%27%3e%3cpath d=%27M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0%27/%3e%3c/svg%3e"},1113:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},1368:t=>{"use strict";t.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23fff%27%3e%3cpath d=%27M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708%27/%3e%3c/svg%3e"},1451:t=>{"use strict";t.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27none%27 stroke=%27%23052c65%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27%3e%3cpath d=%27m2 5 6 6 6-6%27/%3e%3c/svg%3e"},1601:t=>{"use strict";t.exports=function(t){return t[1]}},2247:t=>{"use strict";t.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 30 30%27%3e%3cpath stroke=%27rgba%2833, 37, 41, 0.75%29%27 stroke-linecap=%27round%27 stroke-miterlimit=%2710%27 stroke-width=%272%27 d=%27M4 7h22M4 15h22M4 23h22%27/%3e%3c/svg%3e"},2692:t=>{"use strict";t.exports=function(t,e,i,n,a,s,r,o){if(!t){var l;if(void 0===e)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[i,n,a,s,r,o],h=0;(l=new Error(e.replace(/%s/g,function(){return u[h++]}))).name="Invariant Violation"}throw l.framesToPop=1,l}}},2694:(t,e,i)=>{"use strict";var n=i(6925);function a(){}function s(){}s.resetWarningCache=a,t.exports=function(){function t(t,e,i,a,s,r){if(r!==n){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function e(){return t}t.isRequired=t;var i={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:s,resetWarningCache:a};return i.PropTypes=i,i}},3385:t=>{"use strict";t.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%272%27 fill=%27%23fff%27/%3e%3c/svg%3e"},3614:t=>{function e(t,e,i){const n=new RegExp(e).exec(t.slice(i));return n?i+n.index:-1}t.exports=e,t.exports.default=e},4096:(t,e,i)=>{"use strict";i.d(e,{A:()=>o});var n=i(1601),a=i.n(n),s=i(6314),r=i.n(s)()(a());r.push([t.id,':root,\n:host {\n  --ol-background-color: white;\n  --ol-accent-background-color: #F5F5F5;\n  --ol-subtle-background-color: rgba(128, 128, 128, 0.25);\n  --ol-partial-background-color: rgba(255, 255, 255, 0.75);\n  --ol-foreground-color: #333333;\n  --ol-subtle-foreground-color: #666666;\n  --ol-brand-color: #00AAFF;\n}\n\n.ol-box {\n  box-sizing: border-box;\n  border-radius: 2px;\n  border: 1.5px solid var(--ol-background-color);\n  background-color: var(--ol-partial-background-color);\n}\n\n.ol-mouse-position {\n  top: 8px;\n  right: 8px;\n  position: absolute;\n}\n\n.ol-scale-line {\n  background: var(--ol-partial-background-color);\n  border-radius: 4px;\n  bottom: 8px;\n  left: 8px;\n  padding: 2px;\n  position: absolute;\n}\n\n.ol-scale-line-inner {\n  border: 1px solid var(--ol-subtle-foreground-color);\n  border-top: none;\n  color: var(--ol-foreground-color);\n  font-size: 10px;\n  text-align: center;\n  margin: 1px;\n  will-change: contents, width;\n  transition: all 0.25s;\n}\n\n.ol-scale-bar {\n  position: absolute;\n  bottom: 8px;\n  left: 8px;\n}\n\n.ol-scale-bar-inner {\n  display: flex;\n}\n\n.ol-scale-step-marker {\n  width: 1px;\n  height: 15px;\n  background-color: var(--ol-foreground-color);\n  float: right;\n  z-index: 10;\n}\n\n.ol-scale-step-text {\n  position: absolute;\n  bottom: -5px;\n  font-size: 10px;\n  z-index: 11;\n  color: var(--ol-foreground-color);\n  text-shadow: -1.5px 0 var(--ol-partial-background-color), 0 1.5px var(--ol-partial-background-color), 1.5px 0 var(--ol-partial-background-color), 0 -1.5px var(--ol-partial-background-color);\n}\n\n.ol-scale-text {\n  position: absolute;\n  font-size: 12px;\n  text-align: center;\n  bottom: 25px;\n  color: var(--ol-foreground-color);\n  text-shadow: -1.5px 0 var(--ol-partial-background-color), 0 1.5px var(--ol-partial-background-color), 1.5px 0 var(--ol-partial-background-color), 0 -1.5px var(--ol-partial-background-color);\n}\n\n.ol-scale-singlebar {\n  position: relative;\n  height: 10px;\n  z-index: 9;\n  box-sizing: border-box;\n  border: 1px solid var(--ol-foreground-color);\n}\n\n.ol-scale-singlebar-even {\n  background-color: var(--ol-subtle-foreground-color);\n}\n\n.ol-scale-singlebar-odd {\n  background-color: var(--ol-background-color);\n}\n\n.ol-unsupported {\n  display: none;\n}\n\n.ol-viewport,\n.ol-unselectable {\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n}\n\n.ol-viewport canvas {\n  all: unset;\n  overflow: hidden;\n}\n\n.ol-viewport {\n  touch-action: pan-x pan-y;\n}\n\n.ol-selectable {\n  -webkit-touch-callout: default;\n  -webkit-user-select: text;\n  -moz-user-select: text;\n  user-select: text;\n}\n\n.ol-grabbing {\n  cursor: -webkit-grabbing;\n  cursor: -moz-grabbing;\n  cursor: grabbing;\n}\n\n.ol-grab {\n  cursor: move;\n  cursor: -webkit-grab;\n  cursor: -moz-grab;\n  cursor: grab;\n}\n\n.ol-control {\n  position: absolute;\n  background-color: var(--ol-subtle-background-color);\n  border-radius: 4px;\n}\n\n.ol-zoom {\n  top: .5em;\n  left: .5em;\n}\n\n.ol-rotate {\n  top: .5em;\n  right: .5em;\n  transition: opacity .25s linear, visibility 0s linear;\n}\n\n.ol-rotate.ol-hidden {\n  opacity: 0;\n  visibility: hidden;\n  transition: opacity .25s linear, visibility 0s linear .25s;\n}\n\n.ol-zoom-extent {\n  top: 4.643em;\n  left: .5em;\n}\n\n.ol-full-screen {\n  right: .5em;\n  top: .5em;\n}\n\n.ol-control button {\n  display: block;\n  margin: 1px;\n  padding: 0;\n  color: var(--ol-subtle-foreground-color);\n  font-weight: bold;\n  text-decoration: none;\n  font-size: inherit;\n  text-align: center;\n  height: 1.375em;\n  width: 1.375em;\n  line-height: .4em;\n  background-color: var(--ol-background-color);\n  border: none;\n  border-radius: 2px;\n}\n\n.ol-control button::-moz-focus-inner {\n  border: none;\n  padding: 0;\n}\n\n.ol-zoom-extent button {\n  line-height: 1.4em;\n}\n\n.ol-compass {\n  display: block;\n  font-weight: normal;\n  will-change: transform;\n}\n\n.ol-touch .ol-control button {\n  font-size: 1.5em;\n}\n\n.ol-touch .ol-zoom-extent {\n  top: 5.5em;\n}\n\n.ol-control button:hover,\n.ol-control button:focus {\n  text-decoration: none;\n  outline: 1px solid var(--ol-subtle-foreground-color);\n  color: var(--ol-foreground-color);\n}\n\n.ol-zoom .ol-zoom-in {\n  border-radius: 2px 2px 0 0;\n}\n\n.ol-zoom .ol-zoom-out {\n  border-radius: 0 0 2px 2px;\n}\n\n.ol-attribution {\n  text-align: right;\n  bottom: .5em;\n  right: .5em;\n  max-width: calc(100% - 1.3em);\n  display: flex;\n  flex-flow: row-reverse;\n  align-items: center;\n}\n\n.ol-attribution a {\n  color: var(--ol-subtle-foreground-color);\n  text-decoration: none;\n}\n\n.ol-attribution ul {\n  margin: 0;\n  padding: 1px .5em;\n  color: var(--ol-foreground-color);\n  text-shadow: 0 0 2px var(--ol-background-color);\n  font-size: 12px;\n}\n\n.ol-attribution li {\n  display: inline;\n  list-style: none;\n}\n\n.ol-attribution li:not(:last-child):after {\n  content: " ";\n}\n\n.ol-attribution img {\n  max-height: 2em;\n  max-width: inherit;\n  vertical-align: middle;\n}\n\n.ol-attribution button {\n  flex-shrink: 0;\n}\n\n.ol-attribution.ol-collapsed ul {\n  display: none;\n}\n\n.ol-attribution:not(.ol-collapsed) {\n  background: var(--ol-partial-background-color);\n}\n\n.ol-attribution.ol-uncollapsible {\n  bottom: 0;\n  right: 0;\n  border-radius: 4px 0 0;\n}\n\n.ol-attribution.ol-uncollapsible img {\n  margin-top: -.2em;\n  max-height: 1.6em;\n}\n\n.ol-attribution.ol-uncollapsible button {\n  display: none;\n}\n\n.ol-zoomslider {\n  top: 4.5em;\n  left: .5em;\n  height: 200px;\n}\n\n.ol-zoomslider button {\n  position: relative;\n  height: 10px;\n}\n\n.ol-touch .ol-zoomslider {\n  top: 5.5em;\n}\n\n.ol-overviewmap {\n  left: 0.5em;\n  bottom: 0.5em;\n}\n\n.ol-overviewmap.ol-uncollapsible {\n  bottom: 0;\n  left: 0;\n  border-radius: 0 4px 0 0;\n}\n\n.ol-overviewmap .ol-overviewmap-map,\n.ol-overviewmap button {\n  display: block;\n}\n\n.ol-overviewmap .ol-overviewmap-map {\n  border: 1px solid var(--ol-subtle-foreground-color);\n  height: 150px;\n  width: 150px;\n}\n\n.ol-overviewmap:not(.ol-collapsed) button {\n  bottom: 0;\n  left: 0;\n  position: absolute;\n}\n\n.ol-overviewmap.ol-collapsed .ol-overviewmap-map,\n.ol-overviewmap.ol-uncollapsible button {\n  display: none;\n}\n\n.ol-overviewmap:not(.ol-collapsed) {\n  background: var(--ol-subtle-background-color);\n}\n\n.ol-overviewmap-box {\n  border: 1.5px dotted var(--ol-subtle-foreground-color);\n}\n\n.ol-overviewmap .ol-overviewmap-box:hover {\n  cursor: move;\n}\n\n.ol-overviewmap .ol-viewport:hover {\n  cursor: pointer;\n}\n',""]);const o=r},4274:t=>{"use strict";t.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 20 20%27%3e%3cpath fill=%27none%27 stroke=%27%23fff%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%273%27 d=%27M6 10h8%27/%3e%3c/svg%3e"},4417:t=>{"use strict";t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),e.hash&&(t+=e.hash),/["'() \t\n]|(%20)/.test(t)||e.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t):t}},4477:(t,e)=>{"use strict";function i(t,e){var i=t.length;t.push(e);t:for(;0<i;){var n=i-1>>>1,a=t[n];if(!(0<s(a,e)))break t;t[n]=e,t[i]=a,i=n}}function n(t){return 0===t.length?null:t[0]}function a(t){if(0===t.length)return null;var e=t[0],i=t.pop();if(i!==e){t[0]=i;t:for(var n=0,a=t.length,r=a>>>1;n<r;){var o=2*(n+1)-1,l=t[o],u=o+1,h=t[u];if(0>s(l,i))u<a&&0>s(h,l)?(t[n]=h,t[u]=i,n=u):(t[n]=l,t[o]=i,n=o);else{if(!(u<a&&0>s(h,i)))break t;t[n]=h,t[u]=i,n=u}}}return e}function s(t,e){var i=t.sortIndex-e.sortIndex;return 0!==i?i:t.id-e.id}if(e.unstable_now=void 0,"object"==typeof performance&&"function"==typeof performance.now){var r=performance;e.unstable_now=function(){return r.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var u=[],h=[],c=1,d=null,p=3,m=!1,f=!1,g=!1,_=!1,y="function"==typeof setTimeout?setTimeout:null,k="function"==typeof clearTimeout?clearTimeout:null,v="undefined"!=typeof setImmediate?setImmediate:null;function x(t){for(var e=n(h);null!==e;){if(null===e.callback)a(h);else{if(!(e.startTime<=t))break;a(h),e.sortIndex=e.expirationTime,i(u,e)}e=n(h)}}function w(t){if(g=!1,x(t),!f)if(null!==n(u))f=!0,E||(E=!0,b());else{var e=n(h);null!==e&&P(w,e.startTime-t)}}var b,E=!1,M=-1,T=5,S=-1;function C(){return!(!_&&e.unstable_now()-S<T)}function L(){if(_=!1,E){var t=e.unstable_now();S=t;var i=!0;try{t:{f=!1,g&&(g=!1,k(M),M=-1),m=!0;var s=p;try{e:{for(x(t),d=n(u);null!==d&&!(d.expirationTime>t&&C());){var r=d.callback;if("function"==typeof r){d.callback=null,p=d.priorityLevel;var o=r(d.expirationTime<=t);if(t=e.unstable_now(),"function"==typeof o){d.callback=o,x(t),i=!0;break e}d===n(u)&&a(u),x(t)}else a(u);d=n(u)}if(null!==d)i=!0;else{var l=n(h);null!==l&&P(w,l.startTime-t),i=!1}}break t}finally{d=null,p=s,m=!1}i=void 0}}finally{i?b():E=!1}}}if("function"==typeof v)b=function(){v(L)};else if("undefined"!=typeof MessageChannel){var R=new MessageChannel,I=R.port2;R.port1.onmessage=L,b=function(){I.postMessage(null)}}else b=function(){y(L,0)};function P(t,i){M=y(function(){t(e.unstable_now())},i)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<t?Math.floor(1e3/t):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_next=function(t){switch(p){case 1:case 2:case 3:var e=3;break;default:e=p}var i=p;p=e;try{return t()}finally{p=i}},e.unstable_requestPaint=function(){_=!0},e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var i=p;p=t;try{return e()}finally{p=i}},e.unstable_scheduleCallback=function(t,a,s){var r=e.unstable_now();switch(s="object"==typeof s&&null!==s&&"number"==typeof(s=s.delay)&&0<s?r+s:r,t){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return t={id:c++,callback:a,priorityLevel:t,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>r?(t.sortIndex=s,i(h,t),null===n(u)&&t===n(h)&&(g?(k(M),M=-1):g=!0,P(w,s-r))):(t.sortIndex=o,i(u,t),f||m||(f=!0,E||(E=!0,b()))),t},e.unstable_shouldYield=C,e.unstable_wrapCallback=function(t){var e=p;return function(){var i=p;p=e;try{return t.apply(this,arguments)}finally{p=i}}}},4718:t=>{"use strict";t.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27%23fff%27/%3e%3c/svg%3e"},4848:(t,e,i)=>{"use strict";t.exports=i(9698)},4914:t=>{"use strict";t.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%236ea8fe%27%3e%3cpath fill-rule=%27evenodd%27 d=%27M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708%27/%3e%3c/svg%3e"},4915:t=>{t.exports={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}},5056:(t,e,i)=>{"use strict";t.exports=function(t){var e=i.nc;e&&t.setAttribute("nonce",e)}},5072:t=>{"use strict";var e=[];function i(t){for(var i=-1,n=0;n<e.length;n++)if(e[n].identifier===t){i=n;break}return i}function n(t,n){for(var s={},r=[],o=0;o<t.length;o++){var l=t[o],u=n.base?l[0]+n.base:l[0],h=s[u]||0,c="".concat(u," ").concat(h);s[u]=h+1;var d=i(c),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==d)e[d].references++,e[d].updater(p);else{var m=a(p,n);n.byIndex=o,e.splice(o,0,{identifier:c,updater:m,references:1})}r.push(c)}return r}function a(t,e){var i=e.domAPI(e);return i.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;i.update(t=e)}else i.remove()}}t.exports=function(t,a){var s=n(t=t||[],a=a||{});return function(t){t=t||[];for(var r=0;r<s.length;r++){var o=i(s[r]);e[o].references--}for(var l=n(t,a),u=0;u<s.length;u++){var h=i(s[u]);0===e[h].references&&(e[h].updater(),e.splice(h,1))}s=l}}},5160:(t,e,i)=>{"use strict";var n=i(6540),a="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e},s=n.useSyncExternalStore,r=n.useRef,o=n.useEffect,l=n.useMemo,u=n.useDebugValue;e.useSyncExternalStoreWithSelector=function(t,e,i,n,h){var c=r(null);if(null===c.current){var d={hasValue:!1,value:null};c.current=d}else d=c.current;c=l(function(){function t(t){if(!o){if(o=!0,s=t,t=n(t),void 0!==h&&d.hasValue){var e=d.value;if(h(e,t))return r=e}return r=t}if(e=r,a(s,t))return e;var i=n(t);return void 0!==h&&h(e,i)?(s=t,e):(s=t,r=i)}var s,r,o=!1,l=void 0===i?null:i;return[function(){return t(e())},null===l?void 0:function(){return t(l())}]},[e,i,n,h]);var p=s(t,c[0],c[1]);return o(function(){d.hasValue=!0,d.value=p},[p]),u(p),p}},5190:(t,e,i)=>{"use strict";var n={};i.r(n),i.d(n,{exclude:()=>oA,extract:()=>eA,parse:()=>iA,parseUrl:()=>aA,pick:()=>rA,stringify:()=>nA,stringifyUrl:()=>sA});const a="add",s="remove",r="propertychange",o="change",l="contextmenu",u="click",h="keydown",c="keypress",d="touchmove",p="wheel",m=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}};function f(t,e){return t>e?1:t<e?-1:0}function g(t,e){return t<e?1:t>e?-1:0}function _(t,e,i){if(t[0]<=e)return 0;const n=t.length;if(e<=t[n-1])return n-1;if("function"==typeof i){for(let a=1;a<n;++a){const n=t[a];if(n===e)return a;if(n<e)return i(e,t[a-1],n)>0?a-1:a}return n-1}if(i>0){for(let i=1;i<n;++i)if(t[i]<e)return i-1;return n-1}if(i<0){for(let i=1;i<n;++i)if(t[i]<=e)return i;return n-1}for(let i=1;i<n;++i){if(t[i]==e)return i;if(t[i]<e)return t[i-1]-e<e-t[i]?i-1:i}return n-1}function y(t,e,i){for(;e<i;){const n=t[e];t[e]=t[i],t[i]=n,++e,--i}}function k(t,e){const i=Array.isArray(e)?e:[e],n=i.length;for(let e=0;e<n;e++)t[t.length]=i[e]}function v(t,e){const i=t.length;if(i!==e.length)return!1;for(let n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}function x(){return!0}function w(){return!1}function b(){}function E(t){let e,i,n;return function(){const a=Array.prototype.slice.call(arguments);return i&&this===n&&v(a,i)||(n=this,i=a,e=t.apply(this,arguments)),e}}function M(t){return function(){let e;try{e=t()}catch(t){return Promise.reject(t)}return e instanceof Promise?e:Promise.resolve(e)}()}function T(t){for(const e in t)delete t[e]}function S(t){let e;for(e in t)return!1;return!e}const C=class{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}},L=class extends m{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const i=this.listeners_||(this.listeners_={}),n=i[t]||(i[t]=[]);n.includes(e)||n.push(e)}dispatchEvent(t){const e="string"==typeof t,i=e?t:t.type,n=this.listeners_&&this.listeners_[i];if(!n)return;const a=e?new C(t):t;a.target||(a.target=this.eventTarget_||this);const s=this.dispatching_||(this.dispatching_={}),r=this.pendingRemovals_||(this.pendingRemovals_={});let o;i in s||(s[i]=0,r[i]=0),++s[i];for(let t=0,e=n.length;t<e;++t)if(o="handleEvent"in n[t]?n[t].handleEvent(a):n[t].call(this,a),!1===o||a.propagationStopped){o=!1;break}if(0===--s[i]){let t=r[i];for(delete r[i];t--;)this.removeEventListener(i,b);delete s[i]}return o}disposeInternal(){this.listeners_&&T(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return!!this.listeners_&&(t?t in this.listeners_:Object.keys(this.listeners_).length>0)}removeEventListener(t,e){if(!this.listeners_)return;const i=this.listeners_[t];if(!i)return;const n=i.indexOf(e);-1!==n&&(this.pendingRemovals_&&t in this.pendingRemovals_?(i[n]=b,++this.pendingRemovals_[t]):(i.splice(n,1),0===i.length&&delete this.listeners_[t]))}};function R(t,e,i,n,a){if(a){const a=i;i=function(s){return t.removeEventListener(e,i),a.call(n??this,s)}}else n&&n!==t&&(i=i.bind(n));const s={target:t,type:e,listener:i};return t.addEventListener(e,i),s}function I(t,e,i,n){return R(t,e,i,n,!0)}function P(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),T(t))}class A extends L{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(o)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const i=t.length,n=new Array(i);for(let a=0;a<i;++a)n[a]=R(this,t[a],e);return n}return R(this,t,e)}onceInternal(t,e){let i;if(Array.isArray(t)){const n=t.length;i=new Array(n);for(let a=0;a<n;++a)i[a]=I(this,t[a],e)}else i=I(this,t,e);return e.ol_key=i,i}unInternal(t,e){const i=e.ol_key;if(i)!function(t){if(Array.isArray(t))for(let e=0,i=t.length;e<i;++e)P(t[e]);else P(t)}(i);else if(Array.isArray(t))for(let i=0,n=t.length;i<n;++i)this.removeEventListener(t[i],e);else this.removeEventListener(t,e)}}A.prototype.on,A.prototype.once,A.prototype.un;const j=A;function O(){throw new Error("Unimplemented abstract method.")}let F=0;function N(t){return t.ol_uid||(t.ol_uid=String(++F))}class G extends C{constructor(t,e,i){super(t),this.key=e,this.oldValue=i}}const D=class extends j{constructor(t){super(),this.on,this.once,this.un,N(this),this.values_=null,void 0!==t&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let i;i=`change:${t}`,this.hasListener(i)&&this.dispatchEvent(new G(i,t,e)),i=r,this.hasListener(i)&&this.dispatchEvent(new G(i,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,i){const n=this.values_||(this.values_={});if(i)n[t]=e;else{const i=n[t];n[t]=e,i!==e&&this.notify(t,i)}}setProperties(t,e){for(const i in t)this.set(i,t[i],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const i=this.values_[t];delete this.values_[t],S(this.values_)&&(this.values_=null),e||this.notify(t,i)}}},W="length";class H extends C{constructor(t,e,i){super(t),this.element=e,this.index=i}}const U=class extends D{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t??[],this.unique_)for(let t=1,e=this.array_.length;t<e;++t)this.assertUnique_(this.array_[t],t);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,i=t.length;e<i;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let i=0,n=e.length;i<n;++i)t(e[i],i,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(W)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new H(a,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let i=0,n=e.length;i<n;++i)if(e[i]===t)return this.removeAt(i)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new H(s,e,t)),e}setAt(t,e){if(t>=this.getLength())return void this.insertAt(t,e);if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const i=this.array_[t];this.array_[t]=e,this.dispatchEvent(new H(s,i,t)),this.dispatchEvent(new H(a,e,t))}updateLength_(){this.set(W,this.array_.length)}assertUnique_(t,e){const i=this.array_;for(let n=0,a=i.length;n<a;++n)if(i[n]===t&&n!==e)throw new Error("Duplicate item added to a unique collection")}};function B(t,e){if(!t)throw new Error(e)}class V extends D{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if("function"==typeof t.getSimplifiedGeometry){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new V(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const i=this.getStyle();return i&&t.setStyle(i),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(P(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=R(t,o,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?function(t){if("function"==typeof t)return t;let e;return Array.isArray(t)?e=t:(B("function"==typeof t.getZIndex,"Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[t]),function(){return e}}(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}const K=V;function z(t){const e=[1/0,1/0,-1/0,-1/0];for(let i=0,n=t.length;i<n;++i)rt(e,t[i]);return e}function $(t,e,i){return i?(i[0]=t[0]-e,i[1]=t[1]-e,i[2]=t[2]+e,i[3]=t[3]+e,i):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function Y(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function X(t,e,i){let n,a;return n=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0,a=i<t[1]?t[1]-i:t[3]<i?i-t[3]:0,n*n+a*a}function q(t,e){return J(t,e[0],e[1])}function Z(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function J(t,e,i){return t[0]<=e&&e<=t[2]&&t[1]<=i&&i<=t[3]}function Q(t,e){const i=t[0],n=t[1],a=t[2],s=t[3],r=e[0],o=e[1];let l=0;return r<i?l|=16:r>a&&(l|=4),o<n?l|=8:o>s&&(l|=2),0===l&&(l=1),l}function tt(t,e,i,n,a){return a?(a[0]=t,a[1]=e,a[2]=i,a[3]=n,a):[t,e,i,n]}function et(t){return tt(1/0,1/0,-1/0,-1/0,t)}function it(t,e){const i=t[0],n=t[1];return tt(i,n,i,n,e)}function nt(t,e,i,n,a){return ot(et(a),t,e,i,n)}function at(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function st(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function rt(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function ot(t,e,i,n,a){for(;i<n;i+=a)lt(t,e[i],e[i+1]);return t}function lt(t,e,i){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],i),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],i)}function ut(t,e){let i;return i=e(ct(t)),i||(i=e(dt(t)),i||(i=e(vt(t)),i||(i=e(kt(t)),i||!1)))}function ht(t){let e=0;return bt(t)||(e=xt(t)*_t(t)),e}function ct(t){return[t[0],t[1]]}function dt(t){return[t[2],t[1]]}function pt(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function mt(t,e){let i;if("bottom-left"===e)i=ct(t);else if("bottom-right"===e)i=dt(t);else if("top-left"===e)i=kt(t);else{if("top-right"!==e)throw new Error("Invalid corner");i=vt(t)}return i}function ft(t,e,i,n,a){const[s,r,o,l,u,h,c,d]=gt(t,e,i,n);return tt(Math.min(s,o,u,c),Math.min(r,l,h,d),Math.max(s,o,u,c),Math.max(r,l,h,d),a)}function gt(t,e,i,n){const a=e*n[0]/2,s=e*n[1]/2,r=Math.cos(i),o=Math.sin(i),l=a*r,u=a*o,h=s*r,c=s*o,d=t[0],p=t[1];return[d-l+c,p-u-h,d-l-c,p-u+h,d+l-c,p+u+h,d+l+c,p+u-h,d-l+c,p-u-h]}function _t(t){return t[3]-t[1]}function yt(t,e,i){const n=i||[1/0,1/0,-1/0,-1/0];return wt(t,e)?(t[0]>e[0]?n[0]=t[0]:n[0]=e[0],t[1]>e[1]?n[1]=t[1]:n[1]=e[1],t[2]<e[2]?n[2]=t[2]:n[2]=e[2],t[3]<e[3]?n[3]=t[3]:n[3]=e[3]):et(n),n}function kt(t){return[t[0],t[3]]}function vt(t){return[t[2],t[3]]}function xt(t){return t[2]-t[0]}function wt(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function bt(t){return t[2]<t[0]||t[3]<t[1]}function Et(t,e,i,n){if(bt(t))return et(i);let a=[];if(n>1){const e=t[2]-t[0],i=t[3]-t[1];for(let s=0;s<n;++s)a.push(t[0]+e*s/n,t[1],t[2],t[1]+i*s/n,t[2]-e*s/n,t[3],t[0],t[3]-i*s/n)}else a=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];e(a,a,2);const s=[],r=[];for(let t=0,e=a.length;t<e;t+=2)s.push(a[t]),r.push(a[t+1]);return function(t,e,i){return tt(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),i)}(s,r,i)}function Mt(t,e){const i=e.getExtent(),n=pt(t);if(e.canWrapX()&&(n[0]<i[0]||n[0]>=i[2])){const e=xt(i),a=Math.floor((n[0]-i[0])/e)*e;t[0]-=a,t[2]-=a}return t}function Tt(t,e,i){if(e.canWrapX()){const n=e.getExtent();if(!isFinite(t[0])||!isFinite(t[2]))return[[n[0],t[1],n[2],t[3]]];Mt(t,e);const a=xt(n);if(xt(t)>a&&!i)return[[n[0],t[1],n[2],t[3]]];if(t[0]<n[0])return[[t[0]+a,t[1],n[2],t[3]],[n[0],t[1],t[2],t[3]]];if(t[2]>n[2])return[[t[0],t[1],n[2],t[3]],[n[0],t[1],t[2]-a,t[3]]]}return[t]}function St(t,e,i){return Math.min(Math.max(t,e),i)}function Ct(t,e,i,n,a,s){const r=a-i,o=s-n;if(0!==r||0!==o){const l=((t-i)*r+(e-n)*o)/(r*r+o*o);l>1?(i=a,n=s):l>0&&(i+=r*l,n+=o*l)}return Lt(t,e,i,n)}function Lt(t,e,i,n){const a=i-t,s=n-e;return a*a+s*s}function Rt(t){return 180*t/Math.PI}function It(t){return t*Math.PI/180}function Pt(t,e){const i=t%e;return i*e<0?i+e:i}function At(t,e,i){return t+i*(e-t)}function jt(t,e){const i=Math.pow(10,e);return Math.round(t*i)/i}function Ot(t,e){return Math.round(jt(t,e))}function Ft(t,e){return Math.floor(jt(t,e))}function Nt(t,e){return Math.ceil(jt(t,e))}function Gt(t,e,i){if(t>=e&&t<i)return t;const n=i-e;return((t-e)%n+n)%n+e}const Dt=6371008.8;function Wt(t,e,i){i=i||Dt;const n=It(t[1]),a=It(e[1]),s=(a-n)/2,r=It(e[0]-t[0])/2,o=Math.sin(s)*Math.sin(s)+Math.sin(r)*Math.sin(r)*Math.cos(n)*Math.cos(a);return 2*i*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))}function Ht(t,e,i,n){n=n||Dt;const a=It(t[1]),s=It(t[0]),r=e/n,o=Math.asin(Math.sin(a)*Math.cos(r)+Math.cos(a)*Math.sin(r)*Math.cos(i));return[Rt(s+Math.atan2(Math.sin(i)*Math.sin(r)*Math.cos(a),Math.cos(r)-Math.sin(a)*Math.sin(o))),Rt(o)]}const Ut=2,Bt=3;let Vt=1;function Kt(...t){Vt>Ut||console.warn(...t)}function zt(...t){Vt>Bt||console.error(...t)}function $t(t,e){let i=!0;for(let n=t.length-1;n>=0;--n)if(t[n]!=e[n]){i=!1;break}return i}function Yt(t,e){const i=Math.cos(e),n=Math.sin(e),a=t[0]*i-t[1]*n,s=t[1]*i+t[0]*n;return t[0]=a,t[1]=s,t}function Xt(t,e){if(e.canWrapX()){const i=xt(e.getExtent()),n=qt(t,e,i);n&&(t[0]-=n*i)}return t}function qt(t,e,i){const n=e.getExtent();let a=0;return e.canWrapX()&&(t[0]<n[0]||t[0]>n[2])&&(i=i||xt(n),a=Math.floor((t[0]-n[0])/i)),a}const Zt={9001:"m",9002:"ft",9003:"us-ft",9101:"radians",9102:"degrees"};function Jt(t){return Zt[t]}const Qt={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937},te=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Qt[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}},ee=6378137,ie=Math.PI*ee,ne=[-ie,-ie,ie,ie],ae=[-180,-85,180,85],se=ee*Math.log(Math.tan(Math.PI/2));class re extends te{constructor(t){super({code:t,units:"m",extent:ne,global:!0,worldExtent:ae,getPointResolution:function(t,e){return t/Math.cosh(e[1]/ee)}})}}const oe=[new re("EPSG:3857"),new re("EPSG:102100"),new re("EPSG:102113"),new re("EPSG:900913"),new re("http://www.opengis.net/def/crs/EPSG/0/3857"),new re("http://www.opengis.net/gml/srs/epsg.xml#3857")];const le=[-180,-90,180,90],ue=6378137*Math.PI/180;class he extends te{constructor(t,e){super({code:t,units:"degrees",extent:le,axisOrientation:e,global:!0,metersPerUnit:ue,worldExtent:le})}}const ce=[new he("CRS:84"),new he("EPSG:4326","neu"),new he("urn:ogc:def:crs:OGC:1.3:CRS84"),new he("urn:ogc:def:crs:OGC:2:84"),new he("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new he("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new he("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let de={};function pe(t){return de[t]||de[t.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}let me={};function fe(t,e,i){const n=t.getCode(),a=e.getCode();n in me||(me[n]={}),me[n][a]=i}function ge(t,e){return t in me&&e in me[t]?me[t][e]:null}const _e=.9996,ye=.00669438,ke=ye*ye,ve=ke*ye,xe=ye/(1-ye),we=Math.sqrt(1-ye),be=(1-we)/(1+we),Ee=be*be,Me=Ee*be,Te=Me*be,Se=Te*be,Ce=.9983242984503243,Le=15*ke/256+45*ve/1024,Re=35*ve/3072,Ie=1.5*be-27/32*Me+269/512*Se,Pe=21/16*Ee-55/32*Te,Ae=151/96*Me-417/128*Se,je=1097/512*Te,Oe=6378137;function Fe(t,e,i){const n=t-5e5,a=(i.north?e:e-1e7)/_e/(Oe*Ce),s=a+Ie*Math.sin(2*a)+Pe*Math.sin(4*a)+Ae*Math.sin(6*a)+je*Math.sin(8*a),r=Math.sin(s),o=r*r,l=Math.cos(s),u=r/l,h=u*u,c=h*h,d=1-ye*o,p=Math.sqrt(1-ye*o),m=xe*l**2,f=m*m,g=n/(Oe/p*_e),_=g*g,y=_*g,k=y*g,v=k*g,x=s-u/((1-ye)/d)*(_/2-k/24*(5+3*h+10*m-4*f-9*xe))+v*g/720*(61+90*h+298*m+45*c-252*xe-3*f);let w=(g-y/6*(1+2*h+m)+v/120*(5-2*m+28*h-3*f+8*xe+24*c))/l;return w=Gt(w+It(Ge(i.number)),-Math.PI,Math.PI),[Rt(w),Rt(x)]}function Ne(t,e,i){t=Gt(t,-180,180),e<-80?e=-80:e>84&&(e=84);const n=It(e),a=Math.sin(n),s=Math.cos(n),r=a/s,o=r*r,l=o*o,u=It(t),h=It(Ge(i.number)),c=Oe/Math.sqrt(1-ye*a**2),d=xe*s**2,p=s*Gt(u-h,-Math.PI,Math.PI),m=p*p,f=m*p,g=f*p,_=g*p,y=_*p,k=Oe*(Ce*n-.002514607064228144*Math.sin(2*n)+Le*Math.sin(4*n)-Re*Math.sin(6*n)),v=_e*c*(p+f/6*(1-o+d)+_/120*(5-18*o+l+72*d-58*xe))+5e5;let x=_e*(k+c*r*(m/2+g/24*(5-o+9*d+4*d**2)+y/720*(61-58*o+l+600*d-330*xe)));return i.north||(x+=1e7),[v,x]}function Ge(t){return 6*(t-1)-180+3}const De=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function We(t){let e=0;for(const i of De){const n=t.match(i);if(n){e=parseInt(n[1]);break}}if(!e)return null;let i=0,n=!1;return e>32700&&e<32761?i=e-32700:e>32600&&e<32661&&(n=!0,i=e-32600),i?{number:i,north:n}:null}function He(t,e){return function(i,n,a,s){const r=i.length;a=a>1?a:2,s=s??a,n||(n=a>2?i.slice():new Array(r));for(let a=0;a<r;a+=s){const s=i[a],r=i[a+1],o=t(s,r,e);n[a]=o[0],n[a+1]=o[1]}return n}}const Ue=[function(t){const e=We(t.getCode());return e?{forward:He(Ne,e),inverse:He(Fe,e)}:null}],Be=[function(t){return We(t)?new te({code:t,units:"m"}):null}];let Ve=!0;function Ke(t,e){if(void 0!==e)for(let i=0,n=t.length;i<n;++i)e[i]=t[i];else e=t.slice();return e}function ze(t,e){if(void 0!==e&&t!==e){for(let i=0,n=t.length;i<n;++i)e[i]=t[i];t=e}return t}function $e(t){!function(t,e){de[t]=e}(t.getCode(),t),fe(t,t,Ke)}function Ye(t){if("string"!=typeof t)return t;const e=pe(t);if(e)return e;for(const e of Be){const i=e(t);if(i)return i}return null}function Xe(t,e,i,n){let a;const s=(t=Ye(t)).getPointResolutionFunc();if(s){if(a=s(e,i),n&&n!==t.getUnits()){const e=t.getMetersPerUnit();e&&(a=a*e/Qt[n])}}else{const s=t.getUnits();if("degrees"==s&&!n||"degrees"==n)a=e;else{const r=ei(t,Ye("EPSG:4326"));if(r||"degrees"===s){let t=[i[0]-e/2,i[1],i[0]+e/2,i[1],i[0],i[1]-e/2,i[0],i[1]+e/2];t=r(t,t,2),a=(Wt(t.slice(0,2),t.slice(2,4))+Wt(t.slice(4,6),t.slice(6,8)))/2}else a=e*t.getMetersPerUnit();const o=n?Qt[n]:t.getMetersPerUnit();void 0!==o&&(a/=o)}}return a}function qe(t){!function(t){t.forEach($e)}(t),t.forEach(function(e){t.forEach(function(t){e!==t&&fe(e,t,Ke)})})}function Ze(t,e){return t?"string"==typeof t?Ye(t):t:Ye(e)}function Je(t){return function(e,i,n,a){const s=e.length;n=void 0!==n?n:2,a=a??n,i=void 0!==i?i:new Array(s);for(let r=0;r<s;r+=a){const s=t(e.slice(r,r+n)),o=s.length;for(let t=0,n=a;t<n;++t)i[r+t]=t>=o?e[r+t]:s[t]}return i}}function Qe(t,e,i,n){const a=Ye(t),s=Ye(e);fe(a,s,Je(i)),fe(s,a,Je(n))}function ti(t,e){if(t===e)return!0;const i=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||ei(t,e)===Ke)&&i}function ei(t,e){const i=t.getCode(),n=e.getCode();let a=ge(i,n);if(a)return a;let s=null,r=null;for(const i of Ue)s||(s=i(t)),r||(r=i(e));if(!s&&!r)return null;const o="EPSG:4326";if(r)if(s)a=ii(s.inverse,r.forward);else{const t=ge(i,o);t&&(a=ii(t,r.forward))}else{const t=ge(o,n);t&&(a=ii(s.inverse,t))}return a&&($e(t),$e(e),fe(t,e,a)),a}function ii(t,e){return function(i,n,a,s){return n=t(i,n,a,s),e(n,n,a,s)}}function ni(t,e){return ei(Ye(t),Ye(e))}function ai(t,e,i){const n=ni(e,i);if(!n){const t=Ye(e).getCode(),n=Ye(i).getCode();throw new Error(`No transform available between ${t} and ${n}`)}return n(t,void 0,t.length)}function si(t,e,i,n){return Et(t,ni(e,i),void 0,n)}let ri=null;function oi(){return ri}function li(t,e){return t}function ui(t,e){return Ve&&!$t(t,[0,0])&&t[0]>=-180&&t[0]<=180&&t[1]>=-90&&t[1]<=90&&(Ve=!1,Kt("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),t}function hi(t,e){return t}function ci(t,e){return t}function di(t,e){return t}function pi(t,e,i){return function(n){let a,s;if(t.canWrapX()){const e=t.getExtent(),r=xt(e);s=qt(n=n.slice(0),t,r),s&&(n[0]=n[0]-s*r),n[0]=St(n[0],e[0],e[2]),n[1]=St(n[1],e[1],e[3]),a=i(n)}else a=i(n);return s&&e.canWrapX()&&(a[0]+=s*xt(e.getExtent())),a}}var mi,fi,gi;qe(oe),qe(ce),mi=oe,fi=function(t,e,i,n){const a=t.length;i=i>1?i:2,n=n??i,void 0===e&&(e=i>2?t.slice():new Array(a));for(let i=0;i<a;i+=n){e[i]=ie*t[i]/180;let n=ee*Math.log(Math.tan(Math.PI*(+t[i+1]+90)/360));n>se?n=se:n<-se&&(n=-se),e[i+1]=n}return e},gi=function(t,e,i,n){const a=t.length;i=i>1?i:2,n=n??i,void 0===e&&(e=i>2?t.slice():new Array(a));for(let i=0;i<a;i+=n)e[i]=180*t[i]/ie,e[i+1]=360*Math.atan(Math.exp(t[i+1]/ee))/Math.PI-90;return e},ce.forEach(function(t){mi.forEach(function(e){fe(t,e,fi),fe(e,t,gi)})});const _i=new Array(6);function yi(t,e){const i=t[0],n=t[1],a=t[2],s=t[3],r=t[4],o=t[5],l=e[0],u=e[1],h=e[2],c=e[3],d=e[4],p=e[5];return t[0]=i*l+a*u,t[1]=n*l+s*u,t[2]=i*h+a*c,t[3]=n*h+s*c,t[4]=i*d+a*p+r,t[5]=n*d+s*p+o,t}function ki(t,e,i,n,a,s,r){return t[0]=e,t[1]=i,t[2]=n,t[3]=a,t[4]=s,t[5]=r,t}function vi(t,e){const i=e[0],n=e[1];return e[0]=t[0]*i+t[2]*n+t[4],e[1]=t[1]*i+t[3]*n+t[5],e}function xi(t,e,i){return yi(t,ki(_i,e,0,0,i,0,0))}function wi(t,e,i,n,a,s,r,o){const l=Math.sin(s),u=Math.cos(s);return t[0]=n*u,t[1]=a*l,t[2]=-n*l,t[3]=a*u,t[4]=r*n*u-o*n*l+e,t[5]=r*a*l+o*a*u+i,t}function bi(t,e){const i=(n=e)[0]*n[3]-n[1]*n[2];var n;B(0!==i,"Transformation matrix cannot be inverted");const a=e[0],s=e[1],r=e[2],o=e[3],l=e[4],u=e[5];return t[0]=o/i,t[1]=-s/i,t[2]=-r/i,t[3]=a/i,t[4]=(r*u-o*l)/i,t[5]=-(a*u-s*l)/i,t}const Ei=[1e5,1e5,1e5,1e5,2,2];function Mi(t){return t.substring(7,t.length-1).split(",").map(parseFloat)}function Ti(t,e,i,n,a,s,r){s=s||[],r=r||2;let o=0;for(let l=e;l<i;l+=n){const e=t[l],i=t[l+1];s[o++]=a[0]*e+a[2]*i+a[4],s[o++]=a[1]*e+a[3]*i+a[5];for(let e=2;e<r;e++)s[o++]=t[l+e]}return s&&s.length!=o&&(s.length=o),s}function Si(t,e,i,n,a,s,r){r=r||[];const o=Math.cos(a),l=Math.sin(a),u=s[0],h=s[1];let c=0;for(let a=e;a<i;a+=n){const e=t[a]-u,i=t[a+1]-h;r[c++]=u+e*o-i*l,r[c++]=h+e*l+i*o;for(let e=a+2;e<a+n;++e)r[c++]=t[e]}return r&&r.length!=c&&(r.length=c),r}const Ci=[1,0,0,1,0,0],Li=[NaN,NaN],Ri=class extends D{constructor(){super(),this.extent_=[1/0,1/0,-1/0,-1/0],this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=E((t,e,i)=>{if(!i)return this.getSimplifiedGeometry(e);const n=this.clone();return n.applyTransform(i),n.getSimplifiedGeometry(e)})}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return O()}closestPointXY(t,e,i,n){return O()}containsXY(t,e){return 0===this.closestPointXY(t,e,Li,Number.MIN_VALUE)}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return O()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&et(t),this.extentRevision_=this.getRevision()}return function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)}rotate(t,e){O()}scale(t,e,i){O()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return O()}getType(){return O()}applyTransform(t){O()}intersectsExtent(t){return O()}translate(t,e){O()}transform(t,e){const i=Ye(t),n="tile-pixels"==i.getUnits()?function(t,n,a){const s=i.getExtent(),r=i.getWorldExtent(),o=_t(r)/_t(s);wi(Ci,r[0],r[3],o,-o,0,0,0);const l=Ti(t,0,t.length,a,Ci,n),u=ni(i,e);return u?u(l,l,a):l}:ni(i,e);return this.applyTransform(n),this}};function Ii(t){let e;return 2==t?e="XY":3==t?e="XYZ":4==t&&(e="XYZM"),e}function Pi(t){let e;return"XY"==t?e=2:"XYZ"==t||"XYM"==t?e=3:"XYZM"==t&&(e=4),e}const Ai=class extends Ri{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return nt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return O()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=Pi(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){O()}setLayout(t,e,i){let n;if(t)n=Pi(t);else{for(let t=0;t<i;++t){if(0===e.length)return this.layout="XY",void(this.stride=2);e=e[0]}n=e.length,t=Ii(n)}this.layout=t,this.stride=n}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(t,e){const i=this.getFlatCoordinates();if(i){const n=this.getStride();Si(i,0,i.length,n,t,e,i),this.changed()}}scale(t,e,i){void 0===e&&(e=t),i||(i=pt(this.getExtent()));const n=this.getFlatCoordinates();if(n){const a=this.getStride();!function(t,e,i,n,a,s,r,o){o=o||[];const l=r[0],u=r[1];let h=0;for(let e=0;e<i;e+=n){const i=t[e]-l,r=t[e+1]-u;o[h++]=l+a*i,o[h++]=u+s*r;for(let i=e+2;i<e+n;++i)o[h++]=t[i]}o&&o.length!=h&&(o.length=h)}(n,0,n.length,a,t,e,i,n),this.changed()}}translate(t,e){const i=this.getFlatCoordinates();if(i){const n=this.getStride();!function(t,e,i,n,a,s,r){r=r||[];let o=0;for(let e=0;e<i;e+=n){r[o++]=t[e]+a,r[o++]=t[e+1]+s;for(let i=e+2;i<e+n;++i)r[o++]=t[i]}r&&r.length!=o&&(r.length=o)}(i,0,i.length,n,t,e,i),this.changed()}}};function ji(t,e,i,n){let a=0;const s=t[i-n],r=t[i-n+1];let o=0,l=0;for(;e<i;e+=n){const i=t[e]-s,n=t[e+1]-r;a+=l*i-o*n,o=i,l=n}return a/2}function Oi(t,e,i,n){let a=0;for(let s=0,r=i.length;s<r;++s){const r=i[s];a+=ji(t,e,r,n),e=r}return a}function Fi(t,e,i,n,a,s,r){const o=t[e],l=t[e+1],u=t[i]-o,h=t[i+1]-l;let c;if(0===u&&0===h)c=e;else{const d=((a-o)*u+(s-l)*h)/(u*u+h*h);if(d>1)c=i;else{if(d>0){for(let a=0;a<n;++a)r[a]=At(t[e+a],t[i+a],d);return void(r.length=n)}c=e}}for(let e=0;e<n;++e)r[e]=t[c+e];r.length=n}function Ni(t,e,i,n,a){let s=t[e],r=t[e+1];for(e+=n;e<i;e+=n){const i=t[e],n=t[e+1],o=Lt(s,r,i,n);o>a&&(a=o),s=i,r=n}return a}function Gi(t,e,i,n,a){for(let s=0,r=i.length;s<r;++s){const r=i[s];a=Ni(t,e,r,n,a),e=r}return a}function Di(t,e,i,n,a,s,r,o,l,u,h){if(e==i)return u;let c,d;if(0===a){if(d=Lt(r,o,t[e],t[e+1]),d<u){for(c=0;c<n;++c)l[c]=t[e+c];return l.length=n,d}return u}h=h||[NaN,NaN];let p=e+n;for(;p<i;)if(Fi(t,p-n,p,n,r,o,h),d=Lt(r,o,h[0],h[1]),d<u){for(u=d,c=0;c<n;++c)l[c]=h[c];l.length=n,p+=n}else p+=n*Math.max((Math.sqrt(d)-Math.sqrt(u))/a|0,1);if(s&&(Fi(t,i-n,e,n,r,o,h),d=Lt(r,o,h[0],h[1]),d<u)){for(u=d,c=0;c<n;++c)l[c]=h[c];l.length=n}return u}function Wi(t,e,i,n,a,s,r,o,l,u,h){h=h||[NaN,NaN];for(let c=0,d=i.length;c<d;++c){const d=i[c];u=Di(t,e,d,n,a,s,r,o,l,u,h),e=d}return u}function Hi(t,e,i,n){for(let a=0,s=i.length;a<s;++a){const s=i[a];for(let i=0;i<n;++i)t[e++]=s[i]}return e}function Ui(t,e,i,n,a){a=a||[];let s=0;for(let r=0,o=i.length;r<o;++r){const o=Hi(t,e,i[r],n);a[s++]=o,e=o}return a.length=s,a}function Bi(t,e,i,n,a){a=a||[];let s=0;for(let r=0,o=i.length;r<o;++r){const o=Ui(t,e,i[r],n,a[s]);0===o.length&&(o[0]=e),a[s++]=o,e=o[o.length-1]}return a.length=s,a}function Vi(t,e,i,n,a){a=void 0!==a?a:[];let s=0;for(let r=e;r<i;r+=n)a[s++]=t.slice(r,r+n);return a.length=s,a}function Ki(t,e,i,n,a){a=void 0!==a?a:[];let s=0;for(let r=0,o=i.length;r<o;++r){const o=i[r];a[s++]=Vi(t,e,o,n,a[s]),e=o}return a.length=s,a}function zi(t,e,i,n,a){a=void 0!==a?a:[];let s=0;for(let r=0,o=i.length;r<o;++r){const o=i[r];a[s++]=1===o.length&&o[0]===e?[]:Ki(t,e,o,n,a[s]),e=o[o.length-1]}return a.length=s,a}function $i(t,e,i,n,a,s,r){const o=(i-e)/n;if(o<3){for(;e<i;e+=n)s[r++]=t[e],s[r++]=t[e+1];return r}const l=new Array(o);l[0]=1,l[o-1]=1;const u=[e,i-n];let h=0;for(;u.length>0;){const i=u.pop(),s=u.pop();let r=0;const o=t[s],c=t[s+1],d=t[i],p=t[i+1];for(let e=s+n;e<i;e+=n){const i=Ct(t[e],t[e+1],o,c,d,p);i>r&&(h=e,r=i)}r>a&&(l[(h-e)/n]=1,s+n<h&&u.push(s,h),h+n<i&&u.push(h,i))}for(let i=0;i<o;++i)l[i]&&(s[r++]=t[e+i*n],s[r++]=t[e+i*n+1]);return r}function Yi(t,e,i,n,a,s,r,o){for(let l=0,u=i.length;l<u;++l){const u=i[l];r=$i(t,e,u,n,a,s,r),o.push(r),e=u}return r}function Xi(t,e){return e*Math.round(t/e)}function qi(t,e,i,n,a,s,r){if(e==i)return r;let o,l,u=Xi(t[e],a),h=Xi(t[e+1],a);e+=n,s[r++]=u,s[r++]=h;do{if(o=Xi(t[e],a),l=Xi(t[e+1],a),(e+=n)==i)return s[r++]=o,s[r++]=l,r}while(o==u&&l==h);for(;e<i;){const i=Xi(t[e],a),c=Xi(t[e+1],a);if(e+=n,i==o&&c==l)continue;const d=o-u,p=l-h,m=i-u,f=c-h;d*f==p*m&&(d<0&&m<d||d==m||d>0&&m>d)&&(p<0&&f<p||p==f||p>0&&f>p)?(o=i,l=c):(s[r++]=o,s[r++]=l,u=o,h=l,o=i,l=c)}return s[r++]=o,s[r++]=l,r}function Zi(t,e,i,n,a,s,r,o){for(let l=0,u=i.length;l<u;++l){const u=i[l];r=qi(t,e,u,n,a,s,r),o.push(r),e=u}return r}class Ji extends Ai{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}clone(){return new Ji(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,i,n){return n<X(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Ni(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Di(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,n))}getArea(){return ji(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Vi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=$i(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new Ji(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Hi(this.flatCoordinates,0,t,this.stride),this.changed()}}const Qi=Ji;class tn extends Ai{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new tn(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){const a=this.flatCoordinates,s=Lt(t,e,a[0],a[1]);if(s<n){const t=this.stride;for(let e=0;e<t;++e)i[e]=a[e];return i.length=t,s}return n}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return it(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return J(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=function(t,e,i){for(let n=0,a=i.length;n<a;++n)t[e++]=i[n];return e}(this.flatCoordinates,0,t,this.stride),this.changed()}}const en=tn;function nn(t,e,i,n,a){return!ut(a,function(a){return!an(t,e,i,n,a[0],a[1])})}function an(t,e,i,n,a,s){let r=0,o=t[i-n],l=t[i-n+1];for(;e<i;e+=n){const i=t[e],n=t[e+1];l<=s?n>s&&(i-o)*(s-l)-(a-o)*(n-l)>0&&r++:n<=s&&(i-o)*(s-l)-(a-o)*(n-l)<0&&r--,o=i,l=n}return 0!==r}function sn(t,e,i,n,a,s){if(0===i.length)return!1;if(!an(t,e,i[0],n,a,s))return!1;for(let e=1,r=i.length;e<r;++e)if(an(t,i[e-1],i[e],n,a,s))return!1;return!0}function rn(t,e,i,n,a,s,r){let o,l,u,h,c,d,p;const m=a[s+1],g=[];for(let a=0,s=i.length;a<s;++a){const s=i[a];for(h=t[s-n],d=t[s-n+1],o=e;o<s;o+=n)c=t[o],p=t[o+1],(m<=d&&p<=m||d<=m&&m<=p)&&(u=(m-d)/(p-d)*(c-h)+h,g.push(u)),h=c,d=p}let _=NaN,y=-1/0;for(g.sort(f),h=g[0],o=1,l=g.length;o<l;++o){c=g[o];const a=Math.abs(c-h);a>y&&(u=(h+c)/2,sn(t,e,i,n,u,m)&&(_=u,y=a)),h=c}return isNaN(_)&&(_=a[s]),r?(r.push(_,m,y),r):[_,m,y]}function on(t,e,i,n,a){let s=[];for(let r=0,o=i.length;r<o;++r){const o=i[r];s=rn(t,e,o,n,a,2*r,s),e=o[o.length-1]}return s}function ln(t,e,i,n,a){let s;for(e+=n;e<i;e+=n)if(s=a(t.slice(e-n,e),t.slice(e,e+n)),s)return s;return!1}function un(t,e,i,n,a,s){return s=s??ot([1/0,1/0,-1/0,-1/0],t,e,i,n),!!wt(a,s)&&(s[0]>=a[0]&&s[2]<=a[2]||s[1]>=a[1]&&s[3]<=a[3]||ln(t,e,i,n,function(t,e){return function(t,e,i){let n=!1;const a=Q(t,e),s=Q(t,i);if(1===a||1===s)n=!0;else{const r=t[0],o=t[1],l=t[2],u=t[3],h=e[0],c=e[1],d=i[0],p=i[1],m=(p-c)/(d-h);let f,g;2&s&&!(2&a)&&(f=d-(p-u)/m,n=f>=r&&f<=l),n||!(4&s)||4&a||(g=p-(d-l)*m,n=g>=o&&g<=u),n||!(8&s)||8&a||(f=d-(p-o)/m,n=f>=r&&f<=l),n||!(16&s)||16&a||(g=p-(d-r)*m,n=g>=o&&g<=u)}return n}(a,t,e)}))}function hn(t,e,i,n,a){return!!(un(t,e,i,n,a)||an(t,e,i,n,a[0],a[1])||an(t,e,i,n,a[0],a[3])||an(t,e,i,n,a[2],a[1])||an(t,e,i,n,a[2],a[3]))}function cn(t,e,i,n,a){if(!hn(t,e,i[0],n,a))return!1;if(1===i.length)return!0;for(let e=1,s=i.length;e<s;++e)if(nn(t,i[e-1],i[e],n,a)&&!un(t,i[e-1],i[e],n,a))return!1;return!0}function dn(t,e,i,n){for(;e<i-n;){for(let a=0;a<n;++a){const s=t[e+a];t[e+a]=t[i-n+a],t[i-n+a]=s}e+=n,i-=n}}function pn(t,e,i,n){let a=0,s=t[i-n],r=t[i-n+1];for(;e<i;e+=n){const i=t[e],n=t[e+1];a+=(i-s)*(n+r),s=i,r=n}return 0===a?void 0:a>0}function mn(t,e,i,n,a){a=void 0!==a&&a;for(let s=0,r=i.length;s<r;++s){const r=i[s],o=pn(t,e,r,n);if(0===s){if(a&&o||!a&&!o)return!1}else if(a&&!o||!a&&o)return!1;e=r}return!0}function fn(t,e,i,n,a){for(let s=0,r=i.length;s<r;++s){const r=i[s];if(!mn(t,e,r,n,a))return!1;r.length&&(e=r[r.length-1])}return!0}function gn(t,e,i,n,a){a=void 0!==a&&a;for(let s=0,r=i.length;s<r;++s){const r=i[s],o=pn(t,e,r,n);(0===s?a&&o||!a&&!o:a&&!o||!a&&o)&&dn(t,e,r,n),e=r}return e}function _n(t,e,i,n,a){for(let s=0,r=i.length;s<r;++s)e=gn(t,e,i[s],n,a);return e}class yn extends Ai{constructor(t,e,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,void 0!==e&&i?(this.setFlatCoordinates(e,t),this.ends_=i):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?k(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new yn(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<X(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Gi(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Wi(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,n))}containsXY(t,e){return sn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return Oi(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),gn(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,Ki(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=pt(this.getExtent());this.flatInteriorPoint_=rn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new en(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new Qi(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,i=this.ends_,n=[];let a=0;for(let s=0,r=i.length;s<r;++s){const r=i[s],o=new Qi(e.slice(a,r),t);n.push(o),a=r}return n}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;mn(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=gn(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=Zi(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,i),new yn(e,"XY",i)}getType(){return"Polygon"}intersectsExtent(t){return cn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Ui(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()}}const kn=yn;function vn(t){if(bt(t))throw new Error("Cannot create polygon from empty extent");const e=t[0],i=t[1],n=t[2],a=t[3],s=[e,i,e,a,n,a,n,i,e,i];return new yn(s,"XY",[s.length])}const xn="accuracy",wn="accuracyGeometry",bn="altitude",En="altitudeAccuracy",Mn="heading",Tn="position",Sn="projection",Cn="speed",Ln="tracking",Rn="trackingOptions";class In extends C{constructor(t){super("error"),this.code=t.code,this.message=t.message}}const Pn=class extends D{constructor(t){super(),this.on,this.once,this.un,t=t||{},this.position_=null,this.transform_=ze,this.watchId_=void 0,this.addChangeListener(Sn,this.handleProjectionChanged_),this.addChangeListener(Ln,this.handleTrackingChanged_),void 0!==t.projection&&this.setProjection(t.projection),void 0!==t.trackingOptions&&this.setTrackingOptions(t.trackingOptions),this.setTracking(void 0!==t.tracking&&t.tracking)}disposeInternal(){this.setTracking(!1),super.disposeInternal()}handleProjectionChanged_(){const t=this.getProjection();t&&(this.transform_=ei(Ye("EPSG:4326"),t),this.position_&&this.set(Tn,this.transform_(this.position_)))}handleTrackingChanged_(){if("geolocation"in navigator){const t=this.getTracking();t&&void 0===this.watchId_?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):t||void 0===this.watchId_||(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0)}}positionChange_(t){const e=t.coords;this.set(xn,e.accuracy),this.set(bn,null===e.altitude?void 0:e.altitude),this.set(En,null===e.altitudeAccuracy?void 0:e.altitudeAccuracy),this.set(Mn,null===e.heading?void 0:It(e.heading)),this.position_?(this.position_[0]=e.longitude,this.position_[1]=e.latitude):this.position_=[e.longitude,e.latitude];const i=this.transform_(this.position_);this.set(Tn,i.slice()),this.set(Cn,null===e.speed?void 0:e.speed);const n=function(t,e,i){i=i||32;const n=[];for(let a=0;a<i;++a)k(n,Ht(t,e,2*Math.PI*a/i,undefined));return n.push(n[0],n[1]),new yn(n,"XY",[n.length])}(this.position_,e.accuracy);n.applyTransform(this.transform_),this.set(wn,n),this.changed()}positionError_(t){this.dispatchEvent(new In(t))}getAccuracy(){return this.get(xn)}getAccuracyGeometry(){return this.get(wn)||null}getAltitude(){return this.get(bn)}getAltitudeAccuracy(){return this.get(En)}getHeading(){return this.get(Mn)}getPosition(){return this.get(Tn)}getProjection(){return this.get(Sn)}getSpeed(){return this.get(Cn)}getTracking(){return this.get(Ln)}getTrackingOptions(){return this.get(Rn)}setProjection(t){this.set(Sn,Ye(t))}setTracking(t){this.set(Ln,t)}setTrackingOptions(t){this.set(Rn,t)}},An=class extends C{constructor(t,e,i){super(t),this.map=e,this.frameState=void 0!==i?i:null}},jn=class extends An{constructor(t,e,i,n,a,s){super(t,e,a),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=void 0!==n&&n,this.activePointers=s}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}},On={SINGLECLICK:"singleclick",CLICK:u,DBLCLICK:"dblclick",POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Fn="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"",Nn=Fn.includes("safari")&&!Fn.includes("chrom")&&(Fn.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(Fn)),Gn=Fn.includes("webkit")&&!Fn.includes("edge"),Dn=Fn.includes("macintosh"),Wn="undefined"!=typeof devicePixelRatio?devicePixelRatio:1,Hn="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,Un="undefined"!=typeof Image&&Image.prototype.decode,Bn=function(){let t=!1;try{const e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return t}(),Vn="pointerdown",Kn=class extends L{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=void 0===e?1:e,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=R(i,Vn,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=R(i,"pointermove",this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(d,this.boundHandleTouchMove_,!!Bn&&{passive:!1})}emulateClick_(t){let e=new jn(On.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new jn(On.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const e=new jn(On.SINGLECLICK,this.map_,t);this.dispatchEvent(e)},250)}updateActivePointers_(t){const e=t,i=e.pointerId;if(e.type==On.POINTERUP||e.type==On.POINTERCANCEL){delete this.trackedTouches_[i];for(const t in this.trackedTouches_)if(this.trackedTouches_[t].target!==e.target){delete this.trackedTouches_[t];break}}else e.type!=On.POINTERDOWN&&e.type!=On.POINTERMOVE||(this.trackedTouches_[i]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new jn(On.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),0===this.activePointers_.length&&(this.dragListenerKeys_.forEach(P),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return 0===t.button}handlePointerDown_(t){this.emulateClicks_=0===this.activePointers_.length,this.updateActivePointers_(t);const e=new jn(On.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),0===this.dragListenerKeys_.length){const t=this.map_.getOwnerDocument();this.dragListenerKeys_.push(R(t,On.POINTERMOVE,this.handlePointerMove_,this),R(t,On.POINTERUP,this.handlePointerUp_,this),R(this.element_,On.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==t&&this.dragListenerKeys_.push(R(this.element_.getRootNode(),On.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new jn(On.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new jn(On.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;e&&!e.defaultPrevented||"boolean"==typeof t.cancelable&&!0!==t.cancelable||t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(P(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(d,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(P(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(P),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}},zn="postrender",$n="loadstart",Yn="loadend",Xn="layergroup",qn="size",Zn="target",Jn="view",Qn=1/0,ta=class{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,T(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,i=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const n=this.keyFunction_(i);return delete this.queuedElements_[n],i}enqueue(t){B(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const e=this.priorityFunction_(t);return e!=Qn&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}getCount(){return this.elements_.length}getLeftChildIndex_(t){return 2*t+1}getRightChildIndex_(t){return 2*t+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return 0===this.elements_.length}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,i=this.priorities_,n=e.length,a=e[t],s=i[t],r=t;for(;t<n>>1;){const a=this.getLeftChildIndex_(t),s=this.getRightChildIndex_(t),r=s<n&&i[s]<i[a]?s:a;e[t]=e[r],i[t]=i[r],t=r}e[t]=a,i[t]=s,this.siftDown_(r,t)}siftDown_(t,e){const i=this.elements_,n=this.priorities_,a=i[e],s=n[e];for(;e>t;){const t=this.getParentIndex_(e);if(!(n[t]>s))break;i[e]=i[t],n[e]=n[t],e=t}i[e]=a,n[e]=s}reprioritize(){const t=this.priorityFunction_,e=this.elements_,i=this.priorities_;let n=0;const a=e.length;let s,r,o;for(r=0;r<a;++r)s=e[r],o=t(s),o==Qn?delete this.queuedElements_[this.keyFunction_(s)]:(i[n]=o,e[n++]=s);e.length=n,i.length=n,this.heapify_()}},ea=class extends ta{constructor(t,e){super(e=>t.apply(null,e),t=>t[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);return e&&t[0].addEventListener(o,this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,i=e.getState();if(2===i||3===i||4===i){3!==i&&e.removeEventListener(o,this.boundHandleTileChange_);const t=e.getKey();t in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[t],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let i=0;for(;this.tilesLoading_<t&&i<e&&this.getCount()>0;){const t=this.dequeue()[0],e=t.getKey();0!==t.getState()||e in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[e]=!0,++this.tilesLoading_,++i,t.load())}}},ia={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function na(t,e,i){return function(n,a,s,r,o){if(!n)return;if(!a&&!e)return n;const l=e?0:s[0]*a,u=e?0:s[1]*a,h=o?o[0]:0,c=o?o[1]:0;let d=t[0]+l/2+h,p=t[2]-l/2+h,m=t[1]+u/2+c,f=t[3]-u/2+c;d>p&&(d=(p+d)/2,p=d),m>f&&(m=(f+m)/2,f=m);let g=St(n[0],d,p),_=St(n[1],m,f);if(r&&i&&a){const t=30*a;g+=-t*Math.log(1+Math.max(0,d-n[0])/t)+t*Math.log(1+Math.max(0,n[0]-p)/t),_+=-t*Math.log(1+Math.max(0,m-n[1])/t)+t*Math.log(1+Math.max(0,n[1]-f)/t)}return[g,_]}}function aa(t){return t}function sa(t){return Math.pow(t,3)}function ra(t){return 1-sa(1-t)}function oa(t){return 3*t*t-2*t*t*t}function la(t){return t}function ua(t,e,i,n){const a=xt(e)/i[0],s=_t(e)/i[1];return n?Math.min(t,Math.max(a,s)):Math.min(t,Math.min(a,s))}function ha(t,e,i){let n=Math.min(t,e);return n*=Math.log(1+50*Math.max(0,t/e-1))/50+1,i&&(n=Math.max(n,i),n/=Math.log(1+50*Math.max(0,i/t-1))/50+1),St(n,i/2,2*e)}function ca(t,e,i,n,a){return i=void 0===i||i,function(s,r,o,l){if(void 0!==s){const r=n?ua(t,n,o,a):t;return i&&l?ha(s,r,e):St(s,e,r)}}}function da(t){if(void 0!==t)return 0}function pa(t){if(void 0!==t)return t}function ma(t,e){setTimeout(function(){t(e)},0)}function fa(t){return!(t.sourceCenter&&t.targetCenter&&!$t(t.sourceCenter,t.targetCenter))&&t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation}function ga(t,e,i,n,a){const s=Math.cos(-a);let r=Math.sin(-a),o=t[0]*s-t[1]*r,l=t[1]*s+t[0]*r;return o+=(e[0]/2-i[0])*n,l+=(i[1]-e[1]/2)*n,r=-r,[o*s-l*r,l*s+o*r]}const _a=class extends D{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=Ze(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&function(t){Ve=!(void 0===t||t)}(),t.center&&(t.center=ui(t.center,this.projection_)),t.extent&&(t.extent=ci(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const t in ia)delete e[t];this.setProperties(e,!0);const i=function(t){let e,i,n;let a=void 0!==t.minZoom?t.minZoom:0,s=void 0!==t.maxZoom?t.maxZoom:28;const r=void 0!==t.zoomFactor?t.zoomFactor:2,o=void 0!==t.multiWorld&&t.multiWorld,l=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,u=void 0!==t.showFullExtent&&t.showFullExtent,h=Ze(t.projection,"EPSG:3857"),c=h.getExtent();let d=t.constrainOnlyCenter,p=t.extent;if(o||p||!h.isGlobal()||(d=!1,p=c),void 0!==t.resolutions){const r=t.resolutions;i=r[a],n=void 0!==r[s]?r[s]:r[r.length-1],e=t.constrainResolution?function(t,e,i,n){return e=void 0===e||e,function(a,s,r,o){if(void 0!==a){const l=t[0],u=t[t.length-1],h=i?ua(l,i,r,n):l;if(o)return e?ha(a,h,u):St(a,u,h);const c=Math.min(h,a),d=Math.floor(_(t,c,s));return t[d]>h&&d<t.length-1?t[d+1]:t[d]}}}(r,l,!d&&p,u):ca(i,n,l,!d&&p,u)}else{const o=(c?Math.max(xt(c),_t(c)):360*Qt.degrees/h.getMetersPerUnit())/256/Math.pow(2,0),m=o/Math.pow(2,28);i=t.maxResolution,void 0!==i?a=0:i=o/Math.pow(r,a),n=t.minResolution,void 0===n&&(n=void 0!==t.maxZoom?void 0!==t.maxResolution?i/Math.pow(r,s):o/Math.pow(r,s):m),s=a+Math.floor(Math.log(i/n)/Math.log(r)),n=i/Math.pow(r,s-a),e=t.constrainResolution?function(t,e,i,n,a,s){return n=void 0===n||n,i=void 0!==i?i:0,function(r,o,l,u){if(void 0!==r){const h=a?ua(e,a,l,s):e;if(u)return n?ha(r,h,i):St(r,i,h);const c=1e-9,d=Math.ceil(Math.log(e/h)/Math.log(t)-c),p=-o*(.5-c)+.5,m=Math.min(h,r),f=Math.floor(Math.log(e/m)/Math.log(t)+p),g=Math.max(d,f);return St(e/Math.pow(t,g),i,h)}}}(r,i,n,l,!d&&p,u):ca(i,n,l,!d&&p,u)}return{constraint:e,maxResolution:i,minResolution:n,minZoom:a,zoomFactor:r}}(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=i.minZoom;const n=function(t){if(void 0!==t.extent){const e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return na(t.extent,t.constrainOnlyCenter,e)}const e=Ze(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,na(t,!1,!1)}return aa}(t),a=i.constraint,s=function(t){if(void 0===t.enableRotation||t.enableRotation){const e=t.constrainRotation;return void 0===e||!0===e?function(){const t=It(5);return function(e,i){return i||void 0===e?e:Math.abs(e)<=t?0:e}}():!1===e?pa:"number"==typeof e?function(t){const e=2*Math.PI/t;return function(t,i){return i?t:void 0!==t?t=Math.floor(t/e+.5)*e:void 0}}(e):pa}return da}(t);this.constraints_={center:n,resolution:a,rotation:s},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const i=this.getCenterInternal();if(i){const n=t||[0,0,0,0];e=e||[0,0,0,0];const a=this.getResolution(),s=a/2*(n[3]-e[3]+e[1]-n[1]),r=a/2*(n[0]-e[0]+e[2]-n[2]);this.setCenterInternal([i[0]+s,i[1]-r])}}getUpdatedOptions_(t){const e=this.getProperties();return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let t=0;t<e.length;++t){let i=arguments[t];i.center&&(i=Object.assign({},i),i.center=ui(i.center,this.getProjection())),i.anchor&&(i=Object.assign({},i),i.anchor=ui(i.anchor,this.getProjection())),e[t]=i}this.animateInternal.apply(this,e)}animateInternal(t){let e,i=arguments.length;i>1&&"function"==typeof arguments[i-1]&&(e=arguments[i-1],--i);let n=0;for(;n<i&&!this.isDef();++n){const t=arguments[n];t.center&&this.setCenterInternal(t.center),void 0!==t.zoom?this.setZoom(t.zoom):t.resolution&&this.setResolution(t.resolution),void 0!==t.rotation&&this.setRotation(t.rotation)}if(n===i)return void(e&&ma(e,!0));let a=Date.now(),s=this.targetCenter_.slice(),r=this.targetResolution_,o=this.targetRotation_;const l=[];for(;n<i;++n){const t=arguments[n],i={start:a,complete:!1,anchor:t.anchor,duration:void 0!==t.duration?t.duration:1e3,easing:t.easing||oa,callback:e};if(t.center&&(i.sourceCenter=s,i.targetCenter=t.center.slice(),s=i.targetCenter),void 0!==t.zoom?(i.sourceResolution=r,i.targetResolution=this.getResolutionForZoom(t.zoom),r=i.targetResolution):t.resolution&&(i.sourceResolution=r,i.targetResolution=t.resolution,r=i.targetResolution),void 0!==t.rotation){i.sourceRotation=o;const e=Pt(t.rotation-o+Math.PI,2*Math.PI)-Math.PI;i.targetRotation=o+e,o=i.targetRotation}fa(i)?i.complete=!0:a+=i.duration,l.push(i)}this.animations_.push(l),this.setHint(0,1),this.updateAnimations_()}getAnimating(){return this.hints_[0]>0}getInteracting(){return this.hints_[1]>0}cancelAnimations(){let t;this.setHint(0,-this.hints_[0]);for(let e=0,i=this.animations_.length;e<i;++e){const i=this.animations_[e];if(i[0].callback&&ma(i[0].callback,!1),!t)for(let e=0,n=i.length;e<n;++e){const n=i[e];if(!n.complete){t=n.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let i=this.animations_.length-1;i>=0;--i){const n=this.animations_[i];let a=!0;for(let i=0,s=n.length;i<s;++i){const s=n[i];if(s.complete)continue;const r=t-s.start;let o=s.duration>0?r/s.duration:1;o>=1?(s.complete=!0,o=1):a=!1;const l=s.easing(o);if(s.sourceCenter){const t=s.sourceCenter[0],e=s.sourceCenter[1],i=s.targetCenter[0],n=s.targetCenter[1];this.nextCenter_=s.targetCenter;const a=t+l*(i-t),r=e+l*(n-e);this.targetCenter_=[a,r]}if(s.sourceResolution&&s.targetResolution){const t=1===l?s.targetResolution:s.sourceResolution+l*(s.targetResolution-s.sourceResolution);if(s.anchor){const e=this.getViewportSize_(this.getRotation()),i=this.constraints_.resolution(t,0,e,!0);this.targetCenter_=this.calculateCenterZoom(i,s.anchor)}this.nextResolution_=s.targetResolution,this.targetResolution_=t,this.applyTargetState_(!0)}if(void 0!==s.sourceRotation&&void 0!==s.targetRotation){const t=1===l?Pt(s.targetRotation+Math.PI,2*Math.PI)-Math.PI:s.sourceRotation+l*(s.targetRotation-s.sourceRotation);if(s.anchor){const e=this.constraints_.rotation(t,!0);this.targetCenter_=this.calculateCenterRotate(e,s.anchor)}this.nextRotation_=s.targetRotation,this.targetRotation_=t}if(this.applyTargetState_(!0),e=!0,!s.complete)break}if(a){this.animations_[i]=null,this.setHint(0,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const t=n[0].callback;t&&ma(t,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let i;const n=this.getCenterInternal();var a,s;return void 0!==n&&(i=[n[0]-e[0],n[1]-e[1]],Yt(i,t-this.getRotation()),s=e,(a=i)[0]+=+s[0],a[1]+=+s[1]),i}calculateCenterZoom(t,e){let i;const n=this.getCenterInternal(),a=this.getResolution();return void 0!==n&&void 0!==a&&(i=[e[0]-t*(e[0]-n[0])/a,e[1]-t*(e[1]-n[1])/a]),i}getViewportSize_(t){const e=this.viewportSize_;if(t){const i=e[0],n=e[1];return[Math.abs(i*Math.cos(t))+Math.abs(n*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(n*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t?li(t,this.getProjection()):t}getCenterInternal(){return this.get(ia.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){return hi(this.calculateExtentInternal(t),this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();B(e,"The view center is not defined");const i=this.getResolution();B(void 0!==i,"The view resolution is not defined");const n=this.getRotation();return B(void 0!==n,"The view rotation is not defined"),ft(e,i,n,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(ia.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(ci(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const i=xt(t)/e[0],n=_t(t)/e[1];return Math.max(i,n)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,n=Math.log(e/i)/Math.log(t);return function(i){return e/Math.pow(t,i*n)}}getRotation(){return this.get(ia.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,a=Math.log(i/n)/e;return function(t){return Math.log(i/t)/e/a}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const i=this.padding_;return i&&(e=[e[0]-i[1]-i[3],e[1]-i[0]-i[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),i=this.getRotation();let n=this.getCenterInternal();const a=this.padding_;if(a){const t=this.getViewportSizeMinusPadding_();n=ga(n,this.getViewportSize_(),[t[0]/2+a[3],t[1]/2+a[0]],e,i)}return{center:n.slice(0),projection:void 0!==t?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e,i,n=this.minZoom_||0;if(this.resolutions_){const a=_(this.resolutions_,t,1);n=a,e=this.resolutions_[a],i=a==this.resolutions_.length-1?2:e/this.resolutions_[a+1]}else e=this.maxResolution_,i=this.zoomFactor_;return n+Math.log(e/t)/Math.log(i)}getResolutionForZoom(t){if(this.resolutions_?.length){if(1===this.resolutions_.length)return this.resolutions_[0];const e=St(Math.floor(t),0,this.resolutions_.length-2),i=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(i,St(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let i;if(B(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,"Invalid extent or geometry provided as `geometry`"),Array.isArray(t))B(!bt(t),"Cannot fit empty extent provided as `geometry`"),i=vn(ci(t,this.getProjection()));else if("Circle"===t.getType()){const e=ci(t.getExtent(),this.getProjection());i=vn(e),i.rotate(this.getRotation(),pt(e))}else{const e=oi();i=e?t.clone().transform(e,this.getProjection()):t}this.fitInternal(i,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),i=Math.cos(e),n=Math.sin(-e),a=t.getFlatCoordinates(),s=t.getStride();let r=1/0,o=1/0,l=-1/0,u=-1/0;for(let t=0,e=a.length;t<e;t+=s){const e=a[t]*i-a[t+1]*n,s=a[t]*n+a[t+1]*i;r=Math.min(r,e),o=Math.min(o,s),l=Math.max(l,e),u=Math.max(u,s)}return[r,o,l,u]}fitInternal(t,e){let i=(e=e||{}).size;i||(i=this.getViewportSizeMinusPadding_());const n=void 0!==e.padding?e.padding:[0,0,0,0],a=void 0!==e.nearest&&e.nearest;let s;s=void 0!==e.minResolution?e.minResolution:void 0!==e.maxZoom?this.getResolutionForZoom(e.maxZoom):0;const r=this.rotatedExtentForGeometry(t);let o=this.getResolutionForExtentInternal(r,[i[0]-n[1]-n[3],i[1]-n[0]-n[2]]);o=isNaN(o)?s:Math.max(o,s),o=this.getConstrainedResolution(o,a?0:1);const l=this.getRotation(),u=Math.sin(l),h=Math.cos(l),c=pt(r);c[0]+=(n[1]-n[3])/2*o,c[1]+=(n[0]-n[2])/2*o;const d=c[0]*h-c[1]*u,p=c[1]*h+c[0]*u,m=this.getConstrainedCenter([d,p],o),f=e.callback?e.callback:b;void 0!==e.duration?this.animateInternal({resolution:o,center:m,duration:e.duration,easing:e.easing},f):(this.targetResolution_=o,this.targetCenter_=m,this.applyTargetState_(!1,!0),ma(f,!0))}centerOn(t,e,i){this.centerOnInternal(ui(t,this.getProjection()),e,i)}centerOnInternal(t,e,i){this.setCenterInternal(ga(t,e,i,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,i,n){let a;const s=this.padding_;if(s&&t){const r=this.getViewportSizeMinusPadding_(-i),o=ga(t,n,[r[0]/2+s[3],r[1]/2+s[0]],e,i);a=[t[0]-o[0],t[1]-o[1]]}return a}isDef(){return!!this.getCenterInternal()&&void 0!==this.getResolution()}adjustCenter(t){const e=li(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&ui(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const i=this.getAnimating()||this.getInteracting(),n=this.getViewportSize_(this.getRotation()),a=this.constraints_.resolution(this.targetResolution_*t,0,n,i);e&&(this.targetCenter_=this.calculateCenterZoom(a,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=ui(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const i=this.getAnimating()||this.getInteracting(),n=this.constraints_.rotation(this.targetRotation_+t,i);e&&(this.targetCenter_=this.calculateCenterRotate(n,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t?ui(t,this.getProjection()):t)}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const i=this.getAnimating()||this.getInteracting()||e,n=this.constraints_.rotation(this.targetRotation_,i),a=this.getViewportSize_(n),s=this.constraints_.resolution(this.targetResolution_,0,a,i),r=this.constraints_.center(this.targetCenter_,s,a,i,this.calculateCenterShift(this.targetCenter_,s,n,a));this.get(ia.ROTATION)!==n&&this.set(ia.ROTATION,n),this.get(ia.RESOLUTION)!==s&&(this.set(ia.RESOLUTION,s),this.set("zoom",this.getZoom(),!0)),r&&this.get(ia.CENTER)&&$t(this.get(ia.CENTER),r)||this.set(ia.CENTER,r),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,i){t=void 0!==t?t:200;const n=e||0,a=this.constraints_.rotation(this.targetRotation_),s=this.getViewportSize_(a),r=this.constraints_.resolution(this.targetResolution_,n,s),o=this.constraints_.center(this.targetCenter_,r,s,!1,this.calculateCenterShift(this.targetCenter_,r,a,s));if(0===t&&!this.cancelAnchor_)return this.targetResolution_=r,this.targetRotation_=a,this.targetCenter_=o,void this.applyTargetState_();i=i||(0===t?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,this.getResolution()===r&&this.getRotation()===a&&this.getCenterInternal()&&$t(this.getCenterInternal(),o)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:a,center:o,resolution:r,duration:t,easing:ra,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(1,1)}endInteraction(t,e,i){i=i&&ui(i,this.getProjection()),this.endInteractionInternal(t,e,i)}endInteractionInternal(t,e,i){this.getInteracting()&&(this.setHint(1,-1),this.resolveConstraints(t,e,i))}getConstrainedCenter(t,e){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),i)}getConstrainedZoom(t,e){const i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,e))}getConstrainedResolution(t,e){e=e||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,i)}},ya="ol-hidden",ka="ol-unselectable",va="ol-control",xa="ol-collapsed",wa=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z0-9]+?)\\s*$"].join(""),"i"),ba=["style","variant","weight","size","lineHeight","family"],Ea={normal:400,bold:700},Ma=function(t){const e=t.match(wa);if(!e)return null;const i={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let t=0,n=ba.length;t<n;++t){const n=e[t+1];void 0!==n&&(i[ba[t]]="string"==typeof n?n.trim():n)}return isNaN(Number(i.weight))&&i.weight in Ea&&(i.weight=Ea[i.weight]),i.families=i.family.split(/,\s?/).map(t=>t.trim().replace(/^['"]|['"]$/g,"")),i};function Ta(t,e,i,n){let a;return a=i&&i.length?i.shift():Hn?new class extends OffscreenCanvas{style={}}(t??300,e??150):document.createElement("canvas"),t&&(a.width=t),e&&(a.height=e),a.getContext("2d",n)}let Sa;function Ca(){return Sa||(Sa=Ta(1,1)),Sa}function La(t){const e=t.canvas;e.width=1,e.height=1,t.clearRect(0,0,1,1)}function Ra(t,e){const i=e.parentNode;i&&i.replaceChild(t,e)}function Ia(){return new Proxy({childNodes:[],appendChild:function(t){return this.childNodes.push(t),t},remove:function(){},removeChild:function(t){const e=this.childNodes.indexOf(t);if(-1===e)throw new Error("Node to remove was not found");return this.childNodes.splice(e,1),t},insertBefore:function(t,e){const i=this.childNodes.indexOf(e);if(-1===i)throw new Error("Reference node not found");return this.childNodes.splice(i,0,t),t},style:{}},{get:(t,e,i)=>"firstElementChild"===e?t.childNodes.length>0?t.childNodes[0]:null:Reflect.get(t,e,i)})}function Pa(t){return"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas}const Aa=class extends D{constructor(t){super();const e=t.element;!e||t.target||e.style.pointerEvents||(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&this.element?.remove();for(let t=0,e=this.listenerKeys.length;t<e;++t)P(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=t,t){const e=this.target_??t.getOverlayContainerStopEvent();this.element&&e.appendChild(this.element),this.render!==b&&this.listenerKeys.push(R(t,zn,this.render,this)),t.render()}}render(t){}setTarget(t){this.target_="string"==typeof t?document.getElementById(t):t}},ja=class extends Aa{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=void 0===t.collapsed||t.collapsed,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=void 0!==t.collapsible,this.collapsible_=void 0===t.collapsible||t.collapsible,this.collapsible_||(this.collapsed_=!1),this.attributions_=t.attributions;const e=void 0!==t.className?t.className:"ol-attribution",i=void 0!==t.tipLabel?t.tipLabel:"Attributions",n=void 0!==t.expandClassName?t.expandClassName:e+"-expand",a=void 0!==t.collapseLabel?t.collapseLabel:"",s=void 0!==t.collapseClassName?t.collapseClassName:e+"-collapse";"string"==typeof a?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=a,this.collapseLabel_.className=s):this.collapseLabel_=a;const r=void 0!==t.label?t.label:"i";"string"==typeof r?(this.label_=document.createElement("span"),this.label_.textContent=r,this.label_.className=n):this.label_=r;const o=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(o),this.toggleButton_.addEventListener(u,this.handleClick_.bind(this),!1);const l=e+" "+ka+" "+va+(this.collapsed_&&this.collapsible_?" "+xa:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=l,h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e=this.getMap().getAllLayers(),i=new Set(e.flatMap(e=>e.getAttributions(t)));if(void 0!==this.attributions_&&(Array.isArray(this.attributions_)?this.attributions_.forEach(t=>i.add(t)):i.add(this.attributions_)),!this.overrideCollapsible_){const t=!e.some(t=>!1===t.getSource()?.getAttributionsCollapsible());this.setCollapsible(t)}return Array.from(i)}async updateElement_(t){if(!t)return void(this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1));const e=await Promise.all(this.collectSourceAttributions_(t).map(t=>M(()=>t))),i=e.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!v(e,this.renderedAttributions_)){!function(t){for(;t.lastChild;)t.lastChild.remove()}(this.ulElement_);for(let t=0,i=e.length;t<i;++t){const i=document.createElement("li");i.innerHTML=e[t],this.ulElement_.appendChild(i)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(xa),this.collapsed_?Ra(this.collapseLabel_,this.label_):Ra(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}},Oa=class extends Aa{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=void 0!==t.className?t.className:"ol-rotate",i=void 0!==t.label?t.label:"",n=void 0!==t.compassClassName?t.compassClassName:"ol-compass";this.label_=null,"string"==typeof i?(this.label_=document.createElement("span"),this.label_.className=n,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(n));const a=t.tipLabel?t.tipLabel:"Reset rotation",s=document.createElement("button");s.className=e+"-reset",s.setAttribute("type","button"),s.title=a,s.appendChild(this.label_),s.addEventListener(u,this.handleClick_.bind(this),!1);const r=e+" "+ka+" "+va,o=this.element;o.className=r,o.appendChild(s),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=void 0!==t.duration?t.duration:250,this.autoHide_=void 0===t.autoHide||t.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(ya)}handleClick_(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const e=t.getRotation();void 0!==e&&(this.duration_>0&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:ra}):t.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const i=e.viewState.rotation;if(i!=this.rotation_){const t="rotate("+i+"rad)";if(this.autoHide_){const t=this.element.classList.contains(ya);t||0!==i?t&&0!==i&&this.element.classList.remove(ya):this.element.classList.add(ya)}this.label_.style.transform=t}this.rotation_=i}},Fa=class extends Aa{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=void 0!==t.className?t.className:"ol-zoom",i=void 0!==t.delta?t.delta:1,n=void 0!==t.zoomInClassName?t.zoomInClassName:e+"-in",a=void 0!==t.zoomOutClassName?t.zoomOutClassName:e+"-out",s=void 0!==t.zoomInLabel?t.zoomInLabel:"+",r=void 0!==t.zoomOutLabel?t.zoomOutLabel:"",o=void 0!==t.zoomInTipLabel?t.zoomInTipLabel:"Zoom in",l=void 0!==t.zoomOutTipLabel?t.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=n,h.setAttribute("type","button"),h.title=o,h.appendChild("string"==typeof s?document.createTextNode(s):s),h.addEventListener(u,this.handleClick_.bind(this,i),!1);const c=document.createElement("button");c.className=a,c.setAttribute("type","button"),c.title=l,c.appendChild("string"==typeof r?document.createTextNode(r):r),c.addEventListener(u,this.handleClick_.bind(this,-i),!1);const d=e+" "+ka+" "+va,p=this.element;p.className=d,p.appendChild(h),p.appendChild(c),this.duration_=void 0!==t.duration?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const e=this.getMap().getView();if(!e)return;const i=e.getZoom();if(void 0!==i){const n=e.getConstrainedZoom(i+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:n,duration:this.duration_,easing:ra})):e.setZoom(n)}}},Na=class{constructor(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let i=e-3;for(;i>0&&this.points_[i+2]>t;)i-=3;const n=this.points_[e+2]-this.points_[i+2];if(n<1e3/60)return!1;const a=this.points_[e]-this.points_[i],s=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(s,a),this.initialVelocity_=Math.sqrt(a*a+s*s)/n,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}},Ga="active";function Da(t,e,i,n){const a=t.getZoom();if(void 0===a)return;const s=t.getConstrainedZoom(a+e),r=t.getResolutionForZoom(s);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:r,anchor:i,duration:void 0!==n?n:250,easing:ra})}const Wa=class extends D{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(Ga)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(Ga,t)}setMap(t){this.map_=t}},Ha=class extends Wa{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:250}handleEvent(t){let e=!1;if(t.type==On.DBLCLICK){const i=t.originalEvent,n=t.map,a=t.coordinate,s=i.shiftKey?-this.delta_:this.delta_;Da(n.getView(),s,a,this.duration_),i.preventDefault(),e=!0}return!e}};function Ua(t){const e=arguments;return function(t){let i=!0;for(let n=0,a=e.length;n<a&&(i=i&&e[n](t),i);++n);return i}}const Ba=function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Va=function(t){const e=t.map.getTargetElement(),i=e.getRootNode();return!(i instanceof ShadowRoot?i.host:e).hasAttribute("tabindex")||function(t){const e=t.map.getTargetElement(),i=e.getRootNode(),n=t.map.getOwnerDocument().activeElement;return i instanceof ShadowRoot?i.host.contains(n):e.contains(n)}(t)},Ka=x,za=function(t){const e=t.originalEvent;return"pointerId"in e&&0==e.button&&!(Gn&&Dn&&e.ctrlKey)},$a=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},Ya=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Xa=function(t){const e=t.originalEvent,i=e.target.tagName;return"INPUT"!==i&&"SELECT"!==i&&"TEXTAREA"!==i&&!e.target.isContentEditable},qa=function(t){const e=t.originalEvent;return"pointerId"in e&&"mouse"==e.pointerType},Za=function(t){const e=t.originalEvent;return"pointerId"in e&&e.isPrimary&&0===e.button};function Ja(t){const e=t.length;let i=0,n=0;for(let a=0;a<e;a++)i+=t[a].clientX,n+=t[a].clientY;return{clientX:i/e,clientY:n/e}}const Qa=class extends Wa{constructor(t){super(t=t||{}),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==On.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==On.POINTERUP){const e=this.handleUpEvent(t);this.handlingDownUpSequence=e&&this.targetPointers.length>0}}else if(t.type==On.POINTERDOWN){const i=this.handleDownEvent(t);this.handlingDownUpSequence=i,e=this.stopDown(i)}else t.type==On.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}},ts=class extends Qa{constructor(t){super({stopDown:w}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const e=t.condition?t.condition:Ua($a,Za);this.condition_=t.onFocusOnly?Ua(Va,e):e,this.noKinetic_=!1}handleDragEvent(t){const e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());const i=this.targetPointers,n=e.getEventPixel(Ja(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(n[0],n[1]),this.lastCentroid){const e=[this.lastCentroid[0]-n[0],n[1]-this.lastCentroid[1]],i=t.map.getView();a=e,s=i.getResolution(),a[0]*=s,a[1]*=s,Yt(e,i.getRotation()),i.adjustCenterInternal(e)}}else this.kinetic_&&this.kinetic_.begin();var a,s;this.lastCentroid=n,this.lastPointersCount_=i.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,i=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const t=this.kinetic_.getDistance(),n=this.kinetic_.getAngle(),a=i.getCenterInternal(),s=e.getPixelFromCoordinateInternal(a),r=e.getCoordinateFromPixelInternal([s[0]-t*Math.cos(n),s[1]-t*Math.sin(n)]);i.animateInternal({center:i.getConstrainedCenter(r),duration:500,easing:ra})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}},es=class extends Qa{constructor(t){t=t||{},super({stopDown:w}),this.condition_=t.condition?t.condition:Ba,this.lastAngle_=void 0,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){if(!qa(t))return;const e=t.map,i=e.getView();if(i.getConstraints().rotation===da)return;const n=e.getSize(),a=t.pixel,s=Math.atan2(n[1]/2-a[1],a[0]-n[0]/2);if(void 0!==this.lastAngle_){const t=s-this.lastAngle_;i.adjustRotationInternal(-t)}this.lastAngle_=s}handleUpEvent(t){return!qa(t)||(t.map.getView().endInteraction(this.duration_),!1)}handleDownEvent(t){return!!qa(t)&&(!(!za(t)||!this.condition_(t))&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0))}},is=class extends m{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,i="px",n=this.element_.style;n.left=Math.min(t[0],e[0])+i,n.top=Math.min(t[1],e[1])+i,n.width=Math.abs(e[0]-t[0])+i,n.height=Math.abs(e[1]-t[1])+i}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const t=this.startPixel_,e=this.endPixel_,i=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new kn([i])}getGeometry(){return this.geometry_}},ns="boxcancel";class as extends C{constructor(t,e,i){super(t),this.coordinate=e,this.mapBrowserEvent=i}}const ss=class extends Qa{constructor(t){super(),this.on,this.once,this.un,t=t??{},this.box_=new is(t.className||"ol-dragbox"),this.minArea_=t.minArea??64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition??za,this.boxEndCondition_=t.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,i){const n=i[0]-e[0],a=i[1]-e[1];return n*n+a*a>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.startPixel_&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new as("boxdrag",t.coordinate,t)))}handleUpEvent(t){if(!this.startPixel_)return!1;const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new as(e?"boxend":ns,t.coordinate,t)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new as("boxstart",t.coordinate,t)),!0)}onBoxEnd(t){}setActive(t){t||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new as(ns,this.startPixel_,null)),this.startPixel_=null)),super.setActive(t)}setMap(t){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new as(ns,this.startPixel_,null)),this.startPixel_=null)),super.setMap(t)}},rs=class extends ss{constructor(t){super({condition:(t=t||{}).condition?t.condition:Ya,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=void 0!==t.duration?t.duration:200,this.out_=void 0!==t.out&&t.out}onBoxEnd(t){const e=this.getMap().getView();let i=this.getGeometry();if(this.out_){const t=e.rotatedExtentForGeometry(i),n=e.getResolutionForExtentInternal(t),a=e.getResolution()/n;i=i.clone(),i.scale(a*a)}e.fitInternal(i,{duration:this.duration_,easing:ra})}},os="ArrowLeft",ls="ArrowRight",us="ArrowDown",hs=class extends Wa{constructor(t){super(),t=t||{},this.defaultCondition_=function(t){return $a(t)&&Xa(t)},this.condition_=void 0!==t.condition?t.condition:this.defaultCondition_,this.duration_=void 0!==t.duration?t.duration:100,this.pixelDelta_=void 0!==t.pixelDelta?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==h){const i=t.originalEvent,n=i.key;if(this.condition_(t)&&(n==us||n==os||n==ls||"ArrowUp"==n)){const a=t.map.getView(),s=a.getResolution()*this.pixelDelta_;let r=0,o=0;n==us?o=-s:n==os?r=-s:n==ls?r=s:o=s;const l=[r,o];Yt(l,a.getRotation()),function(t,e,i){const n=t.getCenterInternal();if(n){const a=[n[0]+e[0],n[1]+e[1]];t.animateInternal({duration:void 0!==i?i:250,easing:la,center:t.getConstrainedCenter(a)})}}(a,l,this.duration_),i.preventDefault(),e=!0}}return!e}},cs=class extends Wa{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:function(t){return!function(t){const e=t.originalEvent;return Dn?e.metaKey:e.ctrlKey}(t)&&Xa(t)},this.delta_=t.delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:100}handleEvent(t){let e=!1;if(t.type==h||t.type==c){const i=t.originalEvent,n=i.key;if(this.condition_(t)&&("+"===n||"-"===n)){const a=t.map,s="+"===n?this.delta_:-this.delta_;Da(a.getView(),s,void 0,this.duration_),i.preventDefault(),e=!0}}return!e}},ds=class extends Wa{constructor(t){super(t=t||{}),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=void 0!==t.maxDelta?t.maxDelta:1,this.duration_=void 0!==t.duration?t.duration:250,this.timeout_=void 0!==t.timeout?t.timeout:80,this.useAnchor_=void 0===t.useAnchor||t.useAnchor,this.constrainResolution_=void 0!==t.constrainResolution&&t.constrainResolution;const e=t.condition?t.condition:Ka;this.condition_=t.onFocusOnly?Ua(Va,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();t&&t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?t.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(t){if(!this.condition_(t))return!0;if(t.type!==p)return!0;const e=t.map,i=t.originalEvent;i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.pixel);let n=i.deltaY;switch(i.deltaMode){case WheelEvent.DOM_DELTA_LINE:n*=40;break;case WheelEvent.DOM_DELTA_PAGE:n*=300}if(0===n)return!1;this.lastDelta_=n;const a=Date.now();void 0===this.startTime_&&(this.startTime_=a),(!this.mode_||a-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(n)<4?"trackpad":"wheel");const s=e.getView();if("trackpad"===this.mode_&&!s.getConstrainResolution()&&!this.constrainResolution_)return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(s.getAnimating()&&s.cancelAnimations(),s.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),s.adjustZoom(-n/this.deltaPerZoom_,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=a,!1;this.totalDelta_+=n;const r=Math.max(this.timeout_-(a-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,e),r),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let i=-St(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),Da(e,i,this.lastAnchor_?t.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}},ps=class extends Qa{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=w),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==t.threshold?t.threshold:.3,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){let e=0;const i=this.targetPointers[0],n=this.targetPointers[1],a=Math.atan2(n.clientY-i.clientY,n.clientX-i.clientX);if(void 0!==this.lastAngle_){const t=a-this.lastAngle_;this.rotationDelta_+=t,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=t}this.lastAngle_=a;const s=t.map,r=s.getView();r.getConstraints().rotation!==da&&(this.anchor_=s.getCoordinateFromPixelInternal(s.getEventPixel(Ja(this.targetPointers))),this.rotating_&&(s.render(),r.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){return!(this.targetPointers.length<2)||(t.map.getView().endInteraction(this.duration_),!1)}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}},ms=class extends Qa{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=w),super(e),this.anchor_=null,this.duration_=void 0!==t.duration?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const i=this.targetPointers[0],n=this.targetPointers[1],a=i.clientX-n.clientX,s=i.clientY-n.clientY,r=Math.sqrt(a*a+s*s);void 0!==this.lastDistance_&&(e=this.lastDistance_/r),this.lastDistance_=r;const o=t.map,l=o.getView();1!=e&&(this.lastScaleDelta_=e),this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(Ja(this.targetPointers))),o.render(),l.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){const e=t.map.getView(),i=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,i),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}},fs="opacity",gs="visible",_s="extent",ys="zIndex",ks="maxResolution",vs="minResolution",xs="maxZoom",ws="minZoom",bs="source",Es="map",Ms=class extends D{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);"object"==typeof t.properties&&(delete e.properties,Object.assign(e,t.properties)),e[fs]=void 0!==t.opacity?t.opacity:1,B("number"==typeof e[fs],"Layer opacity must be a number"),e[gs]=void 0===t.visible||t.visible,e[ys]=t.zIndex,e[ks]=void 0!==t.maxResolution?t.maxResolution:1/0,e[vs]=void 0!==t.minResolution?t.minResolution:0,e[ws]=void 0!==t.minZoom?t.minZoom:-1/0,e[xs]=void 0!==t.maxZoom?t.maxZoom:1/0,this.className_=void 0!==e.className?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:void 0===t||t},i=this.getZIndex();return e.opacity=St(Math.round(100*this.getOpacity())/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==i||e.managed?i:1/0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return O()}getLayerStatesArray(t){return O()}getExtent(){return this.get(_s)}getMaxResolution(){return this.get(ks)}getMinResolution(){return this.get(vs)}getMinZoom(){return this.get(ws)}getMaxZoom(){return this.get(xs)}getOpacity(){return this.get(fs)}getSourceState(){return O()}getVisible(){return this.get(gs)}getZIndex(){return this.get(ys)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(_s,t)}setMaxResolution(t){this.set(ks,t)}setMinResolution(t){this.set(vs,t)}setMaxZoom(t){this.set(xs,t)}setMinZoom(t){this.set(ws,t)}setOpacity(t){B("number"==typeof t,"Layer opacity must be a number"),this.set(fs,t)}setVisible(t){this.set(gs,t)}setZIndex(t){this.set(ys,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}},Ts="addlayer",Ss="removelayer";class Cs extends C{constructor(t,e){super(t),this.layer=e}}const Ls="layers";class Rs extends Ms{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let i=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(Ls,this.handleLayersChanged_),i?Array.isArray(i)?i=new U(i.slice(),{unique:!0}):B("function"==typeof i.getArray,"Expected `layers` to be an array or a `Collection`"):i=new U(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(P),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(R(t,a,this.handleLayersAdd_,this),R(t,s,this.handleLayersRemove_,this));for(const t in this.listenerKeys_)this.listenerKeys_[t].forEach(P);T(this.listenerKeys_);const e=t.getArray();for(let t=0,i=e.length;t<i;t++){const i=e[t];this.registerLayerListeners_(i),this.dispatchEvent(new Cs(Ts,i))}this.changed()}registerLayerListeners_(t){const e=[R(t,r,this.handleLayerChange_,this),R(t,o,this.handleLayerChange_,this)];t instanceof Rs&&e.push(R(t,Ts,this.handleLayerGroupAdd_,this),R(t,Ss,this.handleLayerGroupRemove_,this)),this.listenerKeys_[N(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new Cs(Ts,t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new Cs(Ss,t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new Cs(Ts,e)),this.changed()}handleLayersRemove_(t){const e=t.element,i=N(e);this.listenerKeys_[i].forEach(P),delete this.listenerKeys_[i],this.dispatchEvent(new Cs(Ss,e)),this.changed()}getLayers(){return this.get(Ls)}setLayers(t){const e=this.getLayers();if(e){const t=e.getArray();for(let e=0,i=t.length;e<i;++e)this.dispatchEvent(new Cs(Ss,t[e]))}this.set(Ls,t)}getLayersArray(t){return t=void 0!==t?t:[],this.getLayers().forEach(function(e){e.getLayersArray(t)}),t}getLayerStatesArray(t){const e=void 0!==t?t:[],i=e.length;this.getLayers().forEach(function(t){t.getLayerStatesArray(e)});const n=this.getLayerState();let a=n.zIndex;t||void 0!==n.zIndex||(a=0);for(let t=i,s=e.length;t<s;t++){const i=e[t];i.opacity*=n.opacity,i.visible=i.visible&&n.visible,i.maxResolution=Math.min(i.maxResolution,n.maxResolution),i.minResolution=Math.max(i.minResolution,n.minResolution),i.minZoom=Math.max(i.minZoom,n.minZoom),i.maxZoom=Math.min(i.maxZoom,n.maxZoom),void 0!==n.extent&&(void 0!==i.extent?i.extent=yt(i.extent,n.extent):i.extent=n.extent),void 0===i.zIndex&&(i.zIndex=a)}return e}getSourceState(){return"ready"}}const Is=Rs,Ps="prerender",As="postrender",js="precompose",Os="postcompose",Fs="rendercomplete";function Ns(t,e){if(!t.visible)return!1;const i=e.resolution;if(i<t.minResolution||i>=t.maxResolution)return!1;const n=e.zoom;return n>t.minZoom&&n<=t.maxZoom}const Gs=class extends Ms{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(bs,this.handleSourcePropertyChange_);const i=t.source?t.source:null;this.setSource(i)}getLayersArray(t){return(t=t||[]).push(this),t}getLayerStatesArray(t){return(t=t||[]).push(this.getLayerState()),t}getSource(){return this.get(bs)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),this.sourceReady_||"ready"!==this.getSource().getState()||(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(P(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=R(t,o,this.handleSourceChange_,this),"ready"===t.getState()&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return this.renderer_&&this.rendered?this.renderer_.getData(t):null}isVisible(t){let e;const i=this.getMapInternal();let n;if(!t&&i&&(t=i.getView()),e=t instanceof _a?{viewState:t.getState(),extent:t.calculateExtent()}:t,!e.layerStatesArray&&i&&(e.layerStatesArray=i.getLayerGroup().getLayerStatesArray()),e.layerStatesArray){if(n=e.layerStatesArray.find(t=>t.layer===this),!n)return!1}else n=this.getLayerState();const a=this.getExtent();return Ns(n,e.viewState)&&(!a||wt(a,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];const e=this.getSource()?.getAttributions();if(!e)return[];let i=e(t instanceof _a?t.getViewStateAndExtent():t);return Array.isArray(i)||(i=[i]),i}render(t,e){const i=this.getRenderer();return i.prepareFrame(t)?(this.rendered=!0,i.renderFrame(t,e)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(t,e){}renderDeferred(t){const e=this.getRenderer();e&&e.renderDeferred(t)}setMapInternal(t){t||this.unrender(),this.set(Es,t)}getMapInternal(){return this.get(Es)}setMap(t){this.mapPrecomposeKey_&&(P(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(P(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=R(t,js,this.handlePrecompose_,this),this.mapRenderKey_=R(this,o,t.render,t),this.changed())}handlePrecompose_(t){const e=t.frameState.layerStatesArray,i=this.getLayerState(!1);B(!e.some(t=>t.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),e.push(i)}setSource(t){this.set(bs,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}};function Ds(t,e,i=0,n=t.length-1,a=Hs){for(;n>i;){if(n-i>600){const s=n-i+1,r=e-i+1,o=Math.log(s),l=.5*Math.exp(2*o/3),u=.5*Math.sqrt(o*l*(s-l)/s)*(r-s/2<0?-1:1);Ds(t,e,Math.max(i,Math.floor(e-r*l/s+u)),Math.min(n,Math.floor(e+(s-r)*l/s+u)),a)}const s=t[e];let r=i,o=n;for(Ws(t,i,e),a(t[n],s)>0&&Ws(t,i,n);r<o;){for(Ws(t,r,o),r++,o--;a(t[r],s)<0;)r++;for(;a(t[o],s)>0;)o--}0===a(t[i],s)?Ws(t,i,o):(o++,Ws(t,o,n)),o<=e&&(i=o+1),e<=o&&(n=o-1)}}function Ws(t,e,i){const n=t[e];t[e]=t[i],t[i]=n}function Hs(t,e){return t<e?-1:t>e?1:0}class Us{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}all(){return this._all(this.data,[])}search(t){let e=this.data;const i=[];if(!tr(t,e))return i;const n=this.toBBox,a=[];for(;e;){for(let s=0;s<e.children.length;s++){const r=e.children[s],o=e.leaf?n(r):r;tr(t,o)&&(e.leaf?i.push(r):Qs(t,o)?this._all(r,i):a.push(r))}e=a.pop()}return i}collides(t){let e=this.data;if(!tr(t,e))return!1;const i=[];for(;e;){for(let n=0;n<e.children.length;n++){const a=e.children[n],s=e.leaf?this.toBBox(a):a;if(tr(t,s)){if(e.leaf||Qs(t,s))return!0;i.push(a)}}e=i.pop()}return!1}load(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(let e=0;e<t.length;e++)this.insert(t[e]);return this}let e=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){const t=this.data;this.data=e,e=t}this._insert(e,this.data.height-e.height-1,!0)}else this.data=e;return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=er([]),this}remove(t,e){if(!t)return this;let i=this.data;const n=this.toBBox(t),a=[],s=[];let r,o,l;for(;i||a.length;){if(i||(i=a.pop(),o=a[a.length-1],r=s.pop(),l=!0),i.leaf){const n=Bs(t,i.children,e);if(-1!==n)return i.children.splice(n,1),a.push(i),this._condense(a),this}l||i.leaf||!Qs(i,n)?o?(r++,i=o.children[r],l=!1):i=null:(a.push(i),s.push(r),r=0,o=i,i=i.children[0])}return this}toBBox(t){return t}compareMinX(t,e){return t.minX-e.minX}compareMinY(t,e){return t.minY-e.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,e){const i=[];for(;t;)t.leaf?e.push(...t.children):i.push(...t.children),t=i.pop();return e}_build(t,e,i,n){const a=i-e+1;let s,r=this._maxEntries;if(a<=r)return s=er(t.slice(e,i+1)),Vs(s,this.toBBox),s;n||(n=Math.ceil(Math.log(a)/Math.log(r)),r=Math.ceil(a/Math.pow(r,n-1))),s=er([]),s.leaf=!1,s.height=n;const o=Math.ceil(a/r),l=o*Math.ceil(Math.sqrt(r));ir(t,e,i,l,this.compareMinX);for(let a=e;a<=i;a+=l){const e=Math.min(a+l-1,i);ir(t,a,e,o,this.compareMinY);for(let i=a;i<=e;i+=o){const a=Math.min(i+o-1,e);s.children.push(this._build(t,i,a,n-1))}}return Vs(s,this.toBBox),s}_chooseSubtree(t,e,i,n){for(;n.push(e),!e.leaf&&n.length-1!==i;){let i,n=1/0,a=1/0;for(let s=0;s<e.children.length;s++){const r=e.children[s],o=Xs(r),l=Zs(t,r)-o;l<a?(a=l,n=o<n?o:n,i=r):l===a&&o<n&&(n=o,i=r)}e=i||e.children[0]}return e}_insert(t,e,i){const n=i?t:this.toBBox(t),a=[],s=this._chooseSubtree(n,this.data,e,a);for(s.children.push(t),zs(s,n);e>=0&&a[e].children.length>this._maxEntries;)this._split(a,e),e--;this._adjustParentBBoxes(n,a,e)}_split(t,e){const i=t[e],n=i.children.length,a=this._minEntries;this._chooseSplitAxis(i,a,n);const s=this._chooseSplitIndex(i,a,n),r=er(i.children.splice(s,i.children.length-s));r.height=i.height,r.leaf=i.leaf,Vs(i,this.toBBox),Vs(r,this.toBBox),e?t[e-1].children.push(r):this._splitRoot(i,r)}_splitRoot(t,e){this.data=er([t,e]),this.data.height=t.height+1,this.data.leaf=!1,Vs(this.data,this.toBBox)}_chooseSplitIndex(t,e,i){let n,a=1/0,s=1/0;for(let r=e;r<=i-e;r++){const e=Ks(t,0,r,this.toBBox),o=Ks(t,r,i,this.toBBox),l=Js(e,o),u=Xs(e)+Xs(o);l<a?(a=l,n=r,s=u<s?u:s):l===a&&u<s&&(s=u,n=r)}return n||i-e}_chooseSplitAxis(t,e,i){const n=t.leaf?this.compareMinX:$s,a=t.leaf?this.compareMinY:Ys;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,a)&&t.children.sort(n)}_allDistMargin(t,e,i,n){t.children.sort(n);const a=this.toBBox,s=Ks(t,0,e,a),r=Ks(t,i-e,i,a);let o=qs(s)+qs(r);for(let n=e;n<i-e;n++){const e=t.children[n];zs(s,t.leaf?a(e):e),o+=qs(s)}for(let n=i-e-1;n>=e;n--){const e=t.children[n];zs(r,t.leaf?a(e):e),o+=qs(r)}return o}_adjustParentBBoxes(t,e,i){for(let n=i;n>=0;n--)zs(e[n],t)}_condense(t){for(let e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children,e.splice(e.indexOf(t[i]),1)):this.clear():Vs(t[i],this.toBBox)}}function Bs(t,e,i){if(!i)return e.indexOf(t);for(let n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function Vs(t,e){Ks(t,0,t.children.length,e,t)}function Ks(t,e,i,n,a){a||(a=er(null)),a.minX=1/0,a.minY=1/0,a.maxX=-1/0,a.maxY=-1/0;for(let s=e;s<i;s++){const e=t.children[s];zs(a,t.leaf?n(e):e)}return a}function zs(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function $s(t,e){return t.minX-e.minX}function Ys(t,e){return t.minY-e.minY}function Xs(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function qs(t){return t.maxX-t.minX+(t.maxY-t.minY)}function Zs(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function Js(t,e){const i=Math.max(t.minX,e.minX),n=Math.max(t.minY,e.minY),a=Math.min(t.maxX,e.maxX),s=Math.min(t.maxY,e.maxY);return Math.max(0,a-i)*Math.max(0,s-n)}function Qs(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function tr(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function er(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function ir(t,e,i,n,a){const s=[e,i];for(;s.length;){if((i=s.pop())-(e=s.pop())<=n)continue;const r=e+Math.ceil((i-e)/n/2)*n;Ds(t,r,e,i,a),s.push(e,r,r,i)}}const nr=[NaN,NaN,NaN,0];let ar;const sr=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,rr=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,or=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,lr=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function ur(t,e){return t.endsWith("%")?Number(t.substring(0,t.length-1))/e:Number(t)}function hr(t){throw new Error('failed to parse "'+t+'" as color')}function cr(t){if(t.toLowerCase().startsWith("rgb")){const e=t.match(rr)||t.match(sr)||t.match(or);if(e){const t=e[4],i=100/255;return[St(ur(e[1],i)+.5|0,0,255),St(ur(e[2],i)+.5|0,0,255),St(ur(e[3],i)+.5|0,0,255),void 0!==t?St(ur(t,100),0,1):1]}hr(t)}if(t.startsWith("#")){if(lr.test(t)){const e=t.substring(1),i=e.length<=4?1:2,n=[0,0,0,255];for(let t=0,a=e.length;t<a;t+=i){let a=parseInt(e.substring(t,t+i),16);1===i&&(a+=a<<4),n[t/i]=a}return n[3]=n[3]/255,n}hr(t)}const e=(ar||(ar=Ta(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),ar);e.fillStyle="#abcdef";let i=e.fillStyle;e.fillStyle=t,e.fillStyle===i&&(e.fillStyle="#fedcba",i=e.fillStyle,e.fillStyle=t,e.fillStyle===i&&hr(t));const n=e.fillStyle;if(n.startsWith("#")||n.startsWith("rgba"))return cr(n);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const a=Array.from(e.getImageData(0,0,1,1).data);return a[3]=jt(a[3]/255,3),a}const dr={};let pr=0;function mr(t){if(4===t.length)return t;const e=t.slice();return e[3]=1,e}function fr(t){return t>.0031308?269.025*Math.pow(t,1/2.4)-14.025:3294.6*t}function gr(t){return t>.2068965?Math.pow(t,3):108/841*(t-4/29)}function _r(t){return t>10.314724?Math.pow((t+14.025)/269.025,2.4):t/3294.6}function yr(t){return t>.0088564?Math.pow(t,1/3):t/(108/841)+4/29}function kr(t){const e=_r(t[0]),i=_r(t[1]),n=_r(t[2]),a=yr(.222488403*e+.716873169*i+.06060791*n),s=500*(yr(.452247074*e+.399439023*i+.148375274*n)-a),r=200*(a-yr(.016863605*e+.117638439*i+.865350722*n)),o=Math.atan2(r,s)*(180/Math.PI);return[116*a-16,Math.sqrt(s*s+r*r),o<0?o+360:o,t[3]]}function vr(t){if("none"===t)return nr;if(dr.hasOwnProperty(t))return dr[t];if(pr>=1024){let t=0;for(const e in dr)3&t++||(delete dr[e],--pr)}const e=cr(t);4!==e.length&&hr(t);for(const i of e)isNaN(i)&&hr(t);return dr[t]=e,++pr,e}function xr(t){return Array.isArray(t)?t:vr(t)}function wr(t){let e=t[0];e!=(0|e)&&(e=e+.5|0);let i=t[1];i!=(0|i)&&(i=i+.5|0);let n=t[2];return n!=(0|n)&&(n=n+.5|0),"rgba("+e+","+i+","+n+","+(void 0===t[3]?1:Math.round(1e3*t[3])/1e3)+")"}function br(t){return t[0]>0&&t[1]>0}function Er(t,e,i){return void 0===i&&(i=[0,0]),i[0]=t[0]*e+.5|0,i[1]=t[1]*e+.5|0,i}function Mr(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}let Tr=0;const Sr=1<<Tr++,Cr=1<<Tr++,Lr=1<<Tr++,Rr=1<<Tr++,Ir=1<<Tr++,Pr=1<<Tr++,Ar=Math.pow(2,6)-1,jr={[Sr]:"boolean",[Cr]:"number",[Lr]:"string",[Rr]:"color",[Ir]:"number[]",[Pr]:"size"},Or=Object.keys(jr).map(Number).sort(f);function Fr(t){const e=[];for(const i of Or)Nr(t,i)&&e.push(jr[i]);return 0===e.length?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function Nr(t,e){return(t&e)===e}function Gr(t,e){return t===e}class Dr{constructor(t,e){if(!function(t){return t in jr}(t))throw new Error(`literal expressions must have a specific type, got ${Fr(t)}`);this.type=t,this.value=e}}class Wr{constructor(t,e,...i){this.type=t,this.operator=e,this.args=i}}function Hr(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function Ur(t,e,i){switch(typeof t){case"boolean":if(Gr(e,Lr))return new Dr(Lr,t?"true":"false");if(!Nr(e,Sr))throw new Error(`got a boolean, but expected ${Fr(e)}`);return new Dr(Sr,t);case"number":if(Gr(e,Pr))return new Dr(Pr,Mr(t));if(Gr(e,Sr))return new Dr(Sr,!!t);if(Gr(e,Lr))return new Dr(Lr,t.toString());if(!Nr(e,Cr))throw new Error(`got a number, but expected ${Fr(e)}`);return new Dr(Cr,t);case"string":if(Gr(e,Rr))return new Dr(Rr,vr(t));if(Gr(e,Sr))return new Dr(Sr,!!t);if(!Nr(e,Lr))throw new Error(`got a string, but expected ${Fr(e)}`);return new Dr(Lr,t)}if(!Array.isArray(t))throw new Error("expression must be an array or a primitive value");if(0===t.length)throw new Error("empty expression");if("string"==typeof t[0])return function(t,e,i){const n=t[0],a=No[n];if(!a)throw new Error(`unknown operator: ${n}`);return a(t,e,i)}(t,e,i);for(const e of t)if("number"!=typeof e)throw new Error("expected an array of numbers");if(Gr(e,Pr)){if(2!==t.length)throw new Error(`expected an array of two values for a size, got ${t.length}`);return new Dr(Pr,t)}if(Gr(e,Rr)){if(3===t.length)return new Dr(Rr,[...t,1]);if(4===t.length)return new Dr(Rr,t);throw new Error(`expected an array of 3 or 4 values for a color, got ${t.length}`)}if(!Nr(e,Ir))throw new Error(`got an array of numbers, but expected ${Fr(e)}`);return new Dr(Ir,t)}const Br="get",Vr="var",Kr="concat",zr="geometry-type",$r="line-metric",Yr="any",Xr="all",qr="!",Zr="resolution",Jr="zoom",Qr="time",to="==",eo="!=",io=">",no=">=",ao="<",so="<=",ro="*",oo="/",lo="+",uo="-",ho="clamp",co="%",po="^",mo="abs",fo="floor",go="ceil",_o="round",yo="sin",ko="cos",vo="atan",xo="sqrt",wo="match",bo="between",Eo="interpolate",Mo="coalesce",To="case",So="in",Co="number",Lo="string",Ro="array",Io="color",Po="id",Ao="band",jo="palette",Oo="to-string",Fo="has",No={[Br]:Ko(Ho(1,1/0),Go),[Vr]:Ko(Ho(1,1),function(t,e,i){const n=t[1];if("string"!=typeof n)throw new Error("expected a string argument for var operation");return i.variables.add(n),[new Dr(Lr,n)]}),[Fo]:Ko(Ho(1,1/0),Go),[Po]:Ko(function(t,e,i){i.featureId=!0},Wo),[Kr]:Ko(Ho(2,1/0),Bo(Lr)),[zr]:Ko(function(t,e,i){i.geometryType=!0},Wo),[$r]:Ko(Wo),[Zr]:Ko(Do,Wo),[Jr]:Ko(Do,Wo),[Qr]:Ko(Do,Wo),[Yr]:Ko(Ho(2,1/0),Bo(Sr)),[Xr]:Ko(Ho(2,1/0),Bo(Sr)),[qr]:Ko(Ho(1,1),Bo(Sr)),[to]:Ko(Ho(2,2),Bo(Ar)),[eo]:Ko(Ho(2,2),Bo(Ar)),[io]:Ko(Ho(2,2),Bo(Cr)),[no]:Ko(Ho(2,2),Bo(Cr)),[ao]:Ko(Ho(2,2),Bo(Cr)),[so]:Ko(Ho(2,2),Bo(Cr)),[ro]:Ko(Ho(2,1/0),Uo),[Mo]:Ko(Ho(2,1/0),Uo),[oo]:Ko(Ho(2,2),Bo(Cr)),[lo]:Ko(Ho(2,1/0),Bo(Cr)),[uo]:Ko(Ho(2,2),Bo(Cr)),[ho]:Ko(Ho(3,3),Bo(Cr)),[co]:Ko(Ho(2,2),Bo(Cr)),[po]:Ko(Ho(2,2),Bo(Cr)),[mo]:Ko(Ho(1,1),Bo(Cr)),[fo]:Ko(Ho(1,1),Bo(Cr)),[go]:Ko(Ho(1,1),Bo(Cr)),[_o]:Ko(Ho(1,1),Bo(Cr)),[yo]:Ko(Ho(1,1),Bo(Cr)),[ko]:Ko(Ho(1,1),Bo(Cr)),[vo]:Ko(Ho(1,2),Bo(Cr)),[xo]:Ko(Ho(1,1),Bo(Cr)),[wo]:Ko(Ho(4,1/0),Vo,function(t,e,i){const n=t.length-1,a=Lr|Cr|Sr,s=Ur(t[1],a,i),r=Ur(t[t.length-1],e,i),o=new Array(n-2);for(let e=0;e<n-2;e+=2){try{const n=Ur(t[e+2],s.type,i);o[e]=n}catch(t){throw new Error(`failed to parse argument ${e+1} of match expression: ${t.message}`)}try{const n=Ur(t[e+3],r.type,i);o[e+1]=n}catch(t){throw new Error(`failed to parse argument ${e+2} of match expression: ${t.message}`)}}return[s,...o,r]}),[bo]:Ko(Ho(3,3),Bo(Cr)),[Eo]:Ko(Ho(6,1/0),Vo,function(t,e,i){const n=t[1];let a;switch(n[0]){case"linear":a=1;break;case"exponential":const t=n[1];if("number"!=typeof t||t<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(t)} instead`);a=t;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(n)}`)}const s=new Dr(Cr,a);let r;try{r=Ur(t[2],Cr,i)}catch(t){throw new Error(`failed to parse argument 1 in interpolate expression: ${t.message}`)}const o=new Array(t.length-3);for(let n=0;n<o.length;n+=2){try{const e=Ur(t[n+3],Cr,i);o[n]=e}catch(t){throw new Error(`failed to parse argument ${n+2} for interpolate expression: ${t.message}`)}try{const a=Ur(t[n+4],e,i);o[n+1]=a}catch(t){throw new Error(`failed to parse argument ${n+3} for interpolate expression: ${t.message}`)}}return[s,r,...o]}),[To]:Ko(Ho(3,1/0),function(t,e,i){const n=t[0],a=t.length-1;if(a%2==0)throw new Error(`expected an odd number of arguments for ${n}, got ${a} instead`)},function(t,e,i){const n=Ur(t[t.length-1],e,i),a=new Array(t.length-1);for(let e=0;e<a.length-1;e+=2){try{const n=Ur(t[e+1],Sr,i);a[e]=n}catch(t){throw new Error(`failed to parse argument ${e} of case expression: ${t.message}`)}try{const s=Ur(t[e+2],n.type,i);a[e+1]=s}catch(t){throw new Error(`failed to parse argument ${e+1} of case expression: ${t.message}`)}}return a[a.length-1]=n,a}),[So]:Ko(Ho(2,2),function(t,e,i){let n,a=t[2];if(!Array.isArray(a))throw new Error('the second argument for the "in" operator must be an array');if("string"==typeof a[0]){if("literal"!==a[0])throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(a[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');a=a[1],n=Lr}else n=Cr;const s=new Array(a.length);for(let t=0;t<s.length;t++)try{const e=Ur(a[t],n,i);s[t]=e}catch(e){throw new Error(`failed to parse haystack item ${t} for "in" expression: ${e.message}`)}return[Ur(t[1],n,i),...s]}),[Co]:Ko(Ho(1,1/0),Bo(Ar)),[Lo]:Ko(Ho(1,1/0),Bo(Ar)),[Ro]:Ko(Ho(1,1/0),Bo(Cr)),[Io]:Ko(Ho(1,4),Bo(Cr)),[Ao]:Ko(Ho(1,3),Bo(Cr)),[jo]:Ko(Ho(2,2),function(t,e,i){let n;try{n=Ur(t[1],Cr,i)}catch(t){throw new Error(`failed to parse first argument in palette expression: ${t.message}`)}const a=t[2];if(!Array.isArray(a))throw new Error("the second argument of palette must be an array");const s=new Array(a.length);for(let t=0;t<s.length;t++){let e;try{e=Ur(a[t],Rr,i)}catch(e){throw new Error(`failed to parse color at index ${t} in palette expression: ${e.message}`)}if(!(e instanceof Dr))throw new Error(`the palette color at index ${t} must be a literal value`);s[t]=e}return[n,...s]}),[Oo]:Ko(Ho(1,1),Bo(Sr|Cr|Lr|Rr))};function Go(t,e,i){const n=t.length-1,a=new Array(n);for(let e=0;e<n;++e){const n=t[e+1];switch(typeof n){case"number":a[e]=new Dr(Cr,n);break;case"string":a[e]=new Dr(Lr,n);break;default:throw new Error(`expected a string key or numeric array index for a get operation, got ${n}`)}0===e&&i.properties.add(String(n))}return a}function Do(t,e,i){i.mapState=!0}function Wo(t,e,i){const n=t[0];if(1!==t.length)throw new Error(`expected no arguments for ${n} operation`);return[]}function Ho(t,e){return function(i,n,a){const s=i[0],r=i.length-1;if(t===e){if(r!==t)throw new Error(`expected ${t} argument${1===t?"":"s"} for ${s}, got ${r}`)}else if(r<t||r>e)throw new Error(`expected ${e===1/0?`${t} or more`:`${t} to ${e}`} arguments for ${s}, got ${r}`)}}function Uo(t,e,i){const n=t.length-1,a=new Array(n);for(let s=0;s<n;++s){const n=Ur(t[s+1],e,i);a[s]=n}return a}function Bo(t){return function(e,i,n){const a=e.length-1,s=new Array(a);for(let i=0;i<a;++i){const a=Ur(e[i+1],t,n);s[i]=a}return s}}function Vo(t,e,i){const n=t[0],a=t.length-1;if(a%2==1)throw new Error(`expected an even number of arguments for operation ${n}, got ${a} instead`)}function Ko(...t){return function(e,i,n){const a=e[0];let s;for(let a=0;a<t.length;a++){const r=t[a](e,i,n);if(a==t.length-1){if(!r)throw new Error("expected last argument validator to return the parsed args");s=r}}return new Wr(i,a,...s)}}function zo(t){if(!t)return"";const e=t.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return zo(t.getGeometries()[0]);default:return""}}function $o(t,e,i){return Yo(Ur(t,e,i),i)}function Yo(t,e){if(t instanceof Dr){if(t.type===Rr&&"string"==typeof t.value){const e=vr(t.value);return function(){return e}}return function(){return t.value}}const i=t.operator;switch(i){case Co:case Lo:case Mo:return function(t,e){const i=t.operator,n=t.args.length,a=new Array(n);for(let i=0;i<n;++i)a[i]=Yo(t.args[i],e);switch(i){case Mo:return t=>{for(let e=0;e<n;++e){const i=a[e](t);if(null!=i)return i}throw new Error("Expected one of the values to be non-null")};case Co:case Lo:return t=>{for(let e=0;e<n;++e){const n=a[e](t);if(typeof n===i)return n}throw new Error(`Expected one of the values to be a ${i}`)};default:throw new Error(`Unsupported assertion operator ${i}`)}}(t,e);case Br:case Vr:case Fo:return function(t){const e=t.args[0].value;switch(t.operator){case Br:return i=>{const n=t.args;let a=i.properties[e];for(let t=1,e=n.length;t<e;++t)a=a[n[t].value];return a};case Vr:return t=>t.variables[e];case Fo:return i=>{const n=t.args;if(!(e in i.properties))return!1;let a=i.properties[e];for(let t=1,e=n.length;t<e;++t){const e=n[t].value;if(!a||!Object.hasOwn(a,e))return!1;a=a[e]}return!0};default:throw new Error(`Unsupported accessor operator ${t.operator}`)}}(t);case Po:return t=>t.featureId;case zr:return t=>t.geometryType;case Kr:{const i=t.args.map(t=>Yo(t,e));return t=>"".concat(...i.map(e=>e(t).toString()))}case Zr:return t=>t.resolution;case Yr:case Xr:case bo:case So:case qr:return function(t,e){const i=t.operator,n=t.args.length,a=new Array(n);for(let i=0;i<n;++i)a[i]=Yo(t.args[i],e);switch(i){case Yr:return t=>{for(let e=0;e<n;++e)if(a[e](t))return!0;return!1};case Xr:return t=>{for(let e=0;e<n;++e)if(!a[e](t))return!1;return!0};case bo:return t=>{const e=a[0](t),i=a[1](t),n=a[2](t);return e>=i&&e<=n};case So:return t=>{const e=a[0](t);for(let i=1;i<n;++i)if(e===a[i](t))return!0;return!1};case qr:return t=>!a[0](t);default:throw new Error(`Unsupported logical operator ${i}`)}}(t,e);case to:case eo:case ao:case so:case io:case no:return function(t,e){const i=t.operator,n=Yo(t.args[0],e),a=Yo(t.args[1],e);switch(i){case to:return t=>n(t)===a(t);case eo:return t=>n(t)!==a(t);case ao:return t=>n(t)<a(t);case so:return t=>n(t)<=a(t);case io:return t=>n(t)>a(t);case no:return t=>n(t)>=a(t);default:throw new Error(`Unsupported comparison operator ${i}`)}}(t,e);case ro:case oo:case lo:case uo:case ho:case co:case po:case mo:case fo:case go:case _o:case yo:case ko:case vo:case xo:return function(t,e){const i=t.operator,n=t.args.length,a=new Array(n);for(let i=0;i<n;++i)a[i]=Yo(t.args[i],e);switch(i){case ro:return t=>{let e=1;for(let i=0;i<n;++i)e*=a[i](t);return e};case oo:return t=>a[0](t)/a[1](t);case lo:return t=>{let e=0;for(let i=0;i<n;++i)e+=a[i](t);return e};case uo:return t=>a[0](t)-a[1](t);case ho:return t=>{const e=a[0](t),i=a[1](t);if(e<i)return i;const n=a[2](t);return e>n?n:e};case co:return t=>a[0](t)%a[1](t);case po:return t=>Math.pow(a[0](t),a[1](t));case mo:return t=>Math.abs(a[0](t));case fo:return t=>Math.floor(a[0](t));case go:return t=>Math.ceil(a[0](t));case _o:return t=>Math.round(a[0](t));case yo:return t=>Math.sin(a[0](t));case ko:return t=>Math.cos(a[0](t));case vo:return 2===n?t=>Math.atan2(a[0](t),a[1](t)):t=>Math.atan(a[0](t));case xo:return t=>Math.sqrt(a[0](t));default:throw new Error(`Unsupported numeric operator ${i}`)}}(t,e);case To:return function(t,e){const i=t.args.length,n=new Array(i);for(let a=0;a<i;++a)n[a]=Yo(t.args[a],e);return t=>{for(let e=0;e<i-1;e+=2)if(n[e](t))return n[e+1](t);return n[i-1](t)}}(t,e);case wo:return function(t,e){const i=t.args.length,n=new Array(i);for(let a=0;a<i;++a)n[a]=Yo(t.args[a],e);return t=>{const e=n[0](t);for(let a=1;a<i-1;a+=2)if(e===n[a](t))return n[a+1](t);return n[i-1](t)}}(t,e);case Eo:return function(t,e){const i=t.args.length,n=new Array(i);for(let a=0;a<i;++a)n[a]=Yo(t.args[a],e);return t=>{const e=n[0](t),a=n[1](t);let s,r;for(let o=2;o<i;o+=2){const i=n[o](t);let l=n[o+1](t);const u=Array.isArray(l);if(u&&(l=mr(l)),i>=a)return 2===o?l:u?qo(e,a,s,r,i,l):Xo(e,a,s,r,i,l);s=i,r=l}return r}}(t,e);case Oo:return function(t,e){const i=t.operator,n=t.args.length,a=new Array(n);for(let i=0;i<n;++i)a[i]=Yo(t.args[i],e);if(i===Oo)return e=>{const i=a[0](e);return t.args[0].type===Rr?wr(i):i.toString()};throw new Error(`Unsupported convert operator ${i}`)}(t,e);default:throw new Error(`Unsupported operator ${i}`)}}function Xo(t,e,i,n,a,s){const r=a-i;if(0===r)return n;const o=e-i;return n+(1===t?o/r:(Math.pow(t,o)-1)/(Math.pow(t,r)-1))*(s-n)}function qo(t,e,i,n,a,s){if(0===a-i)return n;const r=kr(n),o=kr(s);let l=o[2]-r[2];return l>180?l-=360:l<-180&&(l+=360),function(t){const e=(t[0]+16)/116,i=t[1],n=t[2]*Math.PI/180,a=gr(e),s=gr(e+i/500*Math.cos(n)),r=gr(e-i/200*Math.sin(n)),o=fr(3.021973625*s-1.617392459*a-.404875592*r),l=fr(-.943766287*s+1.916279586*a+.027607165*r),u=fr(.069407491*s-.22898585*a+1.159737864*r);return[St(o+.5|0,0,255),St(l+.5|0,0,255),St(u+.5|0,0,255),t[3]]}([Xo(t,e,i,r[0],a,o[0]),Xo(t,e,i,r[1],a,o[1]),r[2]+Xo(t,e,i,0,a,l),Xo(t,e,i,n[3],a,s[3])])}function Zo(t,e,i){return e+":"+t+":"+(i?xr(i):"null")}const Jo=new class{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const i=this.cache_[e];3&t++||i.hasListener()||(delete this.cache_[e],delete this.patternCache_[e],--this.cacheSize_)}}}get(t,e,i){const n=Zo(t,e,i);return n in this.cache_?this.cache_[n]:null}getPattern(t,e,i){const n=Zo(t,e,i);return n in this.patternCache_?this.patternCache_[n]:null}set(t,e,i,n,a){const s=Zo(t,e,i),r=s in this.cache_;this.cache_[s]=n,a&&(0===n.getImageState()&&n.load(),1===n.getImageState()?n.ready().then(()=>{this.patternCache_[s]=Ca().createPattern(n.getImage(1),"repeat")}):this.patternCache_[s]=Ca().createPattern(n.getImage(1),"repeat")),r||++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}};let Qo=null;class tl extends L{constructor(t,e,i,n,a){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=i,this.canvas_={},this.color_=a,this.imageState_=void 0===n?0:n,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=e,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(void 0===this.tainted_&&2===this.imageState_){Qo||(Qo=Ta(1,1,void 0,{willReadFrequently:!0})),Qo.drawImage(this.image_,0,0);try{Qo.getImageData(0,0,1,1),this.tainted_=!1}catch{Qo=null,this.tainted_=!0}}return!0===this.tainted_}dispatchChangeEvent_(){this.dispatchEvent(o)}handleImageError_(){this.imageState_=3,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=2,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],i=Ta(t,e);i.fillRect(0,0,t,e),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(0===this.imageState_){this.image_||this.initializeImage_(),this.imageState_=1;try{void 0!==this.src_&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&(t=this.image_,e=this.src_,e&&(t.src=e),t.src&&Un?new Promise((e,i)=>t.decode().then(()=>e(t)).catch(n=>t.complete&&t.width?e(t):i(n))):function(t){return new Promise((e,i)=>{function n(){s(),e(t)}function a(){s(),i(new Error("Image load error"))}function s(){t.removeEventListener("load",n),t.removeEventListener("error",a)}t.addEventListener("load",n),t.addEventListener("error",a)})}(t)).then(t=>{this.image_=t,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}var t,e}replaceColor_(t){if(!this.color_||this.canvas_[t]||2!==this.imageState_)return;const e=this.image_,i=Ta(Math.ceil(e.width*t),Math.ceil(e.height*t)),n=i.canvas;var a;i.scale(t,t),i.drawImage(e,0,0),i.globalCompositeOperation="multiply",i.fillStyle="string"==typeof(a=this.color_)?a:wr(a),i.fillRect(0,0,n.width/t,n.height/t),i.globalCompositeOperation="destination-in",i.drawImage(e,0,0),this.canvas_[t]=n}ready(){return this.ready_||(this.ready_=new Promise(t=>{if(2===this.imageState_||3===this.imageState_)t();else{const e=()=>{2!==this.imageState_&&3!==this.imageState_||(this.removeEventListener(o,e),t())};this.addEventListener(o,e)}})),this.ready_}}function el(t,e,i,n,a,s){let r=void 0===e?void 0:Jo.get(e,i,a);return r||(r=new tl(t,t&&"src"in t?t.src||void 0:e,i,n,a),Jo.set(e,i,a,r,s)),s&&r&&!Jo.getPattern(e,i,a)&&Jo.set(e,i,a,r,s),r}const il=tl;function nl(t){return t?Array.isArray(t)?wr(t):"object"==typeof t&&"src"in t?function(t){if(!t.offset||!t.size)return Jo.getPattern(t.src,"anonymous",t.color);const e=t.src+":"+t.offset,i=Jo.getPattern(e,void 0,t.color);if(i)return i;const n=Jo.get(t.src,"anonymous",null);if(2!==n.getImageState())return null;const a=Ta(t.size[0],t.size[1]);return a.drawImage(n.getImage(1),t.offset[0],t.offset[1],t.size[0],t.size[1],0,0,t.size[0],t.size[1]),el(a.canvas,e,void 0,2,t.color,!0),Jo.getPattern(e,void 0,t.color)}(t):t:null}const al="10px sans-serif",sl="#000",rl="round",ol=[],ll="round",ul="#000",hl="center",cl="middle",dl=[0,0,0,0],pl=new D;let ml,fl=null;const gl={},_l=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function yl(t,e,i){return`${t} ${e} 16px "${i}"`}const kl=function(){const t=100;let e,i;async function n(t){await i.ready;const e=await i.load(t);if(0===e.length)return!1;const n=Ma(t),a=n.families[0].toLowerCase(),s=n.weight;return e.some(t=>{const e=t.family.replace(/^['"]|['"]$/g,"").toLowerCase(),i=Ea[t.weight]||t.weight;return e===a&&t.style===n.style&&i==s})}async function a(){await i.ready;let s=!0;const r=pl.getProperties(),o=Object.keys(r).filter(e=>r[e]<t);for(let e=o.length-1;e>=0;--e){const i=o[e];let a=r[i];a<t&&(await n(i)?(T(gl),pl.set(i,t)):(a+=10,pl.set(i,a,!0),a<t&&(s=!1)))}e=void 0,s||(e=setTimeout(a,100))}return async function(t){i||(i=Hn?self.fonts:document.fonts);const n=Ma(t);if(!n)return;const s=n.families;let r=!1;for(const t of s){if(_l.has(t))continue;const e=yl(n.style,n.weight,t);void 0===pl.get(e)&&(pl.set(e,0,!0),r=!0)}r&&(clearTimeout(e),e=setTimeout(a,100))}}(),vl=function(){let t;return function(e){let i=gl[e];if(null==i){if(Hn){const t=Ma(e),n=xl(e,"g");i=(isNaN(Number(t.lineHeight))?1.2:Number(t.lineHeight))*(n.actualBoundingBoxAscent+n.actualBoundingBoxDescent)}else t||(t=document.createElement("div"),t.innerHTML="M",t.style.minHeight="0",t.style.maxHeight="none",t.style.height="auto",t.style.padding="0",t.style.border="none",t.style.position="absolute",t.style.display="block",t.style.left="-99999px"),t.style.font=e,document.body.appendChild(t),i=t.offsetHeight,document.body.removeChild(t);gl[e]=i}return i}}();function xl(t,e){return fl||(fl=Ta(1,1)),t!=ml&&(fl.font=t,ml=fl.font),fl.measureText(e)}function wl(t,e){return xl(t,e).width}function bl(t,e,i){if(e in i)return i[e];const n=e.split("\n").reduce((e,i)=>Math.max(e,wl(t,i)),0);return i[e]=n,n}class El{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=Mr(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new El({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return O()}getImage(t){return O()}getHitDetectionImage(){return O()}getPixelRatio(t){return 1}getImageState(){return O()}getImageSize(){return O()}getOrigin(){return O()}getSize(){return O()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=Mr(t)}listenImageChange(t){O()}load(){O()}unlistenImageChange(t){O()}ready(){return Promise.resolve()}}const Ml=El;class Tl extends Ml{constructor(t){super({opacity:1,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,rotation:void 0!==t.rotation?t.rotation:0,scale:void 0!==t.scale?t.scale:1,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=void 0!==t.fill?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius=t.radius,this.radius2_=t.radius2,this.angle_=void 0!==t.angle?t.angle:0,this.stroke_=void 0!==t.stroke?t.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?1:2,1===this.imageState_&&this.ready().then(()=>this.imageState_=2),this.render()}clone(){const t=this.getScale(),e=new Tl({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_,e=this.getDisplacement(),i=this.getScaleArray();return[t[0]/2-e[0]/i[0],t[1]/2+e[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(t){const e=this.fill_?.getKey(),i=`${t},${this.angle_},${this.radius},${this.radius2_},${this.points_},${e}`+Object.values(this.renderOptions_).join(",");let n=Jo.get(i,null,null)?.getImage(1);if(!n){const e=this.renderOptions_,a=Math.ceil(e.size*t),s=Ta(a,a);this.draw_(e,s,t),n=s.canvas,Jo.set(i,null,null,new il(n,void 0,null,2,null))}return n}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,i){if(0===e||this.points_===1/0||"bevel"!==t&&"miter"!==t)return e;let n=this.radius,a=void 0===this.radius2_?n:this.radius2_;if(n<a){const t=n;n=a,a=t}const s=void 0===this.radius2_?this.points_:2*this.points_,r=2*Math.PI/s,o=a*Math.sin(r),l=n-Math.sqrt(a*a-o*o),u=Math.sqrt(o*o+l*l),h=u/o;if("miter"===t&&h<=i)return h*e;const c=e/2/h,d=e/2*(l/u),p=Math.sqrt((n+c)*(n+c)+d*d)-n;if(void 0===this.radius2_||"bevel"===t)return 2*p;const m=n*Math.sin(r),f=a-Math.sqrt(n*n-m*m),g=Math.sqrt(m*m+f*f)/m;if(g<=i){const t=g*e/2-a-n;return 2*Math.max(p,t)}return 2*p}createRenderOptions(){let t,e=rl,i=ll,n=0,a=null,s=0,r=0;this.stroke_&&(t=nl(this.stroke_.getColor()??ul),r=this.stroke_.getWidth()??1,a=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,i=this.stroke_.getLineJoin()??ll,e=this.stroke_.getLineCap()??rl,n=this.stroke_.getMiterLimit()??10);const o=this.calculateLineJoinSize_(i,r,n),l=Math.max(this.radius,this.radius2_||0);return{strokeStyle:t,strokeWidth:r,size:Math.ceil(2*l+o),lineCap:e,lineDash:a,lineDashOffset:s,lineJoin:i,miterLimit:n}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[t,t]}draw_(t,e,i){if(e.scale(i,i),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let t=this.fill_.getColor();null===t&&(t=sl),e.fillStyle=nl(t),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){let e;if(this.fill_){let i=this.fill_.getColor(),n=0;"string"==typeof i&&(i=xr(i)),null===i?n=1:Array.isArray(i)&&(n=4===i.length?i[3]:1),0===n&&(e=Ta(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}createPath_(t){let e=this.points_;const i=this.radius;if(e===1/0)t.arc(0,0,i,0,2*Math.PI);else{const n=void 0===this.radius2_?i:this.radius2_;void 0!==this.radius2_&&(e*=2);const a=this.angle_-Math.PI/2,s=2*Math.PI/e;for(let r=0;r<e;r++){const e=a+r*s,o=r%2==0?i:n;t.lineTo(o*Math.cos(e),o*Math.sin(e))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=sl,e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}const Sl=Tl;class Cl extends Sl{constructor(t){super({points:1/0,fill:(t=t||{radius:5}).fill,radius:t.radius,stroke:t.stroke,scale:void 0!==t.scale?t.scale:1,rotation:void 0!==t.rotation?t.rotation:0,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new Cl({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius=t,this.render()}}const Ll=Cl;class Rl{constructor(t){t=t||{},this.patternImage_=null,this.color_=null,void 0!==t.color&&this.setColor(t.color)}clone(){const t=this.getColor();return new Rl({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){if(null!==t&&"object"==typeof t&&"src"in t){const e=el(null,t.src,"anonymous",void 0,t.offset?null:t.color?t.color:null,!(t.offset&&t.size));e.ready().then(()=>{this.patternImage_=null}),0===e.getImageState()&&e.load(),1===e.getImageState()&&(this.patternImage_=e)}this.color_=t}getKey(){const t=this.getColor();return t?t instanceof CanvasPattern||t instanceof CanvasGradient?N(t):"object"==typeof t&&"src"in t?t.src+":"+t.offset:xr(t).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}const Il=Rl;function Pl(t,e,i,n){return void 0!==i&&void 0!==n?[i/t,n/e]:void 0!==i?i/t:void 0!==n?n/e:1}class Al extends Ml{constructor(t){const e=void 0!==(t=t||{}).opacity?t.opacity:1,i=void 0!==t.rotation?t.rotation:0,n=void 0!==t.scale?t.scale:1,a=void 0!==t.rotateWithView&&t.rotateWithView;super({opacity:e,rotation:i,scale:n,displacement:void 0!==t.displacement?t.displacement:[0,0],rotateWithView:a,declutterMode:t.declutterMode}),this.anchor_=void 0!==t.anchor?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=void 0!==t.anchorOrigin?t.anchorOrigin:"top-left",this.anchorXUnits_=void 0!==t.anchorXUnits?t.anchorXUnits:"fraction",this.anchorYUnits_=void 0!==t.anchorYUnits?t.anchorYUnits:"fraction",this.crossOrigin_=void 0!==t.crossOrigin?t.crossOrigin:null;const s=void 0!==t.img?t.img:null;let r,o=t.src;if(B(!(void 0!==o&&s),"`image` and `src` cannot be provided at the same time"),void 0!==o&&0!==o.length||!s||(o=s.src||N(s)),B(void 0!==o&&o.length>0,"A defined and non-empty `src` or `image` must be provided"),B(!((void 0!==t.width||void 0!==t.height)&&void 0!==t.scale),"`width` or `height` cannot be provided together with `scale`"),void 0!==t.src?r=0:void 0!==s&&(r="complete"in s?s.complete?s.src?2:0:1:2),this.color_=void 0!==t.color?xr(t.color):null,this.iconImage_=el(s,o,this.crossOrigin_,r,this.color_),this.offset_=void 0!==t.offset?t.offset:[0,0],this.offsetOrigin_=void 0!==t.offsetOrigin?t.offsetOrigin:"top-left",this.origin_=null,this.size_=void 0!==t.size?t.size:null,this.initialOptions_,void 0!==t.width||void 0!==t.height){let e,i;if(t.size)[e,i]=t.size;else{const n=this.getImage(1);if(n.width&&n.height)e=n.width,i=n.height;else if(n instanceof HTMLImageElement){this.initialOptions_=t;const e=()=>{if(this.unlistenImageChange(e),!this.initialOptions_)return;const i=this.iconImage_.getSize();this.setScale(Pl(i[0],i[1],t.width,t.height))};return void this.listenImageChange(e)}}void 0!==e&&this.setScale(Pl(e,i,t.width,t.height))}}clone(){let t,e,i;return this.initialOptions_?(e=this.initialOptions_.width,i=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new Al({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:i,size:null!==this.size_?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const e=this.getSize();if("fraction"==this.anchorXUnits_||"fraction"==this.anchorYUnits_){if(!e)return null;t=this.anchor_.slice(),"fraction"==this.anchorXUnits_&&(t[0]*=e[0]),"fraction"==this.anchorYUnits_&&(t[1]*=e[1])}if("top-left"!=this.anchorOrigin_){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),"top-right"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[0]=-t[0]+e[0]),"bottom-left"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[1]=-t[1]+e[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),i=this.getScaleArray();return[t[0]-e[0]/i[0],t[1]+e[1]/i[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if("top-left"!=this.offsetOrigin_){const e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),"top-right"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[0]=i[0]-e[0]-t[0]),"bottom-left"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(t){this.iconImage_=el(null,t,this.crossOrigin_,0,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const t=this.getScaleArray();return this.size_?this.size_[0]*t[0]:2==this.iconImage_.getImageState()?this.iconImage_.getSize()[0]*t[0]:void 0}getHeight(){const t=this.getScaleArray();return this.size_?this.size_[1]*t[1]:2==this.iconImage_.getImageState()?this.iconImage_.getSize()[1]*t[1]:void 0}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener(o,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(o,t)}ready(){return this.iconImage_.ready()}}const jl=Al;class Ol{constructor(t){t=t||{},this.color_=void 0!==t.color?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=void 0!==t.lineDash?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new Ol({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}}const Fl=Ol;class Nl{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=Wl,void 0!==t.geometry&&this.setGeometry(t.geometry),this.fill_=void 0!==t.fill?t.fill:null,this.image_=void 0!==t.image?t.image:null,this.renderer_=void 0!==t.renderer?t.renderer:null,this.hitDetectionRenderer_=void 0!==t.hitDetectionRenderer?t.hitDetectionRenderer:null,this.stroke_=void 0!==t.stroke?t.stroke:null,this.text_=void 0!==t.text?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&"object"==typeof t&&(t=t.clone()),new Nl({geometry:t??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=Wl,this.geometry_=t}setZIndex(t){this.zIndex_=t}}let Gl=null;function Dl(t,e){if(!Gl){const t=new Il({color:"rgba(255,255,255,0.4)"}),e=new Fl({color:"#3399CC",width:1.25});Gl=[new Nl({image:new Ll({fill:t,stroke:e,radius:5}),fill:t,stroke:e})]}return Gl}function Wl(t){return t.getGeometry()}const Hl=Nl;class Ul{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.keepUpright_=t.keepUpright,this.scale_=t.scale,this.scaleArray_=Mr(void 0!==t.scale?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=void 0!==t.fill?t.fill:new Il({color:"#333"}),this.maxAngle_=void 0!==t.maxAngle?t.maxAngle:Math.PI/4,this.placement_=void 0!==t.placement?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=void 0!==t.stroke?t.stroke:null,this.offsetX_=void 0!==t.offsetX?t.offsetX:0,this.offsetY_=void 0!==t.offsetY?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=void 0===t.padding?null:t.padding,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new Ul({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof Il?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setKeepUpright(t){this.keepUpright_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=Mr(void 0!==t?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}}const Bl=Ul;function Vl(t){return!0}function Kl(t){const e=Hr(),i=function(t,e){const i=t.length,n=new Array(i);for(let a=0;a<i;++a){const i=t[a],s="filter"in i?$o(i.filter,Sr,e):Vl;let r;if(Array.isArray(i.style)){const t=i.style.length;r=new Array(t);for(let n=0;n<t;++n)r[n]=$l(i.style[n],e)}else r=[$l(i.style,e)];n[a]={filter:s,styles:r}}return function(e){const a=[];let s=!1;for(let r=0;r<i;++r)if((0,n[r].filter)(e)&&(!t[r].else||!s)){s=!0;for(const t of n[r].styles){const i=t(e);i&&a.push(i)}}return a}}(t,e),n={variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""};return function(t,a){if(n.properties=t.getPropertiesInternal(),n.resolution=a,e.featureId){const e=t.getId();n.featureId=void 0!==e?e:null}return e.geometryType&&(n.geometryType=zo(t.getGeometry())),i(n)}}function zl(t){const e=Hr(),i=t.length,n=new Array(i);for(let a=0;a<i;++a)n[a]=$l(t[a],e);const a={variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""},s=new Array(i);return function(t,r){if(a.properties=t.getPropertiesInternal(),a.resolution=r,e.featureId){const e=t.getId();a.featureId=void 0!==e?e:null}let o=0;for(let t=0;t<i;++t){const e=n[t](a);e&&(s[o]=e,o+=1)}return s.length=o,s}}function $l(t,e){const i=Yl(t,"",e),n=Xl(t,"",e),a=function(t,e){const i="text-",n=Zl(t,i+"value",e);if(!n)return null;const a=Yl(t,i,e),s=Yl(t,i+"background-",e),r=Xl(t,i,e),o=Xl(t,i+"background-",e),l=Zl(t,i+"font",e),u=ql(t,i+"max-angle",e),h=ql(t,i+"offset-x",e),c=ql(t,i+"offset-y",e),d=Jl(t,i+"overflow",e),p=Zl(t,i+"placement",e),m=ql(t,i+"repeat",e),f=nu(t,i+"scale",e),g=Jl(t,i+"rotate-with-view",e),_=ql(t,i+"rotation",e),y=Zl(t,i+"align",e),k=Zl(t,i+"justify",e),v=Zl(t,i+"baseline",e),x=Jl(t,i+"keep-upright",e),w=tu(t,i+"padding",e),b=ou(t,i+"declutter-mode"),E=new Bl({declutterMode:b});return function(t){if(E.setText(n(t)),a&&E.setFill(a(t)),s&&E.setBackgroundFill(s(t)),r&&E.setStroke(r(t)),o&&E.setBackgroundStroke(o(t)),l&&E.setFont(l(t)),u&&E.setMaxAngle(u(t)),h&&E.setOffsetX(h(t)),c&&E.setOffsetY(c(t)),d&&E.setOverflow(d(t)),p){const e=p(t);if("point"!==e&&"line"!==e)throw new Error("Expected point or line for text-placement");E.setPlacement(e)}if(m&&E.setRepeat(m(t)),f&&E.setScale(f(t)),g&&E.setRotateWithView(g(t)),_&&E.setRotation(_(t)),y){const e=y(t);if("left"!==e&&"center"!==e&&"right"!==e&&"end"!==e&&"start"!==e)throw new Error("Expected left, right, center, start, or end for text-align");E.setTextAlign(e)}if(k){const e=k(t);if("left"!==e&&"right"!==e&&"center"!==e)throw new Error("Expected left, right, or center for text-justify");E.setJustify(e)}if(v){const e=v(t);if("bottom"!==e&&"top"!==e&&"middle"!==e&&"alphabetic"!==e&&"hanging"!==e)throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");E.setTextBaseline(e)}return w&&E.setPadding(w(t)),x&&E.setKeepUpright(x(t)),E}}(t,e),s=function(t,e){return"icon-src"in t?function(t,e){const i="icon-",n=i+"src",a=uu(t[n],n),s=eu(t,i+"anchor",e),r=nu(t,i+"scale",e),o=ql(t,i+"opacity",e),l=eu(t,i+"displacement",e),u=ql(t,i+"rotation",e),h=Jl(t,i+"rotate-with-view",e),c=su(t,i+"anchor-origin"),d=ru(t,i+"anchor-x-units"),p=ru(t,i+"anchor-y-units"),m=function(t,e){const i=t[e];if(void 0!==i)return cu(i,e)}(t,i+"color"),f=function(t,e){const i=t[e];if(void 0!==i){if("string"!=typeof i)throw new Error(`Expected a string for ${e}`);return i}}(t,i+"cross-origin"),g=function(t,e){const i=t[e];if(void 0!==i)return lu(i,e)}(t,i+"offset"),_=su(t,i+"offset-origin"),y=au(t,i+"width"),k=au(t,i+"height"),v=function(t,e){const i=t[e];if(void 0!==i){if("number"==typeof i)return Mr(i);if(!Array.isArray(i))throw new Error(`Expected a number or size array for ${e}`);if(2!==i.length||"number"!=typeof i[0]||"number"!=typeof i[1])throw new Error(`Expected a number or size array for ${e}`);return i}}(t,i+"size"),x=ou(t,i+"declutter-mode"),w=new jl({src:a,anchorOrigin:c,anchorXUnits:d,anchorYUnits:p,color:m,crossOrigin:f,offset:g,offsetOrigin:_,height:k,width:y,size:v,declutterMode:x});return function(t){return o&&w.setOpacity(o(t)),l&&w.setDisplacement(l(t)),u&&w.setRotation(u(t)),h&&w.setRotateWithView(h(t)),r&&w.setScale(r(t)),s&&w.setAnchor(s(t)),w}}(t,e):"shape-points"in t?function(t,e){const i="shape-",n=i+"points",a=i+"radius",s=hu(t[n],n),r=hu(t[a],a),o=Yl(t,i,e),l=Xl(t,i,e),u=nu(t,i+"scale",e),h=eu(t,i+"displacement",e),c=ql(t,i+"rotation",e),d=Jl(t,i+"rotate-with-view",e),p=au(t,i+"radius2"),m=au(t,i+"angle"),f=ou(t,i+"declutter-mode"),g=new Sl({points:s,radius:r,radius2:p,angle:m,declutterMode:f});return function(t){return o&&g.setFill(o(t)),l&&g.setStroke(l(t)),h&&g.setDisplacement(h(t)),c&&g.setRotation(c(t)),d&&g.setRotateWithView(d(t)),u&&g.setScale(u(t)),g}}(t,e):"circle-radius"in t?function(t,e){const i="circle-",n=Yl(t,i,e),a=Xl(t,i,e),s=ql(t,i+"radius",e),r=nu(t,i+"scale",e),o=eu(t,i+"displacement",e),l=ql(t,i+"rotation",e),u=Jl(t,i+"rotate-with-view",e),h=ou(t,i+"declutter-mode"),c=new Ll({radius:5,declutterMode:h});return function(t){return s&&c.setRadius(s(t)),n&&c.setFill(n(t)),a&&c.setStroke(a(t)),o&&c.setDisplacement(o(t)),l&&c.setRotation(l(t)),u&&c.setRotateWithView(u(t)),r&&c.setScale(r(t)),c}}(t,e):null}(t,e),r=ql(t,"z-index",e);if(!(i||n||a||s||S(t)))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(t));const o=new Hl;return function(t){let e=!0;if(i){const n=i(t);n&&(e=!1),o.setFill(n)}if(n){const i=n(t);i&&(e=!1),o.setStroke(i)}if(a){const i=a(t);i&&(e=!1),o.setText(i)}if(s){const i=s(t);i&&(e=!1),o.setImage(i)}return r&&o.setZIndex(r(t)),e?null:o}}function Yl(t,e,i){let n;if(e+"fill-pattern-src"in t)n=function(t,e,i){const n=Zl(t,e+"pattern-src",i),a=iu(t,e+"pattern-offset",i),s=iu(t,e+"pattern-size",i),r=Ql(t,e+"color",i);return function(t){return{src:n(t),offset:a&&a(t),size:s&&s(t),color:r&&r(t)}}}(t,e+"fill-",i);else{if("none"===t[e+"fill-color"])return t=>null;n=Ql(t,e+"fill-color",i)}if(!n)return null;const a=new Il;return function(t){const e=n(t);return e===nr?null:(a.setColor(e),a)}}function Xl(t,e,i){const n=ql(t,e+"stroke-width",i),a=Ql(t,e+"stroke-color",i);if(!n&&!a)return null;const s=Zl(t,e+"stroke-line-cap",i),r=Zl(t,e+"stroke-line-join",i),o=tu(t,e+"stroke-line-dash",i),l=ql(t,e+"stroke-line-dash-offset",i),u=ql(t,e+"stroke-miter-limit",i),h=new Fl;return function(t){if(a){const e=a(t);if(e===nr)return null;h.setColor(e)}if(n&&h.setWidth(n(t)),s){const e=s(t);if("butt"!==e&&"round"!==e&&"square"!==e)throw new Error("Expected butt, round, or square line cap");h.setLineCap(e)}if(r){const e=r(t);if("bevel"!==e&&"round"!==e&&"miter"!==e)throw new Error("Expected bevel, round, or miter line join");h.setLineJoin(e)}return o&&h.setLineDash(o(t)),l&&h.setLineDashOffset(l(t)),u&&h.setMiterLimit(u(t)),h}}function ql(t,e,i){if(!(e in t))return;const n=$o(t[e],Cr,i);return function(t){return hu(n(t),e)}}function Zl(t,e,i){if(!(e in t))return null;const n=$o(t[e],Lr,i);return function(t){return uu(n(t),e)}}function Jl(t,e,i){if(!(e in t))return null;const n=$o(t[e],Sr,i);return function(t){const i=n(t);if("boolean"!=typeof i)throw new Error(`Expected a boolean for ${e}`);return i}}function Ql(t,e,i){if(!(e in t))return null;const n=$o(t[e],Rr,i);return function(t){return cu(n(t),e)}}function tu(t,e,i){if(!(e in t))return null;const n=$o(t[e],Ir,i);return function(t){return lu(n(t),e)}}function eu(t,e,i){if(!(e in t))return null;const n=$o(t[e],Ir,i);return function(t){const i=lu(n(t),e);if(2!==i.length)throw new Error(`Expected two numbers for ${e}`);return i}}function iu(t,e,i){if(!(e in t))return null;const n=$o(t[e],Ir,i);return function(t){return du(n(t),e)}}function nu(t,e,i){if(!(e in t))return null;const n=$o(t[e],Ir|Cr,i);return function(t){return i=n(t),a=e,"number"==typeof i?i:du(i,a);var i,a}}function au(t,e){const i=t[e];if(void 0!==i){if("number"!=typeof i)throw new Error(`Expected a number for ${e}`);return i}}function su(t,e){const i=t[e];if(void 0!==i){if("bottom-left"!==i&&"bottom-right"!==i&&"top-left"!==i&&"top-right"!==i)throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return i}}function ru(t,e){const i=t[e];if(void 0!==i){if("pixels"!==i&&"fraction"!==i)throw new Error(`Expected pixels or fraction for ${e}`);return i}}function ou(t,e){const i=t[e];if(void 0!==i){if("string"!=typeof i)throw new Error(`Expected a string for ${e}`);if("declutter"!==i&&"obstacle"!==i&&"none"!==i)throw new Error(`Expected declutter, obstacle, or none for ${e}`);return i}}function lu(t,e){if(!Array.isArray(t))throw new Error(`Expected an array for ${e}`);const i=t.length;for(let n=0;n<i;++n)if("number"!=typeof t[n])throw new Error(`Expected an array of numbers for ${e}`);return t}function uu(t,e){if("string"!=typeof t)throw new Error(`Expected a string for ${e}`);return t}function hu(t,e){if("number"!=typeof t)throw new Error(`Expected a number for ${e}`);return t}function cu(t,e){if("string"==typeof t)return t;const i=lu(t,e),n=i.length;if(n<3||n>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return i}function du(t,e){const i=lu(t,e);if(2!==i.length)throw new Error(`Expected an array of two numbers for ${e}`);return i}const pu="renderOrder",mu=class extends Gs{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=t.declutter?String(t.declutter):void 0,this.renderBuffer_=void 0!==t.renderBuffer?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=void 0!==t.updateWhileAnimating&&t.updateWhileAnimating,this.updateWhileInteracting_=void 0!==t.updateWhileInteracting&&t.updateWhileInteracting}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(pu)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t,e){const i=this.getDeclutter();i in t.declutter==0&&(t.declutter[i]=new Us(9)),this.getRenderer().renderDeclutter(t,e)}setRenderOrder(t){this.set(pu,t)}setStyle(t){this.style_=void 0===t?Dl:t;const e=function(t){if(void 0===t)return Dl;if(!t)return null;if("function"==typeof t)return t;if(t instanceof Hl)return t;if(!Array.isArray(t))return zl([t]);if(0===t.length)return[];const e=t.length,i=t[0];if(i instanceof Hl){const i=new Array(e);for(let n=0;n<e;++n){const e=t[n];if(!(e instanceof Hl))throw new Error("Expected a list of style instances");i[n]=e}return i}if("style"in i){const i=new Array(e);for(let n=0;n<e;++n){const e=t[n];if(!("style"in e))throw new Error("Expected a list of rules with a style property");i[n]=e}return Kl(i)}return zl(t)}(t);this.styleFunction_=null===t?void 0:function(t){let e;if("function"==typeof t)e=t;else{let i;Array.isArray(t)?i=t:(B("function"==typeof t.getZIndex,"Expected an `Style` or an array of `Style`"),i=[t]),e=function(){return i}}return e}(e),this.changed()}setDeclutter(t){this.declutter_=t?String(t):void 0,this.changed()}},fu=class extends C{constructor(t,e,i,n){super(t),this.inversePixelTransform=e,this.frameState=i,this.context=n}};function gu(t,e){Jo.expire()}const _u=class extends m{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){O()}calculateMatrices2D(t){const e=t.viewState,i=t.coordinateToPixelTransform,n=t.pixelToCoordinateTransform;wi(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),bi(n,i)}forEachFeatureAtCoordinate(t,e,i,n,a,s,r,o){let l;const u=e.viewState;function h(t,e,i,n){return a.call(s,e,t?i:null,n)}const c=u.projection,d=Xt(t.slice(),c),p=[[0,0]];if(c.canWrapX()&&n){const t=xt(c.getExtent());p.push([-t,0],[t,0])}const m=e.layerStatesArray,f=m.length,g=[],_=[];for(let n=0;n<p.length;n++)for(let a=f-1;a>=0;--a){const s=m[a],c=s.layer;if(c.hasRenderer()&&Ns(s,u)&&r.call(o,c)){const a=c.getRenderer(),r=c.getSource();if(a&&r){const o=r.getWrapX()?d:t,u=h.bind(null,s.managed);_[0]=o[0]+p[n][0],_[1]=o[1]+p[n][1],l=a.forEachFeatureAtCoordinate(_,e,i,u,g)}if(l)return l}}if(0===g.length)return;const y=1/g.length;return g.forEach((t,e)=>t.distanceSq+=e*y),g.sort((t,e)=>t.distanceSq-e.distanceSq),g.some(t=>l=t.callback(t.feature,t.layer,t.geometry)),l}hasFeatureAtCoordinate(t,e,i,n,a,s){return void 0!==this.forEachFeatureAtCoordinate(t,e,i,n,x,this,a,s)}getMap(){return this.map_}renderFrame(t){O()}scheduleExpireIconCache(t){Jo.canExpireCache()&&t.postRenderFunctions.push(gu)}},yu=class extends _u{constructor(t){super(t),this.fontChangeListenerKey_=R(pl,r,t.redrawText,t),this.element_=Hn?Ia():document.createElement("div");const e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=ka+" ol-layers";const i=t.getViewport();i&&i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(t,e){const i=this.getMap();if(i.hasListener(t)){const n=new fu(t,void 0,e);i.dispatchEvent(n)}}disposeInternal(){P(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(t){if(!t)return void(this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1));this.calculateMatrices2D(t),this.dispatchRenderEvent(js,t);const e=t.layerStatesArray.sort((t,e)=>t.zIndex-e.zIndex);e.some(t=>t.layer instanceof mu&&t.layer.getDeclutter())&&(t.declutter={});const i=t.viewState;this.children_.length=0;const n=[];let a=null;for(let s=0,r=e.length;s<r;++s){const r=e[s];t.layerIndex=s;const o=r.layer,l=o.getSourceState();if(!Ns(r,i)||"ready"!=l&&"undefined"!=l){o.unrender();continue}const u=o.render(t,a);u&&(u!==a&&(this.children_.push(u),a=u),n.push(r))}this.declutter(t,n),function(t,e){const i=t.childNodes;for(let n=0;;++n){const a=i[n],s=e[n];if(!a&&!s)break;a!==s&&(a?s?t.insertBefore(s,a):(t.removeChild(a),--n):t.appendChild(s))}}(this.element_,this.children_);const s=this.getMap().getTargetElement();if(Pa(s)){const t=s.getContext("2d");for(const e of this.children_){const i=e.firstElementChild||e,n=e.style.backgroundColor;if(n&&(!Pa(i)||i.width>0)&&(t.fillStyle=n,t.fillRect(0,0,s.width,s.height)),Pa(i)&&i.width>0){const n=e.style.opacity||i.style.opacity;t.globalAlpha=""===n?1:Number(n);const a=i.style.transform;if(a)t.setTransform(...Mi(a));else{const e=parseFloat(i.style.width)/i.width,n=parseFloat(i.style.height)/i.height;t.setTransform(e,0,0,n,0,0)}t.drawImage(i,0,0)}}t.globalAlpha=1,t.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(Os,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}declutter(t,e){if(t.declutter){for(let i=e.length-1;i>=0;--i){const n=e[i],a=n.layer;a.getDeclutter()&&a.renderDeclutter(t,n)}e.forEach(e=>e.layer.renderDeferred(t))}}};function ku(t){t instanceof Gs?t.setMapInternal(null):t instanceof Is&&t.getLayers().forEach(ku)}function vu(t,e){if(t instanceof Gs)t.setMapInternal(e);else if(t instanceof Is){const i=t.getLayers().getArray();for(let t=0,n=i.length;t<n;++t)vu(i[t],e)}}const xu=class extends D{constructor(t){super(),t=t||{},this.on,this.once,this.un;const e=function(t){let e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);const i={},n=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new Is({layers:t.layers});let a,s,r;return i[Xn]=n,i[Zn]=t.target,i[Jn]=t.view instanceof _a?t.view:new _a,void 0!==t.controls&&(Array.isArray(t.controls)?a=new U(t.controls.slice()):(B("function"==typeof t.controls.getArray,"Expected `controls` to be an array or an `ol/Collection.js`"),a=t.controls)),void 0!==t.interactions&&(Array.isArray(t.interactions)?s=new U(t.interactions.slice()):(B("function"==typeof t.interactions.getArray,"Expected `interactions` to be an array or an `ol/Collection.js`"),s=t.interactions)),void 0!==t.overlays?Array.isArray(t.overlays)?r=new U(t.overlays.slice()):(B("function"==typeof t.overlays.getArray,"Expected `overlays` to be an array or an `ol/Collection.js`"),r=t.overlays):r=new U,{controls:a,interactions:s,keyboardEventTarget:e,overlays:r,values:i}}(t);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=void 0!==t.maxTilesLoading?t.maxTilesLoading:16,this.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:Wn,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=[1,0,0,1,0,0],this.pixelToCoordinateTransform_=[1,0,0,1,0,0],this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,Hn||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,Hn||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=e.controls||(Hn?new U:function(t){t=t||{};const e=new U;return(void 0===t.zoom||t.zoom)&&e.push(new Fa(t.zoomOptions)),(void 0===t.rotate||t.rotate)&&e.push(new Oa(t.rotateOptions)),(void 0===t.attribution||t.attribution)&&e.push(new ja(t.attributionOptions)),e}()),this.interactions=e.interactions||(Hn?new U:function(t){t=t||{};const e=new U,i=new Na(-.005,.05,100);return(void 0===t.altShiftDragRotate||t.altShiftDragRotate)&&e.push(new es),(void 0===t.doubleClickZoom||t.doubleClickZoom)&&e.push(new Ha({delta:t.zoomDelta,duration:t.zoomDuration})),(void 0===t.dragPan||t.dragPan)&&e.push(new ts({onFocusOnly:t.onFocusOnly,kinetic:i})),(void 0===t.pinchRotate||t.pinchRotate)&&e.push(new ps),(void 0===t.pinchZoom||t.pinchZoom)&&e.push(new ms({duration:t.zoomDuration})),(void 0===t.keyboard||t.keyboard)&&(e.push(new hs),e.push(new cs({delta:t.zoomDelta,duration:t.zoomDuration}))),(void 0===t.mouseWheelZoom||t.mouseWheelZoom)&&e.push(new ds({onFocusOnly:t.onFocusOnly,duration:t.zoomDuration})),(void 0===t.shiftDragZoom||t.shiftDragZoom)&&e.push(new rs({duration:t.zoomDuration})),e}({onFocusOnly:!0})),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new ea(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Xn,this.handleLayerGroupChanged_),this.addChangeListener(Jn,this.handleViewChanged_),this.addChangeListener(qn,this.handleSizeChanged_),this.addChangeListener(Zn,this.handleTargetChanged_),this.setProperties(e.values);const i=this;!t.view||t.view instanceof _a||t.view.then(function(t){i.setView(new _a(t))}),this.controls.addEventListener(a,t=>{t.element.setMap(this)}),this.controls.addEventListener(s,t=>{t.element.setMap(null)}),this.interactions.addEventListener(a,t=>{t.element.setMap(this)}),this.interactions.addEventListener(s,t=>{t.element.setMap(null)}),this.overlays_.addEventListener(a,t=>{this.addOverlayInternal_(t.element)}),this.overlays_.addEventListener(s,t=>{const e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)}),this.controls.forEach(t=>{t.setMap(this)}),this.interactions.forEach(t=>{t.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){vu(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,i){if(!this.frameState_||!this.renderer_)return;const n=this.getCoordinateFromPixelInternal(t),a=void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance:0,s=void 0!==i.layerFilter?i.layerFilter:x,r=!1!==i.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,a,r,e,null,s,null)}getFeaturesAtPixel(t,e){const i=[];return this.forEachFeatureAtPixel(t,function(t){i.push(t)},e),i}getAllLayers(){const t=[];return function e(i){i.forEach(function(i){i instanceof Is?e(i.getLayers()):t.push(i)})}(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(t),n=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:x,a=void 0!==e.hitTolerance?e.hitTolerance:0,s=!1!==e.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,a,s,n,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const e=this.viewport_.getBoundingClientRect(),i=this.getSize(),n=e.width/i[0],a=e.height/i[1],s="changedTouches"in t?t.changedTouches[0]:t;return[(s.clientX-e.left)/n,(s.clientY-e.top)/a]}getTarget(){return this.get(Zn)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return li(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?vi(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Xn)}setLayers(t){const e=this.getLayerGroup();if(t instanceof U)return void e.setLayers(t);const i=e.getLayers();i.clear(),i.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const i=t[e];if(!i.visible)continue;const n=i.layer.getRenderer();if(n&&!n.ready)return!0;const a=i.layer.getSource();if(a&&a.loading)return!0}return!1}getPixelFromCoordinate(t){const e=ui(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?vi(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(qn)}getView(){return this.get(Jn)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,i,n){return function(t,e,i,n,a){if(!t||!(i in t.wantedTiles))return Qn;if(!t.wantedTiles[i][e.getKey()])return Qn;const s=t.viewState.center,r=n[0]-s[0],o=n[1]-s[1];return 65536*Math.log(a)+Math.sqrt(r*r+o*o)/a}(this.frameState_,t,e,i,n)}handleBrowserEvent(t,e){e=e||t.type;const i=new jn(e,this,t);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,i=e.type;if(i===Vn||i===p||i===h){const t=this.getOwnerDocument(),i=this.viewport_.getRootNode?this.viewport_.getRootNode():t,n=e.target,a=i instanceof ShadowRoot?i.host===n?i.host.ownerDocument:i:i===t?t.documentElement:i;if(this.overlayContainerStopEvent_.contains(n)||!a.contains(n))return}if(t.frameState=this.frameState_,!1!==this.dispatchEvent(t)){const e=this.getInteractions().getArray().slice();for(let i=e.length-1;i>=0;i--){const n=e[i];if(n.getMap()===this&&n.getActive()&&this.getTargetElement()&&(!n.handleEvent(t)||t.propagationStopped))break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let i=this.maxTilesLoading_,n=i;if(t){const e=t.viewHints;if(e[0]||e[1]){const e=Date.now()-t.time>8;i=e?0:8,n=e?0:2}}e.getTilesLoading()<i&&(e.reprioritize(),e.loadMoreTiles(i,n))}t&&this.renderer_&&!t.animate&&(this.renderComplete_?(this.hasListener(Fs)&&this.renderer_.dispatchRenderEvent(Fs,t),!1===this.loaded_&&(this.loaded_=!0,this.dispatchEvent(new An(Yn,this,t)))):!0===this.loaded_&&(this.loaded_=!1,this.dispatchEvent(new An($n,this,t))));const i=this.postRenderFunctions_;if(t)for(let e=0,n=i.length;e<n;++e)i[e](this,t);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let t=0,e=this.targetChangeHandlerKeys_.length;t<e;++t)P(this.targetChangeHandlerKeys_[t]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(l,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(p,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!Pa(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const t=this.targetElement_.getRootNode();t instanceof ShadowRoot&&this.resizeObserver_.unobserve(t.host),this.setSize(void 0)}const t=this.getTarget(),e="string"==typeof t?document.getElementById(t):t;if(this.targetElement_=e,e){if(Pa(e)||e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new yu(this)),!Pa(e)){this.mapBrowserEventHandler_=new Kn(this,this.moveTolerance_);for(const t in On)this.mapBrowserEventHandler_.addEventListener(On[t],this.handleMapBrowserEvent.bind(this));let t;if(this.viewport_.addEventListener(l,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(p,this.boundHandleBrowserEvent_,!!Bn&&{passive:!1}),this.keyboardEventTarget_)t=this.keyboardEventTarget_;else{const i=e.getRootNode();t=i instanceof ShadowRoot?i.host:e}if(this.targetChangeHandlerKeys_=[R(t,h,this.handleBrowserEvent,this),R(t,c,this.handleBrowserEvent,this)],e instanceof HTMLElement){const t=e.getRootNode();t instanceof ShadowRoot&&this.resizeObserver_.observe(t.host),this.resizeObserver_?.observe(e)}}this.updateSize()}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0)}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(P(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(P(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=R(t,r,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=R(t,o,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(P),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.handleLayerAdd_(new Cs("addlayer",t)),this.layerGroupPropertyListenerKeys_=[R(t,r,this.render,this),R(t,o,this.render,this),R(t,"addlayer",this.handleLayerAdd_,this),R(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const t=this.frameState_.layerStatesArray;for(let e=0,i=t.length;e<i;++e){const i=t[e].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){ku(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),i=this.getView(),n=this.frameState_;let a=null;if(void 0!==e&&br(e)&&i&&i.isDef()){const n=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),s=i.getState();if(a={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:ft(s.center,s.resolution,s.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:s,viewHints:n,wantedTiles:{},mapId:N(this),renderTargets:{}},s.nextCenter&&s.nextResolution){const t=isNaN(s.nextRotation)?s.rotation:s.nextRotation;a.nextExtent=ft(s.nextCenter,s.nextResolution,t,e)}}this.frameState_=a,this.renderer_.renderFrame(a),a&&(a.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,a.postRenderFunctions),n&&(!this.previousExtent_||!bt(this.previousExtent_)&&!at(a.extent,this.previousExtent_))&&(this.dispatchEvent(new An("movestart",this,n)),this.previousExtent_=et(this.previousExtent_)),this.previousExtent_&&!a.viewHints[0]&&!a.viewHints[1]&&!at(a.extent,this.previousExtent_)&&(this.dispatchEvent(new An("moveend",this,a)),Y(a.extent,this.previousExtent_))),this.dispatchEvent(new An(zn,this,a)),this.renderComplete_=(this.hasListener($n)||this.hasListener(Yn)||this.hasListener(Fs))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(t){const e=this.getLayerGroup();e&&this.handleLayerRemove_(new Cs("removelayer",e)),this.set(Xn,t)}setSize(t){this.set(qn,t)}setTarget(t){this.set(Zn,t)}setView(t){if(!t||t instanceof _a)return void this.set(Jn,t);this.set(Jn,new _a);const e=this;t.then(function(t){e.setView(new _a(t))})}updateSize(){const t=this.getTargetElement();let e;if(t){let i,n;if(Pa(t))i=t.width,n=t.height;else{const e=getComputedStyle(t);i=t.offsetWidth-parseFloat(e.borderLeftWidth)-parseFloat(e.paddingLeft)-parseFloat(e.paddingRight)-parseFloat(e.borderRightWidth),n=t.offsetHeight-parseFloat(e.borderTopWidth)-parseFloat(e.paddingTop)-parseFloat(e.paddingBottom)-parseFloat(e.borderBottomWidth)}isNaN(i)||isNaN(n)||(e=[Math.max(0,i),Math.max(0,n)],!br(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&Kt("No map visible because the map container's width or height are 0."))}const i=this.getSize();!e||i&&v(e,i)||(this.setSize(e),this.updateViewportSize_(e))}updateViewportSize_(t){const e=this.getView();e&&e.setViewportSize(t)}},wu="units",bu=[1,2,5],Eu=25.4/.28,Mu=class extends Aa{constructor(t){t=t||{};const e=document.createElement("div");e.style.pointerEvents="none",super({element:e,render:t.render,target:t.target}),this.on,this.once,this.un;const i=void 0!==t.className?t.className:t.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=i+"-inner",this.element.className=i+" "+ka,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=void 0!==t.minWidth?t.minWidth:64,this.maxWidth_=t.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(wu,this.handleUnitsChanged_),this.setUnits(t.units||"metric"),this.scaleBar_=t.bar||!1,this.scaleBarSteps_=t.steps||4,this.scaleBarText_=t.text||!1,this.dpi_=t.dpi||void 0}getUnits(){return this.get(wu)}handleUnitsChanged_(){this.updateElement_()}setUnits(t){this.set(wu,t)}setDpi(t){this.dpi_=t}updateElement_(){const t=this.viewState_;if(!t)return void(this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1));const e=t.center,i=t.projection,n=this.getUnits(),a="degrees"==n?"degrees":"m";let s=Xe(i,t.resolution,e,a);const r=this.minWidth_*(this.dpi_||Eu)/Eu,o=void 0!==this.maxWidth_?this.maxWidth_*(this.dpi_||Eu)/Eu:void 0;let l=r*s,u="";if("degrees"==n){const t=Qt.degrees;l*=t,l<t/60?(u="",s*=3600):l<t?(u="",s*=60):u=""}else if("imperial"==n)l<.9144?(u="in",s/=.0254):l<1609.344?(u="ft",s/=.3048):(u="mi",s/=1609.344);else if("nautical"==n)s/=1852,u="NM";else if("metric"==n)l<1e-6?(u="nm",s*=1e9):l<.001?(u="m",s*=1e6):l<1?(u="mm",s*=1e3):l<1e3?u="m":(u="km",s/=1e3);else{if("us"!=n)throw new Error("Invalid units");l<.9144?(u="in",s*=39.37):l<1609.344?(u="ft",s/=.30480061):(u="mi",s/=1609.3472)}let h,c,d,p,m,f=3*Math.floor(Math.log(r*s)/Math.log(10)),g=0;for(;;){d=Math.floor(f/3);const t=Math.pow(10,d);if(h=bu[(f%3+3)%3]*t,c=Math.round(h/s),isNaN(c))return this.element.style.display="none",void(this.renderedVisible_=!1);if(void 0!==o&&c>=o){h=g,c=p,d=m;break}if(c>=r)break;g=h,p=c,m=d,++f}const _=this.scaleBar_?this.createScaleBar(c,h,u):h.toFixed(d<0?-d:0)+" "+u;this.renderedHTML_!=_&&(this.innerElement_.innerHTML=_,this.renderedHTML_=_),this.renderedWidth_!=c&&(this.innerElement_.style.width=c+"px",this.renderedWidth_=c),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(t,e,i){const n=this.getScaleForResolution(),a=n<1?Math.round(1/n).toLocaleString()+" : 1":"1 : "+Math.round(n).toLocaleString(),s=this.scaleBarSteps_,r=t/s,o=[this.createMarker("absolute")];for(let n=0;n<s;++n){const a=n%2==0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";o.push(`<div><div class="ol-scale-singlebar ${a}" style="width: ${r}px;"></div>`+this.createMarker("relative")+(n%2==0||2===s?this.createStepText(n,t,!1,e,i):"")+"</div>")}return o.push(this.createStepText(s,t,!0,e,i)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${t}px;">`+a+"</div>":"")+o.join("")}createMarker(t){return`<div class="ol-scale-step-marker" style="position: ${t}; top: ${"absolute"===t?3:-10}px;"></div>`}createStepText(t,e,i,n,a){const s=(0===t?0:Math.round(n/this.scaleBarSteps_*t*100)/100)+(0===t?"":" "+a);return`<div class="ol-scale-step-text" style="margin-left: ${0===t?-3:e/this.scaleBarSteps_*-1}px;text-align: ${0===t?"left":"center"};min-width: ${0===t?0:e/this.scaleBarSteps_*2}px;left: ${i?e+"px":"unset"};">`+s+"</div>"}getScaleForResolution(){return Xe(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m")*(1e3/25.4)*(this.dpi_||Eu)}render(t){const e=t.frameState;this.viewState_=e?e.viewState:null,this.updateElement_()}};function Tu(t,e,i,n){const a=[];let s=[1/0,1/0,-1/0,-1/0];for(let r=0,o=i.length;r<o;++r){const o=i[r];s=nt(t,e,o[0],n),a.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=o[o.length-1]}return a}function Su(t,e,i,n,a,s,r){let o,l;const u=(i-e)/n;if(1===u)o=e;else if(2===u)o=e,l=a;else if(0!==u){let s=t[e],r=t[e+1],u=0;const h=[0];for(let a=e+n;a<i;a+=n){const e=t[a],i=t[a+1];u+=Math.sqrt((e-s)*(e-s)+(i-r)*(i-r)),h.push(u),s=e,r=i}const c=a*u,d=function(t,e,i){let n,a;i=i||f;let s=0,r=t.length,o=!1;for(;s<r;)n=s+(r-s>>1),a=+i(t[n],e),a<0?s=n+1:(r=n,o=!a);return o?s:~s}(h,c);d<0?(l=(c-h[-d-2])/(h[-d-1]-h[-d-2]),o=e+(-d-2)*n):o=e+d*n}r=r>1?r:2,s=s||new Array(r);for(let e=0;e<r;++e)s[e]=void 0===o?NaN:void 0===l?t[o+e]:At(t[o+e],t[o+n+e],l);return s}function Cu(t,e,i,n,a,s){if(i==e)return null;let r;if(a<t[e+n-1])return s?(r=t.slice(e,e+n),r[n-1]=a,r):null;if(t[i-1]<a)return s?(r=t.slice(i-n,i),r[n-1]=a,r):null;if(a==t[e+n-1])return t.slice(e,e+n);let o=e/n,l=i/n;for(;o<l;){const e=o+l>>1;a<t[(e+1)*n-1]?l=e:o=e+1}const u=t[o*n-1];if(a==u)return t.slice((o-1)*n,(o-1)*n+n);const h=(a-u)/(t[(o+1)*n-1]-u);r=[];for(let e=0;e<n-1;++e)r.push(At(t[(o-1)*n+e],t[o*n+e],h));return r.push(a),r}const Lu=[1,0,0,1,0,0];class Ru{constructor(t,e,i,n,a,s){this.styleFunction,this.extent_,this.id_=s,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=a,this.squaredTolerance_,this.stride_=n,this.simplifiedGeometry_}get(t){return this.properties_[t]}getExtent(){return this.extent_||(this.extent_="Point"===this.type_?it(this.flatCoordinates_):nt(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const t=pt(this.getExtent());this.flatInteriorPoints_=rn(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const t=function(t,e){const i=[];let n,a=0,s=0;for(let r=0,o=e.length;r<o;++r){const o=e[r],l=pn(t,a,o,2);if(void 0===n&&(n=l),l===n)i.push(e.slice(s,r+1));else{if(0===i.length)continue;i[i.length-1].push(e[s])}s=r+1,a=o}return i}(this.flatCoordinates_,this.ends_),e=Tu(this.flatCoordinates_,0,t,2);this.flatInteriorPoints_=on(this.flatCoordinates_,0,t,2,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=Su(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const t=this.flatCoordinates_;let e=0;const i=this.ends_;for(let n=0,a=i.length;n<a;++n){const a=i[n],s=Su(t,e,a,2,.5);k(this.flatMidpoints_,s),e=a}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(t){return this}simplifyTransformed(t,e){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(t){const e=(t=Ye(t)).getExtent(),i=t.getWorldExtent();if(e&&i){const t=_t(i)/_t(e);wi(Lu,i[0],i[3],t,-t,0,0,0),Ti(this.flatCoordinates_,0,this.flatCoordinates_.length,2,Lu,this.flatCoordinates_)}}applyTransform(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new Ru(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=E((t,e)=>{if(t===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),e&&this.simplifiedGeometry_.applyTransform(e);const i=this.simplifiedGeometry_.getFlatCoordinates();let n;switch(this.type_){case"LineString":i.length=$i(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,t,i,0),n=[i.length];break;case"MultiLineString":n=[],i.length=Yi(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,t,i,0,n);break;case"Polygon":n=[],i.length=Zi(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(t),i,0,n)}return n&&(this.simplifiedGeometry_=new Ru(this.type_,i,n,2,this.properties_,this.id_)),this.squaredTolerance_=t,this.simplifiedGeometry_}),this}}Ru.prototype.getFlatCoordinates=Ru.prototype.getOrientedFlatCoordinates;const Iu=Ru;function Pu(t,e,i,n){let a=t[e],s=t[e+1],r=0;for(let o=e+n;o<i;o+=n){const e=t[o],i=t[o+1];r+=Math.sqrt((e-a)*(e-a)+(i-s)*(i-s)),a=e,s=i}return r}class Au extends Ai{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}appendCoordinate(t){k(this.flatCoordinates,t),this.changed()}clone(){const t=new Au(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<X(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Ni(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Di(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,n))}forEachSegment(t){return ln(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return"XYM"!=this.layout&&"XYZM"!=this.layout?null:(e=void 0!==e&&e,Cu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}getCoordinates(){return Vi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return Su(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return Pu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=$i(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new Au(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return un(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,this.getExtent())}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Hi(this.flatCoordinates,0,t,this.stride),this.changed()}}const ju=Au;class Ou extends Ai{constructor(t,e){super(),e&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendPoint(t){k(this.flatCoordinates,t.getFlatCoordinates()),this.changed()}clone(){const t=new Ou(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){if(n<X(this.getExtent(),t,e))return n;const a=this.flatCoordinates,s=this.stride;for(let r=0,o=a.length;r<o;r+=s){const o=Lt(t,e,a[r],a[r+1]);if(o<n){n=o;for(let t=0;t<s;++t)i[t]=a[r+t];i.length=s}}return n}getCoordinates(){return Vi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){const e=this.flatCoordinates.length/this.stride;return t<0||e<=t?null:new en(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,e=this.layout,i=this.stride,n=[];for(let a=0,s=t.length;a<s;a+=i){const s=new en(t.slice(a,a+i),e);n.push(s)}return n}getType(){return"MultiPoint"}intersectsExtent(t){const e=this.flatCoordinates,i=this.stride;for(let n=0,a=e.length;n<a;n+=i)if(J(t,e[n],e[n+1]))return!0;return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Hi(this.flatCoordinates,0,t,this.stride),this.changed()}}const Fu=Ou;class Nu extends Ai{constructor(t,e,i){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,e);else if(void 0!==e&&i)this.setFlatCoordinates(e,t),this.ends_=i;else{const e=t,i=[],n=[];for(let t=0,a=e.length;t<a;++t)k(i,e[t].getFlatCoordinates()),n.push(i.length);const a=0===e.length?this.getLayout():e[0].getLayout();this.setFlatCoordinates(a,i),this.ends_=n}}appendLineString(t){k(this.flatCoordinates,t.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new Nu(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<X(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Gi(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Wi(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,n))}getCoordinateAtM(t,e,i){return"XYM"!=this.layout&&"XYZM"!=this.layout||0===this.flatCoordinates.length?null:(e=void 0!==e&&e,i=void 0!==i&&i,function(t,e,i,n,a,s,r){if(r)return Cu(t,e,i[i.length-1],n,a,s);let o;if(a<t[n-1])return s?(o=t.slice(0,n),o[n-1]=a,o):null;if(t[t.length-1]<a)return s?(o=t.slice(t.length-n),o[n-1]=a,o):null;for(let s=0,r=i.length;s<r;++s){const r=i[s];if(e!=r){if(a<t[e+n-1])return null;if(a<=t[r-1])return Cu(t,e,r,n,a,!1);e=r}}return null}(this.flatCoordinates,0,this.ends_,this.stride,t,e,i))}getCoordinates(){return Ki(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new ju(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,e=this.ends_,i=this.layout,n=[];let a=0;for(let s=0,r=e.length;s<r;++s){const r=e[s],o=new ju(t.slice(a,r),i);n.push(o),a=r}return n}getLength(){const t=this.ends_;let e=0,i=0;for(let n=0,a=t.length;n<a;++n)i+=Pu(this.flatCoordinates,e,t[n],this.stride),e=t[n];return i}getFlatMidpoints(){const t=[],e=this.flatCoordinates;let i=0;const n=this.ends_,a=this.stride;for(let s=0,r=n.length;s<r;++s){const r=n[s];k(t,Su(e,i,r,a,.5)),i=r}return t}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=Yi(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,i),new Nu(e,"XY",i)}getType(){return"MultiLineString"}intersectsExtent(t){return function(t,e,i,n,a){for(let s=0,r=i.length;s<r;++s){if(un(t,e,i[s],n,a))return!0;e=i[s]}return!1}(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Ui(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()}}const Gu=Nu;class Du extends Ai{constructor(t,e,i){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!i&&!Array.isArray(t[0])){const n=t,a=[],s=[];for(let t=0,e=n.length;t<e;++t){const e=n[t],i=a.length,r=e.getEnds();for(let t=0,e=r.length;t<e;++t)r[t]+=i;k(a,e.getFlatCoordinates()),s.push(r)}e=0===n.length?this.getLayout():n[0].getLayout(),t=a,i=s}void 0!==e&&i?(this.setFlatCoordinates(e,t),this.endss_=i):this.setCoordinates(t,e)}appendPolygon(t){let e;if(this.flatCoordinates){const i=this.flatCoordinates.length;k(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(let t=0,n=e.length;t<n;++t)e[t]+=i}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()}clone(){const t=this.endss_.length,e=new Array(t);for(let i=0;i<t;++i)e[i]=this.endss_[i].slice();const i=new Du(this.flatCoordinates.slice(),this.layout,e);return i.applyProperties(this),i}closestPointXY(t,e,i,n){return n<X(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,i,n,a){for(let s=0,r=i.length;s<r;++s){const r=i[s];a=Gi(t,e,r,n,a),e=r[r.length-1]}return a}(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,i,n,a,s,r,o,l,u,h){h=h||[NaN,NaN];for(let s=0,c=i.length;s<c;++s){const c=i[s];u=Wi(t,e,c,n,a,true,r,o,l,u,h),e=c[c.length-1]}return u}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,0,t,e,i,n))}containsXY(t,e){return function(t,e,i,n,a,s){if(0===i.length)return!1;for(let r=0,o=i.length;r<o;++r){const o=i[r];if(sn(t,e,o,n,a,s))return!0;e=o[o.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}getArea(){return function(t,e,i,n){let a=0;for(let s=0,r=i.length;s<r;++s){const r=i[s];a+=Oi(t,e,r,n),e=r[r.length-1]}return a}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),_n(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,zi(e,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=Tu(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=on(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new Fu(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;fn(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=_n(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=function(t,e,i,n,a,s,r,o){for(let l=0,u=i.length;l<u;++l){const u=i[l],h=[];r=Zi(t,e,u,n,a,s,r,h),o.push(h),e=u[u.length-1]}return r}(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,i),new Du(e,"XY",i)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let e;if(0===t)e=0;else{const i=this.endss_[t-1];e=i[i.length-1]}const i=this.endss_[t].slice(),n=i[i.length-1];if(0!==e)for(let t=0,n=i.length;t<n;++t)i[t]-=e;return new kn(this.flatCoordinates.slice(e,n),this.layout,i)}getPolygons(){const t=this.layout,e=this.flatCoordinates,i=this.endss_,n=[];let a=0;for(let s=0,r=i.length;s<r;++s){const r=i[s].slice(),o=r[r.length-1];if(0!==a)for(let t=0,e=r.length;t<e;++t)r[t]-=a;const l=new kn(e.slice(a,o),t,r);n.push(l),a=o}return n}getType(){return"MultiPolygon"}intersectsExtent(t){return function(t,e,i,n,a){for(let s=0,r=i.length;s<r;++s){const r=i[s];if(cn(t,e,r,n,a))return!0;e=r[r.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const i=Bi(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===i.length)this.flatCoordinates.length=0;else{const t=i[i.length-1];this.flatCoordinates.length=0===t.length?0:t[t.length-1]}this.changed()}}const Wu=Du;class Hu extends Ri{constructor(t){super(),this.geometries_=t,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(P),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const t=this.geometries_;for(let e=0,i=t.length;e<i;++e)this.changeEventsKeys_.push(R(t[e],o,this.changed,this))}clone(){const t=new Hu(Uu(this.geometries_));return t.applyProperties(this),t}closestPointXY(t,e,i,n){if(n<X(this.getExtent(),t,e))return n;const a=this.geometries_;for(let s=0,r=a.length;s<r;++s)n=a[s].closestPointXY(t,e,i,n);return n}containsXY(t,e){const i=this.geometries_;for(let n=0,a=i.length;n<a;++n)if(i[n].containsXY(t,e))return!0;return!1}computeExtent(t){et(t);const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)st(t,e[i].getExtent());return t}getGeometries(){return Uu(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let t=[];const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)e[i].getType()===this.getType()?t=t.concat(e[i].getGeometriesArrayRecursive()):t.push(e[i]);return t}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=[],i=this.geometries_;let n=!1;for(let a=0,s=i.length;a<s;++a){const s=i[a],r=s.getSimplifiedGeometry(t);e.push(r),r!==s&&(n=!0)}return n?new Hu(e):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getType(){return"GeometryCollection"}intersectsExtent(t){const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)if(e[i].intersectsExtent(t))return!0;return!1}isEmpty(){return 0===this.geometries_.length}rotate(t,e){const i=this.geometries_;for(let n=0,a=i.length;n<a;++n)i[n].rotate(t,e);this.changed()}scale(t,e,i){i||(i=pt(this.getExtent()));const n=this.geometries_;for(let a=0,s=n.length;a<s;++a)n[a].scale(t,e,i);this.changed()}setGeometries(t){this.setGeometriesArray(Uu(t))}setGeometriesArray(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}applyTransform(t){const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)e[i].applyTransform(t);this.changed()}translate(t,e){const i=this.geometries_;for(let n=0,a=i.length;n<a;++n)i[n].translate(t,e);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function Uu(t){return t.map(t=>t.clone())}const Bu=Hu,Vu=class{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=K,this.supportedMediaTypes=null}getReadOptions(t,e){if(e){let i=e.dataProjection?Ye(e.dataProjection):this.readProjection(t);e.extent&&i&&"tile-pixels"===i.getUnits()&&(i=Ye(i),i.setWorldExtent(e.extent)),e={dataProjection:i,featureProjection:e.featureProjection}}return this.adaptOptions(e)}adaptOptions(t){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},t)}getType(){return O()}readFeature(t,e){return O()}readFeatures(t,e){return O()}readGeometry(t,e){return O()}readProjection(t){return O()}writeFeature(t,e){return O()}writeFeatures(t,e){return O()}writeGeometry(t,e){return O()}};function Ku(t,e,i){const n=i?Ye(i.featureProjection):null,a=i?Ye(i.dataProjection):null;let s=t;if(n&&a&&!ti(n,a)){e&&(s=t.clone());const i=e?n:a,r=e?a:n;"tile-pixels"===i.getUnits()?s.transform(i,r):s.applyTransform(ni(i,r))}if(e&&i&&void 0!==i.decimals){const e=Math.pow(10,i.decimals),n=function(t){for(let i=0,n=t.length;i<n;++i)t[i]=Math.round(t[i]*e)/e;return t};s===t&&(s=t.clone()),s.applyTransform(n)}return s}const zu={Point:en,LineString:ju,Polygon:kn,MultiPoint:Fu,MultiLineString:Gu,MultiPolygon:Wu};function $u(t,e){const i=t.geometry;if(!i)return[];if(Array.isArray(i))return i.map(e=>$u({...t,geometry:e})).flat();const n="MultiPolygon"===i.type?"Polygon":i.type;if("GeometryCollection"===n||"Circle"===n)throw new Error("Unsupported geometry type: "+n);const a=i.layout.length;return Ku(new Iu(n,"Polygon"===n?function(t,e,i){return Array.isArray(e[0])?(fn(t,0,e,i)||_n(t=t.slice(),0,e,i),t):(mn(t,0,e,i)||gn(t=t.slice(),0,e,i),t)}(i.flatCoordinates,i.ends,a):i.flatCoordinates,i.ends?.flat(),a,t.properties||{},t.id).enableSimplifyTransformed(),!1,e)}function Yu(t,e){if(!t)return null;if(Array.isArray(t)){const i=t.map(t=>Yu(t,e));return new Bu(i)}return Ku(new(0,zu[t.type])(t.flatCoordinates,t.layout||"XY",t.ends),!1,e)}function Xu(t){if("string"==typeof t){return JSON.parse(t)||null}return null!==t?t:null}const qu=class extends Vu{constructor(){super()}getType(){return"json"}readFeature(t,e){return this.readFeatureFromObject(Xu(t),this.getReadOptions(t,e))}readFeatures(t,e){return this.readFeaturesFromObject(Xu(t),this.getReadOptions(t,e))}readFeatureFromObject(t,e){return O()}readFeaturesFromObject(t,e){return O()}readGeometry(t,e){return this.readGeometryFromObject(Xu(t),this.getReadOptions(t,e))}readGeometryFromObject(t,e){return O()}readProjection(t){return this.readProjectionFromObject(Xu(t))}readProjectionFromObject(t){return O()}writeFeature(t,e){return JSON.stringify(this.writeFeatureObject(t,e))}writeFeatureObject(t,e){return O()}writeFeatures(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))}writeFeaturesObject(t,e){return O()}writeGeometry(t,e){return JSON.stringify(this.writeGeometryObject(t,e))}writeGeometryObject(t,e){return O()}};function Zu(t,e){if(!t)return null;let i;switch(t.type){case"Point":i=function(t){const e=t.coordinates;return{type:"Point",flatCoordinates:e,layout:Ii(e.length)}}(t);break;case"LineString":i=function(t){const e=t.coordinates,i=e.flat();return{type:"LineString",flatCoordinates:i,ends:[i.length],layout:Ii(e[0]?.length||2)}}(t);break;case"Polygon":i=function(t){const e=t.coordinates,i=[],n=e[0]?.[0]?.length;return{type:"Polygon",flatCoordinates:i,ends:Ui(i,0,e,n),layout:Ii(n)}}(t);break;case"MultiPoint":i=function(t){const e=t.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:Ii(e[0]?.length||2)}}(t);break;case"MultiLineString":i=function(t){const e=t.coordinates,i=e[0]?.[0]?.length||2,n=[];return{type:"MultiLineString",flatCoordinates:n,ends:Ui(n,0,e,i),layout:Ii(i)}}(t);break;case"MultiPolygon":i=function(t){const e=t.coordinates,i=[],n=e[0]?.[0]?.[0].length||2;return{type:"MultiPolygon",flatCoordinates:i,ends:Bi(i,0,e,n),layout:Ii(n)}}(t);break;case"GeometryCollection":i=function(t){const e=t.geometries.map(function(t){return Zu(t)});return e}(t);break;default:throw new Error("Unsupported GeoJSON type: "+t.type)}return i}function Ju(t,e){const i=(t=Ku(t,!0,e)).getType();let n;switch(i){case"Point":n=function(t){return{type:"Point",coordinates:t.getCoordinates()}}(t);break;case"LineString":n=function(t){return{type:"LineString",coordinates:t.getCoordinates()}}(t);break;case"Polygon":n=function(t,e){let i;return e&&(i=e.rightHanded),{type:"Polygon",coordinates:t.getCoordinates(i)}}(t,e);break;case"MultiPoint":n=function(t){return{type:"MultiPoint",coordinates:t.getCoordinates()}}(t);break;case"MultiLineString":n=function(t){return{type:"MultiLineString",coordinates:t.getCoordinates()}}(t);break;case"MultiPolygon":n=function(t,e){let i;return e&&(i=e.rightHanded),{type:"MultiPolygon",coordinates:t.getCoordinates(i)}}(t,e);break;case"GeometryCollection":n=function(t,e){delete(e=Object.assign({},e)).featureProjection;return{type:"GeometryCollection",geometries:t.getGeometriesArray().map(function(t){return Ju(t,e)})}}(t,e);break;case"Circle":n={type:"GeometryCollection",geometries:[]};break;default:throw new Error("Unsupported geometry type: "+i)}return n}const Qu=class extends qu{constructor(t){t=t||{},super(),this.dataProjection=Ye(t.dataProjection?t.dataProjection:"EPSG:4326"),t.featureProjection&&(this.defaultFeatureProjection=Ye(t.featureProjection)),t.featureClass&&(this.featureClass=t.featureClass),this.geometryName_=t.geometryName,this.extractGeometryName_=t.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(t,e){let i=null;i="Feature"===t.type?t:{type:"Feature",geometry:t,properties:null};const n=Zu(i.geometry);if(this.featureClass===Iu)return $u({geometry:n,id:i.id,properties:i.properties},e);const a=new K;return this.geometryName_?a.setGeometryName(this.geometryName_):this.extractGeometryName_&&i.geometry_name&&a.setGeometryName(i.geometry_name),a.setGeometry(Yu(n,e)),"id"in i&&a.setId(i.id),i.properties&&a.setProperties(i.properties,!0),a}readFeaturesFromObject(t,e){let i=null;if("FeatureCollection"===t.type){i=[];const n=t.features;for(let t=0,a=n.length;t<a;++t){const a=this.readFeatureFromObject(n[t],e);a&&i.push(a)}}else i=[this.readFeatureFromObject(t,e)];return i.flat()}readGeometryFromObject(t,e){return function(t,e){return Yu(Zu(t),e)}(t,e)}readProjectionFromObject(t){const e=t.crs;let i;if(e)if("name"==e.type)i=Ye(e.properties.name);else{if("EPSG"!==e.type)throw new Error("Unknown SRS type");i=Ye("EPSG:"+e.properties.code)}else i=this.dataProjection;return i}writeFeatureObject(t,e){e=this.adaptOptions(e);const i={type:"Feature",geometry:null,properties:null},n=t.getId();if(void 0!==n&&(i.id=n),!t.hasProperties())return i;const a=t.getProperties(),s=t.getGeometry();return s&&(i.geometry=Ju(s,e),delete a[t.getGeometryName()]),S(a)||(i.properties=a),i}writeFeaturesObject(t,e){e=this.adaptOptions(e);const i=[];for(let n=0,a=t.length;n<a;++n)i.push(this.writeFeatureObject(t[n],e));return{type:"FeatureCollection",features:i}}writeGeometryObject(t,e){return Ju(t,this.adaptOptions(e))}};var th=i(5072),eh=i.n(th),ih=i(7825),nh=i.n(ih),ah=i(7659),sh=i.n(ah),rh=i(5056),oh=i.n(rh),lh=i(540),uh=i.n(lh),hh=i(1113),ch=i.n(hh),dh=i(4096),ph={};ph.styleTagTransform=ch(),ph.setAttributes=oh(),ph.insert=sh().bind(null,"head"),ph.domAPI=nh(),ph.insertStyleElement=uh(),eh()(dh.A,ph),dh.A&&dh.A.locals&&dh.A.locals;let mh=null;var fh=6378137,gh=.0066943799901413165,_h=484813681109536e-20,yh=Math.PI/2,kh=1e-10,vh=.017453292519943295,xh=57.29577951308232,wh=Math.PI/4,bh=2*Math.PI,Eh=3.14159265359;const Mh={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667},Th={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var Sh=/[\s_\-\/\(\)]/g;function Ch(t,e){if(t[e])return t[e];for(var i,n=Object.keys(t),a=e.toLowerCase().replace(Sh,""),s=-1;++s<n.length;)if((i=n[s]).toLowerCase().replace(Sh,"")===a)return t[i]}function Lh(t){var e,i,n,a={},s=t.split("+").map(function(t){return t.trim()}).filter(function(t){return t}).reduce(function(t,e){var i=e.split("=");return i.push(!0),t[i[0].toLowerCase()]=i[1],t},{}),r={proj:"projName",datum:"datumCode",rf:function(t){a.rf=parseFloat(t)},lat_0:function(t){a.lat0=t*vh},lat_1:function(t){a.lat1=t*vh},lat_2:function(t){a.lat2=t*vh},lat_ts:function(t){a.lat_ts=t*vh},lon_0:function(t){a.long0=t*vh},lon_1:function(t){a.long1=t*vh},lon_2:function(t){a.long2=t*vh},alpha:function(t){a.alpha=parseFloat(t)*vh},gamma:function(t){a.rectified_grid_angle=parseFloat(t)*vh},lonc:function(t){a.longc=t*vh},x_0:function(t){a.x0=parseFloat(t)},y_0:function(t){a.y0=parseFloat(t)},k_0:function(t){a.k0=parseFloat(t)},k:function(t){a.k0=parseFloat(t)},a:function(t){a.a=parseFloat(t)},b:function(t){a.b=parseFloat(t)},r:function(t){a.a=a.b=parseFloat(t)},r_a:function(){a.R_A=!0},zone:function(t){a.zone=parseInt(t,10)},south:function(){a.utmSouth=!0},towgs84:function(t){a.datum_params=t.split(",").map(function(t){return parseFloat(t)})},to_meter:function(t){a.to_meter=parseFloat(t)},units:function(t){a.units=t;var e=Ch(Th,t);e&&(a.to_meter=e.to_meter)},from_greenwich:function(t){a.from_greenwich=t*vh},pm:function(t){var e=Ch(Mh,t);a.from_greenwich=(e||parseFloat(t))*vh},nadgrids:function(t){"@null"===t?a.datumCode="none":a.nadgrids=t},axis:function(t){var e="ewnsud";3===t.length&&-1!==e.indexOf(t.substr(0,1))&&-1!==e.indexOf(t.substr(1,1))&&-1!==e.indexOf(t.substr(2,1))&&(a.axis=t)},approx:function(){a.approx=!0},over:function(){a.over=!0}};for(e in s)i=s[e],e in r?"function"==typeof(n=r[e])?n(i):a[n]=i:a[e]=i;return"string"==typeof a.datumCode&&"WGS84"!==a.datumCode&&(a.datumCode=a.datumCode.toLowerCase()),a.projStr=t,a}const Rh=class{static getId(t){const e=t.find(t=>Array.isArray(t)&&"ID"===t[0]);return e&&e.length>=3?{authority:e[1],code:parseInt(e[2],10)}:null}static convertUnit(t,e="unit"){if(!t||t.length<3)return{type:e,name:"unknown",conversion_factor:null};const i=t[1],n=parseFloat(t[2])||null,a=t.find(t=>Array.isArray(t)&&"ID"===t[0]);return{type:e,name:i,conversion_factor:n,id:a?{authority:a[1],code:parseInt(a[2],10)}:null}}static convertAxis(t){const e=t[1]||"Unknown";let i;const n=e.match(/^\((.)\)$/);if(n){const t=n[1].toUpperCase();if("E"===t)i="east";else if("N"===t)i="north";else{if("U"!==t)throw new Error(`Unknown axis abbreviation: ${t}`);i="up"}}else i=t[2]?t[2].toLowerCase():"unknown";const a=t.find(t=>Array.isArray(t)&&"ORDER"===t[0]),s=a?parseInt(a[1],10):null,r=t.find(t=>Array.isArray(t)&&("LENGTHUNIT"===t[0]||"ANGLEUNIT"===t[0]||"SCALEUNIT"===t[0]));return{name:e,direction:i,unit:this.convertUnit(r),order:s}}static extractAxes(t){return t.filter(t=>Array.isArray(t)&&"AXIS"===t[0]).map(t=>this.convertAxis(t)).sort((t,e)=>(t.order||0)-(e.order||0))}static convert(t,e={}){switch(t[0]){case"PROJCRS":e.type="ProjectedCRS",e.name=t[1],e.base_crs=t.find(t=>Array.isArray(t)&&"BASEGEOGCRS"===t[0])?this.convert(t.find(t=>Array.isArray(t)&&"BASEGEOGCRS"===t[0])):null,e.conversion=t.find(t=>Array.isArray(t)&&"CONVERSION"===t[0])?this.convert(t.find(t=>Array.isArray(t)&&"CONVERSION"===t[0])):null;const i=t.find(t=>Array.isArray(t)&&"CS"===t[0]);i&&(e.coordinate_system={type:i[1],axis:this.extractAxes(t)});const n=t.find(t=>Array.isArray(t)&&"LENGTHUNIT"===t[0]);if(n){const t=this.convertUnit(n);e.coordinate_system.unit=t}e.id=this.getId(t);break;case"BASEGEOGCRS":case"GEOGCRS":e.type="GeographicCRS",e.name=t[1];const a=t.find(t=>Array.isArray(t)&&("DATUM"===t[0]||"ENSEMBLE"===t[0]));if(a){const i=this.convert(a);"ENSEMBLE"===a[0]?e.datum_ensemble=i:e.datum=i;const n=t.find(t=>Array.isArray(t)&&"PRIMEM"===t[0]);n&&"Greenwich"!==n[1]&&(i.prime_meridian={name:n[1],longitude:parseFloat(n[2])})}e.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(t)},e.id=this.getId(t);break;case"DATUM":e.type="GeodeticReferenceFrame",e.name=t[1],e.ellipsoid=t.find(t=>Array.isArray(t)&&"ELLIPSOID"===t[0])?this.convert(t.find(t=>Array.isArray(t)&&"ELLIPSOID"===t[0])):null;break;case"ENSEMBLE":e.type="DatumEnsemble",e.name=t[1],e.members=t.filter(t=>Array.isArray(t)&&"MEMBER"===t[0]).map(t=>({type:"DatumEnsembleMember",name:t[1],id:this.getId(t)}));const s=t.find(t=>Array.isArray(t)&&"ENSEMBLEACCURACY"===t[0]);s&&(e.accuracy=parseFloat(s[1]));const r=t.find(t=>Array.isArray(t)&&"ELLIPSOID"===t[0]);r&&(e.ellipsoid=this.convert(r)),e.id=this.getId(t);break;case"ELLIPSOID":e.type="Ellipsoid",e.name=t[1],e.semi_major_axis=parseFloat(t[2]),e.inverse_flattening=parseFloat(t[3]),t.find(t=>Array.isArray(t)&&"LENGTHUNIT"===t[0])&&this.convert(t.find(t=>Array.isArray(t)&&"LENGTHUNIT"===t[0]),e);break;case"CONVERSION":e.type="Conversion",e.name=t[1],e.method=t.find(t=>Array.isArray(t)&&"METHOD"===t[0])?this.convert(t.find(t=>Array.isArray(t)&&"METHOD"===t[0])):null,e.parameters=t.filter(t=>Array.isArray(t)&&"PARAMETER"===t[0]).map(t=>this.convert(t));break;case"METHOD":e.type="Method",e.name=t[1],e.id=this.getId(t);break;case"PARAMETER":e.type="Parameter",e.name=t[1],e.value=parseFloat(t[2]),e.unit=this.convertUnit(t.find(t=>Array.isArray(t)&&("LENGTHUNIT"===t[0]||"ANGLEUNIT"===t[0]||"SCALEUNIT"===t[0]))),e.id=this.getId(t);break;case"BOUNDCRS":e.type="BoundCRS";const o=t.find(t=>Array.isArray(t)&&"SOURCECRS"===t[0]);if(o){const t=o.find(t=>Array.isArray(t));e.source_crs=t?this.convert(t):null}const l=t.find(t=>Array.isArray(t)&&"TARGETCRS"===t[0]);if(l){const t=l.find(t=>Array.isArray(t));e.target_crs=t?this.convert(t):null}const u=t.find(t=>Array.isArray(t)&&"ABRIDGEDTRANSFORMATION"===t[0]);e.transformation=u?this.convert(u):null;break;case"ABRIDGEDTRANSFORMATION":if(e.type="Transformation",e.name=t[1],e.method=t.find(t=>Array.isArray(t)&&"METHOD"===t[0])?this.convert(t.find(t=>Array.isArray(t)&&"METHOD"===t[0])):null,e.parameters=t.filter(t=>Array.isArray(t)&&("PARAMETER"===t[0]||"PARAMETERFILE"===t[0])).map(t=>"PARAMETER"===t[0]?this.convert(t):"PARAMETERFILE"===t[0]?{name:t[1],value:t[2],id:{authority:"EPSG",code:8656}}:void 0),7===e.parameters.length){const t=e.parameters[6];"Scale difference"===t.name&&(t.value=Math.round(1e12*(t.value-1))/1e6)}e.id=this.getId(t);break;case"AXIS":e.coordinate_system||(e.coordinate_system={type:"unspecified",axis:[]}),e.coordinate_system.axis.push(this.convertAxis(t));break;case"LENGTHUNIT":const h=this.convertUnit(t,"LinearUnit");e.coordinate_system&&e.coordinate_system.axis&&e.coordinate_system.axis.forEach(t=>{t.unit||(t.unit=h)}),h.conversion_factor&&1!==h.conversion_factor&&e.semi_major_axis&&(e.semi_major_axis={value:e.semi_major_axis,unit:h});break;default:e.keyword=t[0]}return e}},Ih=class extends Rh{static convert(t,e={}){return super.convert(t,e),e.coordinate_system&&"Cartesian"===e.coordinate_system.subtype&&delete e.coordinate_system,e.usage&&delete e.usage,e}},Ph=class extends Rh{static convert(t,e={}){super.convert(t,e);const i=t.find(t=>Array.isArray(t)&&"CS"===t[0]);i&&(e.coordinate_system={subtype:i[1],axis:this.extractAxes(t)});const n=t.find(t=>Array.isArray(t)&&"USAGE"===t[0]);if(n){const t=n.find(t=>Array.isArray(t)&&"SCOPE"===t[0]),i=n.find(t=>Array.isArray(t)&&"AREA"===t[0]),a=n.find(t=>Array.isArray(t)&&"BBOX"===t[0]);e.usage={},t&&(e.usage.scope=t[1]),i&&(e.usage.area=i[1]),a&&(e.usage.bbox=a.slice(1))}return e}};var Ah=1,jh=/\s/,Oh=/[A-Za-z]/,Fh=/[A-Za-z84_]/,Nh=/[,\]]/,Gh=/[\d\.E\-\+]/;function Dh(t){if("string"!=typeof t)throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=Ah}function Wh(t,e,i){Array.isArray(e)&&(i.unshift(e),e=null);var n=e?{}:t,a=i.reduce(function(t,e){return Hh(e,t),t},n);e&&(t[e]=a)}function Hh(t,e){if(Array.isArray(t)){var i=t.shift();if("PARAMETER"===i&&(i=t.shift()),1===t.length)return Array.isArray(t[0])?(e[i]={},void Hh(t[0],e[i])):void(e[i]=t[0]);if(t.length)if("TOWGS84"!==i){if("AXIS"===i)return i in e||(e[i]=[]),void e[i].push(t);var n;switch(Array.isArray(i)||(e[i]={}),i){case"UNIT":case"PRIMEM":case"VERT_DATUM":return e[i]={name:t[0].toLowerCase(),convert:t[1]},void(3===t.length&&Hh(t[2],e[i]));case"SPHEROID":case"ELLIPSOID":return e[i]={name:t[0],a:t[1],rf:t[2]},void(4===t.length&&Hh(t[3],e[i]));case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":return t[0]=["name",t[0]],void Wh(e,i,t);case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":return t[0]=["name",t[0]],Wh(e,i,t),void(e[i].type=i);default:for(n=-1;++n<t.length;)if(!Array.isArray(t[n]))return Hh(t,e[i]);return Wh(e,i,t)}}else e[i]=t;else e[i]=!0}else e[t]=!0}function Uh(t){return.017453292519943295*t}function Bh(t){const e=(t.projName||"").toLowerCase().replace(/_/g," ");t.long0||!t.longc||"albers conic equal area"!==e&&"lambert azimuthal equal area"!==e||(t.long0=t.longc),t.lat_ts||!t.lat1||"stereographic south pole"!==e&&"polar stereographic (variant b)"!==e?t.lat_ts||!t.lat0||"polar stereographic"!==e&&"polar stereographic (variant a)"!==e||(t.lat_ts=t.lat0,t.lat0=Uh(t.lat0>0?90:-90),delete t.lat1):(t.lat0=Uh(t.lat1>0?90:-90),t.lat_ts=t.lat1,delete t.lat1)}function Vh(t){let e={units:null,to_meter:void 0};return"string"==typeof t?(e.units=t.toLowerCase(),"metre"===e.units&&(e.units="meter"),"meter"===e.units&&(e.to_meter=1)):t&&t.name&&(e.units=t.name.toLowerCase(),"metre"===e.units&&(e.units="meter"),e.to_meter=t.conversion_factor),e}function Kh(t){return"object"==typeof t?t.value*t.unit.conversion_factor:t}function zh(t,e){t.ellipsoid.radius?(e.a=t.ellipsoid.radius,e.rf=0):(e.a=Kh(t.ellipsoid.semi_major_axis),void 0!==t.ellipsoid.inverse_flattening?e.rf=t.ellipsoid.inverse_flattening:void 0!==t.ellipsoid.semi_major_axis&&void 0!==t.ellipsoid.semi_minor_axis&&(e.rf=e.a/(e.a-Kh(t.ellipsoid.semi_minor_axis))))}function $h(t,e={}){return t&&"object"==typeof t?"BoundCRS"===t.type?($h(t.source_crs,e),t.transformation&&(t.transformation.method&&"NTv2"===t.transformation.method.name?e.nadgrids=t.transformation.parameters[0].value:e.datum_params=t.transformation.parameters.map(t=>t.value)),e):(Object.keys(t).forEach(i=>{const n=t[i];if(null!==n)switch(i){case"name":if(e.srsCode)break;e.name=n,e.srsCode=n;break;case"type":"GeographicCRS"===n?e.projName="longlat":"ProjectedCRS"===n&&t.conversion&&t.conversion.method&&(e.projName=t.conversion.method.name);break;case"datum":case"datum_ensemble":n.ellipsoid&&(e.ellps=n.ellipsoid.name,zh(n,e)),n.prime_meridian&&(e.from_greenwich=n.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":e.ellps=n.name,zh(n,e);break;case"prime_meridian":e.long0=(n.longitude||0)*Math.PI/180;break;case"coordinate_system":if(n.axis)if(e.axis=n.axis.map(t=>{const e=t.direction;if("east"===e)return"e";if("north"===e)return"n";if("west"===e)return"w";if("south"===e)return"s";throw new Error(`Unknown axis direction: ${e}`)}).join("")+"u",n.unit){const{units:t,to_meter:i}=Vh(n.unit);e.units=t,e.to_meter=i}else if(n.axis[0]&&n.axis[0].unit){const{units:t,to_meter:i}=Vh(n.axis[0].unit);e.units=t,e.to_meter=i}break;case"id":n.authority&&n.code&&(e.title=n.authority+":"+n.code);break;case"conversion":n.method&&n.method.name&&(e.projName=n.method.name),n.parameters&&n.parameters.forEach(t=>{const i=t.name.toLowerCase().replace(/\s+/g,"_"),n=t.value;t.unit&&t.unit.conversion_factor?e[i]=n*t.unit.conversion_factor:"degree"===t.unit?e[i]=n*Math.PI/180:e[i]=n});break;case"unit":n.name&&(e.units=n.name.toLowerCase(),"metre"===e.units&&(e.units="meter")),n.conversion_factor&&(e.to_meter=n.conversion_factor);break;case"base_crs":$h(n,e),e.datumCode=n.id?n.id.authority+"_"+n.id.code:n.name}}),void 0!==e.latitude_of_false_origin&&(e.lat0=e.latitude_of_false_origin),void 0!==e.longitude_of_false_origin&&(e.long0=e.longitude_of_false_origin),void 0!==e.latitude_of_standard_parallel&&(e.lat0=e.latitude_of_standard_parallel,e.lat1=e.latitude_of_standard_parallel),void 0!==e.latitude_of_1st_standard_parallel&&(e.lat1=e.latitude_of_1st_standard_parallel),void 0!==e.latitude_of_2nd_standard_parallel&&(e.lat2=e.latitude_of_2nd_standard_parallel),void 0!==e.latitude_of_projection_centre&&(e.lat0=e.latitude_of_projection_centre),void 0!==e.longitude_of_projection_centre&&(e.longc=e.longitude_of_projection_centre),void 0!==e.easting_at_false_origin&&(e.x0=e.easting_at_false_origin),void 0!==e.northing_at_false_origin&&(e.y0=e.northing_at_false_origin),void 0!==e.latitude_of_natural_origin&&(e.lat0=e.latitude_of_natural_origin),void 0!==e.longitude_of_natural_origin&&(e.long0=e.longitude_of_natural_origin),void 0!==e.longitude_of_origin&&(e.long0=e.longitude_of_origin),void 0!==e.false_easting&&(e.x0=e.false_easting),e.easting_at_projection_centre&&(e.x0=e.easting_at_projection_centre),void 0!==e.false_northing&&(e.y0=e.false_northing),e.northing_at_projection_centre&&(e.y0=e.northing_at_projection_centre),void 0!==e.standard_parallel_1&&(e.lat1=e.standard_parallel_1),void 0!==e.standard_parallel_2&&(e.lat2=e.standard_parallel_2),void 0!==e.scale_factor_at_natural_origin&&(e.k0=e.scale_factor_at_natural_origin),void 0!==e.scale_factor_at_projection_centre&&(e.k0=e.scale_factor_at_projection_centre),void 0!==e.scale_factor_on_pseudo_standard_parallel&&(e.k0=e.scale_factor_on_pseudo_standard_parallel),void 0!==e.azimuth&&(e.alpha=e.azimuth),void 0!==e.azimuth_at_projection_centre&&(e.alpha=e.azimuth_at_projection_centre),e.angle_from_rectified_to_skew_grid&&(e.rectified_grid_angle=e.angle_from_rectified_to_skew_grid),Bh(e),e):t}Dh.prototype.readCharicter=function(){var t=this.text[this.place++];if(4!==this.state)for(;jh.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case Ah:return this.neutral(t);case 2:return this.keyword(t);case 4:return this.quoted(t);case 5:return this.afterquote(t);case 3:return this.number(t);case-1:return}},Dh.prototype.afterquote=function(t){if('"'===t)return this.word+='"',void(this.state=4);if(Nh.test(t))return this.word=this.word.trim(),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in afterquote yet, index '+this.place)},Dh.prototype.afterItem=function(t){return","===t?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=Ah)):"]"===t?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=Ah,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},Dh.prototype.number=function(t){if(!Gh.test(t)){if(Nh.test(t))return this.word=parseFloat(this.word),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in number yet, index '+this.place)}this.word+=t},Dh.prototype.quoted=function(t){'"'!==t?this.word+=t:this.state=5},Dh.prototype.keyword=function(t){if(Fh.test(t))this.word+=t;else{if("["===t){var e=[];return e.push(this.word),this.level++,null===this.root?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,void(this.state=Ah)}if(!Nh.test(t))throw new Error("havn't handled \""+t+'" in keyword yet, index '+this.place);this.afterItem(t)}},Dh.prototype.neutral=function(t){if(Oh.test(t))return this.word=t,void(this.state=2);if('"'===t)return this.word="",void(this.state=4);if(Gh.test(t))return this.word=t,void(this.state=3);if(!Nh.test(t))throw new Error("havn't handled \""+t+'" in neutral yet, index '+this.place);this.afterItem(t)},Dh.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};var Yh=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function Xh(t){for(var e=Object.keys(t),i=0,n=e.length;i<n;++i){var a=e[i];-1!==Yh.indexOf(a)&&qh(t[a]),"object"==typeof t[a]&&Xh(t[a])}}function qh(t){if(t.AUTHORITY){var e=Object.keys(t.AUTHORITY)[0];e&&e in t.AUTHORITY&&(t.title=e+":"+t.AUTHORITY[e])}if("GEOGCS"===t.type?t.projName="longlat":"LOCAL_CS"===t.type?(t.projName="identity",t.local=!0):"object"==typeof t.PROJECTION?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.AXIS){for(var i="",n=0,a=t.AXIS.length;n<a;++n){var s=[t.AXIS[n][0].toLowerCase(),t.AXIS[n][1].toLowerCase()];-1!==s[0].indexOf("north")||("y"===s[0]||"lat"===s[0])&&"north"===s[1]?i+="n":-1!==s[0].indexOf("south")||("y"===s[0]||"lat"===s[0])&&"south"===s[1]?i+="s":-1!==s[0].indexOf("east")||("x"===s[0]||"lon"===s[0])&&"east"===s[1]?i+="e":-1===s[0].indexOf("west")&&("x"!==s[0]&&"lon"!==s[0]||"west"!==s[1])||(i+="w")}2===i.length&&(i+="u"),3===i.length&&(t.axis=i)}t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),"metre"===t.units&&(t.units="meter"),t.UNIT.convert&&("GEOGCS"===t.type?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var r=t.GEOGCS;function o(e){return e*(t.to_meter||1)}"GEOGCS"===t.type&&(r=t),r&&(r.DATUM?t.datumCode=r.DATUM.name.toLowerCase():t.datumCode=r.name.toLowerCase(),"d_"===t.datumCode.slice(0,2)&&(t.datumCode=t.datumCode.slice(2)),"new_zealand_1949"===t.datumCode&&(t.datumCode="nzgd49"),"wgs_1984"!==t.datumCode&&"world_geodetic_system_1984"!==t.datumCode||("Mercator_Auxiliary_Sphere"===t.PROJECTION&&(t.sphere=!0),t.datumCode="wgs84"),"belge_1972"===t.datumCode&&(t.datumCode="rnb72"),r.DATUM&&r.DATUM.SPHEROID&&(t.ellps=r.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===t.ellps.toLowerCase().slice(0,13)&&(t.ellps="intl"),t.a=r.DATUM.SPHEROID.a,t.rf=parseFloat(r.DATUM.SPHEROID.rf,10)),r.DATUM&&r.DATUM.TOWGS84&&(t.datum_params=r.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),"ch1903+"===t.datumCode&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a),t.rectified_grid_angle&&(t.rectified_grid_angle=Uh(t.rectified_grid_angle)),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Uh],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Uh],["x0","false_easting",o],["y0","false_northing",o],["long0","central_meridian",Uh],["lat0","latitude_of_origin",Uh],["lat0","standard_parallel_1",Uh],["lat1","standard_parallel_1",Uh],["lat2","standard_parallel_2",Uh],["azimuth","Azimuth"],["alpha","azimuth",Uh],["srsCode","name"]].forEach(function(e){return function(t,e){var i=e[0],n=e[1];!(i in t)&&n in t&&(t[i]=t[n],3===e.length&&(t[i]=e[2](t[i])))}(t,e)}),Bh(t)}function Zh(t){if("object"==typeof t)return $h(t);const e=function(t){const e=t.toUpperCase();return e.includes("PROJCRS")||e.includes("GEOGCRS")||e.includes("BOUNDCRS")||e.includes("VERTCRS")||e.includes("LENGTHUNIT")||e.includes("ANGLEUNIT")||e.includes("SCALEUNIT")?"WKT2":(e.includes("PROJCS")||e.includes("GEOGCS")||e.includes("LOCAL_CS")||e.includes("VERT_CS")||e.includes("UNIT"),"WKT1")}(t);var i=new Dh(t).output();if("WKT2"===e)return $h(function(t){const e=function(t){return t.find(t=>Array.isArray(t)&&"USAGE"===t[0])?"2019":(t.find(t=>Array.isArray(t)&&"CS"===t[0])||"BOUNDCRS"===t[0]||"PROJCRS"===t[0]||t[0],"2015")}(t);return("2019"===e?Ph:Ih).convert(t)}(i));var n=i[0],a={};return Hh(i,a),Xh(a),a[n]}function Jh(t){var e=this;if(2===arguments.length){var i=arguments[1];"string"==typeof i?"+"===i.charAt(0)?Jh[t]=Lh(arguments[1]):Jh[t]=Zh(arguments[1]):i&&"object"==typeof i&&!("projName"in i)?Jh[t]=Zh(arguments[1]):(Jh[t]=i,i||delete Jh[t])}else if(1===arguments.length){if(Array.isArray(t))return t.map(function(t){return Array.isArray(t)?Jh.apply(e,t):Jh(t)});if("string"==typeof t){if(t in Jh)return Jh[t]}else"EPSG"in t?Jh["EPSG:"+t.EPSG]=t:"ESRI"in t?Jh["ESRI:"+t.ESRI]=t:"IAU2000"in t?Jh["IAU2000:"+t.IAU2000]=t:console.log(t);return}}!function(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var e=1;e<=60;++e)t("EPSG:"+(32600+e),"+proj=utm +zone="+e+" +datum=WGS84 +units=m"),t("EPSG:"+(32700+e),"+proj=utm +zone="+e+" +south +datum=WGS84 +units=m");t("EPSG:5041","+title=WGS 84 / UPS North (E,N) +proj=stere +lat_0=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),t("EPSG:5042","+title=WGS 84 / UPS South (E,N) +proj=stere +lat_0=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}(Jh);const Qh=Jh;var tc=["3857","900913","3785","102113"];function ec(t,e){var i,n;if(t=t||{},!e)return t;for(n in e)void 0!==(i=e[n])&&(t[n]=i);return t}function ic(t,e,i){var n=t*e;return i/Math.sqrt(1-n*n)}function nc(t){return t<0?-1:1}function ac(t,e){return e||Math.abs(t)<=Eh?t:t-nc(t)*bh}function sc(t,e,i){var n=t*i,a=.5*t;return n=Math.pow((1-n)/(1+n),a),Math.tan(.5*(yh-e))/n}function rc(t,e){for(var i,n,a=.5*t,s=yh-2*Math.atan(e),r=0;r<=15;r++)if(i=t*Math.sin(s),s+=n=yh-2*Math.atan(e*Math.pow((1-i)/(1+i),a))-s,Math.abs(n)<=1e-10)return s;return-9999}function oc(t){return t}var lc=["longlat","identity"],uc=[{init:function(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=ic(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function(t){var e,i,n=t.x,a=t.y;if(a*xh>90&&a*xh<-90&&n*xh>180&&n*xh<-180)return null;if(Math.abs(Math.abs(a)-yh)<=kh)return null;if(this.sphere)e=this.x0+this.a*this.k0*ac(n-this.long0,this.over),i=this.y0+this.a*this.k0*Math.log(Math.tan(wh+.5*a));else{var s=Math.sin(a),r=sc(this.e,a,s);e=this.x0+this.a*this.k0*ac(n-this.long0,this.over),i=this.y0-this.a*this.k0*Math.log(r)}return t.x=e,t.y=i,t},inverse:function(t){var e,i,n=t.x-this.x0,a=t.y-this.y0;if(this.sphere)i=yh-2*Math.atan(Math.exp(-a/(this.a*this.k0)));else{var s=Math.exp(-a/(this.a*this.k0));if(-9999===(i=rc(this.e,s)))return null}return e=ac(this.long0+n/(this.a*this.k0),this.over),t.x=e,t.y=i,t},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"]},{init:function(){},forward:oc,inverse:oc,names:lc}],hc={},cc=[];function dc(t,e){var i=cc.length;return t.names?(cc[i]=t,t.names.forEach(function(t){hc[t.toLowerCase()]=i}),this):(console.log(e),!0)}function pc(t){return t.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}const mc={start:function(){uc.forEach(dc)},add:dc,get:function(t){if(!t)return!1;var e=t.toLowerCase();return void 0!==hc[e]&&cc[hc[e]]||(e=pc(e))in hc&&cc[hc[e]]?cc[hc[e]]:void 0}},fc={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:6378249.2,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}},gc=fc.WGS84;var _c={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var yc in _c){var kc=_c[yc];kc.datumName&&(_c[kc.datumName]=kc)}const vc=_c;var xc={};async function wc(t,e){for(var i=[],n=await e.getImageCount(),a=n-1;a>=0;a--){var s=await e.getImage(a),r=await s.readRasters(),o=[s.getWidth(),s.getHeight()],l=s.getBoundingBox().map(Ec),u=[s.fileDirectory.ModelPixelScale[0],s.fileDirectory.ModelPixelScale[1]].map(Ec),h=l[0]+(o[0]-1)*u[0],c=l[3]-(o[1]-1)*u[1],d=r[0],p=r[1],m=[];for(let t=o[1]-1;t>=0;t--)for(let e=o[0]-1;e>=0;e--){var f=t*o[0]+e;m.push([-Mc(p[f]),Mc(d[f])])}i.push({del:u,lim:o,ll:[-h,c],cvs:m})}var g={header:{nSubgrids:n},subgrids:i};return xc[t]=g,g}function bc(t){if(0===t.length)return null;var e="@"===t[0];return e&&(t=t.slice(1)),"null"===t?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:t,mandatory:!e,grid:xc[t]||null,isNull:!1}}function Ec(t){return t*Math.PI/180}function Mc(t){return t/3600*Math.PI/180}function Tc(t,e,i){return String.fromCharCode.apply(null,new Uint8Array(t.buffer.slice(e,i)))}function Sc(t){return t.map(function(t){return[Mc(t.longitudeShift),Mc(t.latitudeShift)]})}function Cc(t,e,i){return{name:Tc(t,e+8,e+16).trim(),parent:Tc(t,e+24,e+24+8).trim(),lowerLatitude:t.getFloat64(e+72,i),upperLatitude:t.getFloat64(e+88,i),lowerLongitude:t.getFloat64(e+104,i),upperLongitude:t.getFloat64(e+120,i),latitudeInterval:t.getFloat64(e+136,i),longitudeInterval:t.getFloat64(e+152,i),gridNodeCount:t.getInt32(e+168,i)}}function Lc(t,e,i,n,a){var s=e+176,r=16;!1===a&&(r=8);for(var o=[],l=0;l<i.gridNodeCount;l++){var u={latitudeShift:t.getFloat32(s+l*r,n),longitudeShift:t.getFloat32(s+l*r+4,n)};!1!==a&&(u.latitudeAccuracy=t.getFloat32(s+l*r+8,n),u.longitudeAccuracy=t.getFloat32(s+l*r+12,n)),o.push(u)}return o}function Rc(t,e){if(!(this instanceof Rc))return new Rc(t);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,e=e||function(t){if(t)throw t};var i=function(t){if(!function(t){return"string"==typeof t}(t))return"projName"in t?t:Zh(t);if(function(t){return t in Qh}(t))return Qh[t];if(function(t){return 0!==t.indexOf("+")&&-1!==t.indexOf("[")||"object"==typeof t&&!("srsCode"in t)}(t)){var e=Zh(t);if(function(t){var e=Ch(t,"authority");if(e){var i=Ch(e,"epsg");return i&&tc.indexOf(i)>-1}}(e))return Qh["EPSG:3857"];var i=function(t){var e=Ch(t,"extension");if(e)return Ch(e,"proj4")}(e);return i?Lh(i):e}return function(t){return"+"===t[0]}(t)?Lh(t):void 0}(t);if("object"==typeof i){var n=Rc.projections.get(i.projName);if(n){if(i.datumCode&&"none"!==i.datumCode){var a=Ch(vc,i.datumCode);a&&(i.datum_params=i.datum_params||(a.towgs84?a.towgs84.split(","):null),i.ellps=a.ellipse,i.datumName=a.datumName?a.datumName:i.datumCode)}i.k0=i.k0||1,i.axis=i.axis||"enu",i.ellps=i.ellps||"wgs84",i.lat1=i.lat1||i.lat0;var s=function(t,e,i,n,a){if(!t){var s=Ch(fc,n);s||(s=gc),t=s.a,e=s.b,i=s.rf}return i&&!e&&(e=(1-1/i)*t),(0===i||Math.abs(t-e)<kh)&&(a=!0,e=t),{a:t,b:e,rf:i,sphere:a}}(i.a,i.b,i.rf,i.ellps,i.sphere),r=function(t,e,i,n){var a=t*t,s=e*e,r=(a-s)/a,o=0;return n?(a=(t*=1-r*(.16666666666666666+r*(.04722222222222222+.022156084656084655*r)))*t,r=0):o=Math.sqrt(r),{es:r,e:o,ep2:(a-s)/s}}(s.a,s.b,s.rf,i.R_A),o=function(t){return void 0===t?null:t.split(",").map(bc)}(i.nadgrids),l=i.datum||function(t,e,i,n,a,s,r){var o={};return o.datum_type=void 0===t||"none"===t?5:4,e&&(o.datum_params=e.map(parseFloat),0===o.datum_params[0]&&0===o.datum_params[1]&&0===o.datum_params[2]||(o.datum_type=1),o.datum_params.length>3&&(0===o.datum_params[3]&&0===o.datum_params[4]&&0===o.datum_params[5]&&0===o.datum_params[6]||(o.datum_type=2,o.datum_params[3]*=_h,o.datum_params[4]*=_h,o.datum_params[5]*=_h,o.datum_params[6]=o.datum_params[6]/1e6+1))),r&&(o.datum_type=3,o.grids=r),o.a=i,o.b=n,o.es=a,o.ep2=s,o}(i.datumCode,i.datum_params,s.a,s.b,r.es,r.ep2,o);ec(this,i),ec(this,n),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=r.es,this.e=r.e,this.ep2=r.ep2,this.datum=l,"init"in this&&"function"==typeof this.init&&this.init(),e(null,this)}else e("Could not get projection name from: "+t)}else e("Could not parse to valid json: "+t)}Rc.projections=mc,Rc.projections.start();const Ic=Rc;function Pc(t,e,i){var n,a,s,r,o=t.x,l=t.y,u=t.z?t.z:0;if(l<-yh&&l>-1.001*yh)l=-yh;else if(l>yh&&l<1.001*yh)l=yh;else{if(l<-yh)return{x:-1/0,y:-1/0,z:t.z};if(l>yh)return{x:1/0,y:1/0,z:t.z}}return o>Math.PI&&(o-=2*Math.PI),a=Math.sin(l),r=Math.cos(l),s=a*a,{x:((n=i/Math.sqrt(1-e*s))+u)*r*Math.cos(o),y:(n+u)*r*Math.sin(o),z:(n*(1-e)+u)*a}}function Ac(t,e,i,n){var a,s,r,o,l,u,h,c,d,p,m,f,g,_,y,k=t.x,v=t.y,x=t.z?t.z:0;if(a=Math.sqrt(k*k+v*v),s=Math.sqrt(k*k+v*v+x*x),a/i<1e-12){if(_=0,s/i<1e-12)return y=-n,{x:t.x,y:t.y,z:t.z}}else _=Math.atan2(v,k);r=x/s,c=(o=a/s)*(1-e)*(l=1/Math.sqrt(1-e*(2-e)*o*o)),d=r*l,g=0;do{g++,u=e*(h=i/Math.sqrt(1-e*d*d))/(h+(y=a*c+x*d-h*(1-e*d*d))),f=(m=r*(l=1/Math.sqrt(1-u*(2-u)*o*o)))*c-(p=o*(1-u)*l)*d,c=p,d=m}while(f*f>1e-24&&g<30);return{x:_,y:Math.atan(m/Math.abs(p)),z:y}}function jc(t){return 1===t||2===t}function Oc(t,e,i){if(null===t.grids||0===t.grids.length)return console.log("Grid shift grids not found"),-1;var n={x:-i.x,y:i.y},a={x:Number.NaN,y:Number.NaN},s=[];t:for(var r=0;r<t.grids.length;r++){var o=t.grids[r];if(s.push(o.name),o.isNull){a=n;break}if(null!==o.grid)for(var l=o.grid.subgrids,u=0,h=l.length;u<h;u++){var c=l[u],d=(Math.abs(c.del[1])+Math.abs(c.del[0]))/1e4,p=c.ll[0]-d,m=c.ll[1]-d,f=c.ll[0]+(c.lim[0]-1)*c.del[0]+d,g=c.ll[1]+(c.lim[1]-1)*c.del[1]+d;if(!(m>n.y||p>n.x||g<n.y||f<n.x||(a=Fc(n,e,c),isNaN(a.x))))break t}else if(o.mandatory)return console.log("Unable to find mandatory grid '"+o.name+"'"),-1}return isNaN(a.x)?(console.log("Failed to find a grid shift table for location '"+-n.x*xh+" "+n.y*xh+" tried: '"+s+"'"),-1):(i.x=-a.x,i.y=a.y,0)}function Fc(t,e,i){var n={x:Number.NaN,y:Number.NaN};if(isNaN(t.x))return n;var a={x:t.x,y:t.y};a.x-=i.ll[0],a.y-=i.ll[1],a.x=ac(a.x-Math.PI)+Math.PI;var s=Nc(a,i);if(e){if(isNaN(s.x))return n;s.x=a.x-s.x,s.y=a.y-s.y;var r,o,l=9;do{if(o=Nc(s,i),isNaN(o.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}r={x:a.x-(o.x+s.x),y:a.y-(o.y+s.y)},s.x+=r.x,s.y+=r.y}while(l--&&Math.abs(r.x)>1e-12&&Math.abs(r.y)>1e-12);if(l<0)return console.log("Inverse grid shift iterator failed to converge."),n;n.x=ac(s.x+i.ll[0]),n.y=s.y+i.ll[1]}else isNaN(s.x)||(n.x=t.x+s.x,n.y=t.y+s.y);return n}function Nc(t,e){var i,n={x:t.x/e.del[0],y:t.y/e.del[1]},a=Math.floor(n.x),s=Math.floor(n.y),r=n.x-1*a,o=n.y-1*s,l={x:Number.NaN,y:Number.NaN};if(a<0||a>=e.lim[0])return l;if(s<0||s>=e.lim[1])return l;i=s*e.lim[0]+a;var u=e.cvs[i][0],h=e.cvs[i][1];i++;var c=e.cvs[i][0],d=e.cvs[i][1];i+=e.lim[0];var p=e.cvs[i][0],m=e.cvs[i][1];i--;var f=e.cvs[i][0],g=e.cvs[i][1],_=r*o,y=r*(1-o),k=(1-r)*(1-o),v=(1-r)*o;return l.x=k*u+y*c+v*f+_*p,l.y=k*h+y*d+v*g+_*m,l}function Gc(t,e,i){var n,a,s,r=i.x,o=i.y,l=i.z||0,u={};for(s=0;s<3;s++)if(!e||2!==s||void 0!==i.z)switch(0===s?(n=r,a=-1!=="ew".indexOf(t.axis[s])?"x":"y"):1===s?(n=o,a=-1!=="ns".indexOf(t.axis[s])?"y":"x"):(n=l,a="z"),t.axis[s]){case"e":case"n":u[a]=n;break;case"w":case"s":u[a]=-n;break;case"u":void 0!==i[a]&&(u.z=n);break;case"d":void 0!==i[a]&&(u.z=-n);break;default:return null}return u}function Dc(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e}function Wc(t){if("function"==typeof Number.isFinite){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof t||t!=t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function Hc(t,e,i,n){var a,s=void 0!==(i=Array.isArray(i)?Dc(i):{x:i.x,y:i.y,z:i.z,m:i.m}).z;if(function(t){Wc(t.x),Wc(t.y)}(i),t.datum&&e.datum&&function(t,e){return(1===t.datum.datum_type||2===t.datum.datum_type||3===t.datum.datum_type)&&"WGS84"!==e.datumCode||(1===e.datum.datum_type||2===e.datum.datum_type||3===e.datum.datum_type)&&"WGS84"!==t.datumCode}(t,e)&&(i=Hc(t,a=new Ic("WGS84"),i,n),t=a),n&&"enu"!==t.axis&&(i=Gc(t,!1,i)),"longlat"===t.projName)i={x:i.x*vh,y:i.y*vh,z:i.z||0};else if(t.to_meter&&(i={x:i.x*t.to_meter,y:i.y*t.to_meter,z:i.z||0}),!(i=t.inverse(i)))return;if(t.from_greenwich&&(i.x+=t.from_greenwich),i=function(t,e,i){if(function(t,e){return t.datum_type===e.datum_type&&!(t.a!==e.a||Math.abs(t.es-e.es)>5e-11)&&(1===t.datum_type?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]:2!==t.datum_type||t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]&&t.datum_params[3]===e.datum_params[3]&&t.datum_params[4]===e.datum_params[4]&&t.datum_params[5]===e.datum_params[5]&&t.datum_params[6]===e.datum_params[6])}(t,e))return i;if(5===t.datum_type||5===e.datum_type)return i;var n=t.a,a=t.es;if(3===t.datum_type){if(0!==Oc(t,!1,i))return;n=fh,a=gh}var s=e.a,r=e.b,o=e.es;return 3===e.datum_type&&(s=fh,r=6356752.314,o=gh),a!==o||n!==s||jc(t.datum_type)||jc(e.datum_type)?(i=Pc(i,a,n),jc(t.datum_type)&&(i=function(t,e,i){if(1===e)return{x:t.x+i[0],y:t.y+i[1],z:t.z+i[2]};if(2===e){var n=i[0],a=i[1],s=i[2],r=i[3],o=i[4],l=i[5],u=i[6];return{x:u*(t.x-l*t.y+o*t.z)+n,y:u*(l*t.x+t.y-r*t.z)+a,z:u*(-o*t.x+r*t.y+t.z)+s}}}(i,t.datum_type,t.datum_params)),jc(e.datum_type)&&(i=function(t,e,i){if(1===e)return{x:t.x-i[0],y:t.y-i[1],z:t.z-i[2]};if(2===e){var n=i[0],a=i[1],s=i[2],r=i[3],o=i[4],l=i[5],u=i[6],h=(t.x-n)/u,c=(t.y-a)/u,d=(t.z-s)/u;return{x:h+l*c-o*d,y:-l*h+c+r*d,z:o*h-r*c+d}}}(i,e.datum_type,e.datum_params)),i=Ac(i,o,s,r),3!==e.datum_type||0===Oc(e,!0,i)?i:void 0):i}(t.datum,e.datum,i))return e.from_greenwich&&(i={x:i.x-e.from_greenwich,y:i.y,z:i.z||0}),"longlat"===e.projName?i={x:i.x*xh,y:i.y*xh,z:i.z||0}:(i=e.forward(i),e.to_meter&&(i={x:i.x/e.to_meter,y:i.y/e.to_meter,z:i.z||0})),n&&"enu"!==e.axis?Gc(e,!0,i):(i&&!s&&delete i.z,i)}var Uc=Ic("WGS84");function Bc(t,e,i,n){var a,s,r;return Array.isArray(i)?(a=Hc(t,e,i,n)||{x:NaN,y:NaN},i.length>2?void 0!==t.name&&"geocent"===t.name||void 0!==e.name&&"geocent"===e.name?"number"==typeof a.z?[a.x,a.y,a.z].concat(i.slice(3)):[a.x,a.y,i[2]].concat(i.slice(3)):[a.x,a.y].concat(i.slice(2)):[a.x,a.y]):(s=Hc(t,e,i,n),2===(r=Object.keys(i)).length||r.forEach(function(n){if(void 0!==t.name&&"geocent"===t.name||void 0!==e.name&&"geocent"===e.name){if("x"===n||"y"===n||"z"===n)return}else if("x"===n||"y"===n)return;s[n]=i[n]}),s)}function Vc(t){return t instanceof Ic?t:"object"==typeof t&&"oProj"in t?t.oProj:Ic(t)}var Kc="AJSAJS",zc="AFAFAF",$c=65,Yc=73,Xc=79;const qc={forward:Zc,inverse:function(t){var e=ed(nd(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]},toPoint:Jc};function Zc(t,e){return e=e||5,function(t,e){var i,n,a,s,r,o,l,u,h,c,d,p="00000"+t.easting,m="00000"+t.northing;return t.zoneNumber+t.zoneLetter+(h=t.easting,c=t.northing,d=id(t.zoneNumber),i=Math.floor(h/1e5),n=Math.floor(c/1e5)%20,s=Kc.charCodeAt(a=d-1),r=zc.charCodeAt(a),u=!1,(o=s+i-1)>90&&(o=o-90+$c-1,u=!0),(o===Yc||s<Yc&&o>Yc||(o>Yc||s<Yc)&&u)&&o++,(o===Xc||s<Xc&&o>Xc||(o>Xc||s<Xc)&&u)&&++o===Yc&&o++,o>90&&(o=o-90+$c-1),(l=r+n)>86?(l=l-86+$c-1,u=!0):u=!1,(l===Yc||r<Yc&&l>Yc||(l>Yc||r<Yc)&&u)&&l++,(l===Xc||r<Xc&&l>Xc||(l>Xc||r<Xc)&&u)&&++l===Yc&&l++,l>86&&(l=l-86+$c-1),String.fromCharCode(o)+String.fromCharCode(l))+p.substr(p.length-5,e)+m.substr(m.length-5,e)}(function(t){var e,i,n,a,s,r,o,l=t.lat,u=t.lon,h=6378137,c=.00669438,d=.9996,p=Qc(l),m=Qc(u);o=Math.floor((u+180)/6)+1,180===u&&(o=60),l>=56&&l<64&&u>=3&&u<12&&(o=32),l>=72&&l<84&&(u>=0&&u<9?o=31:u>=9&&u<21?o=33:u>=21&&u<33?o=35:u>=33&&u<42&&(o=37)),r=Qc(6*(o-1)-180+3),e=.006739496752268451,i=h/Math.sqrt(1-c*Math.sin(p)*Math.sin(p)),n=Math.tan(p)*Math.tan(p),a=e*Math.cos(p)*Math.cos(p);var f,g,_=d*i*((s=Math.cos(p)*(m-r))+(1-n+a)*s*s*s/6+(5-18*n+n*n+72*a-58*e)*s*s*s*s*s/120)+5e5,y=d*(h*(.9983242984503243*p-.002514607064228144*Math.sin(2*p)+2639046602129982e-21*Math.sin(4*p)-3.418046101696858e-9*Math.sin(6*p))+i*Math.tan(p)*(s*s/2+(5-n+9*a+4*a*a)*s*s*s*s/24+(61-58*n+n*n+600*a-2.2240339282485886)*s*s*s*s*s*s/720));return l<0&&(y+=1e7),{northing:Math.round(y),easting:Math.round(_),zoneNumber:o,zoneLetter:(f=l,g="Z",84>=f&&f>=72?g="X":72>f&&f>=64?g="W":64>f&&f>=56?g="V":56>f&&f>=48?g="U":48>f&&f>=40?g="T":40>f&&f>=32?g="S":32>f&&f>=24?g="R":24>f&&f>=16?g="Q":16>f&&f>=8?g="P":8>f&&f>=0?g="N":0>f&&f>=-8?g="M":-8>f&&f>=-16?g="L":-16>f&&f>=-24?g="K":-24>f&&f>=-32?g="J":-32>f&&f>=-40?g="H":-40>f&&f>=-48?g="G":-48>f&&f>=-56?g="F":-56>f&&f>=-64?g="E":-64>f&&f>=-72?g="D":-72>f&&f>=-80&&(g="C"),g)}}({lat:t[1],lon:t[0]}),e)}function Jc(t){var e=ed(nd(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function Qc(t){return t*(Math.PI/180)}function td(t){return t/Math.PI*180}function ed(t){var e=t.northing,i=t.easting,n=t.zoneLetter,a=t.zoneNumber;if(a<0||a>60)return null;var s,r,o,l,u,h,c,d,p,m=.9996,f=6378137,g=.00669438,_=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),y=i-5e5,k=e;n<"N"&&(k-=1e7),c=6*(a-1)-180+3,s=.006739496752268451,p=(d=k/m/6367449.145945056)+(3*_/2-27*_*_*_/32)*Math.sin(2*d)+(21*_*_/16-55*_*_*_*_/32)*Math.sin(4*d)+151*_*_*_/96*Math.sin(6*d),r=f/Math.sqrt(1-g*Math.sin(p)*Math.sin(p)),o=Math.tan(p)*Math.tan(p),l=s*Math.cos(p)*Math.cos(p),u=.99330562*f/Math.pow(1-g*Math.sin(p)*Math.sin(p),1.5),h=y/(r*m);var v=p-r*Math.tan(p)/u*(h*h/2-(5+3*o+10*l-4*l*l-9*s)*h*h*h*h/24+(61+90*o+298*l+45*o*o-1.6983531815716497-3*l*l)*h*h*h*h*h*h/720);v=td(v);var x,w=(h-(1+2*o+l)*h*h*h/6+(5-2*l+28*o-3*l*l+8*s+24*o*o)*h*h*h*h*h/120)/Math.cos(p);if(w=c+td(w),t.accuracy){var b=ed({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});x={top:b.lat,right:b.lon,bottom:v,left:w}}else x={lat:v,lon:w};return x}function id(t){var e=t%6;return 0===e&&(e=6),e}function nd(t){if(t&&0===t.length)throw"MGRSPoint coverting from nothing";for(var e,i=t.length,n=null,a="",s=0;!/[A-Z]/.test(e=t.charAt(s));){if(s>=2)throw"MGRSPoint bad conversion from: "+t;a+=e,s++}var r=parseInt(a,10);if(0===s||s+3>i)throw"MGRSPoint bad conversion from: "+t;var o=t.charAt(s++);if(o<="A"||"B"===o||"Y"===o||o>="Z"||"I"===o||"O"===o)throw"MGRSPoint zone letter "+o+" not handled: "+t;n=t.substring(s,s+=2);for(var l=id(r),u=function(t,e){for(var i=Kc.charCodeAt(e-1),n=1e5,a=!1;i!==t.charCodeAt(0);){if(++i===Yc&&i++,i===Xc&&i++,i>90){if(a)throw"Bad character: "+t;i=$c,a=!0}n+=1e5}return n}(n.charAt(0),l),h=function(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;for(var i=zc.charCodeAt(e-1),n=0,a=!1;i!==t.charCodeAt(0);){if(++i===Yc&&i++,i===Xc&&i++,i>86){if(a)throw"Bad character: "+t;i=$c,a=!0}n+=1e5}return n}(n.charAt(1),l);h<ad(o);)h+=2e6;var c=i-s;if(c%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+t;var d,p,m,f=c/2,g=0,_=0;return f>0&&(d=1e5/Math.pow(10,f),p=t.substring(s,s+f),g=parseFloat(p)*d,m=t.substring(s+f),_=parseFloat(m)*d),{easting:g+u,northing:_+h,zoneLetter:o,zoneNumber:r,accuracy:d}}function ad(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}function sd(t,e,i){if(!(this instanceof sd))return new sd(t,e,i);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if("object"==typeof t)this.x=t.x,this.y=t.y,this.z=t.z||0;else if("string"==typeof t&&void 0===e){var n=t.split(",");this.x=parseFloat(n[0]),this.y=parseFloat(n[1]),this.z=parseFloat(n[2])||0}else this.x=t,this.y=e,this.z=i||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}sd.fromMGRS=function(t){return new sd(Jc(t))},sd.prototype.toMGRS=function(t){return Zc([this.x,this.y],t)};const rd=sd;var od=.046875,ld=.01953125,ud=.01068115234375;function hd(t){var e=[];e[0]=1-t*(.25+t*(od+t*(ld+t*ud))),e[1]=t*(.75-t*(od+t*(ld+t*ud)));var i=t*t;return e[2]=i*(.46875-t*(.013020833333333334+.007120768229166667*t)),i*=t,e[3]=i*(.3645833333333333-.005696614583333333*t),e[4]=i*t*.3076171875,e}function cd(t,e,i,n){return i*=e,e*=e,n[0]*t-i*(n[1]+e*(n[2]+e*(n[3]+e*n[4])))}function dd(t,e,i){for(var n=1/(1-e),a=t,s=20;s;--s){var r=Math.sin(a),o=1-e*r*r;if(a-=o=(cd(a,r,Math.cos(a),i)-t)*(o*Math.sqrt(o))*n,Math.abs(o)<kh)return a}return a}const pd={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=hd(this.es),this.ml0=cd(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(t){var e,i,n,a=t.x,s=t.y,r=ac(a-this.long0,this.over),o=Math.sin(s),l=Math.cos(s);if(this.es){var u=l*r,h=Math.pow(u,2),c=this.ep2*Math.pow(l,2),d=Math.pow(c,2),p=Math.abs(l)>kh?Math.tan(s):0,m=Math.pow(p,2),f=Math.pow(m,2);e=1-this.es*Math.pow(o,2),u/=Math.sqrt(e);var g=cd(s,o,l,this.en);i=this.a*(this.k0*u*(1+h/6*(1-m+c+h/20*(5-18*m+f+14*c-58*m*c+h/42*(61+179*f-f*m-479*m)))))+this.x0,n=this.a*(this.k0*(g-this.ml0+o*r*u/2*(1+h/12*(5-m+9*c+4*d+h/30*(61+f-58*m+270*c-330*m*c+h/56*(1385+543*f-f*m-3111*m))))))+this.y0}else{var _=l*Math.sin(r);if(Math.abs(Math.abs(_)-1)<kh)return 93;if(i=.5*this.a*this.k0*Math.log((1+_)/(1-_))+this.x0,n=l*Math.cos(r)/Math.sqrt(1-Math.pow(_,2)),(_=Math.abs(n))>=1){if(_-1>kh)return 93;n=0}else n=Math.acos(n);s<0&&(n=-n),n=this.a*this.k0*(n-this.lat0)+this.y0}return t.x=i,t.y=n,t},inverse:function(t){var e,i,n,a,s=(t.x-this.x0)*(1/this.a),r=(t.y-this.y0)*(1/this.a);if(this.es)if(i=dd(e=this.ml0+r/this.k0,this.es,this.en),Math.abs(i)<yh){var o=Math.sin(i),l=Math.cos(i),u=Math.abs(l)>kh?Math.tan(i):0,h=this.ep2*Math.pow(l,2),c=Math.pow(h,2),d=Math.pow(u,2),p=Math.pow(d,2);e=1-this.es*Math.pow(o,2);var m=s*Math.sqrt(e)/this.k0,f=Math.pow(m,2);n=i-(e*=u)*f/(1-this.es)*.5*(1-f/12*(5+3*d-9*h*d+h-4*c-f/30*(61+90*d-252*h*d+45*p+46*h-f/56*(1385+3633*d+4095*p+1574*p*d)))),a=ac(this.long0+m*(1-f/6*(1+2*d+h-f/20*(5+28*d+24*p+8*h*d+6*h-f/42*(61+662*d+1320*p+720*p*d))))/l,this.over)}else n=yh*nc(r),a=0;else{var g=Math.exp(s/this.k0),_=.5*(g-1/g),y=this.lat0+r/this.k0,k=Math.cos(y);e=Math.sqrt((1-Math.pow(k,2))/(1+Math.pow(_,2))),n=Math.asin(e),r<0&&(n=-n),a=0===_&&0===k?0:ac(Math.atan2(_,k)+this.long0,this.over)}return t.x=a,t.y=n,t},names:["Fast_Transverse_Mercator","Fast Transverse Mercator"]};function md(t){var e=Math.exp(t);return(e-1/e)/2}function fd(t,e){t=Math.abs(t),e=Math.abs(e);var i=Math.max(t,e),n=Math.min(t,e)/(i||1);return i*Math.sqrt(1+Math.pow(n,2))}function gd(t,e){for(var i,n=2*Math.cos(2*e),a=t.length-1,s=t[a],r=0;--a>=0;)i=n*s-r+t[a],r=s,s=i;return e+i*Math.sin(2*e)}function _d(t,e,i){for(var n,a,s=Math.sin(e),r=Math.cos(e),o=md(i),l=function(t){var e=Math.exp(t);return(e+1/e)/2}(i),u=2*r*l,h=-2*s*o,c=t.length-1,d=t[c],p=0,m=0,f=0;--c>=0;)n=m,a=p,d=u*(m=d)-n-h*(p=f)+t[c],f=h*m-a+u*p;return[(u=s*l)*d-(h=r*o)*f,u*f+h*d]}const yd={init:function(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(pd.init.apply(this),this.forward=pd.forward,this.inverse=pd.inverse),this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),i=e;this.cgb[0]=e*(2+e*(-2/3+e*(e*(116/45+e*(26/45+e*(-2854/675)))-2))),this.cbg[0]=e*(e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))-2),i*=e,this.cgb[1]=i*(7/3+e*(e*(-227/45+e*(2704/315+e*(2323/945)))-1.6)),this.cbg[1]=i*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),i*=e,this.cgb[2]=i*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=i*(-26/15+e*(34/21+e*(1.6+e*(-12686/2835)))),i*=e,this.cgb[3]=i*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=i*(1237/630+e*(e*(-24832/14175)-2.4)),i*=e,this.cgb[4]=i*(4174/315+e*(-144838/6237)),this.cbg[4]=i*(-734/315+e*(109598/31185)),i*=e,this.cgb[5]=i*(601676/22275),this.cbg[5]=i*(444337/155925),i=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+i*(1/4+i*(1/64+i/256))),this.utg[0]=e*(e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))-.5),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=i*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=i*(13/48+e*(e*(557/1440+e*(281/630+e*(-1983433/1935360)))-.6)),i*=e,this.utg[2]=i*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=i*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),i*=e,this.utg[3]=i*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=i*(49561/161280+e*(-179/168+e*(6601661/7257600))),i*=e,this.utg[4]=i*(-4583/161280+e*(108847/3991680)),this.gtu[4]=i*(34729/80640+e*(-3418889/1995840)),i*=e,this.utg[5]=i*(-20648693/638668800),this.gtu[5]=.6650675310896665*i;var n=gd(this.cbg,this.lat0);this.Zb=-this.Qn*(n+function(t,e){for(var i,n=2*Math.cos(e),a=t.length-1,s=t[a],r=0;--a>=0;)i=n*s-r+t[a],r=s,s=i;return Math.sin(e)*i}(this.gtu,2*n))},forward:function(t){var e=ac(t.x-this.long0,this.over),i=t.y;i=gd(this.cbg,i);var n=Math.sin(i),a=Math.cos(i),s=Math.sin(e),r=Math.cos(e);i=Math.atan2(n,r*a),e=Math.atan2(s*a,fd(n,a*r)),e=function(t){var e=Math.abs(t);return e=function(t){var e=1+t,i=e-1;return 0===i?t:t*Math.log(e)/i}(e*(1+e/(fd(1,e)+1))),t<0?-e:e}(Math.tan(e));var o,l,u=_d(this.gtu,2*i,2*e);return i+=u[0],e+=u[1],Math.abs(e)<=2.623395162778?(o=this.a*(this.Qn*e)+this.x0,l=this.a*(this.Qn*i+this.Zb)+this.y0):(o=1/0,l=1/0),t.x=o,t.y=l,t},inverse:function(t){var e,i,n=(t.x-this.x0)*(1/this.a),a=(t.y-this.y0)*(1/this.a);if(a=(a-this.Zb)/this.Qn,n/=this.Qn,Math.abs(n)<=2.623395162778){var s=_d(this.utg,2*a,2*n);a+=s[0],n+=s[1],n=Math.atan(md(n));var r=Math.sin(a),o=Math.cos(a),l=Math.sin(n),u=Math.cos(n);a=Math.atan2(r*u,fd(l,u*o)),e=ac((n=Math.atan2(l,u*o))+this.long0,this.over),i=gd(this.cgb,a)}else e=1/0,i=1/0;return t.x=e,t.y=i,t},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"]},kd={init:function(){var t=function(t,e){if(void 0===t){if((t=Math.floor(30*(ac(e)+Math.PI)/Math.PI)+1)<0)return 0;if(t>60)return 60}return t}(this.zone,this.long0);if(void 0===t)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*vh,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,yd.init.apply(this),this.forward=yd.forward,this.inverse=yd.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"};function vd(t,e){return Math.pow((1-t)/(1+t),e)}const xd={init:function(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+wh)/(Math.pow(Math.tan(.5*this.lat0+wh),this.C)*vd(this.e*t,this.ratexp))},forward:function(t){var e=t.x,i=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*i+wh),this.C)*vd(this.e*Math.sin(i),this.ratexp))-yh,t.x=this.C*e,t},inverse:function(t){for(var e=t.x/this.C,i=t.y,n=Math.pow(Math.tan(.5*i+wh)/this.K,1/this.C),a=20;a>0&&(i=2*Math.atan(n*vd(this.e*Math.sin(t.y),-.5*this.e))-yh,!(Math.abs(i-t.y)<1e-14));--a)t.y=i;return a?(t.x=e,t.y=i,t):null},names:["gauss"]},wd={init:function(){xd.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(t){var e,i,n,a;return t.x=ac(t.x-this.long0,this.over),xd.forward.apply(this,[t]),e=Math.sin(t.y),i=Math.cos(t.y),n=Math.cos(t.x),a=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*i*n),t.x=a*i*Math.sin(t.x),t.y=a*(this.cosc0*e-this.sinc0*i*n),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},inverse:function(t){var e,i,n,a,s;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,s=fd(t.x,t.y)){var r=2*Math.atan2(s,this.R2);e=Math.sin(r),i=Math.cos(r),a=Math.asin(i*this.sinc0+t.y*e*this.cosc0/s),n=Math.atan2(t.x*e,s*this.cosc0*i-t.y*this.sinc0*e)}else a=this.phic0,n=0;return t.x=n,t.y=a,xd.inverse.apply(this,[t]),t.x=ac(t.x+this.long0,this.over),t},names:["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]};function bd(t,e,i){return e*=i,Math.tan(.5*(yh+t))*Math.pow((1-e)/(1+e),.5*i)}const Ed={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=kh&&(this.k0=.5*(1+nc(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=kh&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=kh&&Math.abs(Math.cos(this.lat_ts))>kh&&(this.k0=.5*this.cons*ic(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/sc(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=ic(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(bd(this.lat0,this.sinlat0,this.e))-yh,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(t){var e,i,n,a,s,r,o=t.x,l=t.y,u=Math.sin(l),h=Math.cos(l),c=ac(o-this.long0,this.over);return Math.abs(Math.abs(o-this.long0)-Math.PI)<=kh&&Math.abs(l+this.lat0)<=kh?(t.x=NaN,t.y=NaN,t):this.sphere?(e=2*this.k0/(1+this.sinlat0*u+this.coslat0*h*Math.cos(c)),t.x=this.a*e*h*Math.sin(c)+this.x0,t.y=this.a*e*(this.coslat0*u-this.sinlat0*h*Math.cos(c))+this.y0,t):(i=2*Math.atan(bd(l,u,this.e))-yh,a=Math.cos(i),n=Math.sin(i),Math.abs(this.coslat0)<=kh?(s=sc(this.e,l*this.con,this.con*u),r=2*this.a*this.k0*s/this.cons,t.x=this.x0+r*Math.sin(o-this.long0),t.y=this.y0-this.con*r*Math.cos(o-this.long0),t):(Math.abs(this.sinlat0)<kh?(e=2*this.a*this.k0/(1+a*Math.cos(c)),t.y=e*n):(e=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*n+this.cosX0*a*Math.cos(c))),t.y=e*(this.cosX0*n-this.sinX0*a*Math.cos(c))+this.y0),t.x=e*a*Math.sin(c)+this.x0,t))},inverse:function(t){var e,i,n,a,s;t.x-=this.x0,t.y-=this.y0;var r=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var o=2*Math.atan(r/(2*this.a*this.k0));return e=this.long0,i=this.lat0,r<=kh?(t.x=e,t.y=i,t):(i=Math.asin(Math.cos(o)*this.sinlat0+t.y*Math.sin(o)*this.coslat0/r),e=Math.abs(this.coslat0)<kh?this.lat0>0?ac(this.long0+Math.atan2(t.x,-1*t.y),this.over):ac(this.long0+Math.atan2(t.x,t.y),this.over):ac(this.long0+Math.atan2(t.x*Math.sin(o),r*this.coslat0*Math.cos(o)-t.y*this.sinlat0*Math.sin(o)),this.over),t.x=e,t.y=i,t)}if(Math.abs(this.coslat0)<=kh){if(r<=kh)return i=this.lat0,e=this.long0,t.x=e,t.y=i,t;t.x*=this.con,t.y*=this.con,n=r*this.cons/(2*this.a*this.k0),i=this.con*rc(this.e,n),e=this.con*ac(this.con*this.long0+Math.atan2(t.x,-1*t.y),this.over)}else a=2*Math.atan(r*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,r<=kh?s=this.X0:(s=Math.asin(Math.cos(a)*this.sinX0+t.y*Math.sin(a)*this.cosX0/r),e=ac(this.long0+Math.atan2(t.x*Math.sin(a),r*this.cosX0*Math.cos(a)-t.y*this.sinX0*Math.sin(a)),this.over)),i=-1*rc(this.e,Math.tan(.5*(yh+s)));return t.x=e,t.y=i,t},names:["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"],ssfn_:bd},Md={init:function(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),i=this.a,n=1/this.rf,a=2*n-Math.pow(n,2),s=this.e=Math.sqrt(a);this.R=this.k0*i*Math.sqrt(1-a)/(1-a*Math.pow(e,2)),this.alpha=Math.sqrt(1+a/(1-a)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var r=Math.log(Math.tan(Math.PI/4+this.b0/2)),o=Math.log(Math.tan(Math.PI/4+t/2)),l=Math.log((1+s*e)/(1-s*e));this.K=r-this.alpha*o+this.alpha*s/2*l},forward:function(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),i=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),n=-this.alpha*(e+i)+this.K,a=2*(Math.atan(Math.exp(n))-Math.PI/4),s=this.alpha*(t.x-this.lambda0),r=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(a)+Math.cos(this.b0)*Math.cos(s))),o=Math.asin(Math.cos(this.b0)*Math.sin(a)-Math.sin(this.b0)*Math.cos(a)*Math.cos(s));return t.y=this.R/2*Math.log((1+Math.sin(o))/(1-Math.sin(o)))+this.y0,t.x=this.R*r+this.x0,t},inverse:function(t){for(var e=t.x-this.x0,i=t.y-this.y0,n=e/this.R,a=2*(Math.atan(Math.exp(i/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(a)+Math.sin(this.b0)*Math.cos(a)*Math.cos(n)),r=Math.atan(Math.sin(n)/(Math.cos(this.b0)*Math.cos(n)-Math.sin(this.b0)*Math.tan(a))),o=this.lambda0+r/this.alpha,l=0,u=s,h=-1e3,c=0;Math.abs(u-h)>1e-7;){if(++c>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(u))/2)),h=u,u=2*Math.atan(Math.exp(l))-Math.PI/2}return t.x=o,t.y=u,t},names:["somerc"]};var Td=1e-7;const Sd={init:function(){var t,e,i,n,a,s,r,o,l,u,h,c,d,p,m=0,f=0,g=0,_=0,y=0,k=0,v=0;this.no_off=(d=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],p="object"==typeof(c=this).projName?Object.keys(c.projName)[0]:c.projName,"no_uoff"in c||"no_off"in c||-1!==d.indexOf(p)||-1!==d.indexOf(pc(p))),this.no_rot="no_rot"in this;var x=!1;"alpha"in this&&(x=!0);var w=!1;if("rectified_grid_angle"in this&&(w=!0),x&&(v=this.alpha),w&&(m=this.rectified_grid_angle),x||w)f=this.longc;else if(g=this.long1,y=this.lat1,_=this.long2,k=this.lat2,Math.abs(y-k)<=Td||(t=Math.abs(y))<=Td||Math.abs(t-yh)<=Td||Math.abs(Math.abs(this.lat0)-yh)<=Td||Math.abs(Math.abs(k)-yh)<=Td)throw new Error;var b=1-this.es;e=Math.sqrt(b),Math.abs(this.lat0)>kh?(o=Math.sin(this.lat0),i=Math.cos(this.lat0),t=1-this.es*o*o,this.B=i*i,this.B=Math.sqrt(1+this.es*this.B*this.B/b),this.A=this.B*this.k0*e/t,(a=(n=this.B*e/(i*Math.sqrt(t)))*n-1)<=0?a=0:(a=Math.sqrt(a),this.lat0<0&&(a=-a)),this.E=a+=n,this.E*=Math.pow(sc(this.e,this.lat0,o),this.B)):(this.B=1/e,this.A=this.k0,this.E=n=a=1),x||w?(x?(h=Math.asin(Math.sin(v)/n),w||(m=v)):(h=m,v=Math.asin(n*Math.sin(h))),this.lam0=f-Math.asin(.5*(a-1/a)*Math.tan(h))/this.B):(s=Math.pow(sc(this.e,y,Math.sin(y)),this.B),r=Math.pow(sc(this.e,k,Math.sin(k)),this.B),a=this.E/s,l=(r-s)/(r+s),u=((u=this.E*this.E)-r*s)/(u+r*s),(t=g-_)<-Math.PI?_-=bh:t>Math.PI&&(_+=bh),this.lam0=ac(.5*(g+_)-Math.atan(u*Math.tan(.5*this.B*(g-_))/l)/this.B,this.over),h=Math.atan(2*Math.sin(this.B*ac(g-this.lam0,this.over))/(a-1/a)),m=v=Math.asin(n*Math.sin(h))),this.singam=Math.sin(h),this.cosgam=Math.cos(h),this.sinrot=Math.sin(m),this.cosrot=Math.cos(m),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(n*n-1)/Math.cos(v))),this.lat0<0&&(this.u_0=-this.u_0)),a=.5*h,this.v_pole_n=this.ArB*Math.log(Math.tan(wh-a)),this.v_pole_s=this.ArB*Math.log(Math.tan(wh+a))},forward:function(t){var e,i,n,a,s,r,o,l,u={};if(t.x=t.x-this.lam0,Math.abs(Math.abs(t.y)-yh)>kh){if(e=.5*((s=this.E/Math.pow(sc(this.e,t.y,Math.sin(t.y)),this.B))-(r=1/s)),i=.5*(s+r),a=Math.sin(this.B*t.x),n=(e*this.singam-a*this.cosgam)/i,Math.abs(Math.abs(n)-1)<kh)throw new Error;l=.5*this.ArB*Math.log((1-n)/(1+n)),r=Math.cos(this.B*t.x),o=Math.abs(r)<Td?this.A*t.x:this.ArB*Math.atan2(e*this.cosgam+a*this.singam,r)}else l=t.y>0?this.v_pole_n:this.v_pole_s,o=this.ArB*t.y;return this.no_rot?(u.x=o,u.y=l):(o-=this.u_0,u.x=l*this.cosrot+o*this.sinrot,u.y=o*this.cosrot-l*this.sinrot),u.x=this.a*u.x+this.x0,u.y=this.a*u.y+this.y0,u},inverse:function(t){var e,i,n,a,s,r,o,l={};if(t.x=(t.x-this.x0)*(1/this.a),t.y=(t.y-this.y0)*(1/this.a),this.no_rot?(i=t.y,e=t.x):(i=t.x*this.cosrot-t.y*this.sinrot,e=t.y*this.cosrot+t.x*this.sinrot+this.u_0),a=.5*((n=Math.exp(-this.BrA*i))-1/n),s=.5*(n+1/n),o=((r=Math.sin(this.BrA*e))*this.cosgam+a*this.singam)/s,Math.abs(Math.abs(o)-1)<kh)l.x=0,l.y=o<0?-yh:yh;else{if(l.y=this.E/Math.sqrt((1+o)/(1-o)),l.y=rc(this.e,Math.pow(l.y,1/this.B)),l.y===1/0)throw new Error;l.x=-this.rB*Math.atan2(a*this.cosgam-r*this.singam,Math.cos(this.BrA*e))}return l.x+=this.lam0,l},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"]},Cd={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<kh)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),i=Math.cos(this.lat1),n=ic(this.e,e,i),a=sc(this.e,this.lat1,e),s=Math.sin(this.lat2),r=Math.cos(this.lat2),o=ic(this.e,s,r),l=sc(this.e,this.lat2,s),u=Math.abs(Math.abs(this.lat0)-yh)<kh?0:sc(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>kh?this.ns=Math.log(n/o)/Math.log(a/l):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=n/(this.ns*Math.pow(a,this.ns)),this.rh=this.a*this.f0*Math.pow(u,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(t){var e=t.x,i=t.y;Math.abs(2*Math.abs(i)-Math.PI)<=kh&&(i=nc(i)*(yh-2e-10));var n,a,s=Math.abs(Math.abs(i)-yh);if(s>kh)n=sc(this.e,i,Math.sin(i)),a=this.a*this.f0*Math.pow(n,this.ns);else{if((s=i*this.ns)<=0)return null;a=0}var r=this.ns*ac(e-this.long0,this.over);return t.x=this.k0*(a*Math.sin(r))+this.x0,t.y=this.k0*(this.rh-a*Math.cos(r))+this.y0,t},inverse:function(t){var e,i,n,a,s,r=(t.x-this.x0)/this.k0,o=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(r*r+o*o),i=1):(e=-Math.sqrt(r*r+o*o),i=-1);var l=0;if(0!==e&&(l=Math.atan2(i*r,i*o)),0!==e||this.ns>0){if(i=1/this.ns,n=Math.pow(e/(this.a*this.f0),i),-9999===(a=rc(this.e,n)))return null}else a=-yh;return s=ac(l/this.ns+this.long0,this.over),t.x=s,t.y=a,t},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"]},Ld={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(t){var e,i,n,a,s,r,o,l=t.x,u=t.y,h=ac(l-this.long0,this.over);return e=Math.pow((1+this.e*Math.sin(u))/(1-this.e*Math.sin(u)),this.alfa*this.e/2),i=2*(Math.atan(this.k*Math.pow(Math.tan(u/2+this.s45),this.alfa)/e)-this.s45),n=-h*this.alfa,a=Math.asin(Math.cos(this.ad)*Math.sin(i)+Math.sin(this.ad)*Math.cos(i)*Math.cos(n)),s=Math.asin(Math.cos(i)*Math.sin(n)/Math.cos(a)),r=this.n*s,o=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(a/2+this.s45),this.n),t.y=o*Math.cos(r)/1,t.x=o*Math.sin(r)/1,this.czech||(t.y*=-1,t.x*=-1),t},inverse:function(t){var e,i,n,a,s,r,o,l=t.x;t.x=t.y,t.y=l,this.czech||(t.y*=-1,t.x*=-1),s=Math.sqrt(t.x*t.x+t.y*t.y),a=Math.atan2(t.y,t.x)/Math.sin(this.s0),n=2*(Math.atan(Math.pow(this.ro0/s,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(n)-Math.sin(this.ad)*Math.cos(n)*Math.cos(a)),i=Math.asin(Math.cos(n)*Math.sin(a)/Math.cos(e)),t.x=this.long0-i/this.alfa,r=e,o=0;var u=0;do{t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(r))/(1-this.e*Math.sin(r)),this.e/2))-this.s45),Math.abs(r-t.y)<1e-10&&(o=1),r=t.y,u+=1}while(0===o&&u<15);return u>=15?null:t},names:["Krovak","krovak"]};function Rd(t,e,i,n,a){return t*a-e*Math.sin(2*a)+i*Math.sin(4*a)-n*Math.sin(6*a)}function Id(t){return 1-.25*t*(1+t/16*(3+1.25*t))}function Pd(t){return.375*t*(1+.25*t*(1+.46875*t))}function Ad(t){return.05859375*t*t*(1+.75*t)}function jd(t){return t*t*t*(35/3072)}function Od(t,e,i){var n=e*i;return t/Math.sqrt(1-n*n)}function Fd(t){return Math.abs(t)<yh?t:t-nc(t)*Math.PI}function Nd(t,e,i,n,a){var s,r;s=t/e;for(var o=0;o<15;o++)if(s+=r=(t-(e*s-i*Math.sin(2*s)+n*Math.sin(4*s)-a*Math.sin(6*s)))/(e-2*i*Math.cos(2*s)+4*n*Math.cos(4*s)-6*a*Math.cos(6*s)),Math.abs(r)<=1e-10)return s;return NaN}const Gd={init:function(){this.sphere||(this.e0=Id(this.es),this.e1=Pd(this.es),this.e2=Ad(this.es),this.e3=jd(this.es),this.ml0=this.a*Rd(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(t){var e,i,n=t.x,a=t.y;if(n=ac(n-this.long0,this.over),this.sphere)e=this.a*Math.asin(Math.cos(a)*Math.sin(n)),i=this.a*(Math.atan2(Math.tan(a),Math.cos(n))-this.lat0);else{var s=Math.sin(a),r=Math.cos(a),o=Od(this.a,this.e,s),l=Math.tan(a)*Math.tan(a),u=n*Math.cos(a),h=u*u,c=this.es*r*r/(1-this.es);e=o*u*(1-h*l*(1/6-(8-l+8*c)*h/120)),i=this.a*Rd(this.e0,this.e1,this.e2,this.e3,a)-this.ml0+o*s/r*h*(.5+(5-l+6*c)*h/24)}return t.x=e+this.x0,t.y=i+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,i,n=t.x/this.a,a=t.y/this.a;if(this.sphere){var s=a+this.lat0;e=Math.asin(Math.sin(s)*Math.cos(n)),i=Math.atan2(Math.tan(n),Math.cos(s))}else{var r=Nd(this.ml0/this.a+a,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(r)-yh)<=kh)return t.x=this.long0,t.y=yh,a<0&&(t.y*=-1),t;var o=Od(this.a,this.e,Math.sin(r)),l=o*o*o/this.a/this.a*(1-this.es),u=Math.pow(Math.tan(r),2),h=n*this.a/o,c=h*h;e=r-o*Math.tan(r)/l*h*h*(.5-(1+3*u)*h*h/24),i=h*(1-c*(u/3+(1+3*u)*u*c/15))/Math.cos(r)}return t.x=ac(i+this.long0,this.over),t.y=Fd(e),t},names:["Cassini","Cassini_Soldner","cass"]};function Dd(t,e){var i;return t>1e-7?(1-t*t)*(e/(1-(i=t*e)*i)-.5/t*Math.log((1-i)/(1+i))):2*e}const Wd={init:function(){var t,e=Math.abs(this.lat0);if(Math.abs(e-yh)<kh?this.mode=this.lat0<0?1:2:Math.abs(e)<kh?this.mode=3:this.mode=4,this.es>0)switch(this.qp=Dd(this.e,1),this.mmf=.5/(1-this.es),this.apa=function(t){var e,i=[];return i[0]=.3333333333333333*t,e=t*t,i[0]+=.17222222222222222*e,i[1]=.06388888888888888*e,e*=t,i[0]+=.10257936507936508*e,i[1]+=.0664021164021164*e,i[2]=.016415012942191543*e,i}(this.es),this.mode){case 2:case 1:this.dd=1;break;case 3:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case 4:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=Dd(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else 4===this.mode&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(t){var e,i,n,a,s,r,o,l,u,h,c=t.x,d=t.y;if(c=ac(c-this.long0,this.over),this.sphere){if(s=Math.sin(d),h=Math.cos(d),n=Math.cos(c),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((i=this.mode===this.EQUIT?1+h*n:1+this.sinph0*s+this.cosph0*h*n)<=kh)return null;e=(i=Math.sqrt(2/i))*h*Math.sin(c),i*=this.mode===this.EQUIT?s:this.cosph0*s-this.sinph0*h*n}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),Math.abs(d+this.lat0)<kh)return null;i=wh-.5*d,e=(i=2*(this.mode===this.S_POLE?Math.cos(i):Math.sin(i)))*Math.sin(c),i*=n}}else{switch(o=0,l=0,u=0,n=Math.cos(c),a=Math.sin(c),s=Math.sin(d),r=Dd(this.e,s),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(o=r/this.qp,l=Math.sqrt(1-o*o)),this.mode){case this.OBLIQ:u=1+this.sinb1*o+this.cosb1*l*n;break;case this.EQUIT:u=1+l*n;break;case this.N_POLE:u=yh+d,r=this.qp-r;break;case this.S_POLE:u=d-yh,r=this.qp+r}if(Math.abs(u)<kh)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:u=Math.sqrt(2/u),i=this.mode===this.OBLIQ?this.ymf*u*(this.cosb1*o-this.sinb1*l*n):(u=Math.sqrt(2/(1+l*n)))*o*this.ymf,e=this.xmf*u*l*a;break;case this.N_POLE:case this.S_POLE:r>=0?(e=(u=Math.sqrt(r))*a,i=n*(this.mode===this.S_POLE?u:-u)):e=i=0}}return t.x=this.a*e+this.x0,t.y=this.a*i+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,i,n,a,s,r,o,l,u,h,c=t.x/this.a,d=t.y/this.a;if(this.sphere){var p,m=0,f=0;if((i=.5*(p=Math.sqrt(c*c+d*d)))>1)return null;switch(i=2*Math.asin(i),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(f=Math.sin(i),m=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(p)<=kh?0:Math.asin(d*f/p),c*=f,d=m*p;break;case this.OBLIQ:i=Math.abs(p)<=kh?this.lat0:Math.asin(m*this.sinph0+d*f*this.cosph0/p),c*=f*this.cosph0,d=(m-Math.sin(i)*this.sinph0)*p;break;case this.N_POLE:d=-d,i=yh-i;break;case this.S_POLE:i-=yh}e=0!==d||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(c,d):0}else{if(o=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(c/=this.dd,d*=this.dd,(r=Math.sqrt(c*c+d*d))<kh)return t.x=this.long0,t.y=this.lat0,t;a=2*Math.asin(.5*r/this.rq),n=Math.cos(a),c*=a=Math.sin(a),this.mode===this.OBLIQ?(o=n*this.sinb1+d*a*this.cosb1/r,s=this.qp*o,d=r*this.cosb1*n-d*this.sinb1*a):(o=d*a/r,s=this.qp*o,d=r*n)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(d=-d),!(s=c*c+d*d))return t.x=this.long0,t.y=this.lat0,t;o=1-s/this.qp,this.mode===this.S_POLE&&(o=-o)}e=Math.atan2(c,d),l=Math.asin(o),u=this.apa,h=l+l,i=l+u[0]*Math.sin(h)+u[1]*Math.sin(h+h)+u[2]*Math.sin(h+h+h)}return t.x=ac(this.long0+e,this.over),t.y=i,t},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4};function Hd(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)}const Ud={init:function(){Math.abs(this.lat1+this.lat2)<kh||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=ic(this.e3,this.sin_po,this.cos_po),this.qs1=Dd(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=ic(this.e3,this.sin_po,this.cos_po),this.qs2=Dd(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Dd(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>kh?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(t){var e=t.x,i=t.y;this.sin_phi=Math.sin(i),this.cos_phi=Math.cos(i);var n=Dd(this.e3,this.sin_phi),a=this.a*Math.sqrt(this.c-this.ns0*n)/this.ns0,s=this.ns0*ac(e-this.long0,this.over),r=a*Math.sin(s)+this.x0,o=this.rh-a*Math.cos(s)+this.y0;return t.x=r,t.y=o,t},inverse:function(t){var e,i,n,a,s,r;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),n=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),n=-1),a=0,0!==e&&(a=Math.atan2(n*t.x,n*t.y)),n=e*this.ns0/this.a,this.sphere?r=Math.asin((this.c-n*n)/(2*this.ns0)):(i=(this.c-n*n)/this.ns0,r=this.phi1z(this.e3,i)),s=ac(a/this.ns0+this.long0,this.over),t.x=s,t.y=r,t},names:["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"],phi1z:function(t,e){var i,n,a,s,r=Hd(.5*e);if(t<kh)return r;for(var o=t*t,l=1;l<=25;l++)if(r+=s=.5*(a=1-(n=t*(i=Math.sin(r)))*n)*a/Math.cos(r)*(e/(1-o)-i/a+.5/t*Math.log((1-n)/(1+n))),Math.abs(s)<=1e-7)return r;return null}},Bd={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(t){var e,i,n,a,s,r,o,l=t.x,u=t.y;return n=ac(l-this.long0,this.over),e=Math.sin(u),i=Math.cos(u),a=Math.cos(n),(s=this.sin_p14*e+this.cos_p14*i*a)>0||Math.abs(s)<=kh?(r=this.x0+1*this.a*i*Math.sin(n)/s,o=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*i*a)/s):(r=this.x0+this.infinity_dist*i*Math.sin(n),o=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*i*a)),t.x=r,t.y=o,t},inverse:function(t){var e,i,n,a,s,r;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(a=Math.atan2(e,this.rc),i=Math.sin(a),r=Hd((n=Math.cos(a))*this.sin_p14+t.y*i*this.cos_p14/e),s=Math.atan2(t.x*i,e*this.cos_p14*n-t.y*this.sin_p14*i),s=ac(this.long0+s,this.over)):(r=this.phic0,s=0),t.x=s,t.y=r,t},names:["gnom"]},Vd={init:function(){this.sphere||(this.k0=ic(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(t){var e,i,n=t.x,a=t.y,s=ac(n-this.long0,this.over);if(this.sphere)e=this.x0+this.a*s*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(a)/Math.cos(this.lat_ts);else{var r=Dd(this.e,Math.sin(a));e=this.x0+this.a*this.k0*s,i=this.y0+this.a*r*.5/this.k0}return t.x=e,t.y=i,t},inverse:function(t){var e,i;return t.x-=this.x0,t.y-=this.y0,this.sphere?(e=ac(this.long0+t.x/this.a/Math.cos(this.lat_ts),this.over),i=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(i=function(t,e){var i=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-i)<1e-6)return e<0?-1*yh:yh;for(var n,a,s,r,o=Math.asin(.5*e),l=0;l<30;l++)if(a=Math.sin(o),s=Math.cos(o),r=t*a,o+=n=Math.pow(1-r*r,2)/(2*s)*(e/(1-t*t)-a/(1-r*r)+.5/t*Math.log((1-r)/(1+r))),Math.abs(n)<=1e-10)return o;return NaN}(this.e,2*t.y*this.k0/this.a),e=ac(this.long0+t.x/(this.a*this.k0),this.over)),t.x=e,t.y=i,t},names:["cea"]},Kd={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(t){var e=t.x,i=t.y,n=ac(e-this.long0,this.over),a=Fd(i-this.lat0);return t.x=this.x0+this.a*n*this.rc,t.y=this.y0+this.a*a,t},inverse:function(t){var e=t.x,i=t.y;return t.x=ac(this.long0+(e-this.x0)/(this.a*this.rc),this.over),t.y=Fd(this.lat0+(i-this.y0)/this.a),t},names:["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"]},zd={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Id(this.es),this.e1=Pd(this.es),this.e2=Ad(this.es),this.e3=jd(this.es),this.ml0=this.a*Rd(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(t){var e,i,n,a=t.x,s=t.y,r=ac(a-this.long0,this.over);if(n=r*Math.sin(s),this.sphere)Math.abs(s)<=kh?(e=this.a*r,i=-1*this.a*this.lat0):(e=this.a*Math.sin(n)/Math.tan(s),i=this.a*(Fd(s-this.lat0)+(1-Math.cos(n))/Math.tan(s)));else if(Math.abs(s)<=kh)e=this.a*r,i=-1*this.ml0;else{var o=Od(this.a,this.e,Math.sin(s))/Math.tan(s);e=o*Math.sin(n),i=this.a*Rd(this.e0,this.e1,this.e2,this.e3,s)-this.ml0+o*(1-Math.cos(n))}return t.x=e+this.x0,t.y=i+this.y0,t},inverse:function(t){var e,i,n,a,s,r,o,l,u;if(n=t.x-this.x0,a=t.y-this.y0,this.sphere)if(Math.abs(a+this.a*this.lat0)<=kh)e=ac(n/this.a+this.long0,this.over),i=0;else{var h;for(r=this.lat0+a/this.a,o=n*n/this.a/this.a+r*r,l=r,s=20;s;--s)if(l+=u=-1*(r*(l*(h=Math.tan(l))+1)-l-.5*(l*l+o)*h)/((l-r)/h-1),Math.abs(u)<=kh){i=l;break}e=ac(this.long0+Math.asin(n*Math.tan(l)/this.a)/Math.sin(i),this.over)}else if(Math.abs(a+this.ml0)<=kh)i=0,e=ac(this.long0+n/this.a,this.over);else{var c,d,p,m,f;for(r=(this.ml0+a)/this.a,o=n*n/this.a/this.a+r*r,l=r,s=20;s;--s)if(f=this.e*Math.sin(l),c=Math.sqrt(1-f*f)*Math.tan(l),d=this.a*Rd(this.e0,this.e1,this.e2,this.e3,l),p=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),l-=u=(r*(c*(m=d/this.a)+1)-m-.5*c*(m*m+o))/(this.es*Math.sin(2*l)*(m*m+o-2*r*m)/(4*c)+(r-m)*(c*p-2/Math.sin(2*l))-p),Math.abs(u)<=kh){i=l;break}c=Math.sqrt(1-this.es*Math.pow(Math.sin(i),2))*Math.tan(i),e=ac(this.long0+Math.asin(n*c/this.a)/Math.sin(i),this.over)}return t.x=e,t.y=i,t},names:["Polyconic","American_Polyconic","poly"]},$d={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(t){var e,i=t.x,n=t.y-this.lat0,a=i-this.long0,s=n/_h*1e-5,r=a,o=1,l=0;for(e=1;e<=10;e++)o*=s,l+=this.A[e]*o;var u,h=l,c=r,d=1,p=0,m=0,f=0;for(e=1;e<=6;e++)u=p*h+d*c,d=d*h-p*c,p=u,m=m+this.B_re[e]*d-this.B_im[e]*p,f=f+this.B_im[e]*d+this.B_re[e]*p;return t.x=f*this.a+this.x0,t.y=m*this.a+this.y0,t},inverse:function(t){var e,i,n=t.x,a=t.y,s=n-this.x0,r=(a-this.y0)/this.a,o=s/this.a,l=1,u=0,h=0,c=0;for(e=1;e<=6;e++)i=u*r+l*o,l=l*r-u*o,u=i,h=h+this.C_re[e]*l-this.C_im[e]*u,c=c+this.C_im[e]*l+this.C_re[e]*u;for(var d=0;d<this.iterations;d++){var p,m=h,f=c,g=r,_=o;for(e=2;e<=6;e++)p=f*h+m*c,m=m*h-f*c,f=p,g+=(e-1)*(this.B_re[e]*m-this.B_im[e]*f),_+=(e-1)*(this.B_im[e]*m+this.B_re[e]*f);m=1,f=0;var y=this.B_re[1],k=this.B_im[1];for(e=2;e<=6;e++)p=f*h+m*c,m=m*h-f*c,f=p,y+=e*(this.B_re[e]*m-this.B_im[e]*f),k+=e*(this.B_im[e]*m+this.B_re[e]*f);var v=y*y+k*k;h=(g*y+_*k)/v,c=(_*y-g*k)/v}var x=h,w=c,b=1,E=0;for(e=1;e<=9;e++)b*=x,E+=this.D[e]*b;var M=this.lat0+E*_h*1e5,T=this.long0+w;return t.x=T,t.y=M,t},names:["New_Zealand_Map_Grid","nzmg"]},Yd={init:function(){},forward:function(t){var e=t.x,i=t.y,n=ac(e-this.long0,this.over),a=this.x0+this.a*n,s=this.y0+this.a*Math.log(Math.tan(Math.PI/4+i/2.5))*1.25;return t.x=a,t.y=s,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e=ac(this.long0+t.x/this.a,this.over),i=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=i,t},names:["Miller_Cylindrical","mill"]},Xd={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=hd(this.es)},forward:function(t){var e,i,n=t.x,a=t.y;if(n=ac(n-this.long0,this.over),this.sphere){if(this.m)for(var s=this.n*Math.sin(a),r=20;r;--r){var o=(this.m*a+Math.sin(a)-s)/(this.m+Math.cos(a));if(a-=o,Math.abs(o)<kh)break}else a=1!==this.n?Math.asin(this.n*Math.sin(a)):a;e=this.a*this.C_x*n*(this.m+Math.cos(a)),i=this.a*this.C_y*a}else{var l=Math.sin(a),u=Math.cos(a);i=this.a*cd(a,l,u,this.en),e=this.a*n*u/Math.sqrt(1-this.es*l*l)}return t.x=e,t.y=i,t},inverse:function(t){var e,i,n;return t.x-=this.x0,i=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,i/=this.C_x*(this.m+Math.cos(e)),this.m?e=Hd((this.m*e+Math.sin(e))/this.n):1!==this.n&&(e=Hd(Math.sin(e)/this.n)),i=ac(i+this.long0,this.over),e=Fd(e)):(e=dd(t.y/this.a,this.es,this.en),(n=Math.abs(e))<yh?(n=Math.sin(e),i=ac(this.long0+t.x*Math.sqrt(1-this.es*n*n)/(this.a*Math.cos(e)),this.over)):n-kh<yh&&(i=this.long0)),t.x=i,t.y=e,t},names:["Sinusoidal","sinu"]},qd={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0},forward:function(t){for(var e=t.x,i=t.y,n=ac(e-this.long0,this.over),a=i,s=Math.PI*Math.sin(i);;){var r=-(a+Math.sin(a)-s)/(1+Math.cos(a));if(a+=r,Math.abs(r)<kh)break}a/=2,Math.PI/2-Math.abs(i)<kh&&(n=0);var o=.900316316158*this.a*n*Math.cos(a)+this.x0,l=1.4142135623731*this.a*Math.sin(a)+this.y0;return t.x=o,t.y=l,t},inverse:function(t){var e,i;t.x-=this.x0,t.y-=this.y0,i=t.y/(1.4142135623731*this.a),Math.abs(i)>.999999999999&&(i=.999999999999),e=Math.asin(i);var n=ac(this.long0+t.x/(.900316316158*this.a*Math.cos(e)),this.over);n<-Math.PI&&(n=-Math.PI),n>Math.PI&&(n=Math.PI),i=(2*e+Math.sin(2*e))/Math.PI,Math.abs(i)>1&&(i=1);var a=Math.asin(i);return t.x=n,t.y=a,t},names:["Mollweide","moll"]},Zd={init:function(){Math.abs(this.lat1+this.lat2)<kh||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Id(this.es),this.e1=Pd(this.es),this.e2=Ad(this.es),this.e3=jd(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=ic(this.e,this.sin_phi,this.cos_phi),this.ml1=Rd(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<kh?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=ic(this.e,this.sin_phi,this.cos_phi),this.ml2=Rd(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Rd(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(t){var e,i=t.x,n=t.y;if(this.sphere)e=this.a*(this.g-n);else{var a=Rd(this.e0,this.e1,this.e2,this.e3,n);e=this.a*(this.g-a)}var s=this.ns*ac(i-this.long0,this.over),r=this.x0+e*Math.sin(s),o=this.y0+this.rh-e*Math.cos(s);return t.x=r,t.y=o,t},inverse:function(t){var e,i,n,a;t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns>=0?(i=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(i=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var s=0;return 0!==i&&(s=Math.atan2(e*t.x,e*t.y)),this.sphere?(a=ac(this.long0+s/this.ns,this.over),n=Fd(this.g-i/this.a),t.x=a,t.y=n,t):(n=Nd(this.g-i/this.a,this.e0,this.e1,this.e2,this.e3),a=ac(this.long0+s/this.ns,this.over),t.x=a,t.y=n,t)},names:["Equidistant_Conic","eqdc"]},Jd={init:function(){this.R=this.a},forward:function(t){var e,i,n=t.x,a=t.y,s=ac(n-this.long0,this.over);Math.abs(a)<=kh&&(e=this.x0+this.R*s,i=this.y0);var r=Hd(2*Math.abs(a/Math.PI));(Math.abs(s)<=kh||Math.abs(Math.abs(a)-yh)<=kh)&&(e=this.x0,i=a>=0?this.y0+Math.PI*this.R*Math.tan(.5*r):this.y0+Math.PI*this.R*-Math.tan(.5*r));var o=.5*Math.abs(Math.PI/s-s/Math.PI),l=o*o,u=Math.sin(r),h=Math.cos(r),c=h/(u+h-1),d=c*c,p=c*(2/u-1),m=p*p,f=Math.PI*this.R*(o*(c-m)+Math.sqrt(l*(c-m)*(c-m)-(m+l)*(d-m)))/(m+l);s<0&&(f=-f),e=this.x0+f;var g=l+c;return f=Math.PI*this.R*(p*g-o*Math.sqrt((m+l)*(l+1)-g*g))/(m+l),i=a>=0?this.y0+f:this.y0-f,t.x=e,t.y=i,t},inverse:function(t){var e,i,n,a,s,r,o,l,u,h,c,d;return t.x-=this.x0,t.y-=this.y0,c=Math.PI*this.R,s=(n=t.x/c)*n+(a=t.y/c)*a,c=3*(a*a/(l=-2*(r=-Math.abs(a)*(1+s))+1+2*a*a+s*s)+(2*(o=r-2*a*a+n*n)*o*o/l/l/l-9*r*o/l/l)/27)/(u=(r-o*o/3/l)/l)/(h=2*Math.sqrt(-u/3)),Math.abs(c)>1&&(c=c>=0?1:-1),d=Math.acos(c)/3,i=t.y>=0?(-h*Math.cos(d+Math.PI/3)-o/3/l)*Math.PI:-(-h*Math.cos(d+Math.PI/3)-o/3/l)*Math.PI,e=Math.abs(n)<kh?this.long0:ac(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(n*n-a*a)+s*s))/2/n,this.over),t.x=e,t.y=i,t},names:["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"]},Qd={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))},forward:function(t){var e,i,n,a,s,r,o,l,u,h,c,d=t.x,p=t.y,m=Math.sin(t.y),f=Math.cos(t.y),g=ac(d-this.long0,this.over);return this.sphere?Math.abs(this.sin_p12-1)<=kh?(t.x=this.x0+this.a*(yh-p)*Math.sin(g),t.y=this.y0-this.a*(yh-p)*Math.cos(g),t):Math.abs(this.sin_p12+1)<=kh?(t.x=this.x0+this.a*(yh+p)*Math.sin(g),t.y=this.y0+this.a*(yh+p)*Math.cos(g),t):(u=this.sin_p12*m+this.cos_p12*f*Math.cos(g),l=(o=Math.acos(u))?o/Math.sin(o):1,t.x=this.x0+this.a*l*f*Math.sin(g),t.y=this.y0+this.a*l*(this.cos_p12*m-this.sin_p12*f*Math.cos(g)),t):(e=Id(this.es),i=Pd(this.es),n=Ad(this.es),a=jd(this.es),Math.abs(this.sin_p12-1)<=kh?(s=this.a*Rd(e,i,n,a,yh),r=this.a*Rd(e,i,n,a,p),t.x=this.x0+(s-r)*Math.sin(g),t.y=this.y0-(s-r)*Math.cos(g),t):Math.abs(this.sin_p12+1)<=kh?(s=this.a*Rd(e,i,n,a,yh),r=this.a*Rd(e,i,n,a,p),t.x=this.x0+(s+r)*Math.sin(g),t.y=this.y0+(s+r)*Math.cos(g),t):Math.abs(d)<kh&&Math.abs(p-this.lat0)<kh?(t.x=t.y=0,t):(h=function(t,e,i,n,a,s){const r=n-e,o=Math.atan((1-s)*Math.tan(t)),l=Math.atan((1-s)*Math.tan(i)),u=Math.sin(o),h=Math.cos(o),c=Math.sin(l),d=Math.cos(l);let p,m,f,g,_,y,k,v,x,w,b,E,M,T,S,C=r,L=100;do{if(m=Math.sin(C),f=Math.cos(C),g=Math.sqrt(d*m*(d*m)+(h*c-u*d*f)*(h*c-u*d*f)),0===g)return{azi1:0,s12:0};_=u*c+h*d*f,y=Math.atan2(g,_),k=h*d*m/g,v=1-k*k,x=0!==v?_-2*u*c/v:0,w=s/16*v*(4+s*(4-3*v)),p=C,C=r+(1-w)*s*k*(y+w*g*(x+w*_*(2*x*x-1)))}while(Math.abs(C-p)>1e-12&&--L>0);return 0===L?{azi1:NaN,s12:NaN}:(b=v*(a*a-a*(1-s)*(a*(1-s)))/(a*(1-s)*(a*(1-s))),E=1+b/16384*(4096+b*(b*(320-175*b)-768)),M=b/1024*(256+b*(b*(74-47*b)-128)),T=M*g*(x+M/4*(_*(2*x*x-1)-M/6*x*(4*g*g-3)*(4*x*x-3))),S=a*(1-s)*E*(y-T),{azi1:Math.atan2(d*m,h*c-u*d*f),s12:S})}(this.lat0,this.long0,p,d,this.a,this.f),c=h.azi1,t.x=h.s12*Math.sin(c),t.y=h.s12*Math.cos(c),t))},inverse:function(t){var e,i,n,a,s,r,o,l,u,h,c,d,p,m,f;if(t.x-=this.x0,t.y-=this.y0,this.sphere){if((e=Math.sqrt(t.x*t.x+t.y*t.y))>2*yh*this.a)return;return i=e/this.a,n=Math.sin(i),a=Math.cos(i),s=this.long0,Math.abs(e)<=kh?r=this.lat0:(r=Hd(a*this.sin_p12+t.y*n*this.cos_p12/e),o=Math.abs(this.lat0)-yh,s=Math.abs(o)<=kh?this.lat0>=0?ac(this.long0+Math.atan2(t.x,-t.y),this.over):ac(this.long0-Math.atan2(-t.x,t.y),this.over):ac(this.long0+Math.atan2(t.x*n,e*this.cos_p12*a-t.y*this.sin_p12*n),this.over)),t.x=s,t.y=r,t}return l=Id(this.es),u=Pd(this.es),h=Ad(this.es),c=jd(this.es),Math.abs(this.sin_p12-1)<=kh?(r=Nd(((d=this.a*Rd(l,u,h,c,yh))-(e=Math.sqrt(t.x*t.x+t.y*t.y)))/this.a,l,u,h,c),s=ac(this.long0+Math.atan2(t.x,-1*t.y),this.over),t.x=s,t.y=r,t):Math.abs(this.sin_p12+1)<=kh?(d=this.a*Rd(l,u,h,c,yh),r=Nd(((e=Math.sqrt(t.x*t.x+t.y*t.y))-d)/this.a,l,u,h,c),s=ac(this.long0+Math.atan2(t.x,t.y),this.over),t.x=s,t.y=r,t):(p=Math.atan2(t.x,t.y),m=Math.sqrt(t.x*t.x+t.y*t.y),f=function(t,e,i,n,a,s){const r=Math.atan((1-s)*Math.tan(t)),o=Math.sin(r),l=Math.cos(r),u=Math.sin(i),h=Math.cos(i),c=Math.atan2(o,l*h),d=l*u,p=1-d*d,m=p*(a*a-a*(1-s)*(a*(1-s)))/(a*(1-s)*(a*(1-s))),f=1+m/16384*(4096+m*(m*(320-175*m)-768)),g=m/1024*(256+m*(m*(74-47*m)-128));let _,y,k,v,x,w=n/(a*(1-s)*f),b=100;do{y=Math.cos(2*c+w),k=Math.sin(w),v=Math.cos(w),x=g*k*(y+g/4*(v*(2*y*y-1)-g/6*y*(4*k*k-3)*(4*y*y-3))),_=w,w=n/(a*(1-s)*f)+x}while(Math.abs(w-_)>1e-12&&--b>0);if(0===b)return{lat2:NaN,lon2:NaN};const E=o*k-l*v*h,M=s/16*p*(4+s*(4-3*p));return{lat2:Math.atan2(o*v+l*k*h,(1-s)*Math.sqrt(d*d+E*E)),lon2:e+(Math.atan2(k*u,l*v-o*k*h)-(1-M)*s*d*(w+M*k*(y+M*v*(2*y*y-1))))}}(this.lat0,this.long0,p,m,this.a,this.f),t.x=f.lon2,t.y=f.lat2,t)},names:["Azimuthal_Equidistant","aeqd"]},tp={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(t){var e,i,n,a,s,r,o,l=t.x,u=t.y;return n=ac(l-this.long0,this.over),e=Math.sin(u),i=Math.cos(u),a=Math.cos(n),((s=this.sin_p14*e+this.cos_p14*i*a)>0||Math.abs(s)<=kh)&&(r=1*this.a*i*Math.sin(n),o=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*i*a)),t.x=r,t.y=o,t},inverse:function(t){var e,i,n,a,s,r,o;return t.x-=this.x0,t.y-=this.y0,i=Hd((e=Math.sqrt(t.x*t.x+t.y*t.y))/this.a),n=Math.sin(i),a=Math.cos(i),r=this.long0,Math.abs(e)<=kh?(o=this.lat0,t.x=r,t.y=o,t):(o=Hd(a*this.sin_p14+t.y*n*this.cos_p14/e),s=Math.abs(this.lat0)-yh,Math.abs(s)<=kh?(r=this.lat0>=0?ac(this.long0+Math.atan2(t.x,-t.y),this.over):ac(this.long0-Math.atan2(-t.x,t.y),this.over),t.x=r,t.y=o,t):(r=ac(this.long0+Math.atan2(t.x*n,e*this.cos_p14*a-t.y*this.sin_p14*n),this.over),t.x=r,t.y=o,t))},names:["ortho"]};function ep(t,e,i,n){var a;return t<kh?(n.value=1,a=0):(a=Math.atan2(e,i),Math.abs(a)<=wh?n.value=1:a>wh&&a<=yh+wh?(n.value=2,a-=yh):a>yh+wh||a<=-(yh+wh)?(n.value=3,a=a>=0?a-Eh:a+Eh):(n.value=4,a+=yh)),a}function ip(t,e){var i=t+e;return i<-Eh?i+=bh:i>+Eh&&(i-=bh),i}const np={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=yh-wh/2?this.face=5:this.lat0<=-(yh-wh/2)?this.face=6:Math.abs(this.long0)<=wh?this.face=1:Math.abs(this.long0)<=yh+wh?this.face=this.long0>0?2:4:this.face=3,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(t){var e,i,n,a,s,r,o={x:0,y:0},l={value:0};if(t.x-=this.long0,e=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(t.y)):t.y,i=t.x,5===this.face)a=yh-e,i>=wh&&i<=yh+wh?(l.value=1,n=i-yh):i>yh+wh||i<=-(yh+wh)?(l.value=2,n=i>0?i-Eh:i+Eh):i>-(yh+wh)&&i<=-wh?(l.value=3,n=i+yh):(l.value=4,n=i);else if(6===this.face)a=yh+e,i>=wh&&i<=yh+wh?(l.value=1,n=-i+yh):i<wh&&i>=-wh?(l.value=2,n=-i):i<-wh&&i>=-(yh+wh)?(l.value=3,n=-i-yh):(l.value=4,n=i>0?-i+Eh:-i-Eh);else{var u,h,c,d,p,m;2===this.face?i=ip(i,+yh):3===this.face?i=ip(i,+Eh):4===this.face&&(i=ip(i,-yh)),d=Math.sin(e),p=Math.cos(e),m=Math.sin(i),u=p*Math.cos(i),h=p*m,c=d,1===this.face?n=ep(a=Math.acos(u),c,h,l):2===this.face?n=ep(a=Math.acos(h),c,-u,l):3===this.face?n=ep(a=Math.acos(-u),c,-h,l):4===this.face?n=ep(a=Math.acos(-h),c,u,l):(a=n=0,l.value=1)}return r=Math.atan(12/Eh*(n+Math.acos(Math.sin(n)*Math.cos(wh))-yh)),s=Math.sqrt((1-Math.cos(a))/(Math.cos(r)*Math.cos(r))/(1-Math.cos(Math.atan(1/Math.cos(n))))),2===l.value?r+=yh:3===l.value?r+=Eh:4===l.value&&(r+=1.5*Eh),o.x=s*Math.cos(r),o.y=s*Math.sin(r),o.x=o.x*this.a+this.x0,o.y=o.y*this.a+this.y0,t.x=o.x,t.y=o.y,t},inverse:function(t){var e,i,n,a,s,r,o,l,u,h,c,d,p={lam:0,phi:0},m={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,i=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),e=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?m.value=1:t.y>=0&&t.y>=Math.abs(t.x)?(m.value=2,e-=yh):t.x<0&&-t.x>=Math.abs(t.y)?(m.value=3,e=e<0?e+Eh:e-Eh):(m.value=4,e+=yh),u=Eh/12*Math.tan(e),s=Math.sin(u)/(Math.cos(u)-1/Math.sqrt(2)),r=Math.atan(s),(o=1-(n=Math.cos(e))*n*(a=Math.tan(i))*a*(1-Math.cos(Math.atan(1/Math.cos(r)))))<-1?o=-1:o>1&&(o=1),5===this.face)l=Math.acos(o),p.phi=yh-l,1===m.value?p.lam=r+yh:2===m.value?p.lam=r<0?r+Eh:r-Eh:3===m.value?p.lam=r-yh:p.lam=r;else if(6===this.face)l=Math.acos(o),p.phi=l-yh,1===m.value?p.lam=-r+yh:2===m.value?p.lam=-r:3===m.value?p.lam=-r-yh:p.lam=r<0?-r-Eh:-r+Eh;else{var f,g,_;u=(f=o)*f,g=(u+=(_=u>=1?0:Math.sqrt(1-u)*Math.sin(r))*_)>=1?0:Math.sqrt(1-u),2===m.value?(u=g,g=-_,_=u):3===m.value?(g=-g,_=-_):4===m.value&&(u=g,g=_,_=-u),2===this.face?(u=f,f=-g,g=u):3===this.face?(f=-f,g=-g):4===this.face&&(u=f,f=g,g=-u),p.phi=Math.acos(-_)-yh,p.lam=Math.atan2(g,f),2===this.face?p.lam=ip(p.lam,-yh):3===this.face?p.lam=ip(p.lam,-Eh):4===this.face&&(p.lam=ip(p.lam,+yh))}return 0!==this.es&&(h=p.phi<0?1:0,c=Math.tan(p.phi),d=this.b/Math.sqrt(c*c+this.one_minus_f_squared),p.phi=Math.atan(Math.sqrt(this.a*this.a-d*d)/(this.one_minus_f*d)),h&&(p.phi=-p.phi)),p.lam+=this.long0,t.x=p.lam,t.y=p.phi,t},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]};var ap=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],sp=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],rp=.8487,op=1.3523,lp=xh/5,up=1/lp,hp=function(t,e){return t[0]+e*(t[1]+e*(t[2]+e*t[3]))};const cp={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(t){var e=ac(t.x-this.long0,this.over),i=Math.abs(t.y),n=Math.floor(i*lp);n<0?n=0:n>=18&&(n=17);var a={x:hp(ap[n],i=xh*(i-up*n))*e,y:hp(sp[n],i)};return t.y<0&&(a.y=-a.y),a.x=a.x*this.a*rp+this.x0,a.y=a.y*this.a*op+this.y0,a},inverse:function(t){var e={x:(t.x-this.x0)/(this.a*rp),y:Math.abs(t.y-this.y0)/(this.a*op)};if(e.y>=1)e.x/=ap[18][0],e.y=t.y<0?-yh:yh;else{var i=Math.floor(18*e.y);for(i<0?i=0:i>=18&&(i=17);;)if(sp[i][0]>e.y)--i;else{if(!(sp[i+1][0]<=e.y))break;++i}var n=sp[i],a=5*(e.y-n[0])/(sp[i+1][0]-n[0]);a=function(t,e,i,n){for(var a=e;n;--n){var s=t(a);if(a-=s,Math.abs(s)<1e-10)break}return a}(function(t){return(hp(n,t)-e.y)/function(t,e){return t[1]+e*(2*t[2]+3*e*t[3])}(n,t)},a,0,100),e.x/=hp(ap[i],a),e.y=(5*i+a)*vh,t.y<0&&(e.y=-e.y)}return e.x=ac(e.x+this.long0,this.over),e},names:["Robinson","robin"]},dp={init:function(){this.name="geocent"},forward:function(t){return Pc(t,this.es,this.a)},inverse:function(t){return Ac(t,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]};var pp={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};const mp={init:function(){if(Object.keys(pp).forEach(function(t){if(void 0===this[t])this[t]=pp[t].def;else{if(pp[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);pp[t].num&&(this[t]=parseFloat(this[t]))}pp[t].degrees&&(this[t]=this[t]*vh)}.bind(this)),Math.abs(Math.abs(this.lat0)-yh)<kh?this.mode=this.lat0<0?1:0:Math.abs(this.lat0)<kh?this.mode=2:(this.mode=3,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var t=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(t),this.sw=Math.sin(t)},forward:function(t){t.x-=this.long0;var e,i,n,a,s=Math.sin(t.y),r=Math.cos(t.y),o=Math.cos(t.x);switch(this.mode){case 3:i=this.sinph0*s+this.cosph0*r*o;break;case 2:i=r*o;break;case 1:i=-s;break;case 0:i=s}switch(e=(i=this.pn1/(this.p-i))*r*Math.sin(t.x),this.mode){case 3:i*=this.cosph0*s-this.sinph0*r*o;break;case 2:i*=s;break;case 0:i*=-r*o;break;case 1:i*=r*o}return a=1/((n=i*this.cg+e*this.sg)*this.sw*this.h1+this.cw),e=(e*this.cg-i*this.sg)*this.cw*a,i=n*a,t.x=e*this.a,t.y=i*this.a,t},inverse:function(t){t.x/=this.a,t.y/=this.a;var e,i,n,a={x:t.x,y:t.y};n=1/(this.pn1-t.y*this.sw),e=this.pn1*t.x*n,i=this.pn1*t.y*this.cw*n,t.x=e*this.cg+i*this.sg,t.y=i*this.cg-e*this.sg;var s=fd(t.x,t.y);if(Math.abs(s)<kh)a.x=0,a.y=t.y;else{var r,o;switch(o=1-s*s*this.pfact,o=(this.p-Math.sqrt(o))/(this.pn1/s+s/this.pn1),r=Math.sqrt(1-o*o),this.mode){case 3:a.y=Math.asin(r*this.sinph0+t.y*o*this.cosph0/s),t.y=(r-this.sinph0*Math.sin(a.y))*s,t.x*=o*this.cosph0;break;case 2:a.y=Math.asin(t.y*o/s),t.y=r*s,t.x*=o;break;case 0:a.y=Math.asin(r),t.y=-t.y;break;case 1:a.y=-Math.asin(r)}a.x=Math.atan2(t.x,t.y)}return t.x=a.x+this.long0,t.y=a.y,t},names:["Tilted_Perspective","tpers"]},fp={init:function(){if(this.flip_axis="x"===this.sweep?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,0!==this.es){var t=1-this.es,e=1/t;this.radius_p=Math.sqrt(t),this.radius_p2=t,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")},forward:function(t){var e,i,n,a,s=t.x,r=t.y;if(s-=this.long0,"ellipse"===this.shape){r=Math.atan(this.radius_p2*Math.tan(r));var o=this.radius_p/fd(this.radius_p*Math.cos(r),Math.sin(r));if(i=o*Math.cos(s)*Math.cos(r),n=o*Math.sin(s)*Math.cos(r),a=o*Math.sin(r),(this.radius_g-i)*i-n*n-a*a*this.radius_p_inv2<0)return t.x=Number.NaN,t.y=Number.NaN,t;e=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(n/fd(a,e)),t.y=this.radius_g_1*Math.atan(a/e)):(t.x=this.radius_g_1*Math.atan(n/e),t.y=this.radius_g_1*Math.atan(a/fd(n,e)))}else"sphere"===this.shape&&(e=Math.cos(r),i=Math.cos(s)*e,n=Math.sin(s)*e,a=Math.sin(r),e=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(n/fd(a,e)),t.y=this.radius_g_1*Math.atan(a/e)):(t.x=this.radius_g_1*Math.atan(n/e),t.y=this.radius_g_1*Math.atan(a/fd(n,e))));return t.x=t.x*this.a,t.y=t.y*this.a,t},inverse:function(t){var e,i,n,a,s=-1,r=0,o=0;if(t.x=t.x/this.a,t.y=t.y/this.a,"ellipse"===this.shape){this.flip_axis?(o=Math.tan(t.y/this.radius_g_1),r=Math.tan(t.x/this.radius_g_1)*fd(1,o)):(r=Math.tan(t.x/this.radius_g_1),o=Math.tan(t.y/this.radius_g_1)*fd(1,r));var l=o/this.radius_p;if(e=r*r+l*l+s*s,(n=(i=2*this.radius_g*s)*i-4*e*this.C)<0)return t.x=Number.NaN,t.y=Number.NaN,t;a=(-i-Math.sqrt(n))/(2*e),s=this.radius_g+a*s,r*=a,o*=a,t.x=Math.atan2(r,s),t.y=Math.atan(o*Math.cos(t.x)/s),t.y=Math.atan(this.radius_p_inv2*Math.tan(t.y))}else if("sphere"===this.shape){if(this.flip_axis?(o=Math.tan(t.y/this.radius_g_1),r=Math.tan(t.x/this.radius_g_1)*Math.sqrt(1+o*o)):(r=Math.tan(t.x/this.radius_g_1),o=Math.tan(t.y/this.radius_g_1)*Math.sqrt(1+r*r)),e=r*r+o*o+s*s,(n=(i=2*this.radius_g*s)*i-4*e*this.C)<0)return t.x=Number.NaN,t.y=Number.NaN,t;a=(-i-Math.sqrt(n))/(2*e),s=this.radius_g+a*s,r*=a,o*=a,t.x=Math.atan2(r,s),t.y=Math.atan(o*Math.cos(t.x)/s)}return t.x=t.x+this.long0,t},names:["Geostationary Satellite View","Geostationary_Satellite","geos"]};var gp=1.340264,_p=-.081106,yp=893e-6,kp=.003796,vp=Math.sqrt(3)/2;const xp={init:function(){this.es=0,this.long0=void 0!==this.long0?this.long0:0,this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0},forward:function(t){var e=ac(t.x-this.long0,this.over),i=t.y,n=Math.asin(vp*Math.sin(i)),a=n*n,s=a*a*a;return t.x=e*Math.cos(n)/(vp*(gp+3*_p*a+s*(7*yp+9*kp*a))),t.y=n*(gp+_p*a+s*(yp+kp*a)),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},inverse:function(t){t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a;var e,i,n,a,s=t.y;for(a=0;a<12&&(s-=n=(s*(gp+_p*(e=s*s)+(i=e*e*e)*(yp+kp*e))-t.y)/(gp+3*_p*e+i*(7*yp+9*kp*e)),!(Math.abs(n)<1e-9));++a);return i=(e=s*s)*e*e,t.x=vp*t.x*(gp+3*_p*e+i*(7*yp+9*kp*e))/Math.cos(s),t.y=Math.asin(Math.sin(s)/vp),t.x=ac(t.x+this.long0,this.over),t},names:["eqearth","Equal Earth","Equal_Earth"]};var wp=1e-10;function bp(t){var e,i,n,a=ac(t.x-(this.long0||0),this.over),s=t.y;return e=this.am1+this.m1-cd(s,i=Math.sin(s),n=Math.cos(s),this.en),i=n*a/(e*Math.sqrt(1-this.es*i*i)),t.x=e*Math.sin(i),t.y=this.am1-e*Math.cos(i),t.x=this.a*t.x+(this.x0||0),t.y=this.a*t.y+(this.y0||0),t}function Ep(t){var e,i,n,a;if(t.x=(t.x-(this.x0||0))/this.a,t.y=(t.y-(this.y0||0))/this.a,i=fd(t.x,t.y=this.am1-t.y),a=dd(this.am1+this.m1-i,this.es,this.en),(e=Math.abs(a))<yh)e=Math.sin(a),n=i*Math.atan2(t.x,t.y)*Math.sqrt(1-this.es*e*e)/Math.cos(a);else{if(!(Math.abs(e-yh)<=wp))throw new Error;n=0}return t.x=ac(n+(this.long0||0),this.over),t.y=Fd(a),t}function Mp(t){var e,i,n=ac(t.x-(this.long0||0),this.over),a=t.y;return i=this.cphi1+this.phi1-a,Math.abs(i)>wp?(t.x=i*Math.sin(e=n*Math.cos(a)/i),t.y=this.cphi1-i*Math.cos(e)):t.x=t.y=0,t.x=this.a*t.x+(this.x0||0),t.y=this.a*t.y+(this.y0||0),t}function Tp(t){var e,i;t.x=(t.x-(this.x0||0))/this.a,t.y=(t.y-(this.y0||0))/this.a;var n=fd(t.x,t.y=this.cphi1-t.y);if(i=this.cphi1+this.phi1-n,Math.abs(i)>yh)throw new Error;return e=Math.abs(Math.abs(i)-yh)<=wp?0:n*Math.atan2(t.x,t.y)/Math.cos(i),t.x=ac(e+(this.long0||0),this.over),t.y=Fd(i),t}const Sp={init:function(){var t;if(this.phi1=this.lat1,Math.abs(this.phi1)<wp)throw new Error;this.es?(this.en=hd(this.es),this.m1=cd(this.phi1,this.am1=Math.sin(this.phi1),t=Math.cos(this.phi1),this.en),this.am1=t/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=Ep,this.forward=bp):(Math.abs(this.phi1)+wp>=yh?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=Tp,this.forward=Mp)},names:["bonne","Bonne (Werner lat_1=90)"]},Cp={OBLIQUE:{forward:function(t,e){let{x:i,y:n}=e;i+=t.long0;const a=Math.cos(i),s=Math.sin(n),r=Math.cos(n);e.x=ac(Math.atan2(r*Math.sin(i),t.sphip*r*a+t.cphip*s)+t.lamp),e.y=Math.asin(t.sphip*s-t.cphip*r*a);const o=t.obliqueProjection.forward(e);return t.isIdentity&&(o.x*=xh,o.y*=xh),o},inverse:function(t,e){t.isIdentity&&(e.x*=vh,e.y*=vh);const i=t.obliqueProjection.inverse(e);let{x:n,y:a}=i;if(n<Number.MAX_VALUE){n-=t.lamp;const i=Math.cos(n),s=Math.sin(a),r=Math.cos(a);e.x=Math.atan2(r*Math.sin(n),t.sphip*r*i-t.cphip*s),e.y=Math.asin(t.sphip*s+t.cphip*r*i)}return e.x=ac(e.x+t.long0),e}},TRANSVERSE:{forward:function(t,e){let{x:i,y:n}=e;i+=t.long0;const a=Math.cos(n),s=Math.cos(i);e.x=ac(Math.atan2(a*Math.sin(i),Math.sin(n))+t.lamp),e.y=Math.asin(-1*a*s);const r=t.obliqueProjection.forward(e);return t.isIdentity&&(r.x*=xh,r.y*=xh),r},inverse:function(t,e){t.isIdentity&&(e.x*=vh,e.y*=vh);const i=t.obliqueProjection.inverse(e);let{x:n,y:a}=i;if(n<Number.MAX_VALUE){const i=Math.cos(a);n-=t.lamp,e.x=Math.atan2(i*Math.sin(n),-1*Math.sin(a)),e.y=Math.asin(i*Math.cos(n))}return e.x=ac(e.x+t.long0),e}}},Lp={ROTATE:{o_alpha:"oAlpha",o_lon_c:"oLongC",o_lat_c:"oLatC"},NEW_POLE:{o_lat_p:"oLatP",o_lon_p:"oLongP"},NEW_EQUATOR:{o_lon_1:"oLong1",o_lat_1:"oLat1",o_lon_2:"oLong2",o_lat_2:"oLat2"}},Rp={init:function(){if(this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.title=this.title||"General Oblique Transformation",this.isIdentity=lc.includes(this.o_proj),!this.o_proj)throw new Error("Missing parameter: o_proj");if("ob_tran"===this.o_proj)throw new Error("Invalid value for o_proj: "+this.o_proj);const t=this.projStr.replace("+proj=ob_tran","").replace("+o_proj=","+proj=").trim(),e=Ic(t);if(!e)throw new Error("Invalid parameter: o_proj. Unknown projection "+this.o_proj);let i;e.long0=0,this.obliqueProjection=e;const n=Object.keys(Lp),a=t=>{if(void 0===this[t])return;const e=parseFloat(this[t])*vh;if(isNaN(e))throw new Error("Invalid value for "+t+": "+this[t]);return e};for(let t=0;t<n.length;t++){const e=n[t],s=Lp[e],r=Object.entries(s);if(r.some(([t])=>void 0!==this[t])){i=s;for(let t=0;t<r.length;t++){const[e,i]=r[t],n=a(e);if(void 0===n)throw new Error("Missing parameter: "+e+".");this[i]=n}break}}if(!i)throw new Error("No valid parameters provided for ob_tran projection.");const{lamp:s,phip:r}=function(t,e){let i,n;if(e===Lp.ROTATE){let e=t.oLongC,a=t.oLatC,s=t.oAlpha;if(Math.abs(Math.abs(a)-yh)<=kh)throw new Error("Invalid value for o_lat_c: "+t.o_lat_c+" should be < 90");n=e+Math.atan2(-1*Math.cos(s),-1*Math.sin(s)*Math.sin(a)),i=Math.asin(Math.cos(a)*Math.sin(s))}else if(e===Lp.NEW_POLE)n=t.oLongP,i=t.oLatP;else{let e=t.oLong1,a=t.oLat1,s=t.oLong2,r=t.oLat2,o=Math.abs(a);if(Math.abs(a)>yh-kh)throw new Error("Invalid value for o_lat_1: "+t.o_lat_1+" should be < 90");if(Math.abs(r)>yh-kh)throw new Error("Invalid value for o_lat_2: "+t.o_lat_2+" should be < 90");if(Math.abs(a-r)<kh)throw new Error("Invalid value for o_lat_1 and o_lat_2: o_lat_1 should be different from o_lat_2");if(o<kh)throw new Error("Invalid value for o_lat_1: o_lat_1 should be different from zero");n=Math.atan2(Math.cos(a)*Math.sin(r)*Math.cos(e)-Math.sin(a)*Math.cos(r)*Math.cos(s),Math.sin(a)*Math.cos(r)*Math.sin(s)-Math.cos(a)*Math.sin(r)*Math.sin(e)),i=Math.atan(-1*Math.cos(n-e)/Math.tan(a))}return{lamp:n,phip:i}}(this,i);this.lamp=s,Math.abs(r)>kh?(this.cphip=Math.cos(r),this.sphip=Math.sin(r),this.projectionType=Cp.OBLIQUE):this.projectionType=Cp.TRANSVERSE},forward:function(t){return this.projectionType.forward(this,t)},inverse:function(t){return this.projectionType.inverse(this,t)},names:["General Oblique Transformation","General_Oblique_Transformation","ob_tran"]},Ip=Object.assign(function(t,e,i){var n,a,s,r=!1;return void 0===e?(a=Vc(t),n=Uc,r=!0):(void 0!==e.x||Array.isArray(e))&&(i=e,a=Vc(t),n=Uc,r=!0),n||(n=Vc(t)),a||(a=Vc(e)),i?Bc(n,a,i):(s={forward:function(t,e){return Bc(n,a,t,e)},inverse:function(t,e){return Bc(a,n,t,e)}},r&&(s.oProj=a),s)},{defaultDatum:"WGS84",Proj:Ic,WGS84:new Ic("WGS84"),Point:rd,toPoint:Dc,defs:Qh,nadgrid:function(t,e,i){return e instanceof ArrayBuffer?function(t,e,i){var n=!0;void 0!==i&&!1===i.includeErrorFields&&(n=!1);var a=new DataView(e),s=function(t){var e=t.getInt32(8,!1);return 11!==e&&(11!==(e=t.getInt32(8,!0))&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}(a),r=function(t,e){return{nFields:t.getInt32(8,e),nSubgridFields:t.getInt32(24,e),nSubgrids:t.getInt32(40,e),shiftType:Tc(t,56,64).trim(),fromSemiMajorAxis:t.getFloat64(120,e),fromSemiMinorAxis:t.getFloat64(136,e),toSemiMajorAxis:t.getFloat64(152,e),toSemiMinorAxis:t.getFloat64(168,e)}}(a,s),o=function(t,e,i,n){for(var a=176,s=[],r=0;r<e.nSubgrids;r++){var o=Cc(t,a,i),l=Lc(t,a,o,i,n),u=Math.round(1+(o.upperLongitude-o.lowerLongitude)/o.longitudeInterval),h=Math.round(1+(o.upperLatitude-o.lowerLatitude)/o.latitudeInterval);s.push({ll:[Mc(o.lowerLongitude),Mc(o.lowerLatitude)],del:[Mc(o.longitudeInterval),Mc(o.latitudeInterval)],lim:[u,h],count:o.gridNodeCount,cvs:Sc(l)});var c=16;!1===n&&(c=8),a+=176+o.gridNodeCount*c}return s}(a,r,s,n),l={header:r,subgrids:o};return xc[t]=l,l}(t,e,i):{ready:wc(t,e)}},transform:Hc,mgrs:qc,version:"__VERSION__"});var Pp;(Pp=Ip).Proj.projections.add(pd),Pp.Proj.projections.add(yd),Pp.Proj.projections.add(kd),Pp.Proj.projections.add(wd),Pp.Proj.projections.add(Ed),Pp.Proj.projections.add(Md),Pp.Proj.projections.add(Sd),Pp.Proj.projections.add(Cd),Pp.Proj.projections.add(Ld),Pp.Proj.projections.add(Gd),Pp.Proj.projections.add(Wd),Pp.Proj.projections.add(Ud),Pp.Proj.projections.add(Bd),Pp.Proj.projections.add(Vd),Pp.Proj.projections.add(Kd),Pp.Proj.projections.add(zd),Pp.Proj.projections.add($d),Pp.Proj.projections.add(Yd),Pp.Proj.projections.add(Xd),Pp.Proj.projections.add(qd),Pp.Proj.projections.add(Zd),Pp.Proj.projections.add(Jd),Pp.Proj.projections.add(Qd),Pp.Proj.projections.add(tp),Pp.Proj.projections.add(np),Pp.Proj.projections.add(cp),Pp.Proj.projections.add(dp),Pp.Proj.projections.add(mp),Pp.Proj.projections.add(fp),Pp.Proj.projections.add(xp),Pp.Proj.projections.add(Sp),Pp.Proj.projections.add(Rp);const Ap=Ip,jp=t=>!(!("properties"in t)||!t.properties)&&"registryItem"in t.properties;var Op,Fp,Np,Gp,Dp,Wp,Hp,Up,Bp,Vp,Kp,zp,$p,Yp;!function(t){t.FI="fi",t.SV="sv",t.EN="en"}(Op||(Op={})),function(t){t.MMLPohjakartta="MMLPohjakartta",t.MMLVanhatKartat="MMLVanhatKartat",t.GTK="GTK",t.MaannousuInfo="MaannousuInfo",t.Museovirasto="Museovirasto",t.Ahvenanmaa="Ahvenanmaa",t.Helsinki="Helsinki",t.Models="Models",t.MaisemanMuisti="MaisemanMuisti",t.Viabundus="Viabundus"}(Fp||(Fp={})),function(t){t.Maastokartta="maastokartta",t.Taustakartta="taustakartta",t.Ortokuva="ortokuva",t.Korkeusmalli25m="mml_korkeusmalli_25m_2000"}(Np||(Np={})),function(t){t["Venlinen_topografinen_kartta_1871_1919"]="mml_ven_topo_21k_1871_1919",t["Venlinen_topografinen_kartta_1870_1944"]="mml_ven_topo_42k_1870_1944",t["Venlinen_topografinen_kartta_192x"]="mml_ven_topo_42k_192x",t["Venlinen_topografinen_kartta_1916_1917"]="mml_ven_topo_84k_1916-1917",t.Yleiskartta_1863_1879="mml_yleiskartta_400k_1863-1879",t.Yleiskartta_1880_1899="mml_yleiskartta_400k_1880-1899",t.Yleiskartta_1900_1919="mml_yleiskartta_400k_1900-1919",t.Yleiskartta_1920_1939="mml_yleiskartta_400k_1920-1939",t.Yleiskartta_1940_1972="mml_yleiskartta_400k_1940-1972",t.Yleiskartta_1954_1975="mml_yleiskartta_400k_1954-1975",t.Yleiskartta_1983_1992="mml_yleiskartta_400k_1983-1992",t.Yleiskartta_1996="mml_yleiskartta_500k_1996",t.Yleiskartta_2000="mml_yleiskartta_500k_2000",t["Pitjkartta_1912_1968"]="mml_pitajakartta_20k_1912-1968",t.Taloudellinen_kartta_1911_1970="mml_taloudellinen_100k_1911-1970",t.Maasto_perus_topografinen_kartta_100k_1928_1947="mml_topo_100k_1928_1947",t.Maasto_perus_topografinen_kartta_100k_1948_1989="mml_topo_100k_1948_1989",t.Maasto_perus_topografinen_kartta_20k_1924_1948="mml_topo_20k_1924-1948",t.Maasto_perus_topografinen_kartta_20k_1947_1959="mml_topo_20k_1947-1959",t.Maasto_perus_topografinen_kartta_20k_1960_1969="mml_topo_20k_1960-1969",t.Maasto_perus_topografinen_kartta_20k_1970_1979="mml_topo_20k_1970-1979",t.Maasto_perus_topografinen_kartta_20k_1980_1997="mml_topo_20k_1980-1997",t.Maasto_perus_topografinen_kartta_50k_1922_1946="mml_topo_50k_1922-1946",t.Maasto_perus_topografinen_kartta_50k_1964_2006="mml_topo_50k_1964-2006",t.Maasto_perus_topografinen_kartta_50k_2005_2020="mml_topo_50k_2005-2020"}(Gp||(Gp={})),function(t){t.Vuosi10000eaa="-10000",t.Vuosi9750eaa="-9750",t.Vuosi9500eaa="-9500",t.Vuosi9250eaa="-9250",t.Vuosi9000eaa="-9000",t.Vuosi8750eaa="-8750",t.Vuosi8500eaa="-8500",t.Vuosi8250eaa="-8250",t.Vuosi8000eaa="-8000",t.Vuosi7750eaa="-7750",t.Vuosi7500eaa="-7500",t.Vuosi7250eaa="-7250",t.Vuosi7000eaa="-7000",t.Vuosi6750eaa="-6750",t.Vuosi6500eaa="-6500",t.Vuosi6250eaa="-6250",t.Vuosi6000eaa="-6000",t.Vuosi5750eaa="-5750",t.Vuosi5500eaa="-5500",t.Vuosi5250eaa="-5250",t.Vuosi5000eaa="-5000",t.Vuosi4750eaa="-4750",t.Vuosi4500eaa="-4500",t.Vuosi4250eaa="-4250",t.Vuosi4000eaa="-4000",t.Vuosi3750eaa="-3750",t.Vuosi3500eaa="-3500",t.Vuosi3250eaa="-3250",t.Vuosi3000eaa="-3000",t.Vuosi2750eaa="-2750",t.Vuosi2500eaa="-2500",t.Vuosi2250eaa="-2250",t.Vuosi2000eaa="-2000",t.Vuosi1750eaa="-1750",t.Vuosi1500eaa="-1500",t.Vuosi1400eaa="-1400",t.Vuosi1300eaa="-1300",t.Vuosi1200eaa="-1200",t.Vuosi1100eaa="-1100",t.Vuosi1000eaa="-1000",t.Vuosi900eaa="-900",t.Vuosi800eaa="-800",t.Vuosi700eaa="-700",t.Vuosi600eaa="-600",t.Vuosi500eaa="-500",t.Vuosi400eaa="-400",t.Vuosi300eaa="-300",t.Vuosi200eaa="-200",t.Vuosi100eaa="-100",t.Vuosi0eaa="0",t.Vuosi100aa="100",t.Vuosi200aa="200",t.Vuosi300aa="300",t.Vuosi400aa="400",t.Vuosi500aa="500",t.Vuosi600aa="600",t.Vuosi700aa="700",t.Vuosi800aa="800",t.Vuosi900aa="900",t.Vuosi1000aa="1000",t.Vuosi1100aa="1100",t.Vuosi1200aa="1200",t.Vuosi1300aa="1300",t.Vuosi1400aa="1400",t.Vuosi1500aa="1500",t.Vuosi1600aa="1600",t.Vuosi1700aa="1700",t.Vuosi1800aa="1800",t.Vuosi1900aa="1900"}(Dp||(Dp={})),function(t){t.Vuosi10000eaa="-10000",t.Vuosi9750eaa="-9750",t.Vuosi9500eaa="-9500",t.Vuosi9250eaa="-9250",t.Vuosi9000eaa="-9000",t.Vuosi8750eaa="-8750",t.Vuosi8500eaa="-8500",t.Vuosi8250eaa="-8250"}(Wp||(Wp={})),function(t){t.Top="top",t.Bottom="bottom"}(Hp||(Hp={})),function(t){t.Muinaisjaannokset_piste="rajapinta_suojellut:muinaisjaannos_piste",t.Muinaisjaannokset_alue="rajapinta_suojellut:muinaisjaannos_alue",t.Suojellut_rakennukset_piste="rajapinta_suojellut:suojellut_rakennukset_piste",t.Suojellut_rakennukset_alue="rajapinta_suojellut:suojellut_rakennukset_alue",t.RKY_alue="rajapinta_suojellut:rky_alue",t.RKY_piste="rajapinta_suojellut:rky_piste",t.RKY_viiva="rajapinta_suojellut:rky_viiva",t.Maailmanperinto_piste="rajapinta_suojellut:maailmanperinto_piste",t.Maailmanperinto_alue="rajapinta_suojellut:maailmanperinto_alue",t.Muu_kulttuuriperintokohde_alue="rajapinta_suojellut:muu_kulttuuriperintokohde_alue",t.Muu_kulttuuriperintokohde_piste="rajapinta_suojellut:muu_kulttuuriperintokohde_piste",t.VARK_alueet="rajapinta_suojellut:vark_alueet",t.VARK_pisteet="rajapinta_suojellut:vark_pisteet",t["Lytpaikka_piste"]="rajapinta:rajapinta_loytopaikka_piste",t["Lytpaikka_alue"]="rajapinta:rajapinta_loytopaikka_alue",t.Alakohde_piste="rajapinta:alakohde_piste",t.Havaintokohde_piste="rajapinta:rajapinta_havaintokohde_piste",t.Havaintokohde_alue="rajapinta:rajapinta_havaintokohde_alue",t.Luonnonmuodostuma_piste="rajapinta:rajapinta_luonnonmuodostuma_piste",t.Luonnonmuodostuma_alue="rajapinta:rajapinta_luonnonmuodostuma_alue",t["Mahdollinen_muinaisjnns_piste"]="rajapinta:rajapinta_mahdollinen_muinaisjaannos_piste",t["Mahdollinen_muinaisjnns_alue"]="rajapinta:rajapinta_mahdollinen_muinaisjaannos_alue",t.Muu_kohde_piste="rajapinta:rajapinta_muu_kohde_piste",t.Muu_kohde_alue="rajapinta:rajapinta_muu_kohde_alue",t["PoistettuKiinteMuijaisjnnsPiste"]="rajapinta:rajapinta_poistettu_kiintea_muinaisjaannos_piste",t["PoistettuKiinteMuijaisjnnsAlue"]="rajapinta:rajapinta_poistettu_kiintea_muinaisjaannos_alue"}(Up||(Up={})),function(t){t.Fornminnen="Fornminnen",t.MaritimaFornminnen="Maritima fornminnen"}(Bp||(Bp={})),function(t){t.ModelLayer="ModelLayer"}(Vp||(Vp={})),function(t){t.MaisemanMuisti="MaisemanMuisti"}(Kp||(Kp={})),function(t){t.muinaisrannat="muinaisrannat",t.maapera_200k_maalaji="maapera_200k_maalaji"}(zp||(zp={})),function(t){t.Maalinnoitus_yksikot="Maalinnoitus_yksikot",t.Maalinnoitus_kohteet="Maalinnoitus_kohteet",t.Maalinnoitus_rajaukset="Maalinnoitus_rajaukset",t.Maalinnoitus_karttatekstit="Maalinnoitus_karttatekstit"}($p||($p={})),function(t){t.Viabundus="Viabundus"}(Yp||(Yp={}));const Xp=[Object.values(Up),Object.values(Bp),Object.values(Vp),Object.values(Kp),Object.values($p),Object.values(Yp)].flat(),qp=t=>!(!("properties"in t)||!t.properties)&&"registerName"in t.properties,Zp=t=>"properties"in t,Jp=t=>"attributes"in t;var Qp,tm,em;!function(t){t["eiMritelty"]="ei mritelty",t.alustenHylyt="alusten hylyt",t.asuinpaikat="asuinpaikat",t.hautapaikat="hautapaikat",t.kirkkorakenteet="kirkkorakenteet",t.kivirakenteet="kivirakenteet",t["kulkuvylt"]="kulkuvylt",t.kulttiJaTarinapaikat="kultti- ja tarinapaikat",t.luonnonmuodostumat="luonnonmuodostumat",t["lytpaikat"]="lytpaikat",t.maarakenteet="maarakenteet",t["muinaisjnnsryhmt"]="muinaisjnnsryhmt",t.puolustusvarustukset="puolustusvarustukset",t.puurakenteet="puurakenteet",t.raakaAineenHankintapaikat="raaka-aineen hankintapaikat",t.tapahtumapaikat="tapahtumapaikat",t.teollisuuskohteet="teollisuuskohteet",t.taideMuistomerkit="taide, muistomerkit",t["tyJaValmistuspaikat"]="ty- ja valmistuspaikat"}(Qp||(Qp={})),function(t){t.moniperiodinen="moniperiodinen",t.esihistoriallinen="esihistoriallinen",t.kivikautinen="kivikautinen",t.varhaismetallikautinen="varhaismetallikautinen",t.pronssikautinen="pronssikautinen",t.rautakautinen="rautakautinen",t.rautakautinenJaTaiKeskiaikainen="rautakautinen ja/tai keskiaikainen",t.keskiaikainen="keskiaikainen",t.historiallinen="historiallinen",t.moderni="moderni",t.ajoittamaton="ajoittamaton",t["eiMritelty"]="ei mritelty"}(tm||(tm={})),function(t){t._1100_LUKU="1100-luku",t._1200_LUKU="1200-luku",t._1300_LUKU="1300-luku",t._1400_LUKU="1400-luku",t._1500_LUKU="1500-luku",t._1600_LUKU="1600-luku",t._1700_LUKU="1700-luku",t._1800_LUKU="1800-luku",t._1900_LUKU="1900-luku",t.VAASA_AIKA_1523_1617="Vaasa-aika 15231617",t.AJOITTAMATON="ajoittamaton",t.AUTONOMIAN_AIKA_1809_1917="autonomian aika 18091917",t.EI_MAARITELTY="ei mritelty",t.ESIHISTORIALLINEN="esihistoriallinen",t.ESIROOMALAINEN_AIKA="esiroomalainen aika",t.HISTORIALLINEN="historiallinen",t.KANSAINVAELLUSAIKA="kansainvaellusaika",t.KESKIAIKAINEN="keskiaikainen",t.KIVIKAUTINEN="kivikautinen",t.MEROVINGIAIKA="merovingiaika",t.MESOLIITTINEN="mesoliittinen",t.MODERNI="moderni",t.NEOLIITTINEN="neoliittinen",t.NUOREMPI_ROOMALAISAIKA="nuorempi roomalaisaika",t.PRONSSIKAUTINEN="pronssikautinen",t.RAUTAKAUTINEN="rautakautinen",t.RAUTAKAUTINEN_JA_TAI_KESKIAIKAINEN="rautakautinen ja/tai keskiaikainen",t.RISTIRETKIAIKA="ristiretkiaika",t.SUURVALTA_AIKA_1617_1721="suurvalta-aika 16171721",t.TOINEN_MAAILMANSOTA_1939_1945="toinen maailmansota 19391945",t.VANHEMPI_ROOMALAISAIKA="vanhempi roomalaisaika",t.VAPAUDEN_AIKA_JA_KUSTAVILAINEN_AIKA_1721_1809="vapauden aika ja kustavilainen aika 17211809",t.VARHAISMETALLIKAUTINEN="varhaismetallikautinen",t.VIIKINKIAIKA="viikinkiaika"}(em||(em={}));const im=t=>t.id?.toString().startsWith("muinaisjaannos_piste.")??!1,nm=t=>t.id?.toString().startsWith("muinaisjaannos_alue.")??!1,am=t=>t.id?.toString().startsWith("muu_kulttuuriperintokohde_piste.")??!1,sm=t=>t.id?.toString().startsWith("muu_kulttuuriperintokohde_alue.")??!1,rm=t=>t.id?.toString().startsWith("suojellut_rakennukset_piste.")??!1,om=t=>t.id?.toString().startsWith("suojellut_rakennukset_alue.")??!1,lm=t=>t.id?.toString().startsWith("rky_alue.")??!1,um=t=>t.id?.toString().startsWith("rky_piste.")??!1,hm=t=>t.id?.toString().startsWith("rky_viiva.")??!1,cm=t=>t.id?.toString().startsWith("maailmanperinto_piste.")??!1,dm=t=>t.id?.toString().startsWith("maailmanperinto_alue.")??!1,pm=t=>t.id?.toString().startsWith("vark_pisteet.")??!1,mm=t=>t.id?.toString().startsWith("vark_alueet.")??!1,fm=t=>t.id?.toString().startsWith("rajapinta_loytopaikka_piste.")??!1,gm=t=>t.id?.toString().startsWith("rajapinta_loytopaikka_alue.")??!1,_m=t=>t.id?.toString().startsWith("rajapinta_muu_kohde_piste.")??!1,ym=t=>t.id?.toString().startsWith("rajapinta_muu_kohde_alue.")??!1,km=t=>t.id?.toString().startsWith("rajapinta_luonnonmuodostuma_piste.")??!1,vm=t=>t.id?.toString().startsWith("rajapinta_luonnonmuodostuma_piste.")??!1,xm=t=>t.id?.toString().startsWith("alakohde_piste.")??!1,wm=t=>t.id?.toString().startsWith("rajapinta_havaintokohde_piste.")??!1,bm=t=>t.id?.toString().startsWith("rajapinta_havaintokohde_alue.")??!1,Em=t=>t.id?.toString().startsWith("rajapinta_mahdollinen_muinaisjaannos_piste.")??!1,Mm=t=>t.id?.toString().startsWith("rajapinta_mahdollinen_muinaisjaannos_alue.")??!1,Tm=t=>t.id?.toString().startsWith("rajapinta_poistettu_kiintea_muinaisjaannos_piste.")??!1,Sm=t=>t.id?.toString().startsWith("rajapinta_poistettu_kiintea_muinaisjaannos_alue.")??!1,Cm=t=>Lm(t)||Rm(t),Lm=t=>im(t)||am(t)||fm(t)||_m(t)||km(t)||wm(t)||Em(t)||Tm(t)||xm(t),Rm=t=>nm(t)||sm(t)||gm(t)||ym(t)||vm(t)||Mm(t)||Sm(t)||bm(t),Im=t=>{switch(t){case Up.Muinaisjaannokset_piste:case Up.Muinaisjaannokset_alue:case Up.Muu_kulttuuriperintokohde_alue:case Up.Muu_kulttuuriperintokohde_piste:case Up.Suojellut_rakennukset_alue:case Up.Suojellut_rakennukset_piste:case Up.RKY_alue:case Up.RKY_piste:case Up.RKY_viiva:case Up.Lytpaikka_piste:case Up.Lytpaikka_alue:case Up.Havaintokohde_piste:case Up.Havaintokohde_alue:case Up.Luonnonmuodostuma_piste:case Up.Luonnonmuodostuma_alue:case Up.Mahdollinen_muinaisjnns_piste:case Up.Mahdollinen_muinaisjnns_alue:case Up.Muu_kohde_piste:case Up.Muu_kohde_alue:case Up.PoistettuKiinteMuijaisjnnsPiste:case Up.PoistettuKiinteMuijaisjnnsAlue:case Up.Alakohde_piste:return"kohdenimi";case Up.Maailmanperinto_piste:return"nimi";case Up.Maailmanperinto_alue:return"Nimi";case Up.VARK_pisteet:case Up.VARK_alueet:return"VARK_nimi"}};var Pm,Am,jm;!function(t){t.road="road",t.place="place",t.townOutline="townOutline"}(Pm||(Pm={})),function(t){t.canal="canal",t.coast="coast",t.ferry="ferry",t.land="land",t.river="river",t.winter="winter"}(Am||(Am={})),function(t){t[t.VeryCertain=1]="VeryCertain",t[t.Mediocre=2]="Mediocre",t[t.Uncertain=3]="Uncertain"}(jm||(jm={}));const Om=t=>!!t.properties&&"type"in t.properties&&t.properties.type===Pm.place,Fm=t=>!!t.properties&&"type"in t.properties&&t.properties.type===Pm.road,Nm=t=>!!t.properties&&"type"in t.properties&&t.properties.type===Pm.townOutline,Gm=t=>"properties"in t&&(Om(t)||Fm(t)||Nm(t));var Dm;!function(t){t.FIRST_USER_LOCATION_DETECTION_COMPLETE="FIRST_USER_LOCATION_DETECTION_COMPLETE",t.CENTER_MAP_TO_CURRENT_POSITION="CENTER_MAP_TO_CURRENT_POSITION",t.SET_LINKED_FEATURE="SET_LINKED_FEATURE",t.CENTER_MAP_TO_LINKED_FEATURE="CENTER_MAP_TO_LINKED_FEATURE",t.SEARCH_FEATURES="SEARCH_FEATURES",t.SEARCH_FEATURES_COMPLETE="SEARCH_FEATURES_COMPLETE",t.IDENTIFY_MAP_FEATURES_ON_COORDINATE="IDENTIFY_MAP_FEATURES_ON_COORDINATE",t.MAP_FEATURE_IDENTIFICATION_COMPLETE="MAP_FEATURE_IDENTIFICATION_COMPLETE",t.SELECT_VISIBLE_LAYERS="SELECT_VISIBLE_LAYERS",t.CHANGE_LAYER_OPACITY="CHANGE_LAYER_OPACITY",t.ENABLE_LAYER_GROUP="ENABLE_LAYER_GROUP",t["SELECT_VISIBLE_MUINAISJNNS_TYPE"]="SELECT_VISIBLE_MUINAISJNNS_TYPE",t["SELECT_VISIBLE_MUINAISJNNS_DATING"]="SELECT_VISIBLE_MUINAISJNNS_DATING",t.CHANGE_LANGUAGE="CHANGE_LANGUAGE",t.SHOW_LOADING_ANIMATION="SHOW_LOADING_ANIMATION",t.SHOW_PAGE="SHOW_PAGE",t.ZOOM="ZOOM",t.ZOOM_CHANGED="ZOOM_CHANGED",t.MAP_CENTER_CHANGED="MAP_CENTER_CHANGED",t.MOVE_MAANNOUSU_LAYER="MOVE_MAANNOUSU_LAYER",t.SELECT_VIABUNDUS_YEAR="SELECT_VIABUNDUS_YEAR"}(Dm||(Dm={}));const Wm=class extends L{constructor(t,e,i){super(),i=i||{},this.tileCoord=t,this.state=e,this.key="",this.transition_=void 0===i.transition?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(o)}release(){this.setState(4)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(4!==this.state){if(3!==this.state&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}}load(){O()}getAlpha(t,e){if(!this.transition_)return 1;let i=this.transitionStarts_[t];if(i){if(-1===i)return 1}else i=e,this.transitionStarts_[t]=i;const n=e-i+1e3/60;return n>=this.transition_?1:sa(n/this.transition_)}inTransition(t){return!!this.transition_&&-1!==this.transitionStarts_[t]}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}disposeInternal(){this.release(),super.disposeInternal()}};function Hm(t){return t instanceof Image||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageBitmap?t:null}function Um(t){return t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Float32Array||t instanceof DataView?t:null}const Bm=new Error("disposed");let Vm=null;const Km=[256,256],zm=class extends Wm{constructor(t){super(t.tileCoord,0,{transition:t.transition,interpolate:t.interpolate}),this.loader_=t.loader,this.data_=null,this.error_=null,this.size_=t.size||null,this.controller_=t.controller||null}getSize(){if(this.size_)return this.size_;const t=Hm(this.data_);return t?[t.width,t.height]:Km}getData(){return this.data_}getError(){return this.error_}load(){if(0!==this.state&&3!==this.state)return;this.state=1,this.changed();const t=this;this.loader_().then(function(e){t.data_=e,t.state=2,t.changed()}).catch(function(e){t.error_=e,t.state=3,t.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(Bm),this.controller_=null),super.disposeInternal()}},$m=class extends Wm{constructor(t,e,i,n,a,s){super(t,e,s),this.crossOrigin_=n,this.src_=i,this.key=i,this.image_,Hn?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,null!==n&&(this.image_.crossOrigin=n)),this.unlisten_=null,this.tileLoadFunction_=a}getImage(){return this.image_}setImage(t){this.image_=t,this.state=2,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=3,this.unlistenImage_(),this.image_=function(){const t=Ta(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}(),this.changed()}handleImageLoad_(){if(Hn)this.state=2;else{const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=2:this.state=4}this.unlistenImage_(),this.changed()}load(){3==this.state&&(this.state=0,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),0==this.state&&(this.state=1,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=function(t,e,i){const n=t;let a=!0,s=!1,r=!1;const o=[I(n,"load",function(){r=!0,s||e()})];return n.src&&Un?(s=!0,n.decode().then(function(){a&&e()}).catch(function(t){a&&(r?e():i())})):o.push(I(n,"error",i)),function(){a=!1,o.forEach(P)}}(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}};class Ym{constructor(t,e,i,n){this.minX=t,this.maxX=e,this.minY=i,this.maxY=n}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function Xm(t,e,i,n,a){return void 0!==a?(a.minX=t,a.maxX=e,a.minY=i,a.maxY=n,a):new Ym(t,e,i,n)}const qm=Ym;let Zm;const Jm=[];function Qm(t,e,i,n,a){t.beginPath(),t.moveTo(0,0),t.lineTo(e,i),t.lineTo(n,a),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,n)+1,Math.max(i,a)),t.restore()}function tf(t,e){return Math.abs(t[4*e]-210)>2||Math.abs(t[4*e+3]-191.25)>2}function ef(t,e,i,n){const a=ai(i,e,t);let s=Xe(e,n,i);const r=e.getMetersPerUnit();void 0!==r&&(s*=r);const o=t.getMetersPerUnit();void 0!==o&&(s/=o);const l=t.getExtent();if(!l||q(l,a)){const e=Xe(t,s,a)/s;isFinite(e)&&e>0&&(s/=e)}return s}function nf(t,e,i,n){const a=pt(i);let s=ef(t,e,a,n);return(!isFinite(s)||s<=0)&&ut(i,function(i){return s=ef(t,e,i,n),isFinite(s)&&s>0}),s}const af=class{constructor(t,e,i,n,a,s,r){this.sourceProj_=t,this.targetProj_=e;let o={};const l=r?Je(t=>vi(r,ai(t,this.targetProj_,this.sourceProj_))):ni(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){const e=t[0]+"/"+t[1];return o[e]||(o[e]=l(t)),o[e]},this.maxSourceExtent_=n,this.errorThresholdSquared_=a*a,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&xt(n)>=xt(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?xt(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?xt(this.targetProj_.getExtent()):null;const u=kt(i),h=vt(i),c=dt(i),d=ct(i),p=this.transformInv_(u),m=this.transformInv_(h),f=this.transformInv_(c),g=this.transformInv_(d),_=10+(s?Math.max(0,Math.ceil(Math.log2(ht(i)/(s*s*256*256)))):0);if(this.addQuad_(u,h,c,d,p,m,f,g,_),this.wrapsXInSource_){let t=1/0;this.triangles_.forEach(function(e,i,n){t=Math.min(t,e.source[0][0],e.source[1][0],e.source[2][0])}),this.triangles_.forEach(e=>{if(Math.max(e.source[0][0],e.source[1][0],e.source[2][0])-t>this.sourceWorldWidth_/2){const i=[[e.source[0][0],e.source[0][1]],[e.source[1][0],e.source[1][1]],[e.source[2][0],e.source[2][1]]];i[0][0]-t>this.sourceWorldWidth_/2&&(i[0][0]-=this.sourceWorldWidth_),i[1][0]-t>this.sourceWorldWidth_/2&&(i[1][0]-=this.sourceWorldWidth_),i[2][0]-t>this.sourceWorldWidth_/2&&(i[2][0]-=this.sourceWorldWidth_);const n=Math.min(i[0][0],i[1][0],i[2][0]);Math.max(i[0][0],i[1][0],i[2][0])-n<this.sourceWorldWidth_/2&&(e.source=i)}})}o={}}addTriangle_(t,e,i,n,a,s){this.triangles_.push({source:[n,a,s],target:[t,e,i]})}addQuad_(t,e,i,n,a,s,r,o,l){const u=z([a,s,r,o]),h=this.sourceWorldWidth_?xt(u)/this.sourceWorldWidth_:null,c=this.sourceWorldWidth_,d=this.sourceProj_.canWrapX()&&h>.5&&h<1;let p=!1;if(l>0&&(this.targetProj_.isGlobal()&&this.targetWorldWidth_&&(p=xt(z([t,e,i,n]))/this.targetWorldWidth_>.25||p),!d&&this.sourceProj_.isGlobal()&&h&&(p=h>.25||p)),!p&&this.maxSourceExtent_&&isFinite(u[0])&&isFinite(u[1])&&isFinite(u[2])&&isFinite(u[3])&&!wt(u,this.maxSourceExtent_))return;let m=0;if(!(p||isFinite(a[0])&&isFinite(a[1])&&isFinite(s[0])&&isFinite(s[1])&&isFinite(r[0])&&isFinite(r[1])&&isFinite(o[0])&&isFinite(o[1])))if(l>0)p=!0;else if(m=(isFinite(a[0])&&isFinite(a[1])?0:8)+(isFinite(s[0])&&isFinite(s[1])?0:4)+(isFinite(r[0])&&isFinite(r[1])?0:2)+(isFinite(o[0])&&isFinite(o[1])?0:1),1!=m&&2!=m&&4!=m&&8!=m)return;if(l>0){if(!p){const e=[(t[0]+i[0])/2,(t[1]+i[1])/2],n=this.transformInv_(e);let s;s=d?(Pt(a[0],c)+Pt(r[0],c))/2-Pt(n[0],c):(a[0]+r[0])/2-n[0];const o=(a[1]+r[1])/2-n[1];p=s*s+o*o>this.errorThresholdSquared_}if(p){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){const u=[(e[0]+i[0])/2,(e[1]+i[1])/2],h=this.transformInv_(u),c=[(n[0]+t[0])/2,(n[1]+t[1])/2],d=this.transformInv_(c);this.addQuad_(t,e,u,c,a,s,h,d,l-1),this.addQuad_(c,u,i,n,d,h,r,o,l-1)}else{const u=[(t[0]+e[0])/2,(t[1]+e[1])/2],h=this.transformInv_(u),c=[(i[0]+n[0])/2,(i[1]+n[1])/2],d=this.transformInv_(c);this.addQuad_(t,u,c,n,a,h,d,o,l-1),this.addQuad_(u,e,i,c,h,s,r,d,l-1)}return}}if(d){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}11&m||this.addTriangle_(t,i,n,a,r,o),14&m||this.addTriangle_(t,i,e,a,r,s),m&&(13&m||this.addTriangle_(e,n,t,s,o,a),7&m||this.addTriangle_(e,n,i,s,o,r))}calculateSourceExtent(){const t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach(function(e,i,n){const a=e.source;rt(t,a[0]),rt(t,a[1]),rt(t,a[2])}),t}getTriangles(){return this.triangles_}},sf=class extends Wm{constructor(t,e,i,n,a,s,r,o,l,u,h,c){super(a,0,c),this.renderEdges_=void 0!==h&&h,this.pixelRatio_=r,this.gutter_=o,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=n,this.wrappedTileCoord_=s||a,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=t.canWrapX()?t.getExtent():void 0;const d=n.getTileCoordExtent(this.wrappedTileCoord_),p=this.targetTileGrid_.getExtent();let m=this.sourceTileGrid_.getExtent();const f=p?yt(d,p):d;if(0===ht(f))return void(this.state=4);const g=t.getExtent();g&&(m=m?yt(m,g):g);const _=n.getResolution(this.wrappedTileCoord_[0]),y=nf(t,i,f,_);if(!isFinite(y)||y<=0)return void(this.state=4);const k=void 0!==u?u:.5;if(this.triangulation_=new af(t,i,f,m,y*k,_),0===this.triangulation_.getTriangles().length)return void(this.state=4);this.sourceZ_=e.getZForResolution(y);let v=this.triangulation_.calculateSourceExtent();if(m&&(t.canWrapX()?(v[1]=St(v[1],m[1],m[3]),v[3]=St(v[3],m[1],m[3])):v=yt(v,m)),ht(v)){let i=0,n=0;t.canWrapX()&&(i=xt(g),n=Math.floor((v[0]-g[0])/i)),Tt(v.slice(),t,!0).forEach(t=>{const a=e.getTileRangeForExtentAndZ(t,this.sourceZ_);for(let t=a.minX;t<=a.maxX;t++)for(let e=a.minY;e<=a.maxY;e++){const a=l(this.sourceZ_,t,e,r);if(a){const t=n*i;this.sourceTiles_.push({tile:a,offset:t})}}++n}),0===this.sourceTiles_.length&&(this.state=4)}else this.state=4}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach(e=>{const i=e.tile;if(i&&2==i.getState()){const n=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);n[0]+=e.offset,n[2]+=e.offset;const a=this.clipExtent_?.slice();a&&(a[0]+=e.offset,a[2]+=e.offset),t.push({extent:n,clipExtent:a,image:i.getImage()})}}),this.sourceTiles_.length=0,0===t.length)this.state=3;else{const e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),n="number"==typeof i?i:i[0],a="number"==typeof i?i:i[1],s=this.targetTileGrid_.getResolution(e),r=this.sourceTileGrid_.getResolution(this.sourceZ_),o=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=function(t,e,i,n,a,s,r,o,l,u,h,c,d,p){const m=Ta(Math.round(i*t),Math.round(i*e),Jm);if(c||(m.imageSmoothingEnabled=!1),0===l.length)return m.canvas;function f(t){return Math.round(t*i)/i}m.scale(i,i),m.globalCompositeOperation="lighter";const g=[1/0,1/0,-1/0,-1/0];let _;l.forEach(function(t,e,i){st(g,t.extent)});const y=i/n,k=(c?1:1+Math.pow(2,-24))/y;if(!d||1!==l.length||0!==u){if(_=Ta(Math.round(xt(g)*y),Math.round(_t(g)*y),Jm),c||(_.imageSmoothingEnabled=!1),a&&p){const t=(a[0]-g[0])*y,e=-(a[3]-g[3])*y,i=xt(a)*y,n=_t(a)*y;_.rect(t,e,i,n),_.clip()}l.forEach(function(t,e,i){if(t.image.width>0&&t.image.height>0){if(t.clipExtent){_.save();const e=(t.clipExtent[0]-g[0])*y,i=-(t.clipExtent[3]-g[3])*y,n=xt(t.clipExtent)*y,a=_t(t.clipExtent)*y;_.rect(c?e:Math.round(e),c?i:Math.round(i),c?n:Math.round(e+n)-Math.round(e),c?a:Math.round(i+a)-Math.round(i)),_.clip()}const e=(t.extent[0]-g[0])*y,i=-(t.extent[3]-g[3])*y,n=xt(t.extent)*y,a=_t(t.extent)*y;_.drawImage(t.image,u,u,t.image.width-2*u,t.image.height-2*u,c?e:Math.round(e),c?i:Math.round(i),c?n:Math.round(e+n)-Math.round(e),c?a:Math.round(i+a)-Math.round(i)),t.clipExtent&&_.restore()}})}const v=kt(r);return o.getTriangles().forEach(function(t,e,i){const n=t.source,a=t.target;let r=n[0][0],o=n[0][1],u=n[1][0],h=n[1][1],d=n[2][0],p=n[2][1];const y=f((a[0][0]-v[0])/s),x=f(-(a[0][1]-v[1])/s),w=f((a[1][0]-v[0])/s),b=f(-(a[1][1]-v[1])/s),E=f((a[2][0]-v[0])/s),M=f(-(a[2][1]-v[1])/s),T=r,S=o;r=0,o=0,u-=T,h-=S,d-=T,p-=S;const C=function(t){const e=t.length;for(let i=0;i<e;i++){let n=i,a=Math.abs(t[i][i]);for(let s=i+1;s<e;s++){const e=Math.abs(t[s][i]);e>a&&(a=e,n=s)}if(0===a)return null;const s=t[n];t[n]=t[i],t[i]=s;for(let n=i+1;n<e;n++){const a=-t[n][i]/t[i][i];for(let s=i;s<e+1;s++)i==s?t[n][s]=0:t[n][s]+=a*t[i][s]}}const i=new Array(e);for(let n=e-1;n>=0;n--){i[n]=t[n][e]/t[n][n];for(let a=n-1;a>=0;a--)t[a][e]-=t[a][n]*i[n]}return i}([[u,h,0,0,w-y],[d,p,0,0,E-y],[0,0,u,h,b-x],[0,0,d,p,M-x]]);if(!C)return;if(m.save(),m.beginPath(),function(){if(void 0===Zm){const t=Ta(6,6,Jm);t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",Qm(t,4,5,4,0),Qm(t,4,5,0,5);const e=t.getImageData(0,0,3,3).data;Zm=tf(e,0)||tf(e,4)||tf(e,8),La(t),Jm.push(t.canvas)}return Zm}()||!c){m.moveTo(w,b);const t=4,e=y-w,i=x-b;for(let n=0;n<t;n++)m.lineTo(w+f((n+1)*e/t),b+f(n*i/(t-1))),n!=t-1&&m.lineTo(w+f((n+1)*e/t),b+f((n+1)*i/(t-1)));m.lineTo(E,M)}else m.moveTo(w,b),m.lineTo(y,x),m.lineTo(E,M);let L;if(m.clip(),m.transform(C[0],C[2],C[1],C[3],y,x),m.translate(g[0]-T,g[3]-S),_)L=_.canvas,m.scale(k,-k);else{const t=l[0],e=t.extent;L=t.image,m.scale(xt(e)/L.width,-_t(e)/L.height)}m.drawImage(L,0,0),m.restore()}),_&&(La(_),Jm.push(_.canvas)),h&&(m.save(),m.globalCompositeOperation="source-over",m.strokeStyle="black",m.lineWidth=1,o.getTriangles().forEach(function(t,e,i){const n=t.target,a=(n[0][0]-v[0])/s,r=-(n[0][1]-v[1])/s,o=(n[1][0]-v[0])/s,l=-(n[1][1]-v[1])/s,u=(n[2][0]-v[0])/s,h=-(n[2][1]-v[1])/s;m.beginPath(),m.moveTo(o,l),m.lineTo(a,r),m.lineTo(u,h),m.closePath(),m.stroke()}),m.restore()),m.canvas}(n,a,this.pixelRatio_,r,this.sourceTileGrid_.getExtent(),s,o,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=2}this.changed()}load(){if(0==this.state){this.state=1,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:e})=>{const i=e.getState();if(0==i||1==i){t++;const i=R(e,o,n=>{const a=e.getState();2!=a&&3!=a&&4!=a||(P(i),t--,0===t&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(i)}}),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},e,i){0==t.getState()&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(P),this.sourcesListenerKeys_=null}release(){this.canvas_&&(La(this.canvas_.getContext("2d")),Jm.push(this.canvas_),this.canvas_=null),super.release()}},rf=class{constructor(t){this.highWaterMark=void 0!==t?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const t=this.pop();t instanceof m&&t.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const i=this.entries_[t];return B(void 0!==i,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(t){const e=this.entries_[t];return B(void 0!==e,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e,i=0;for(e=this.newest_;e;e=e.older)t[i++]=e.key_;return t}getValues(){const t=new Array(this.count_);let e,i=0;for(e=this.newest_;e;e=e.older)t[i++]=e.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){return this.entries_[t]?.value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){B(!(t in this.entries_),"Tried to set a value for a key that is used already");const i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_}setSize(t){this.highWaterMark=t}};function of(t,e,i,n){return void 0!==n?(n[0]=t,n[1]=e,n[2]=i,n):[t,e,i]}function lf(t,e,i){return t+"/"+e+"/"+i}function uf(t){return lf(t[0],t[1],t[2])}function hf(t,e,i,n,a){return`${N(t)},${e},${lf(i,n,a)}`}function cf(t){return e=t[0],(t[1]<<e)+t[2];var e}const df=class{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(Ca(),{get:(t,e)=>{if("function"==typeof Ca()[e])return this.push_(e),this.pushMethodArgs_},set:(t,e,i)=>(this.push_(e,i),!0)})}push_(...t){const e=this.instructions_,i=this.zIndex+this.offset_;e[i]||(e[i]=[]),e[i].push(...t)}pushMethodArgs_=(...t)=>(this.push_(t),this);pushFunction(t){this.push_(t)}getContext(){return this.context_}draw(t){this.instructions_.forEach(e=>{for(let i=0,n=e.length;i<n;++i){const n=e[i];if("function"==typeof n){n(t);continue}const a=e[++i];if("function"==typeof t[n])t[n](...a);else{if("function"==typeof a){t[n]=a(t);continue}t[n]=a}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}},pf=class extends j{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.staleKeys_=new Array,this.maxStaleKeys=5}getStaleKeys(){return this.staleKeys_}prependStaleKey(t){this.staleKeys_.unshift(t),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(t){return O()}getData(t){return null}prepareFrame(t){return O()}renderFrame(t,e){return O()}forEachFeatureAtCoordinate(t,e,i,n,a){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const e=t.target;2!==e.getState()&&3!==e.getState()||this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return 2!=e&&3!=e&&t.addEventListener(o,this.boundHandleImageChange_),0==e&&(t.load(),e=t.getState()),2==e}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&"ready"===t.getSourceState()&&t.changed()}renderDeferred(t){}disposeInternal(){delete this.layer_,super.disposeInternal()}},mf=[];let ff=null;const gf=class extends pf{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=[1,0,0,1,0,0],this.pixelTransform=[1,0,0,1,0,0],this.inversePixelTransform=[1,0,0,1,0,0],this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(t,e,i){let n;ff||(ff=Ta(1,1,void 0,{willReadFrequently:!0})),ff.clearRect(0,0,1,1);try{ff.drawImage(t,e,i,1,1,0,0,1,1),n=ff.getImageData(0,0,1,1).data}catch{return ff=null,null}return n}getBackground(t){let e=this.getLayer().getBackground();return"function"==typeof e&&(e=e(t.viewState.resolution)),e||void 0}useContainer(t,e,i){const n=this.getLayer().getClassName();let a,s;if(t&&t.className===n&&(!i||t&&t.style.backgroundColor&&v(xr(t.style.backgroundColor),xr(i)))){const e=t.firstElementChild;Pa(e)&&(s=e.getContext("2d"))}if(s&&function(t,e){const i=Mi(t),n=Mi(e);for(let t=0;t<6;++t)if(0!==Math.round((i[t]-n[t])*Ei[t]))return!1;return!0}(s.canvas.style.transform,e)?(this.container=t,this.context=s,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){a=Hn?Ia():document.createElement("div"),a.className=n;let t=a.style;t.position="absolute",t.width="100%",t.height="100%",s=Ta();const e=s.canvas;a.appendChild(e),t=e.style,t.position="absolute",t.left="0",t.transformOrigin="top left",this.container=a,this.context=s}this.containerReused||!i||this.container.style.backgroundColor||(this.container.style.backgroundColor=i)}clipUnrotated(t,e,i){const n=kt(i),a=vt(i),s=dt(i),r=ct(i);vi(e.coordinateToPixelTransform,n),vi(e.coordinateToPixelTransform,a),vi(e.coordinateToPixelTransform,s),vi(e.coordinateToPixelTransform,r);const o=this.inversePixelTransform;vi(o,n),vi(o,a),vi(o,s),vi(o,r),t.save(),t.beginPath(),t.moveTo(Math.round(n[0]),Math.round(n[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.clip()}prepareContainer(t,e){const i=t.extent,n=t.viewState.resolution,a=t.viewState.rotation,s=t.pixelRatio,r=Math.round(xt(i)/n*s),o=Math.round(_t(i)/n*s);wi(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/s,1/s,a,-r/2,-o/2),bi(this.inversePixelTransform,this.pixelTransform);const l="matrix("+this.pixelTransform.join(", ")+")";if(this.useContainer(e,l,this.getBackground(t)),!this.containerReused){const t=this.context.canvas;t.width!=r||t.height!=o?(t.width=r,t.height=o):this.context.clearRect(0,0,r,o),l!==t.style.transform&&(t.style.transform=l)}}dispatchRenderEvent_(t,e,i){const n=this.getLayer();if(n.hasListener(t)){const a=new fu(t,this.inversePixelTransform,i,e);n.dispatchEvent(a)}}preRender(t,e){this.frameState=e,e.declutter||this.dispatchRenderEvent_(Ps,t,e)}postRender(t,e){e.declutter||this.dispatchRenderEvent_(As,t,e)}renderDeferredInternal(t){}getRenderContext(t){return t.declutter&&!this.deferredContext_&&(this.deferredContext_=new df),t.declutter?this.deferredContext_.getContext():this.context}renderDeferred(t){t.declutter&&(this.dispatchRenderEvent_(Ps,this.context,t),t.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(t),this.dispatchRenderEvent_(As,this.context,t))}getRenderTransform(t,e,i,n,a,s,r){const o=a/2,l=s/2,u=n/e,h=-u,c=-t[0]+r,d=-t[1];return wi(this.tempTransform,o,l,u,h,-i,c,d)}disposeInternal(){delete this.frameState,super.disposeInternal()}};function _f(t,e,i){if(!(i in t))return t[i]=new Set([e]),!0;const n=t[i],a=n.has(e);return a||n.add(e),!a}function yf(t,e,i){const n=t[i];return!!n&&n.delete(e)}function kf(t,e){const i=t.layerStatesArray[t.layerIndex];i.extent&&(e=yt(e,ci(i.extent,t.viewState.projection)));const n=i.layer.getRenderSource();if(!n.getWrapX()){const i=n.getTileGridForProjection(t.viewState.projection).getExtent();i&&(e=yt(e,i))}return e}const vf=class extends gf{constructor(t,e){super(t),e=e||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=[1/0,1/0,-1/0,-1/0],this.tempTileRange_=new qm(0,0,0,0),this.tempTileCoord_=of(0,0,0);const i=void 0!==e.cacheSize?e.cacheSize:512;this.tileCache_=new rf(i),this.sourceTileCache_=null,this.maxStaleKeys=.5*i}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new rf(512)),this.sourceTileCache_}getOrCreateTile(t,e,i,n){const a=this.tileCache_,s=this.getLayer().getSource(),r=hf(s,s.getKey(),t,e,i);let o;if(a.containsKey(r))o=a.get(r);else{const l=n.viewState.projection,u=s.getProjection();if(o=s.getTile(t,e,i,n.pixelRatio,l,!u||ti(u,l)?void 0:this.getSourceTileCache()),!o)return null;a.set(r,o)}return o}getTile(t,e,i,n){return this.getOrCreateTile(t,e,i,n)||null}getData(t){const e=this.frameState;if(!e)return null;const i=this.getLayer(),n=vi(e.pixelToCoordinateTransform,t.slice()),a=i.getExtent();if(a&&!q(a,n))return null;const s=e.viewState,r=i.getRenderSource(),o=r.getTileGridForProjection(s.projection),l=r.getTilePixelRatio(e.pixelRatio);for(let t=o.getZForResolution(s.resolution);t>=o.getMinZoom();--t){const i=o.getTileCoordForCoordAndZ(n,t),a=this.getTile(t,i[1],i[2],e);if(!a||2!==a.getState())continue;const u=o.getOrigin(t),h=Mr(o.getTileSize(t)),c=o.getResolution(t);let d;if(a instanceof $m||a instanceof sf)d=a.getImage();else{if(!(a instanceof zm))continue;if(d=Hm(a.getData()),!d)continue}const p=Math.floor(l*((n[0]-u[0])/c-i[1]*h[0])),m=Math.floor(l*((u[1]-n[1])/c-i[2]*h[1])),f=Math.round(l*r.getGutterForProjection(s.projection));return this.getImageData(d,p+f,m+f)}return null}prepareFrame(t){this.renderedProjection?t.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=t.viewState.projection):this.renderedProjection=t.viewState.projection;const e=this.getLayer().getSource();if(!e)return!1;const i=e.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==i&&(this.renderedSourceRevision_=i,this.renderedSourceKey_===e.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=i,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(t,e,i,n,a){const s=t.viewState,r=this.getLayer(),o=r.getRenderSource(),l=o.getTileGridForProjection(s.projection),u=N(o);u in t.wantedTiles||(t.wantedTiles[u]={});const h=t.wantedTiles[u],c=r.getMapInternal(),d=Math.max(i-a,l.getMinZoom(),l.getZForResolution(Math.min(r.getMaxResolution(),c?c.getView().getResolutionForZoom(Math.max(r.getMinZoom(),0)):l.getResolution(0)),o.zDirection)),p=s.rotation,m=p?gt(s.center,s.resolution,p,t.size):void 0;for(let a=i;a>=d;--a){const i=l.getTileRangeForExtentAndZ(e,a,this.tempTileRange_),s=l.getResolution(a);for(let e=i.minX;e<=i.maxX;++e)for(let r=i.minY;r<=i.maxY;++r){if(p&&!l.tileCoordIntersectsViewport([a,e,r],m))continue;const i=this.getTile(a,e,r,t);if(!i)continue;if(!_f(n,i,a))continue;const o=i.getKey();if(h[o]=!0,0===i.getState()&&!t.tileQueue.isKeyQueued(o)){const n=of(a,e,r,this.tempTileCoord_);t.tileQueue.enqueue([i,u,l.getTileCoordCenter(n),s])}}}}findStaleTile_(t,e){const i=this.tileCache_,n=t[0],a=t[1],s=t[2],r=this.getStaleKeys();for(let t=0;t<r.length;++t){const o=hf(this.getLayer().getSource(),r[t],n,a,s);if(i.containsKey(o)){const t=i.peek(o);if(2===t.getState())return t.endTransition(N(this)),_f(e,t,n),!0}}return!1}findAltTiles_(t,e,i,n){const a=t.getTileRangeForTileCoordAndZ(e,i,this.tempTileRange_);if(!a)return!1;let s=!0;const r=this.tileCache_,o=this.getLayer().getRenderSource(),l=o.getKey();for(let t=a.minX;t<=a.maxX;++t)for(let e=a.minY;e<=a.maxY;++e){const a=hf(o,l,i,t,e);let u=!1;if(r.containsKey(a)){const t=r.peek(a);2===t.getState()&&(_f(n,t,i),u=!0)}u||(s=!1)}return s}renderFrame(t,e){this.renderComplete=!0;const i=t.layerStatesArray[t.layerIndex],n=t.viewState,a=n.projection,s=n.resolution,r=n.center,o=t.pixelRatio,l=this.getLayer(),u=l.getSource(),h=u.getTileGridForProjection(a),c=h.getZForResolution(s,u.zDirection),d=h.getResolution(c),p=u.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==p&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=p):this.renderedSourceKey_=p;let m=t.extent;const g=u.getTilePixelRatio(o);this.prepareContainer(t,e);const _=this.context.canvas.width,y=this.context.canvas.height,k=i.extent&&ci(i.extent);k&&(m=yt(m,ci(i.extent)));const v=d*_/2/g,x=d*y/2/g,w=[r[0]-v,r[1]-x,r[0]+v,r[1]+x],b={};this.renderedTiles.length=0;const E=l.getPreload();if(t.nextExtent&&this.enqueueTilesForNextExtent()){const e=h.getZForResolution(n.nextResolution,u.zDirection),i=kf(t,t.nextExtent);this.enqueueTiles(t,i,e,b,E)}const M=kf(t,m);if(this.enqueueTiles(t,M,c,b,0),E>0&&setTimeout(()=>{this.enqueueTiles(t,M,c-1,b,E-1)},0),!(c in b))return this.container;const T=N(this),S=t.time;for(const e of b[c]){const i=e.getState();if(4===i)continue;const n=e.tileCoord;if(2===i&&1===e.getAlpha(T,S)){e.endTransition(T);continue}if(3!==i&&(this.renderComplete=!1),this.findStaleTile_(n,b)){yf(b,e,c),t.animate=!0;continue}if(this.findAltTiles_(h,n,c+1,b))continue;const a=h.getMinZoom();for(let t=c-1;t>=a&&!this.findAltTiles_(h,n,t,b);--t);}const C=d/s*o/g,L=this.getRenderContext(t);wi(this.tempTransform,_/2,y/2,C,C,0,-_/2,-y/2),i.extent&&this.clipUnrotated(L,t,k),u.getInterpolate()||(L.imageSmoothingEnabled=!1),this.preRender(L,t);const R=Object.keys(b).map(Number);let I;R.sort(f);const P=[],A=[];for(let e=R.length-1;e>=0;--e){const i=R[e],n=u.getTilePixelSize(i,o,a),s=h.getResolution(i)/d,r=n[0]*s*C,l=n[1]*s*C,c=h.getTileCoordForCoordAndZ(kt(w),i),p=h.getTileCoordExtent(c),m=vi(this.tempTransform,[g*(p[0]-w[0])/d,g*(w[3]-p[3])/d]),f=g*u.getGutterForProjection(a);for(const e of b[i]){if(2!==e.getState())continue;const n=e.tileCoord,a=c[1]-n[1],s=Math.round(m[0]-(a-1)*r),o=c[2]-n[2],h=Math.round(m[1]-(o-1)*l),d=Math.round(m[0]-a*r),p=Math.round(m[1]-o*l),g=s-d,_=h-p,y=1===R.length;let k=!1;I=[d,p,d+g,p,d+g,p+_,d,p+_];for(let t=0,e=P.length;t<e;++t)if(!y&&i<A[t]){const e=P[t];wt([d,p,d+g,p+_],[e[0],e[3],e[4],e[7]])&&(k||(L.save(),k=!0),L.beginPath(),L.moveTo(I[0],I[1]),L.lineTo(I[2],I[3]),L.lineTo(I[4],I[5]),L.lineTo(I[6],I[7]),L.moveTo(e[6],e[7]),L.lineTo(e[4],e[5]),L.lineTo(e[2],e[3]),L.lineTo(e[0],e[1]),L.clip())}P.push(I),A.push(i),this.drawTile(e,t,d,p,g,_,f,y),k&&L.restore(),this.renderedTiles.unshift(e),this.updateUsedTiles(t.usedTiles,u,e)}}if(this.renderedResolution=d,this.extentChanged=!this.renderedExtent_||!at(this.renderedExtent_,w),this.renderedExtent_=w,this.renderedPixelRatio=o,this.postRender(this.context,t),i.extent&&L.restore(),L.imageSmoothingEnabled=!0,this.renderComplete){const e=(t,e)=>{const i=N(u),n=e.wantedTiles[i],a=n?Object.keys(n).length:0;this.updateCacheSize(a),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};t.postRenderFunctions.push(e)}return this.container}updateCacheSize(t){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,2*t)}drawTile(t,e,i,n,a,s,r,o){let l;if(t instanceof zm){if(l=Hm(t.getData()),!l)throw new Error("Rendering array data is not yet supported")}else l=this.getTileImage(t);if(!l)return;const u=this.getRenderContext(e),h=N(this),c=e.layerStatesArray[e.layerIndex],d=c.opacity*(o?t.getAlpha(h,e.time):1),p=d!==u.globalAlpha;p&&(u.save(),u.globalAlpha=d),u.drawImage(l,r,r,l.width-2*r,l.height-2*r,i,n,a,s),p&&u.restore(),d!==c.opacity?e.animate=!0:o&&t.endTransition(h)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}updateUsedTiles(t,e,i){const n=N(e);n in t||(t[n]={}),t[n][i.getKey()]=!0}},xf="preload",wf="useInterimTilesOnError",bf=class extends Gs{constructor(t){t=t||{};const e=Object.assign({},t),i=t.cacheSize;delete t.cacheSize,delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(void 0!==t.preload?t.preload:0),this.setUseInterimTilesOnError(void 0===t.useInterimTilesOnError||t.useInterimTilesOnError)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(xf)}setPreload(t){this.set(xf,t)}getUseInterimTilesOnError(){return this.get(wf)}setUseInterimTilesOnError(t){this.set(wf,t)}getData(t){return super.getData(t)}},Ef=class extends bf{constructor(t){super(t)}createRenderer(){return new vf(this,{cacheSize:this.getCacheSize()})}},Mf=[0,0,0],Tf=class{constructor(t){let e;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,B(function(t){const e=((t,e)=>e-t)||f;return t.every(function(i,n){if(0===n)return!0;const a=e(t[n-1],i);return!(a>0||0===a)})}(this.resolutions_),"`resolutions` must be sorted in descending order"),!t.origins)for(let t=0,i=this.resolutions_.length-1;t<i;++t)if(e){if(this.resolutions_[t]/this.resolutions_[t+1]!==e){e=void 0;break}}else e=this.resolutions_[t]/this.resolutions_[t+1];this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,B(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=t.extent;void 0===i||this.origin_||this.origins_||(this.origin_=kt(i)),B(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,B(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:256,B(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=void 0!==i?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map((t,e)=>{const n=new qm(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1));if(i){const t=this.getTileRangeForExtentAndZ(i,e);n.minX=Math.max(t.minX,n.minX),n.maxX=Math.min(t.maxX,n.maxX),n.minY=Math.max(t.minY,n.minY),n.maxY=Math.min(t.maxY,n.maxY)}return n}):i&&this.calculateTileRanges_(i)}forEachTileCoord(t,e,i){const n=this.getTileRangeForExtentAndZ(t,e);for(let t=n.minX,a=n.maxX;t<=a;++t)for(let a=n.minY,s=n.maxY;a<=s;++a)i([e,t,a])}forEachTileCoordParentTileRange(t,e,i,n){let a,s,r,o=null,l=t[0]-1;for(2===this.zoomFactor_?(s=t[1],r=t[2]):o=this.getTileCoordExtent(t,n);l>=this.minZoom;){if(void 0!==s&&void 0!==r?(s=Math.floor(s/2),r=Math.floor(r/2),a=Xm(s,s,r,r,i)):a=this.getTileRangeForExtentAndZ(o,l,i),e(l,a))return!0;--l}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,i){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){const i=2*t[1],n=2*t[2];return Xm(i,i+1,n,n+1,e)}const n=this.getTileCoordExtent(t,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(n,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,i){if(e>this.maxZoom||e<this.minZoom)return null;const n=t[0],a=t[1],s=t[2];if(e===n)return Xm(a,s,a,s,i);if(this.zoomFactor_){const t=Math.pow(this.zoomFactor_,e-n),r=Math.floor(a*t),o=Math.floor(s*t);return e<n?Xm(r,r,o,o,i):Xm(r,Math.floor(t*(a+1))-1,o,Math.floor(t*(s+1))-1,i)}const r=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e,i)}getTileRangeForExtentAndZ(t,e,i){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,Mf);const n=Mf[1],a=Mf[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,Mf),Xm(n,Mf[1],a,Mf[2],i)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),i=this.getResolution(t[0]),n=Mr(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*n[0]*i,e[1]-(t[2]+.5)*n[1]*i]}getTileCoordExtent(t,e){const i=this.getOrigin(t[0]),n=this.getResolution(t[0]),a=Mr(this.getTileSize(t[0]),this.tmpSize_),s=i[0]+t[1]*a[0]*n,r=i[1]-(t[2]+1)*a[1]*n;return tt(s,r,s+a[0]*n,r+a[1]*n,e)}getTileCoordForCoordAndResolution(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)}getTileCoordForXYAndResolution_(t,e,i,n,a){const s=this.getZForResolution(i),r=i/this.getResolution(s),o=this.getOrigin(s),l=Mr(this.getTileSize(s),this.tmpSize_);let u=r*(t-o[0])/i/l[0],h=r*(o[1]-e)/i/l[1];return n?(u=Nt(u,5)-1,h=Nt(h,5)-1):(u=Ft(u,5),h=Ft(h,5)),of(s,u,h,a)}getTileCoordForXYAndZ_(t,e,i,n,a){const s=this.getOrigin(i),r=this.getResolution(i),o=Mr(this.getTileSize(i),this.tmpSize_);let l=(t-s[0])/r/o[0],u=(s[1]-e)/r/o[1];return n?(l=Nt(l,5)-1,u=Nt(u,5)-1):(l=Ft(l,5),u=Ft(u,5)),of(i,l,u,a)}getTileCoordForCoordAndZ(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){return St(_(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return hn(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){const e=this.resolutions_.length,i=new Array(e);for(let n=this.minZoom;n<e;++n)i[n]=this.getTileRangeForExtentAndZ(t,n);this.fullTileRanges_=i}};function Sf(t){let e=t.getDefaultTileGrid();return e||(e=function(t){return function(t,e,i,n){n=void 0!==n?n:"top-left";const a=Cf(t,e,i);return new Tf({extent:t,origin:mt(t,n),resolutions:a,tileSize:i})}(Lf(t),void 0,void 0,void 0)}(t),t.setDefaultTileGrid(e)),e}function Cf(t,e,i,n){e=void 0!==e?e:42,i=Mr(void 0!==i?i:256);const a=_t(t),s=xt(t);n=n>0?n:Math.max(s/i[0],a/i[1]);const r=e+1,o=new Array(r);for(let t=0;t<r;++t)o[t]=n/Math.pow(2,t);return o}function Lf(t){let e=(t=Ye(t)).getExtent();if(!e){const i=180*Qt.degrees/t.getMetersPerUnit();e=tt(-i,-i,i,i)}return e}function Rf(t,e){const i=[];Object.keys(e).forEach(function(t){null!==e[t]&&void 0!==e[t]&&i.push(t+"="+encodeURIComponent(e[t]))});const n=i.join("&");return t=t.replace(/[?&]$/,""),(t+=t.includes("?")?"&":"?")+n}const If=/\{z\}/g,Pf=/\{x\}/g,Af=/\{y\}/g,jf=/\{-y\}/g;function Of(t){const e=[];let i=/\{([a-z])-([a-z])\}/.exec(t);if(i){const n=i[1].charCodeAt(0),a=i[2].charCodeAt(0);let s;for(s=n;s<=a;++s)e.push(t.replace(i[0],String.fromCharCode(s)));return e}if(i=/\{(\d+)-(\d+)\}/.exec(t),i){const n=parseInt(i[2],10);for(let a=parseInt(i[1],10);a<=n;a++)e.push(t.replace(i[0],a.toString()));return e}return e.push(t),e}function Ff(t,e){return function(i,n,a){if(!i)return;let s;const r=i[0];if(e){const t=e.getFullTileRange(r);t&&(s=t.getHeight()-1)}return function(t,e,i,n,a){return t.replace(If,e.toString()).replace(Pf,i.toString()).replace(Af,n.toString()).replace(jf,function(){if(void 0===a)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(a-n).toString()})}(t,r,i[1],i[2],s)}}function Nf(t){return 1===t.length?t[0]:function(e,i,n){if(!e)return;const a=Pt(cf(e),t.length);return t[a](e,i,n)}}function Gf(t){return t?"function"==typeof t?t:(Array.isArray(t)||(t=[t]),e=>t):null}const Df=class extends D{constructor(t){super(),this.projection=Ye(t.projection),this.attributions_=Gf(t.attributions),this.attributionsCollapsible_=t.attributionsCollapsible??!0,this.loading=!1,this.state_=void 0!==t.state?t.state:"ready",this.wrapX_=void 0!==t.wrapX&&t.wrapX,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise(function(t,i){e.viewResolver=t,e.viewRejector=i})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=Gf(t),this.changed()}setState(t){this.state_=t,this.changed()}};class Wf extends C{constructor(t,e){super(t),this.tile=e}}const Hf=class extends Df{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=void 0!==t.tilePixelRatio?t.tilePixelRatio:1,this.tileGrid=void 0!==t.tileGrid?t.tileGrid:null;this.tileGrid&&Mr(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),[256,256]),this.tmpSize=[0,0],this.key_=t.key||N(this),this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getResolutions(t){const e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,i,n,a,s){return O()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:Sf(t)}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,i){const n=this.getTileGridForProjection(i),a=this.getTilePixelRatio(e),s=Mr(n.getTileSize(t),this.tmpSize);return 1==a?s:Er(s,a,this.tmpSize)}getTileCoordForTileUrlFunction(t,e){const i=void 0!==e?e:this.getProjection(),n=void 0!==e?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(t=function(t,e,i){const n=e[0],a=t.getTileCoordCenter(e),s=Lf(i);if(!q(s,a)){const e=xt(s),i=Math.ceil((s[0]-a[0])/e);return a[0]+=e*i,t.getTileCoordForCoordAndZ(a,n)}return e}(n,t,i)),function(t,e){const i=t[0],n=t[1],a=t[2];if(e.getMinZoom()>i||i>e.getMaxZoom())return!1;const s=e.getFullTileRange(i);return!s||s.containsXY(n,a)}(t,n)?t:null}clear(){}refresh(){this.clear(),super.refresh()}},Uf="tileloadstart",Bf="tileloadend",Vf="tileloaderror";class Kf extends Hf{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===Kf.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,i=N(e),n=e.getState();let a;1==n?(this.tileLoadingKeys_[i]=!0,a=Uf):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],a=3==n?Vf:2==n?Bf:void 0),null!=a&&this.dispatchEvent(new Wf(a,e))}setTileLoadFunction(t){this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,void 0!==e?this.setKey(e):this.changed()}setUrl(t){const e=Of(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(function(t,e){const i=t.length,n=new Array(i);for(let a=0;a<i;++a)n[a]=Ff(t[a],e);return Nf(n)}(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,i){}}const zf=Kf;function $f(t,e){if(Hn){const i=t.getCrossOrigin();let n="same-origin",a="same-origin";return"anonymous"===i||""===i?(n="cors",a="omit"):"use-credentials"===i&&(n="cors",a="include"),void fetch(e,{mode:n,credentials:a}).then(t=>{if(!t.ok)throw new Error(`HTTP ${t.status}`);return t.blob()}).then(t=>createImageBitmap(t)).then(e=>{const i=t.getImage();i.width=e.width,i.height=e.height,i.getContext("2d").drawImage(e,0,0),e.close?.(),i.dispatchEvent(new Event("load"))}).catch(()=>{t.getImage().dispatchEvent(new Event("error"))})}t.getImage().src=e}const Yf=class extends zf{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:$f,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:void 0===t.interpolate||t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=void 0!==t.crossOrigin?t.crossOrigin:null,this.tileClass=void 0!==t.tileClass?t.tileClass:$m,this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(t){return this.getProjection()&&t&&!ti(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||ti(e,t)))return this.tileGrid;const i=N(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=Sf(t)),this.tileGridForProjection[i]}createTile_(t,e,i,n,a,s){const r=[t,e,i],l=this.getTileCoordForTileUrlFunction(r,a),u=l?this.tileUrlFunction(l,n,a):void 0,h=new this.tileClass(r,void 0!==u?0:4,void 0!==u?u:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=s,h.addEventListener(o,this.handleTileChange.bind(this)),h}getTile(t,e,i,n,a,s){const r=this.getProjection();if(!r||!a||ti(r,a))return this.getTileInternal(t,e,i,n,r||a);const o=[t,e,i],l=this.getKey(),u=this.getTileGridForProjection(r),h=this.getTileGridForProjection(a),c=this.getTileCoordForTileUrlFunction(o,a),d=new sf(r,u,a,h,o,c,this.getTilePixelRatio(n),this.getGutter(),(t,e,i,n)=>this.getTileInternal(t,e,i,n,r,s),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return d.key=l,d}getTileInternal(t,e,i,n,a,s){const r=this.getKey(),o=hf(this,r,t,e,i);if(s&&s.containsKey(o))return s.get(o);const l=this.createTile_(t,e,i,n,a,r);return s?.set(o,l),l}setRenderReprojectionEdges(t){this.renderReprojectionEdges_!=t&&(this.renderReprojectionEdges_=t,this.changed())}setTileGridForProjection(t,e){const i=Ye(t);if(i){const t=N(i);t in this.tileGridForProjection||(this.tileGridForProjection[t]=e)}}};const Xf=class extends Yf{constructor(t){super({attributions:(t=t||{}).attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,zDirection:t.zDirection}),this.params_=Object.assign({},t.params),this.hidpi_=void 0===t.hidpi||t.hidpi,this.tmpExtent_=[1/0,1/0,-1/0,-1/0],this.setKey(this.getKeyForParams_())}getKeyForParams_(){let t=0;const e=[];for(const i in this.params_)e[t++]=i+"-"+this.params_[i];return e.join("/")}getParams(){return this.params_}getRequestUrl_(t,e,i,n,a,s){const r=this.urls;if(!r)return;let o;return o=1==r.length?r[0]:r[Pt(cf(t),r.length)],function(t,e,i,n,a,s){const r=a.getCode().split(/:(?=\d+$)/).pop(),o=i/n,l=[Ot(xt(e)/o,4),Ot(_t(e)/o,4)];return s.SIZE=l[0]+","+l[1],s.BBOX=e.join(","),s.BBOXSR=r,s.IMAGESR=r,s.DPI=Math.round(s.DPI?s.DPI*n:90*n),Rf(t.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage"),s)}(o,i,(this.tileGrid||this.getTileGridForProjection(a)).getResolution(t[0]),n,a,s)}getTilePixelRatio(t){return this.hidpi_?t:1}setParams(t){this.params_=Object.assign({},t),this.setKey(this.getKeyForParams_())}updateParams(t){Object.assign(this.params_,t),this.setKey(this.getKeyForParams_())}tileUrlFunction(t,e,i){let n=this.getTileGrid();if(n||(n=this.getTileGridForProjection(i)),n.getResolutions().length<=t[0])return;1==e||this.hidpi_||(e=1);const a=n.getTileCoordExtent(t,this.tmpExtent_);let s=Mr(n.getTileSize(t[0]),this.tmpSize);1!=e&&(s=Er(s,e,this.tmpSize));const r={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};return Object.assign(r,this.params_),this.getRequestUrl_(t,s,a,e,i,r)}},qf=t=>{switch(t){case Bp.Fornminnen:return 1;case Bp.MaritimaFornminnen:return 5}},Zf=t=>"attributes"in t&&(t.layerName===Bp.Fornminnen||t.layerName===Bp.MaritimaFornminnen);class Jf{constructor(t,e){this.toLayerIds=t=>t.map(qf).sort((t,e)=>t-e),this.getSourceLayersParams=t=>t.ahvenanmaa.selectedLayers.length>0?"show:"+this.toLayerIds(t.ahvenanmaa.selectedLayers).join(","):"hide:"+this.toLayerIds(Object.values(Bp)).join(","),this.createSource=t=>{const e={urls:[t.ahvenanmaa.url.export],params:{layers:this.getSourceLayersParams(t)}},i=new Xf(e);return i.on("tileloadstart",()=>{this.updateTileLoadingStatus(!0)}),i.on("tileloadend",()=>{this.updateTileLoadingStatus(!1)}),i.on("tileloaderror",()=>{this.updateTileLoadingStatus(!1)}),i},this.updateLayerSource=t=>{this.source=this.createSource(t),this.layer.setSource(this.source),this.updateLayerVisibility(t)},this.updateLayerVisibility=t=>{const{ahvenanmaa:{selectedLayers:e,enabled:i}}=t;this.layer.setVisible(i&&e.length>0)},this.selectedFeatureLayersChanged=t=>{this.updateLayerSource(t)},this.identifyFeaturesAt=async(t,e,i,n)=>{const a=this.layer.getExtent();if(!a||!q(a,t)||0===n.ahvenanmaa.selectedLayers.length||!n.ahvenanmaa.enabled)return{results:[]};const s=new URLSearchParams({geometry:t.join(","),geometryType:"esriGeometryPoint",tolerance:"10",imageDisplay:e.join(",")+",96",mapExtent:i.join(","),layers:`visible:${this.toLayerIds(n.ahvenanmaa.selectedLayers).join(",")}`,f:"json",returnGeometry:"true"}),r=new URL(n.ahvenanmaa.url.identify);r.search=String(s);const o=await fetch(String(r)),l=await o.json();return this.addTypeAndDatingToResult(l,n)},this.findFeatures=async(t,e)=>{const{selectedLayers:i,enabled:n}=e.ahvenanmaa;if(0===i.length||!n)return{results:[]};const a={results:(await Promise.all(i.map(i=>{const n=(()=>{switch(i){case Bp.Fornminnen:return"Fornlmnings ID, Namn , Beskrivning";case Bp.MaritimaFornminnen:return"MfornID, Namn , Beskrivning"}})(),a=new URLSearchParams({searchText:t,contains:"true",searchFields:n,layers:qf(i).toString(),f:"json",returnGeometry:"true",returnZ:"false"}),s=new URL(e.ahvenanmaa.url.find);return s.search=String(a),fetch(String(s)).then(t=>t.json())}))).flatMap(({results:t})=>t)};return this.addTypeAndDatingToResult(a,e)},this.addTypeAndDatingToResult=async(t,e)=>{const i=await this.getTypeAndDatingData(e);return{...t,results:t.results.map(t=>{if(t.layerName===Bp.Fornminnen){const e=i.get(t.attributes["Fornlmnings ID"]);if(e)return{...t,attributes:{...t.attributes,typeAndDating:e}}}return t})}},this.getTypeAndDatingData=async t=>{if(this.typeAndDatingMap)return this.typeAndDatingMap;const e=new Map;try{const i=await fetch(t.ahvenanmaa.url.typeAndDating);return(await i.json()).features.forEach(t=>{const i=t.properties.FornID,n=e.get(i);n?e.set(i,[...n,t.properties]):e.set(i,[t.properties])}),this.typeAndDatingMap=e,e}catch{return e}},this.opacityChanged=t=>{this.layer.setOpacity(t.ahvenanmaa.opacity)},this.getLayer=()=>this.layer,this.updateTileLoadingStatus=e,this.source=this.createSource(t),this.layer=new Ef({source:this.source,extent:[65741.9087,6606901.2261,180921.4173,6747168.5691]}),this.opacityChanged(t),this.updateLayerVisibility(t)}}const Qf=class{drawCustom(t,e,i,n,a){}drawGeometry(t){}setStyle(t){}drawCircle(t,e,i){}drawFeature(t,e,i){}drawGeometryCollection(t,e,i){}drawLineString(t,e,i){}drawMultiLineString(t,e,i){}drawMultiPoint(t,e,i){}drawMultiPolygon(t,e,i){}drawPoint(t,e,i){}drawPolygon(t,e,i){}drawText(t,e,i){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}},tg={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},eg=[tg.FILL],ig=[tg.STROKE],ng=[tg.BEGIN_PATH],ag=[tg.CLOSE_PATH],sg=tg,rg=class extends Qf{constructor(t,e,i,n){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=n,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return 1==e?t:t.map(function(t){return t*e})}appendFlatPointCoordinates(t,e){const i=this.getBufferedMaxExtent(),n=this.tmpCoordinate_,a=this.coordinates;let s=a.length;for(let r=0,o=t.length;r<o;r+=e)n[0]=t[r],n[1]=t[r+1],q(i,n)&&(a[s++]=n[0],a[s++]=n[1]);return s}appendFlatLineCoordinates(t,e,i,n,a,s){const r=this.coordinates;let o=r.length;const l=this.getBufferedMaxExtent();s&&(e+=n);let u=t[e],h=t[e+1];const c=this.tmpCoordinate_;let d,p,m,f=!0;for(d=e+n;d<i;d+=n)c[0]=t[d],c[1]=t[d+1],m=Q(l,c),m!==p?(f&&(r[o++]=u,r[o++]=h,f=!1),r[o++]=c[0],r[o++]=c[1]):1===m?(r[o++]=c[0],r[o++]=c[1],f=!1):f=!0,u=c[0],h=c[1],p=m;return(a&&f||d===e+n)&&(r[o++]=u,r[o++]=h),o}drawCustomCoordinates_(t,e,i,n,a){for(let s=0,r=i.length;s<r;++s){const r=i[s],o=this.appendFlatLineCoordinates(t,e,r,n,!1,!1);a.push(o),e=r}return e}drawCustom(t,e,i,n,a){this.beginGeometry(t,e,a);const s=t.getType(),r=t.getStride(),o=this.coordinates.length;let l,u,h,c,d;switch(s){case"MultiPolygon":l=t.getOrientedFlatCoordinates(),c=[];const e=t.getEndss();d=0;for(let t=0,i=e.length;t<i;++t){const i=[];d=this.drawCustomCoordinates_(l,d,e[t],r,i),c.push(i)}this.instructions.push([sg.CUSTOM,o,c,t,i,zi,a]),this.hitDetectionInstructions.push([sg.CUSTOM,o,c,t,n||i,zi,a]);break;case"Polygon":case"MultiLineString":h=[],l="Polygon"==s?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),d=this.drawCustomCoordinates_(l,0,t.getEnds(),r,h),this.instructions.push([sg.CUSTOM,o,h,t,i,Ki,a]),this.hitDetectionInstructions.push([sg.CUSTOM,o,h,t,n||i,Ki,a]);break;case"LineString":case"Circle":l=t.getFlatCoordinates(),u=this.appendFlatLineCoordinates(l,0,l.length,r,!1,!1),this.instructions.push([sg.CUSTOM,o,u,t,i,Vi,a]),this.hitDetectionInstructions.push([sg.CUSTOM,o,u,t,n||i,Vi,a]);break;case"MultiPoint":l=t.getFlatCoordinates(),u=this.appendFlatPointCoordinates(l,r),u>o&&(this.instructions.push([sg.CUSTOM,o,u,t,i,Vi,a]),this.hitDetectionInstructions.push([sg.CUSTOM,o,u,t,n||i,Vi,a]));break;case"Point":l=t.getFlatCoordinates(),this.coordinates.push(l[0],l[1]),u=this.coordinates.length,this.instructions.push([sg.CUSTOM,o,u,t,i,void 0,a]),this.hitDetectionInstructions.push([sg.CUSTOM,o,u,t,n||i,void 0,a])}this.endGeometry(e)}beginGeometry(t,e,i){this.beginGeometryInstruction1_=[sg.BEGIN_GEOMETRY,e,0,t,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[sg.BEGIN_GEOMETRY,e,0,t,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;let e;t.reverse();const i=t.length;let n,a,s=-1;for(e=0;e<i;++e)n=t[e],a=n[0],a==sg.END_GEOMETRY?s=e:a==sg.BEGIN_GEOMETRY&&(n[2]=e,y(this.hitDetectionInstructions,s,e),s=-1)}fillStyleToState(t,e={}){if(t){const i=t.getColor();e.fillPatternScale=i&&"object"==typeof i&&"src"in i?this.pixelRatio:1,e.fillStyle=nl(i||sl)}else e.fillStyle=void 0;return e}strokeStyleToState(t,e={}){if(t){const i=t.getColor();e.strokeStyle=nl(i||ul);const n=t.getLineCap();e.lineCap=void 0!==n?n:rl;const a=t.getLineDash();e.lineDash=a?a.slice():ol;const s=t.getLineDashOffset();e.lineDashOffset=s||0;const r=t.getLineJoin();e.lineJoin=void 0!==r?r:ll;const o=t.getWidth();e.lineWidth=void 0!==o?o:1;const l=t.getMiterLimit();e.miterLimit=void 0!==l?l:10,e.lineWidth>this.maxLineWidth&&(this.maxLineWidth=e.lineWidth,this.bufferedMaxExtent_=null)}else e.strokeStyle=void 0,e.lineCap=void 0,e.lineDash=null,e.lineDashOffset=void 0,e.lineJoin=void 0,e.lineWidth=void 0,e.miterLimit=void 0;return e}setFillStrokeStyle(t,e){const i=this.state;this.fillStyleToState(t,i),this.strokeStyleToState(e,i)}createFill(t){const e=t.fillStyle,i=[sg.SET_FILL_STYLE,e];return"string"!=typeof e&&i.push(t.fillPatternScale),i}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[sg.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,t.lineDash?this.applyPixelRatio(t.lineDash):null,t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const i=t.fillStyle;"string"==typeof i&&t.currentFillStyle==i||(this.instructions.push(e.call(this,t)),t.currentFillStyle=i)}updateStrokeStyle(t,e){const i=t.strokeStyle,n=t.lineCap,a=t.lineDash,s=t.lineDashOffset,r=t.lineJoin,o=t.lineWidth,l=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=n||a!=t.currentLineDash&&!v(t.currentLineDash,a)||t.currentLineDashOffset!=s||t.currentLineJoin!=r||t.currentLineWidth!=o||t.currentMiterLimit!=l)&&(e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=n,t.currentLineDash=a,t.currentLineDashOffset=s,t.currentLineJoin=r,t.currentLineWidth=o,t.currentMiterLimit=l)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[sg.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Y(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;$(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}},og=class extends rg{constructor(t,e,i,n){super(t,e,i,n)}drawFlatCoordinatess_(t,e,i,n){const a=this.state,s=void 0!==a.fillStyle,r=void 0!==a.strokeStyle,o=i.length;this.instructions.push(ng),this.hitDetectionInstructions.push(ng);for(let a=0;a<o;++a){const s=i[a],o=this.coordinates.length,l=this.appendFlatLineCoordinates(t,e,s,n,!0,!r),u=[sg.MOVE_TO_LINE_TO,o,l];this.instructions.push(u),this.hitDetectionInstructions.push(u),r&&(this.instructions.push(ag),this.hitDetectionInstructions.push(ag)),e=s}return s&&(this.instructions.push(eg),this.hitDetectionInstructions.push(eg)),r&&(this.instructions.push(ig),this.hitDetectionInstructions.push(ig)),e}drawCircle(t,e,i){const n=this.state,a=n.fillStyle,s=n.strokeStyle;if(void 0===a&&void 0===s)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([sg.SET_FILL_STYLE,sl]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([sg.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,ol,0]);const r=t.getFlatCoordinates(),o=t.getStride(),l=this.coordinates.length;this.appendFlatLineCoordinates(r,0,r.length,o,!1,!1);const u=[sg.CIRCLE,l];this.instructions.push(ng,u),this.hitDetectionInstructions.push(ng,u),void 0!==n.fillStyle&&(this.instructions.push(eg),this.hitDetectionInstructions.push(eg)),void 0!==n.strokeStyle&&(this.instructions.push(ig),this.hitDetectionInstructions.push(ig)),this.endGeometry(e)}drawPolygon(t,e,i){const n=this.state,a=n.fillStyle,s=n.strokeStyle;if(void 0===a&&void 0===s)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([sg.SET_FILL_STYLE,sl]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([sg.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,ol,0]);const r=t.getEnds(),o=t.getOrientedFlatCoordinates(),l=t.getStride();this.drawFlatCoordinatess_(o,0,r,l),this.endGeometry(e)}drawMultiPolygon(t,e,i){const n=this.state,a=n.fillStyle,s=n.strokeStyle;if(void 0===a&&void 0===s)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([sg.SET_FILL_STYLE,sl]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([sg.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,ol,0]);const r=t.getEndss(),o=t.getOrientedFlatCoordinates(),l=t.getStride();let u=0;for(let t=0,e=r.length;t<e;++t)u=this.drawFlatCoordinatess_(o,u,r[t],l);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(0!==t){const e=this.coordinates;for(let i=0,n=e.length;i<n;++i)e[i]=Xi(e[i],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;this.updateFillStyle(t,this.createFill),this.updateStrokeStyle(t,this.applyStroke)}};function lg(t,e,i,n,a){const s=[];let r=i,o=0,l=e.slice(i,2);for(;o<t&&r+a<n;){const[i,n]=l.slice(-2),u=e[r+a],h=e[r+a+1],c=Math.sqrt((u-i)*(u-i)+(h-n)*(h-n));if(o+=c,o>=t){const e=(t-o+c)/c,d=At(i,u,e),p=At(n,h,e);l.push(d,p),s.push(l),l=[d,p],o==t&&(r+=a),o=0}else if(o<t)l.push(e[r+a],e[r+a+1]),r+=a;else{const t=c-o,e=At(i,u,t/c),d=At(n,h,t/c);l.push(e,d),s.push(l),l=[e,d],o=0,r+=a}}return o>0&&s.push(l),s}function ug(t,e,i,n,a){let s,r,o,l,u,h,c,d,p,m,f=i,g=i,_=0,y=0,k=i;for(r=i;r<n;r+=a){const i=e[r],n=e[r+1];void 0!==u&&(p=i-u,m=n-h,l=Math.sqrt(p*p+m*m),void 0!==c&&(y+=o,s=Math.acos((c*p+d*m)/(o*l)),s>t&&(y>_&&(_=y,f=k,g=r),y=0,k=r-a)),o=l,c=p,d=m),u=i,h=n}return y+=l,y>_?[k,r]:[f,g]}const hg={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},cg={Circle:og,Default:rg,Image:class extends rg{constructor(t,e,i,n){super(t,e,i,n),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e,i){if(!this.image_||this.maxExtent&&!q(this.maxExtent,t.getFlatCoordinates()))return;this.beginGeometry(t,e,i);const n=t.getFlatCoordinates(),a=t.getStride(),s=this.coordinates.length,r=this.appendFlatPointCoordinates(n,a);this.instructions.push([sg.DRAW_IMAGE,s,r,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([sg.DRAW_IMAGE,s,r,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e,i){if(!this.image_)return;this.beginGeometry(t,e,i);const n=t.getFlatCoordinates(),a=[];for(let e=0,i=n.length;e<i;e+=t.getStride())this.maxExtent&&!q(this.maxExtent,n.slice(e,e+2))||a.push(n[e],n[e+1]);const s=this.coordinates.length,r=this.appendFlatPointCoordinates(a,2);this.instructions.push([sg.DRAW_IMAGE,s,r,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([sg.DRAW_IMAGE,s,r,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const i=t.getAnchor(),n=t.getSize(),a=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=n[1],this.opacity_=t.getOpacity(),this.originX_=a[0],this.originY_=a[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=n[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}},LineString:class extends rg{constructor(t,e,i,n){super(t,e,i,n)}drawFlatCoordinates_(t,e,i,n){const a=this.coordinates.length,s=this.appendFlatLineCoordinates(t,e,i,n,!1,!1),r=[sg.MOVE_TO_LINE_TO,a,s];return this.instructions.push(r),this.hitDetectionInstructions.push(r),i}drawLineString(t,e,i){const n=this.state,a=n.strokeStyle,s=n.lineWidth;if(void 0===a||void 0===s)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([sg.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,ol,0],ng);const r=t.getFlatCoordinates(),o=t.getStride();this.drawFlatCoordinates_(r,0,r.length,o),this.hitDetectionInstructions.push(ig),this.endGeometry(e)}drawMultiLineString(t,e,i){const n=this.state,a=n.strokeStyle,s=n.lineWidth;if(void 0===a||void 0===s)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([sg.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,ol,0],ng);const r=t.getEnds(),o=t.getFlatCoordinates(),l=t.getStride();let u=0;for(let t=0,e=r.length;t<e;++t)u=this.drawFlatCoordinates_(o,u,r[t],l);this.hitDetectionInstructions.push(ig),this.endGeometry(e)}finish(){const t=this.state;return null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(ig),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(ig),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(ng)}},Polygon:og,Text:class extends rg{constructor(t,e,i,n){super(t,e,i,n),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[sl]={fillStyle:sl},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e,i){const n=this.textFillState_,a=this.textStrokeState_,s=this.textState_;if(""===this.text_||!s||!n&&!a)return;const r=this.coordinates;let o=r.length;const l=t.getType();let u=null,h=t.getStride();if("line"!==s.placement||"LineString"!=l&&"MultiLineString"!=l&&"Polygon"!=l&&"MultiPolygon"!=l){let n=s.overflow?null:[];switch(l){case"Point":case"MultiPoint":u=t.getFlatCoordinates();break;case"LineString":u=t.getFlatMidpoint();break;case"Circle":u=t.getCenter();break;case"MultiLineString":u=t.getFlatMidpoints(),h=2;break;case"Polygon":u=t.getFlatInteriorPoint(),s.overflow||n.push(u[2]/this.resolution),h=3;break;case"MultiPolygon":const e=t.getFlatInteriorPoints();u=[];for(let t=0,i=e.length;t<i;t+=3)s.overflow||n.push(e[t+2]/this.resolution),u.push(e[t],e[t+1]);if(0===u.length)return;h=2}const a=this.appendFlatPointCoordinates(u,h);if(a===o)return;if(n&&(a-o)/2!==u.length/h){let t=o/2;n=n.filter((e,i)=>{const n=r[2*(t+i)]===u[i*h]&&r[2*(t+i)+1]===u[i*h+1];return n||--t,n})}this.saveTextStates_();const c=s.backgroundFill?this.createFill(this.fillStyleToState(s.backgroundFill)):null,d=s.backgroundStroke?this.createStroke(this.strokeStyleToState(s.backgroundStroke)):null;this.beginGeometry(t,e,i);let p=s.padding;if(p!=dl&&(s.scale[0]<0||s.scale[1]<0)){let t=s.padding[0],e=s.padding[1],i=s.padding[2],n=s.padding[3];s.scale[0]<0&&(e=-e,n=-n),s.scale[1]<0&&(t=-t,i=-i),p=[t,e,i,n]}const m=this.pixelRatio;this.instructions.push([sg.DRAW_IMAGE,o,a,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,p==dl?dl:p.map(function(t){return t*m}),c,d,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,n]);const f=1/m,g=c?c.slice(0):null;g&&(g[1]=sl),this.hitDetectionInstructions.push([sg.DRAW_IMAGE,o,a,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[f,f],NaN,this.declutterMode_,this.declutterImageWithText_,p,g,d,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?sl:this.fillKey_,this.textOffsetX_,this.textOffsetY_,n]),this.endGeometry(e)}else{if(!wt(this.maxExtent,t.getExtent()))return;let n;if(u=t.getFlatCoordinates(),"LineString"==l)n=[u.length];else if("MultiLineString"==l)n=t.getEnds();else if("Polygon"==l)n=t.getEnds().slice(0,1);else if("MultiPolygon"==l){const e=t.getEndss();n=[];for(let t=0,i=e.length;t<i;++t)n.push(e[t][0])}this.beginGeometry(t,e,i);const a=s.repeat,c=a?void 0:s.textAlign;let d=0;for(let t=0,e=n.length;t<e;++t){let e;e=a?lg(a*this.resolution,u,d,n[t],h):[u.slice(d,n[t])];for(let i=0,a=e.length;i<a;++i){const a=e[i];let l=0,u=a.length;if(null==c){const t=ug(s.maxAngle,a,0,a.length,2);l=t[0],u=t[1]}for(let t=l;t<u;t+=h)r.push(a[t],a[t+1]);const p=r.length;d=n[t],this.drawChars_(o,p),o=p}}this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,n=this.strokeKey_;t&&(n in this.strokeStates||(this.strokeStates[n]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const a=this.textKey_;a in this.textStates||(this.textStates[a]={font:e.font,textAlign:e.textAlign||hl,justify:e.justify,textBaseline:e.textBaseline||cl,scale:e.scale});const s=this.fillKey_;i&&(s in this.fillStates||(this.fillStates[s]={fillStyle:i.fillStyle}))}drawChars_(t,e){const i=this.textStrokeState_,n=this.textState_,a=this.strokeKey_,s=this.textKey_,r=this.fillKey_;this.saveTextStates_();const o=this.pixelRatio,l=hg[n.textBaseline],u=this.textOffsetY_*o,h=this.text_,c=i?i.lineWidth*Math.abs(n.scale[0])/2:0;this.instructions.push([sg.DRAW_CHARS,t,e,l,n.overflow,r,n.maxAngle,o,u,a,c*o,h,s,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([sg.DRAW_CHARS,t,e,l,n.overflow,r?sl:r,n.maxAngle,o,u,a,c*o,h,s,1/o,this.declutterMode_,this.textKeepUpright_])}setTextStyle(t,e){let i,n,a;if(t){const e=t.getFill();e?(n=this.textFillState_,n||(n={},this.textFillState_=n),n.fillStyle=nl(e.getColor()||sl)):(n=null,this.textFillState_=n);const s=t.getStroke();if(s){a=this.textStrokeState_,a||(a={},this.textStrokeState_=a);const t=s.getLineDash(),e=s.getLineDashOffset(),i=s.getWidth(),n=s.getMiterLimit();a.lineCap=s.getLineCap()||rl,a.lineDash=t?t.slice():ol,a.lineDashOffset=void 0===e?0:e,a.lineJoin=s.getLineJoin()||ll,a.lineWidth=void 0===i?1:i,a.miterLimit=void 0===n?10:n,a.strokeStyle=nl(s.getColor()||ul)}else a=null,this.textStrokeState_=a;i=this.textState_;const r=t.getFont()||al;kl(r);const o=t.getScaleArray();i.overflow=t.getOverflow(),i.font=r,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.repeat=t.getRepeat(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||cl,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||dl,i.scale=void 0===o?[1,1]:o;const l=t.getOffsetX(),u=t.getOffsetY(),h=t.getRotateWithView(),c=t.getKeepUpright(),d=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===l?0:l,this.textOffsetY_=void 0===u?0:u,this.textRotateWithView_=void 0!==h&&h,this.textKeepUpright_=void 0===c||c,this.textRotation_=void 0===d?0:d,this.strokeKey_=a?("string"==typeof a.strokeStyle?a.strokeStyle:N(a.strokeStyle))+a.lineCap+a.lineDashOffset+"|"+a.lineWidth+a.lineJoin+a.miterLimit+"["+a.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=n&&n.fillStyle?"string"==typeof n.fillStyle?n.fillStyle:"|"+N(n.fillStyle):""}else this.text_="";this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}},dg=class{constructor(t,e,i,n){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=n,this.resolution_=i,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const i=this.buildersByZIndex_[e];for(const n in i){const a=i[n].finish();t[e][n]=a}}return t}getBuilder(t,e){const i=void 0!==t?t.toString():"0";let n=this.buildersByZIndex_[i];void 0===n&&(n={},this.buildersByZIndex_[i]=n);let a=n[e];return void 0===a&&(a=new(0,cg[e])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),n[e]=a),a}};function pg(t,e,i,n,a,s,r,o,l,u,h,c,d=!0){let p=t[e],m=t[e+1],f=0,g=0,_=0,y=0;function k(){f=p,g=m,p=t[e+=n],m=t[e+1],y+=_,_=Math.sqrt((p-f)*(p-f)+(m-g)*(m-g))}do{k()}while(e<i-n&&y+_<s);let v=0===_?0:(s-y)/_;const x=At(f,p,v),w=At(g,m,v),b=e-n,E=y,M=s+o*l(u,a,h);for(;e<i-n&&y+_<M;)k();v=0===_?0:(M-y)/_;const T=At(f,p,v),S=At(g,m,v);let C=!1;if(d)if(c){const t=[x,w,T,S];Si(t,0,4,2,c,t,t),C=t[0]>t[2]}else C=x>T;const L=Math.PI,R=[],I=b+n===e;let P;if(_=0,y=E,p=t[e=b],m=t[e+1],I){k(),P=Math.atan2(m-g,p-f),C&&(P+=P>0?-L:L);const t=(T+x)/2,e=(S+w)/2;return R[0]=[t,e,(M-s)/2,P,a],R}for(let t=0,c=(a=a.replace(/\n/g," ")).length;t<c;){k();let d=Math.atan2(m-g,p-f);if(C&&(d+=d>0?-L:L),void 0!==P){let t=d-P;if(t+=t>L?-2*L:t<-L?2*L:0,Math.abs(t)>r)return null}P=d;const x=t;let w=0;for(;t<c;++t){const r=o*l(u,a[C?c-t-1:t],h);if(e+n<i&&y+_<s+w+r/2)break;w+=r}if(t===x)continue;const b=C?a.substring(c-x,c-t):a.substring(x,t);v=0===_?0:(s+w/2-y)/_;const E=At(f,p,v),M=At(g,m,v);R.push([E,M,w/2,d,b]),s+=w}return R}const mg=[1/0,1/0,-1/0,-1/0],fg=[],gg=[],_g=[],yg=[];function kg(t){return t[3].declutterBox}const vg=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function xg(t,e){return"start"===e?e=vg.test(t)?"right":"left":"end"===e&&(e=vg.test(t)?"left":"right"),hg[e]}function wg(t,e,i){return i>0&&t.push("\n",""),t.push(e,""),t}function bg(t,e,i){return i%2==0&&(t+=e),t}const Eg=class{constructor(t,e,i,n,a){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.alignAndScaleFill_,this.instructions=n.instructions,this.coordinates=n.coordinates,this.coordinateCache_={},this.renderedTransform_=[1,0,0,1,0,0],this.hitDetectionInstructions=n.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=n.fillStates||{},this.strokeStates=n.strokeStates||{},this.textStates=n.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=a?new df:null}getZIndexContext(){return this.zIndexContext_}createLabel(t,e,i,n){const a=t+e+i+n;if(this.labels_[a])return this.labels_[a];const s=n?this.strokeStates[n]:null,r=i?this.fillStates[i]:null,o=this.textStates[e],l=this.pixelRatio,u=[o.scale[0]*l,o.scale[1]*l],h=o.justify?hg[o.justify]:xg(Array.isArray(t)?t[0]:t,o.textAlign||hl),c=n&&s.lineWidth?s.lineWidth:0,d=Array.isArray(t)?t:String(t).split("\n").reduce(wg,[]),{width:p,height:m,widths:f,heights:g,lineWidths:_}=function(t,e){const i=[],n=[],a=[];let s=0,r=0,o=0,l=0;for(let u=0,h=e.length;u<=h;u+=2){const c=e[u];if("\n"===c||u===h){s=Math.max(s,r),a.push(r),r=0,o+=l,l=0;continue}const d=e[u+1]||t.font,p=wl(d,c);i.push(p),r+=p;const m=vl(d);n.push(m),l=Math.max(l,m)}return{width:s,height:o,widths:i,heights:n,lineWidths:a}}(o,d),y=p+c,k=[],v=(y+2)*u[0],x=(m+c)*u[1],w={width:v<0?Math.floor(v):Math.ceil(v),height:x<0?Math.floor(x):Math.ceil(x),contextInstructions:k};1==u[0]&&1==u[1]||k.push("scale",u),n&&(k.push("strokeStyle",s.strokeStyle),k.push("lineWidth",c),k.push("lineCap",s.lineCap),k.push("lineJoin",s.lineJoin),k.push("miterLimit",s.miterLimit),k.push("setLineDash",[s.lineDash]),k.push("lineDashOffset",s.lineDashOffset)),i&&k.push("fillStyle",r.fillStyle),k.push("textBaseline","middle"),k.push("textAlign","center");const b=.5-h;let E=h*y+b*c;const M=[],T=[];let S,C=0,L=0,R=0,I=0;for(let t=0,e=d.length;t<e;t+=2){const e=d[t];if("\n"===e){L+=C,C=0,E=h*y+b*c,++I;continue}const a=d[t+1]||o.font;a!==S&&(n&&M.push("font",a),i&&T.push("font",a),S=a),C=Math.max(C,g[R]);const s=[e,E+b*f[R]+h*(f[R]-_[I]),.5*(c+C)+L];E+=f[R],n&&M.push("strokeText",s),i&&T.push("fillText",s),++R}return Array.prototype.push.apply(k,M),Array.prototype.push.apply(k,T),this.labels_[a]=w,w}replayTextBackground_(t,e,i,n,a,s,r){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,n),t.lineTo.apply(t,a),t.lineTo.apply(t,e),s&&(this.alignAndScaleFill_=s[2],t.fillStyle=s[1],this.fill_(t)),r&&(this.setStrokeStyle_(t,r),t.stroke())}calculateImageOrLabelDimensions_(t,e,i,n,a,s,r,o,l,u,h,c,d,p,m,f){let g=i-(r*=c[0]),_=n-(o*=c[1]);const y=a+l>t?t-l:a,k=s+u>e?e-u:s,v=p[3]+y*c[0]+p[1],x=p[0]+k*c[1]+p[2],w=g-p[3],b=_-p[0];let E;return(m||0!==h)&&(fg[0]=w,yg[0]=w,fg[1]=b,gg[1]=b,gg[0]=w+v,_g[0]=gg[0],_g[1]=b+x,yg[1]=_g[1]),0!==h?(E=wi([1,0,0,1,0,0],i,n,1,1,h,-i,-n),vi(E,fg),vi(E,gg),vi(E,_g),vi(E,yg),tt(Math.min(fg[0],gg[0],_g[0],yg[0]),Math.min(fg[1],gg[1],_g[1],yg[1]),Math.max(fg[0],gg[0],_g[0],yg[0]),Math.max(fg[1],gg[1],_g[1],yg[1]),mg)):tt(Math.min(w,w+v),Math.min(b,b+x),Math.max(w,w+v),Math.max(b,b+x),mg),d&&(g=Math.round(g),_=Math.round(_)),{drawImageX:g,drawImageY:_,drawImageW:y,drawImageH:k,originX:l,originY:u,declutterBox:{minX:mg[0],minY:mg[1],maxX:mg[2],maxY:mg[3],value:f},canvasTransform:E,scale:c}}replayImageOrLabel_(t,e,i,n,a,s,r){const o=!(!s&&!r),l=n.declutterBox,u=r?r[2]*n.scale[0]/2:0;return l.minX-u<=e[0]&&l.maxX+u>=0&&l.minY-u<=e[1]&&l.maxY+u>=0&&(o&&this.replayTextBackground_(t,fg,gg,_g,yg,s,r),function(t,e,i,n,a,s,r,o,l,u,h){t.save(),1!==i&&(void 0===t.globalAlpha?t.globalAlpha=t=>t.globalAlpha*=i:t.globalAlpha*=i),e&&t.transform.apply(t,e),n.contextInstructions?(t.translate(l,u),t.scale(h[0],h[1]),function(t,e){const i=t.contextInstructions;for(let t=0,n=i.length;t<n;t+=2)Array.isArray(i[t+1])?e[i[t]].apply(e,i[t+1]):e[i[t]]=i[t+1]}(n,t)):h[0]<0||h[1]<0?(t.translate(l,u),t.scale(h[0],h[1]),t.drawImage(n,a,s,r,o,0,0,r,o)):t.drawImage(n,a,s,r,o,l,u,r*h[0],o*h[1]),t.restore()}(t,n.canvasTransform,a,i,n.originX,n.originY,n.drawImageW,n.drawImageH,n.drawImageX,n.drawImageY,n.scale)),!0}fill_(t){const e=this.alignAndScaleFill_;if(e){const i=vi(this.renderedTransform_,[0,0]),n=512*this.pixelRatio;t.save(),t.translate(i[0]%n,i[1]%n),1!==e&&t.scale(e,e),t.rotate(this.viewRotation_)}t.fill(),e&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],e[1]&&(t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6]))}drawLabelWithPointPlacement_(t,e,i,n){const a=this.textStates[e],s=this.createLabel(t,e,n,i),r=this.strokeStates[i],o=this.pixelRatio,l=xg(Array.isArray(t)?t[0]:t,a.textAlign||hl),u=hg[a.textBaseline||cl],h=r&&r.lineWidth?r.lineWidth:0;return{label:s,anchorX:l*(s.width/o-2*a.scale[0])+2*(.5-l)*h,anchorY:u*s.height/o+2*(.5-u)*h}}execute_(t,e,i,n,a,s,r,o){const l=this.zIndexContext_;let u;var h,c;this.pixelCoordinates_&&v(i,this.renderedTransform_)?u=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),u=Ti(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),c=i,(h=this.renderedTransform_)[0]=c[0],h[1]=c[1],h[2]=c[2],h[3]=c[3],h[4]=c[4],h[5]=c[5]);let d=0;const p=n.length;let m,f,g,_,y,k,x,w,b,E,M,T,S,C=0,L=0,R=0;const I=this.coordinateCache_,P=this.viewRotation_,A=Math.round(1e12*Math.atan2(-i[1],i[0]))/1e12,j={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:P},O=this.instructions!=n||this.overlaps?0:200;let F,N,G,D;for(;d<p;){const i=n[d];switch(i[0]){case sg.BEGIN_GEOMETRY:F=i[1],D=i[3],F.getGeometry()?void 0===r||wt(r,D.getExtent())?++d:d=i[2]+1:d=i[2],l&&(l.zIndex=i[4]);break;case sg.BEGIN_PATH:L>O&&(this.fill_(t),L=0),R>O&&(t.stroke(),R=0),L||R||(t.beginPath(),y=NaN,k=NaN),++d;break;case sg.CIRCLE:C=i[1];const n=u[C],h=u[C+1],c=u[C+2]-n,p=u[C+3]-h,v=Math.sqrt(c*c+p*p);t.moveTo(n+v,h),t.arc(n,h,v,0,2*Math.PI,!0),++d;break;case sg.CLOSE_PATH:t.closePath(),++d;break;case sg.CUSTOM:C=i[1],m=i[2];const W=i[3],H=i[4],U=i[5];j.geometry=W,j.feature=F,d in I||(I[d]=[]);const B=I[d];U?U(u,C,m,2,B):(B[0]=u[C],B[1]=u[C+1],B.length=2),l&&(l.zIndex=i[6]),H(B,j),++d;break;case sg.DRAW_IMAGE:C=i[1],m=i[2],b=i[3],f=i[4],g=i[5];let V=i[6];const K=i[7],z=i[8],$=i[9],Y=i[10];let X=i[11];const q=i[12];let Z=i[13];_=i[14]||"declutter";const J=i[15];if(!b&&i.length>=20){E=i[19],M=i[20],T=i[21],S=i[22];const t=this.drawLabelWithPointPlacement_(E,M,T,S);b=t.label,i[3]=b;const e=i[23];f=(t.anchorX-e)*this.pixelRatio,i[4]=f;const n=i[24];g=(t.anchorY-n)*this.pixelRatio,i[5]=g,V=b.height,i[6]=V,Z=b.width,i[13]=Z}let Q,tt,et,it;i.length>25&&(Q=i[25]),i.length>17?(tt=i[16],et=i[17],it=i[18]):(tt=dl,et=null,it=null),Y&&A?X+=P:Y||A||(X-=P);let nt=0;for(;C<m;C+=2){if(Q&&Q[nt++]<Z/this.pixelRatio)continue;const i=this.calculateImageOrLabelDimensions_(b.width,b.height,u[C],u[C+1],Z,V,f,g,z,$,X,q,a,tt,!!et||!!it,F),n=[t,e,b,i,K,et,it];if(o){let t,e,a,s,r;if(J){const i=m-C;if(!J[i]){J[i]={args:n,declutterMode:_};continue}const s=J[i];t=s.args,e=s.declutterMode,delete J[i],a=kg(t)}if(!t||"declutter"===e&&o.collides(a)||(s=!0),"declutter"===_&&o.collides(i.declutterBox)||(r=!0),"declutter"===e&&"declutter"===_){const t=s&&r;s=t,r=t}s&&("none"!==e&&o.insert(a),this.replayImageOrLabel_.apply(this,t)),r&&("none"!==_&&o.insert(i.declutterBox),this.replayImageOrLabel_.apply(this,n))}else this.replayImageOrLabel_.apply(this,n)}++d;break;case sg.DRAW_CHARS:const at=i[1],st=i[2],rt=i[3],ot=i[4];S=i[5];const lt=i[6],ut=i[7],ht=i[8];T=i[9];const ct=i[10];E=i[11],Array.isArray(E)&&(E=E.reduce(bg,"")),M=i[12];const dt=[i[13],i[13]];_=i[14]||"declutter";const pt=i[15],mt=this.textStates[M],ft=mt.font,gt=[mt.scale[0]*ut,mt.scale[1]*ut];let _t;ft in this.widths_?_t=this.widths_[ft]:(_t={},this.widths_[ft]=_t);const yt=Pu(u,at,st,2),kt=Math.abs(gt[0])*bl(ft,E,_t);if(ot||kt<=yt){const i=pg(u,at,st,2,E,(yt-kt)*xg(E,this.textStates[M].textAlign),lt,Math.abs(gt[0]),bl,ft,_t,A?0:this.viewRotation_,pt);t:if(i){const n=[];let a,s,r,l,u;if(T)for(a=0,s=i.length;a<s;++a){u=i[a],r=u[4],l=this.createLabel(r,M,"",T),f=u[2]+(gt[0]<0?-ct:ct),g=rt*l.height+2*(.5-rt)*ct*gt[1]/gt[0]-ht;const s=this.calculateImageOrLabelDimensions_(l.width,l.height,u[0],u[1],l.width,l.height,f,g,0,0,u[3],dt,!1,dl,!1,F);if(o&&"declutter"===_&&o.collides(s.declutterBox))break t;n.push([t,e,l,s,1,null,null])}if(S)for(a=0,s=i.length;a<s;++a){u=i[a],r=u[4],l=this.createLabel(r,M,S,""),f=u[2],g=rt*l.height-ht;const s=this.calculateImageOrLabelDimensions_(l.width,l.height,u[0],u[1],l.width,l.height,f,g,0,0,u[3],dt,!1,dl,!1,F);if(o&&"declutter"===_&&o.collides(s.declutterBox))break t;n.push([t,e,l,s,1,null,null])}o&&"none"!==_&&o.load(n.map(kg));for(let t=0,e=n.length;t<e;++t)this.replayImageOrLabel_.apply(this,n[t])}}++d;break;case sg.END_GEOMETRY:if(void 0!==s){F=i[1];const t=s(F,D,_);if(t)return t}++d;break;case sg.FILL:O?L++:this.fill_(t),++d;break;case sg.MOVE_TO_LINE_TO:for(C=i[1],m=i[2],N=u[C],G=u[C+1],t.moveTo(N,G),y=N+.5|0,k=G+.5|0,C+=2;C<m;C+=2)N=u[C],G=u[C+1],x=N+.5|0,w=G+.5|0,C!=m-2&&x===y&&w===k||(t.lineTo(N,G),y=x,k=w);++d;break;case sg.SET_FILL_STYLE:this.alignAndScaleFill_=i[2],L&&(this.fill_(t),L=0,R&&(t.stroke(),R=0)),t.fillStyle=i[1],++d;break;case sg.SET_STROKE_STYLE:R&&(t.stroke(),R=0),this.setStrokeStyle_(t,i),++d;break;case sg.STROKE:O?R++:t.stroke(),++d;break;default:++d}}L&&this.fill_(t),R&&t.stroke()}execute(t,e,i,n,a,s){this.viewRotation_=n,this.execute_(t,e,i,this.instructions,a,void 0,void 0,s)}executeHitDetection(t,e,i,n,a){return this.viewRotation_=i,this.execute_(t,[t.canvas.width,t.canvas.height],e,this.hitDetectionInstructions,!0,n,a)}},Mg=["Polygon","Circle","LineString","Image","Text","Default"],Tg=["Image","Text"],Sg=Mg.filter(t=>!Tg.includes(t)),Cg={},Lg=class{constructor(t,e,i,n,a,s,r){this.maxExtent_=t,this.overlaps_=n,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=s,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=[1,0,0,1,0,0],this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(a,r)}clip(t,e){const i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()}createExecutors_(t,e){for(const i in t){let n=this.executorsByZIndex_[i];void 0===n&&(n={},this.executorsByZIndex_[i]=n);const a=t[i];for(const t in a){const i=a[t];n[t]=new Eg(this.resolution_,this.pixelRatio_,this.overlaps_,i,e)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const i=this.executorsByZIndex_[e];for(let e=0,n=t.length;e<n;++e)if(t[e]in i)return!0}return!1}forEachFeatureAtCoordinate(t,e,i,n,a,s){const r=2*(n=Math.round(n))+1,o=wi(this.hitDetectionTransform_,n+.5,n+.5,1/e,-1/e,-i,-t[0],-t[1]),l=!this.hitDetectionContext_;l&&(this.hitDetectionContext_=Ta(r,r));const u=this.hitDetectionContext_;let h;u.canvas.width!==r||u.canvas.height!==r?(u.canvas.width=r,u.canvas.height=r):l||u.clearRect(0,0,r,r),void 0!==this.renderBuffer_&&(h=[1/0,1/0,-1/0,-1/0],rt(h,t),$(h,e*(this.renderBuffer_+n),h));const c=function(t){if(void 0!==Cg[t])return Cg[t];const e=2*t+1,i=t*t,n=new Array(i+1);for(let a=0;a<=t;++a)for(let s=0;s<=t;++s){const r=a*a+s*s;if(r>i)break;let o=n[r];o||(o=[],n[r]=o),o.push(4*((t+a)*e+(t+s))+3),a>0&&o.push(4*((t-a)*e+(t+s))+3),s>0&&(o.push(4*((t+a)*e+(t-s))+3),a>0&&o.push(4*((t-a)*e+(t-s))+3))}const a=[];for(let t=0,e=n.length;t<e;++t)n[t]&&a.push(...n[t]);return Cg[t]=a,a}(n);let d;function p(t,e,i){const o=u.getImageData(0,0,r,r).data;for(let l=0,h=c.length;l<h;l++)if(o[c[l]]>0){if(!s||"none"===i||"Image"!==d&&"Text"!==d||s.includes(t)){const i=(c[l]-3)/4,s=n-i%r,o=n-(i/r|0),u=a(t,e,s*s+o*o);if(u)return u}u.clearRect(0,0,r,r);break}}const m=Object.keys(this.executorsByZIndex_).map(Number);let g,_,y,k,v;for(m.sort(f),g=m.length-1;g>=0;--g){const t=m[g].toString();for(y=this.executorsByZIndex_[t],_=Mg.length-1;_>=0;--_)if(d=Mg[_],k=y[d],void 0!==k&&(v=k.executeHitDetection(u,o,i,p,h),v))return v}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const i=e[0],n=e[1],a=e[2],s=e[3],r=[i,n,i,s,a,s,a,n];return Ti(r,0,8,2,t,r),r}isEmpty(){return S(this.executorsByZIndex_)}execute(t,e,i,n,a,s,r){const o=Object.keys(this.executorsByZIndex_).map(Number);o.sort(r?g:f),s=s||Mg;const l=Mg.length;for(let u=0,h=o.length;u<h;++u){const h=o[u].toString(),c=this.executorsByZIndex_[h];for(let h=0,d=s.length;h<d;++h){const d=s[h],p=c[d];if(void 0!==p){const s=null===r?void 0:p.getZIndexContext(),h=s?s.getContext():t,c=this.maxExtent_&&"Image"!==d&&"Text"!==d;if(c&&(h.save(),this.clip(h,i)),s&&"Text"!==d&&"Image"!==d?s.pushFunction(t=>p.execute(t,e,i,n,a,r)):p.execute(h,e,i,n,a,r),c&&h.restore(),s){s.offset();const t=o[u]*l+Mg.indexOf(d);this.deferredZIndexContexts_[t]||(this.deferredZIndexContexts_[t]=[]),this.deferredZIndexContexts_[t].push(s)}}}}this.renderedContext_=t}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const t=this.deferredZIndexContexts_,e=Object.keys(t).map(Number).sort(f);for(let i=0,n=e.length;i<n;++i)t[e[i]].forEach(t=>{t.draw(this.renderedContext_),t.clear()}),t[e[i]].length=0}},Rg=class extends Qf{constructor(t,e,i,n,a,s,r){super(),this.context_=t,this.pixelRatio_=e,this.extent_=i,this.transform_=n,this.transformRotation_=n?jt(Math.atan2(n[1],n[0]),10):0,this.viewRotation_=a,this.squaredTolerance_=s,this.userTransform_=r,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=[1,0,0,1,0,0]}drawImages_(t,e,i,n){if(!this.image_)return;const a=Ti(t,e,i,n,this.transform_,this.pixelCoordinates_),s=this.context_,r=this.tmpLocalTransform_,o=s.globalAlpha;1!=this.imageOpacity_&&(s.globalAlpha=o*this.imageOpacity_);let l=this.imageRotation_;0===this.transformRotation_&&(l-=this.viewRotation_),this.imageRotateWithView_&&(l+=this.viewRotation_);for(let t=0,e=a.length;t<e;t+=2){const e=a[t]-this.imageAnchorX_,i=a[t+1]-this.imageAnchorY_;if(0!==l||1!=this.imageScale_[0]||1!=this.imageScale_[1]){const t=e+this.imageAnchorX_,n=i+this.imageAnchorY_;wi(r,t,n,1,1,l,-t,-n),s.save(),s.transform.apply(s,r),s.translate(t,n),s.scale(this.imageScale_[0],this.imageScale_[1]),s.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),s.restore()}else s.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,e,i,this.imageWidth_,this.imageHeight_)}1!=this.imageOpacity_&&(s.globalAlpha=o)}drawText_(t,e,i,n){if(!this.textState_||""===this.text_)return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const a=Ti(t,e,i,n,this.transform_,this.pixelCoordinates_),s=this.context_;let r=this.textRotation_;for(0===this.transformRotation_&&(r-=this.viewRotation_),this.textRotateWithView_&&(r+=this.viewRotation_);e<i;e+=n){const t=a[e]+this.textOffsetX_,i=a[e+1]+this.textOffsetY_;0!==r||1!=this.textScale_[0]||1!=this.textScale_[1]?(s.save(),s.translate(t-this.textOffsetX_,i-this.textOffsetY_),s.rotate(r),s.translate(this.textOffsetX_,this.textOffsetY_),s.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&s.strokeText(this.text_,0,0),this.textFillState_&&s.fillText(this.text_,0,0),s.restore()):(this.textStrokeState_&&s.strokeText(this.text_,t,i),this.textFillState_&&s.fillText(this.text_,t,i))}}moveToLineTo_(t,e,i,n,a){const s=this.context_,r=Ti(t,e,i,n,this.transform_,this.pixelCoordinates_);s.moveTo(r[0],r[1]);let o=r.length;a&&(o-=2);for(let t=2;t<o;t+=2)s.lineTo(r[t],r[t+1]);return a&&s.closePath(),i}drawRings_(t,e,i,n){for(let a=0,s=i.length;a<s;++a)e=this.moveToLineTo_(t,e,i[a],n,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),wt(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=function(t,e,i){const n=t.getFlatCoordinates();if(!n)return null;const a=t.getStride();return Ti(n,0,n.length,a,e,i)}(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],n=e[3]-e[1],a=Math.sqrt(i*i+n*n),s=this.context_;s.beginPath(),s.arc(e[0],e[1],a,0,2*Math.PI),this.fillState_&&s.fill(),this.strokeState_&&s.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t)}}drawFeature(t,e){const i=e.getGeometryFunction()(t);i&&(this.setStyle(e),this.drawGeometry(i))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let t=0,i=e.length;t<i;++t)this.drawGeometry(e[t])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),wt(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(wt(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();let n=0;const a=t.getEnds(),s=t.getStride();e.beginPath();for(let t=0,e=a.length;t<e;++t)n=this.moveToLineTo_(i,n,a[t],s,!1);e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoints();this.drawText_(e,0,e.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),wt(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),wt(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getOrientedFlatCoordinates();let n=0;const a=t.getEndss(),s=t.getStride();e.beginPath();for(let t=0,e=a.length;t<e;++t){const e=a[t];n=this.drawRings_(i,n,e,s)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),v(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,i=this.contextTextState_,n=t.textAlign?t.textAlign:hl;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=n&&(i.textAlign=n,e.textAlign=n),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=n,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:n,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(t){const e=t.getColor();this.fillState_={fillStyle:nl(e||sl)}}else this.fillState_=null;if(e){const t=e.getColor(),i=e.getLineCap(),n=e.getLineDash(),a=e.getLineDashOffset(),s=e.getLineJoin(),r=e.getWidth(),o=e.getMiterLimit(),l=n||ol;this.strokeState_={lineCap:void 0!==i?i:rl,lineDash:1===this.pixelRatio_?l:l.map(t=>t*this.pixelRatio_),lineDashOffset:(a||0)*this.pixelRatio_,lineJoin:void 0!==s?s:ll,lineWidth:(void 0!==r?r:1)*this.pixelRatio_,miterLimit:void 0!==o?o:10,strokeStyle:nl(t||ul)}}else this.strokeState_=null}setImageStyle(t){let e;if(!t||!(e=t.getSize()))return void(this.image_=null);const i=t.getPixelRatio(this.pixelRatio_),n=t.getAnchor(),a=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=n[0]*i,this.imageAnchorY_=n[1]*i,this.imageHeight_=e[1]*i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=a[0],this.imageOriginY_=a[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const s=t.getScaleArray();this.imageScale_=[s[0]*this.pixelRatio_/i,s[1]*this.pixelRatio_/i],this.imageWidth_=e[0]*i}setTextStyle(t){if(t){const e=t.getFill();if(e){const t=e.getColor();this.textFillState_={fillStyle:nl(t||sl)}}else this.textFillState_=null;const i=t.getStroke();if(i){const t=i.getColor(),e=i.getLineCap(),n=i.getLineDash(),a=i.getLineDashOffset(),s=i.getLineJoin(),r=i.getWidth(),o=i.getMiterLimit();this.textStrokeState_={lineCap:void 0!==e?e:rl,lineDash:n||ol,lineDashOffset:a||0,lineJoin:void 0!==s?s:ll,lineWidth:void 0!==r?r:1,miterLimit:void 0!==o?o:10,strokeStyle:nl(t||ul)}}else this.textStrokeState_=null;const n=t.getFont(),a=t.getOffsetX(),s=t.getOffsetY(),r=t.getRotateWithView(),o=t.getRotation(),l=t.getScaleArray(),u=t.getText(),h=t.getTextAlign(),c=t.getTextBaseline();this.textState_={font:void 0!==n?n:al,textAlign:void 0!==h?h:hl,textBaseline:void 0!==c?c:cl},this.text_=void 0!==u?Array.isArray(u)?u.reduce((t,e,i)=>t+(i%2?" ":e),""):u:"",this.textOffsetX_=void 0!==a?this.pixelRatio_*a:0,this.textOffsetY_=void 0!==s?this.pixelRatio_*s:0,this.textRotateWithView_=void 0!==r&&r,this.textRotation_=void 0!==o?o:0,this.textScale_=[this.pixelRatio_*l[0],this.pixelRatio_*l[1]]}else this.text_=""}},Ig=.5,Pg={Point:function(t,e,i,n,a,s){const r=i.getImage(),o=i.getText(),l=o&&o.getText(),u=s&&r&&l?{}:void 0;if(r){if(2!=r.getImageState())return;const s=t.getBuilder(i.getZIndex(),"Image");s.setImageStyle(r,u),s.drawPoint(e,n,a)}if(l){const s=t.getBuilder(i.getZIndex(),"Text");s.setTextStyle(o,u),s.drawText(e,n,a)}},LineString:function(t,e,i,n,a){const s=i.getStroke();if(s){const r=t.getBuilder(i.getZIndex(),"LineString");r.setFillStrokeStyle(null,s),r.drawLineString(e,n,a)}const r=i.getText();if(r&&r.getText()){const s=t.getBuilder(i.getZIndex(),"Text");s.setTextStyle(r),s.drawText(e,n,a)}},Polygon:function(t,e,i,n,a){const s=i.getFill(),r=i.getStroke();if(s||r){const o=t.getBuilder(i.getZIndex(),"Polygon");o.setFillStrokeStyle(s,r),o.drawPolygon(e,n,a)}const o=i.getText();if(o&&o.getText()){const s=t.getBuilder(i.getZIndex(),"Text");s.setTextStyle(o),s.drawText(e,n,a)}},MultiPoint:function(t,e,i,n,a,s){const r=i.getImage(),o=r&&0!==r.getOpacity(),l=i.getText(),u=l&&l.getText(),h=s&&o&&u?{}:void 0;if(o){if(2!=r.getImageState())return;const s=t.getBuilder(i.getZIndex(),"Image");s.setImageStyle(r,h),s.drawMultiPoint(e,n,a)}if(u){const s=t.getBuilder(i.getZIndex(),"Text");s.setTextStyle(l,h),s.drawText(e,n,a)}},MultiLineString:function(t,e,i,n,a){const s=i.getStroke();if(s){const r=t.getBuilder(i.getZIndex(),"LineString");r.setFillStrokeStyle(null,s),r.drawMultiLineString(e,n,a)}const r=i.getText();if(r&&r.getText()){const s=t.getBuilder(i.getZIndex(),"Text");s.setTextStyle(r),s.drawText(e,n,a)}},MultiPolygon:function(t,e,i,n,a){const s=i.getFill(),r=i.getStroke();if(r||s){const o=t.getBuilder(i.getZIndex(),"Polygon");o.setFillStrokeStyle(s,r),o.drawMultiPolygon(e,n,a)}const o=i.getText();if(o&&o.getText()){const s=t.getBuilder(i.getZIndex(),"Text");s.setTextStyle(o),s.drawText(e,n,a)}},GeometryCollection:function(t,e,i,n,a,s){const r=e.getGeometriesArray();let o,l;for(o=0,l=r.length;o<l;++o)(0,Pg[r[o].getType()])(t,r[o],i,n,a,s)},Circle:function(t,e,i,n,a){const s=i.getFill(),r=i.getStroke();if(s||r){const o=t.getBuilder(i.getZIndex(),"Circle");o.setFillStrokeStyle(s,r),o.drawCircle(e,n,a)}const o=i.getText();if(o&&o.getText()){const a=t.getBuilder(i.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,n)}}};function Ag(t,e){return parseInt(N(t),10)-parseInt(N(e),10)}function jg(t,e){const i=Og(t,e);return i*i}function Og(t,e){return.5*t/e}function Fg(t,e,i,n,a,s,r,o){const l=[],u=i.getImage();if(u){let t=!0;const e=u.getImageState();2==e||3==e?t=!1:0==e&&u.load(),t&&l.push(u.ready())}const h=i.getFill();h&&h.loading()&&l.push(h.ready());const c=l.length>0;return c&&Promise.all(l).then(()=>a(null)),function(t,e,i,n,a,s,r){const o=i.getGeometryFunction()(e);if(!o)return;const l=o.simplifyTransformed(n,a);i.getRenderer()?Ng(t,l,i,e,r):(0,Pg[l.getType()])(t,l,i,e,r,s)}(t,e,i,n,s,r,o),c}function Ng(t,e,i,n,a){if("GeometryCollection"==e.getType()){const s=e.getGeometries();for(let e=0,r=s.length;e<r;++e)Ng(t,s[e],i,n,a);return}t.getBuilder(i.getZIndex(),"Default").drawCustom(e,n,i.getRenderer(),i.getHitDetectionRenderer(),a)}const Gg=class extends gf{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=[1/0,1/0,-1/0,-1/0],this.wrappedRenderedExtent_=[1/0,1/0,-1/0,-1/0],this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(t,e,i){const n=e.extent,a=e.viewState,s=a.center,r=a.resolution,o=a.projection,l=a.rotation,u=o.getExtent(),h=this.getLayer().getSource(),c=this.getLayer().getDeclutter(),d=e.pixelRatio,p=e.viewHints,m=!(p[0]||p[1]),f=this.context,g=Math.round(xt(n)/r*d),_=Math.round(_t(n)/r*d),y=h.getWrapX()&&o.canWrapX(),k=y?xt(u):null,v=y?Math.ceil((n[2]-u[2])/k)+1:1;let x=y?Math.floor((n[0]-u[0])/k):0;do{let n=this.getRenderTransform(s,r,0,d,g,_,x*k);e.declutter&&(n=n.slice(0)),t.execute(f,[f.canvas.width,f.canvas.height],n,l,m,void 0===i?Mg:i?Tg:Sg,i?c&&e.declutter[c]:void 0)}while(++x<v)}setDrawContext_(){1!==this.opacity_&&(this.targetContext_=this.context,this.context=Ta(this.context.canvas.width,this.context.canvas.height,mf))}resetDrawContext_(){if(1!==this.opacity_&&this.targetContext_){const t=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=t,La(this.context),mf.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(t){this.replayGroup_&&this.getLayer().getDeclutter()&&this.renderWorlds(this.replayGroup_,t,!0)}renderDeferredInternal(t){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(t,e){const i=t.layerStatesArray[t.layerIndex];this.opacity_=i.opacity;const n=t.viewState;this.prepareContainer(t,e);const a=this.context,s=this.replayGroup_;let r=s&&!s.isEmpty();if(!r&&!this.getLayer().hasListener(Ps)&&!this.getLayer().hasListener(As))return this.container;this.setDrawContext_(),this.preRender(a,t);n.projection;if(this.clipped_=!1,r&&i.extent&&this.clipping){const e=ci(i.extent);r=wt(e,t.extent),this.clipped_=r&&!Z(e,t.extent),this.clipped_&&this.clipUnrotated(a,t,e)}return r&&this.renderWorlds(s,t,!this.getLayer().getDeclutter()&&void 0),!t.declutter&&this.clipped_&&a.restore(),this.postRender(a,t),this.renderedRotation_!==n.rotation&&(this.renderedRotation_=n.rotation,this.hitDetectionImageData_=null),t.declutter||this.resetDrawContext_(),this.container}getFeatures(t){return new Promise(e=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const t=this.frameState.size.slice(),e=this.renderedCenter_,i=this.renderedResolution_,n=this.renderedRotation_,a=this.renderedProjection_,s=this.wrappedRenderedExtent_,r=this.getLayer(),o=[],l=t[0]*Ig,u=t[1]*Ig;o.push(this.getRenderTransform(e,i,n,Ig,l,u,0).slice());const h=r.getSource(),c=a.getExtent();if(h.getWrapX()&&a.canWrapX()&&!Z(c,s)){let t=s[0];const a=xt(c);let r,h=0;for(;t<c[0];)--h,r=a*h,o.push(this.getRenderTransform(e,i,n,Ig,l,u,r).slice()),t+=a;for(h=0,t=s[2];t>c[2];)++h,r=a*h,o.push(this.getRenderTransform(e,i,n,Ig,l,u,r).slice()),t-=a}const d=oi();this.hitDetectionImageData_=function(t,e,i,n,a,s,r,o,l){const u=l?hi(a):a,h=Ta(t[0]*Ig,t[1]*Ig);h.imageSmoothingEnabled=!1;const c=h.canvas,d=new Rg(h,Ig,a,null,r,o,l?ei(oi(),l):null),p=i.length,m=Math.floor(16777215/p),g={};for(let t=1;t<=p;++t){const e=i[t-1],a=e.getStyleFunction()||n;if(!a)continue;let r=a(e,s);if(!r)continue;Array.isArray(r)||(r=[r]);const o=(t*m).toString(16).padStart(7,"#00000");for(let t=0,i=r.length;t<i;++t){const i=r[t],n=i.getGeometryFunction()(e);if(!n||!wt(u,n.getExtent()))continue;const a=i.clone(),s=a.getFill();s&&s.setColor(o);const l=a.getStroke();l&&(l.setColor(o),l.setLineDash(null)),a.setText(void 0);const h=i.getImage();if(h){const t=h.getImageSize();if(!t)continue;const e=Ta(t[0],t[1],void 0,{alpha:!1}),i=e.canvas;e.fillStyle=o,e.fillRect(0,0,i.width,i.height),a.setImage(new jl({img:i,anchor:h.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:h.getOrigin(),opacity:1,size:h.getSize(),scale:h.getScale(),rotation:h.getRotation(),rotateWithView:h.getRotateWithView()}))}const c=a.getZIndex()||0;let d=g[c];d||(d={},g[c]=d,d.Polygon=[],d.Circle=[],d.LineString=[],d.Point=[]);const p=n.getType();if("GeometryCollection"===p){const t=n.getGeometriesArrayRecursive();for(let e=0,i=t.length;e<i;++e){const i=t[e];d[i.getType().replace("Multi","")].push(i,a)}}else d[p.replace("Multi","")].push(n,a)}}const _=Object.keys(g).map(Number).sort(f);for(let t=0,i=_.length;t<i;++t){const i=g[_[t]];for(const t in i){const n=i[t];for(let t=0,i=n.length;t<i;t+=2){d.setStyle(n[t+1]);for(let i=0,a=e.length;i<a;++i)d.setTransform(e[i]),d.drawGeometry(n[t])}}}return h.getImageData(0,0,c.width,c.height)}(t,o,this.renderedFeatures_,r.getStyleFunction(),s,i,n,jg(i,this.renderedPixelRatio_),d?a:null)}e(function(t,e,i){const n=[];if(i){const a=Math.floor(Math.round(t[0])*Ig),s=Math.floor(Math.round(t[1])*Ig),r=4*(St(a,0,i.width-1)+St(s,0,i.height-1)*i.width),o=i.data[r],l=i.data[r+1],u=i.data[r+2]+256*(l+256*o),h=Math.floor(16777215/e.length);u&&u%h===0&&n.push(e[u/h-1])}return n}(t,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(t,e,i,n,a){if(!this.replayGroup_)return;const s=e.viewState.resolution,r=e.viewState.rotation,o=this.getLayer(),l={},u=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(t,s,r,i,function(t,e,i){const s=N(t),r=l[s];if(r){if(!0!==r&&i<r.distanceSq){if(0===i)return l[s]=!0,a.splice(a.lastIndexOf(r),1),n(t,o,e);r.geometry=e,r.distanceSq=i}}else{if(0===i)return l[s]=!0,n(t,o,e);a.push(l[s]={feature:t,layer:o,geometry:e,distanceSq:i,callback:n})}},u?e.declutter?.[u]?.all().map(t=>t.value):null)}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),i=e.getSource();if(!i)return!1;const n=t.viewHints[0],a=t.viewHints[1],s=e.getUpdateWhileAnimating(),r=e.getUpdateWhileInteracting();if(this.ready&&!s&&n||!r&&a)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const o=t.extent,l=t.viewState,u=l.projection,h=l.resolution,c=t.pixelRatio,d=e.getRevision(),p=e.getRenderBuffer();let m=e.getRenderOrder();void 0===m&&(m=Ag);const f=l.center.slice(),g=$(o,p*h),_=g.slice(),y=[g.slice()],k=u.getExtent();if(i.getWrapX()&&u.canWrapX()&&!Z(k,t.extent)){const t=xt(k),e=Math.max(xt(g)/2,t);g[0]=k[0]-e,g[2]=k[2]+e,Xt(f,u);const i=Mt(y[0],u);i[0]<k[0]&&i[2]<k[2]?y.push([i[0]+t,i[1],i[2]+t,i[3]]):i[0]>k[0]&&i[2]>k[2]&&y.push([i[0]-t,i[1],i[2]-t,i[3]])}if(this.ready&&this.renderedResolution_==h&&this.renderedRevision_==d&&this.renderedRenderOrder_==m&&this.renderedFrameDeclutter_===!!t.declutter&&Z(this.wrappedRenderedExtent_,g))return v(this.renderedExtent_,_)||(this.hitDetectionImageData_=null,this.renderedExtent_=_),this.renderedCenter_=f,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const x=new dg(Og(h,c),g,h,c),w=oi();let b;if(w){for(let t=0,e=y.length;t<e;++t){const e=hi(y[t]);i.loadFeatures(e,di(h),w)}b=ei(w,u)}else for(let t=0,e=y.length;t<e;++t)i.loadFeatures(y[t],h,u);const E=jg(h,c);let M=!0;const T=(t,i)=>{let n;const a=t.getStyleFunction()||e.getStyleFunction();if(a&&(n=a(t,h)),n){const e=this.renderFeature(t,E,n,x,b,this.getLayer().getDeclutter(),i);M=M&&!e}},S=hi(g),C=i.getFeaturesInExtent(S);m&&C.sort(m);for(let t=0,e=C.length;t<e;++t)T(C[t],t);this.renderedFeatures_=C,this.ready=M;const L=x.finish(),R=new Lg(g,h,c,i.getOverlaps(),L,e.getRenderBuffer(),!!t.declutter);return this.renderedResolution_=h,this.renderedRevision_=d,this.renderedRenderOrder_=m,this.renderedFrameDeclutter_=!!t.declutter,this.renderedExtent_=_,this.wrappedRenderedExtent_=g,this.renderedCenter_=f,this.renderedProjection_=u,this.renderedPixelRatio_=c,this.replayGroup_=R,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,i,n,a,s,r){if(!i)return!1;let o=!1;if(Array.isArray(i))for(let l=0,u=i.length;l<u;++l)o=Fg(n,t,i[l],e,this.boundHandleStyleImageChange_,a,s,r)||o;else o=Fg(n,t,i,e,this.boundHandleStyleImageChange_,a,s,r);return o}},Dg=class extends mu{constructor(t){super(t)}createRenderer(){return new Gg(this)}};function Wg(t,e){return function(i,n,a,s,r){!function(t,e,i,n,a,s,r){const o=new XMLHttpRequest;o.open("GET","function"==typeof t?t(i,n,a):t,!0),"arraybuffer"==e.getType()&&(o.responseType="arraybuffer"),o.withCredentials=false,o.onload=function(t){if(!o.status||o.status>=200&&o.status<300){const t=e.getType();try{let n;"text"==t||"json"==t?n=o.responseText:"xml"==t?n=o.responseXML||o.responseText:"arraybuffer"==t&&(n=o.response),n?s(e.readFeatures(n,{extent:i,featureProjection:a}),e.readProjection(n)):r()}catch{r()}}else r()},o.onerror=r,o.send()}(t,e,i,n,a,(t,e)=>{this.addFeatures(t),void 0!==s&&s(t)},()=>{this.changed(),void 0!==r&&r()})}}function Hg(t,e){return[[-1/0,-1/0,1/0,1/0]]}const Ug=class{constructor(t){this.rbush_=new Us(t),this.items_={}}insert(t,e){const i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[N(e)]=i}load(t,e){const i=new Array(e.length);for(let n=0,a=e.length;n<a;n++){const a=t[n],s=e[n],r={minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],value:s};i[n]=r,this.items_[N(s)]=r}this.rbush_.load(i)}remove(t){const e=N(t),i=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(i)}update(t,e){const i=this.items_[N(e)];at([i.minX,i.minY,i.maxX,i.maxY],t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(t){return t.value})}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let i;for(let n=0,a=t.length;n<a;n++)if(i=e(t[n]),i)return i;return i}isEmpty(){return S(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return tt(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}},Bg="addfeature",Vg="removefeature";class Kg extends C{constructor(t,e,i){super(t),this.feature=e,this.features=i}}const zg=class extends Df{constructor(t){super({attributions:(t=t||{}).attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:void 0===t.wrapX||t.wrapX}),this.on,this.once,this.un,this.loader_=b,this.format_=t.format||null,this.overlaps_=void 0===t.overlaps||t.overlaps,this.url_=t.url,void 0!==t.loader?this.loader_=t.loader:void 0!==this.url_&&(B(this.format_,"`format` must be set when `url` is set"),this.loader_=Wg(this.url_,this.format_)),this.strategy_=void 0!==t.strategy?t.strategy:Hg;const e=void 0===t.useSpatialIndex||t.useSpatialIndex;let i,n;this.featuresRtree_=e?new Ug:null,this.loadedExtentsRtree_=new Ug,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,Array.isArray(t.features)?n=t.features:t.features&&(i=t.features,n=i.getArray()),e||void 0!==i||(i=new U(n)),void 0!==n&&this.addFeaturesInternal(n),void 0!==i&&this.bindFeaturesCollection_(i)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=N(t);if(!this.addToIndex_(e,t))return void(this.featuresCollection_&&this.featuresCollection_.remove(t));this.setupChangeEvents_(e,t);const i=t.getGeometry();if(i){const e=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(e,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new Kg(Bg,t))}setupChangeEvents_(t,e){e instanceof Iu||(this.featureChangeKeys_[t]=[R(e,o,this.handleFeatureChange_,this),R(e,r,this.handleFeatureChange_,this)])}addToIndex_(t,e){let i=!0;if(void 0!==e.getId()){const t=String(e.getId());if(t in this.idIndex_)if(e instanceof Iu){const n=this.idIndex_[t];n instanceof Iu?Array.isArray(n)?n.push(e):this.idIndex_[t]=[n,e]:i=!1}else i=!1;else this.idIndex_[t]=e}return i&&(B(!(t in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[t]=e),i}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],i=[],n=[];for(let e=0,n=t.length;e<n;e++){const n=t[e],a=N(n);this.addToIndex_(a,n)&&i.push(n)}for(let t=0,a=i.length;t<a;t++){const a=i[t],s=N(a);this.setupChangeEvents_(s,a);const r=a.getGeometry();if(r){const t=r.getExtent();e.push(t),n.push(a)}else this.nullGeometryFeatures_[s]=a}if(this.featuresRtree_&&this.featuresRtree_.load(e,n),this.hasListener(Bg))for(let t=0,e=i.length;t<e;t++)this.dispatchEvent(new Kg(Bg,i[t]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener(Bg,function(i){e||(e=!0,t.push(i.feature),e=!1)}),this.addEventListener(Vg,function(i){e||(e=!0,t.remove(i.feature),e=!1)}),t.addEventListener(a,t=>{e||(e=!0,this.addFeature(t.element),e=!1)}),t.addEventListener(s,t=>{e||(e=!0,this.removeFeature(t.element),e=!1)}),this.featuresCollection_=t}clear(t){if(t){for(const t in this.featureChangeKeys_)this.featureChangeKeys_[t].forEach(P);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(t=>{this.removeFeatureInternal(t)});for(const t in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[t])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new Kg("clear");this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){const i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,function(i){const n=i.getGeometry();if(n instanceof Iu||n.intersectsCoordinate(t))return e(i)})}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,function(i){const n=i.getGeometry();if(n instanceof Iu||n.intersectsExtent(t)){const t=e(i);if(t)return t}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),S(this.nullGeometryFeatures_)||k(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,function(t){e.push(t)}),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const i=Tt(t,e);return[].concat(...i.map(t=>this.featuresRtree_.getInExtent(t)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){const i=t[0],n=t[1];let a=null;const s=[NaN,NaN];let r=1/0;const o=[-1/0,-1/0,1/0,1/0];return e=e||x,this.featuresRtree_.forEachInExtent(o,function(t){if(e(t)){const e=t.getGeometry(),l=r;if(r=e instanceof Iu?0:e.closestPointXY(i,n,s,r),r<l){a=t;const e=Math.sqrt(r);o[0]=i-e,o[1]=n-e,o[2]=i+e,o[3]=n+e}}}),a}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const e=this.idIndex_[t.toString()];return void 0!==e?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return void 0!==e?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,i=N(e),n=e.getGeometry();if(n){const t=n.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(t,e)):this.featuresRtree_&&this.featuresRtree_.update(t,e)}else i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);const a=e.getId();if(void 0!==a){const t=a.toString();this.idIndex_[t]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[t]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[i]=e;this.changed(),this.dispatchEvent(new Kg("changefeature",e))}hasFeature(t){const e=t.getId();return void 0!==e?e in this.idIndex_:N(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&S(this.nullGeometryFeatures_):!this.featuresCollection_||0===this.featuresCollection_.getLength()}loadFeatures(t,e,i){const n=this.loadedExtentsRtree_,a=this.strategy_(t,e,i);for(let t=0,s=a.length;t<s;++t){const s=a[t];n.forEachInExtent(s,function(t){return Z(t.extent,s)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Kg("featuresloadstart")),this.loader_.call(this,s,e,i,t=>{--this.loadingExtentsCount_,this.dispatchEvent(new Kg("featuresloadend",void 0,t))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Kg("featuresloaderror"))}),n.insert(s,{extent:s.slice()}))}this.loading=!(this.loader_.length<4)&&this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_,i=e.forEachInExtent(t,function(e){if(at(e.extent,t))return e});i&&e.remove(i)}removeFeatures(t){let e=!1;for(let i=0,n=t.length;i<n;++i)e=this.removeFeatureInternal(t[i])||e;e&&this.changed()}removeFeature(t){t&&this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=N(t);if(!(e in this.uidIndex_))return!1;e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t);const i=this.featureChangeKeys_[e];i?.forEach(P),delete this.featureChangeKeys_[e];const n=t.getId();if(void 0!==n){const e=n.toString(),i=this.idIndex_[e];i===t?delete this.idIndex_[e]:Array.isArray(i)&&(i.splice(i.indexOf(t),1),1===i.length&&(this.idIndex_[e]=i[0]))}return delete this.uidIndex_[e],this.hasListener(Vg)&&this.dispatchEvent(new Kg(Vg,t)),!0}removeFromIdIndex_(t){for(const e in this.idIndex_)if(this.idIndex_[e]===t){delete this.idIndex_[e];break}}setLoader(t){this.loader_=t}setUrl(t){B(this.format_,"`format` must be set when `url` is set"),this.url_=t,this.setLoader(Wg(t,this.format_))}setOverlaps(t){this.overlaps_=t,this.changed()}};class $g{constructor(t){this.addCurrentPositionMarker=t=>{if(this.currentPositionFeature)return void this.currentPositionFeature.setGeometry(new en(t));const e=new Il({color:"rgba(0, 0, 255, 1.0)"}),i=new Fl({color:"rgba(255, 255, 255, 1.0)",width:3});this.currentPositionFeature=new K({geometry:new en(t)}),this.currentPositionFeature.setStyle(new Hl({image:new Ll({fill:e,stroke:i,radius:7}),fill:e,stroke:i})),this.source.addFeature(this.currentPositionFeature)},this.showLinkedFeatureMarker=t=>{if(this.linkedFeatureMarker)return this.linkedFeatureMarker.setStyle(Yg),void this.linkedFeatureMarker.setGeometry(new en(t));this.linkedFeatureMarker=new K({geometry:new en(t)}),this.linkedFeatureMarker.setStyle(Yg),this.source.addFeature(this.linkedFeatureMarker)},this.hideLinkedFeatureMarker=()=>{this.linkedFeatureMarker&&this.linkedFeatureMarker.setStyle(void 0)},this.getLayer=()=>this.layer,this.source=new zg,this.layer=new Dg({source:this.source}),t.linkedFeature&&this.showLinkedFeatureMarker(t.linkedFeature.coordinates)}}const Yg=new Hl({image:new jl({src:"images/map-pin.png",anchor:[.5,1]})}),Xg=t=>{switch(t){case zp.muinaisrannat:return 20;case zp.maapera_200k_maalaji:return 53}};class qg{constructor(t,e){this.toLayerIds=t=>t.map(Xg).sort((t,e)=>t-e),this.getSourceLayersParams=t=>t.gtk.selectedLayers.length>0?"show:"+this.toLayerIds(t.gtk.selectedLayers).join(","):"hide:"+this.toLayerIds(Object.values(zp)).join(","),this.createSource=t=>{const e={urls:[t.gtk.url.export],params:{layers:this.getSourceLayersParams(t)}},i=new Xf(e);return i.on("tileloadstart",()=>{this.updateTileLoadingStatus(!0)}),i.on("tileloadend",()=>{this.updateTileLoadingStatus(!1)}),i.on("tileloaderror",()=>{this.updateTileLoadingStatus(!1)}),i},this.updateLayerSource=t=>{this.source=this.createSource(t),this.layer.setSource(this.source),this.updateLayerVisibility(t)},this.updateLayerVisibility=t=>{const{gtk:{selectedLayers:e,enabled:i}}=t;this.layer.setVisible(i&&e.length>0)},this.selectedGTKLayersChanged=t=>{this.updateLayerSource(t)},this.opacityChanged=t=>{this.layer.setOpacity(t.gtk.opacity)},this.getLayer=()=>this.layer,this.updateTileLoadingStatus=e,this.source=this.createSource(t),this.layer=new Ef({source:this.source}),this.opacityChanged(t),this.updateLayerVisibility(t)}}function Zg(t,e){const i=(""+t).split("."),n=(""+e).split(".");for(let t=0;t<Math.max(i.length,n.length);t++){const e=parseInt(i[t]||"0",10),a=parseInt(n[t]||"0",10);if(e>a)return 1;if(a>e)return-1}return 0}const Jg="1.3.0";function Qg(t,e,i,n,a,s,r){s=Object.assign({REQUEST:"GetMap"},s);const o=e/i,l=[Ot(xt(t)/o,4),Ot(_t(t)/o,4)];if(1!=i)switch(r){case"geoserver":const t=90*i+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+t:s.FORMAT_OPTIONS="dpi:"+t;break;case"mapserver":s.MAP_RESOLUTION=90*i;break;case"carmentaserver":case"qgis":s.DPI=90*i;break;default:throw new Error("Unknown `serverType` configured")}return function(t,e,i,n,a){a.WIDTH=i[0],a.HEIGHT=i[1];const s=n.getAxisOrientation(),r=Zg(a.VERSION,"1.3")>=0;a[r?"CRS":"SRS"]=n.getCode();const o=r&&s.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e;return a.BBOX=o.join(","),Rf(t,a)}(a,t,l,n,s)}function t_(t,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:Jg,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},t)}const e_=class extends Yf{constructor(t){t=t||{};const e=Object.assign({},t.params);super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,zDirection:t.zDirection}),this.gutter_=void 0!==t.gutter?t.gutter:0,this.params_=e,this.v13_=!0,this.serverType_=t.serverType,this.hidpi_=void 0===t.hidpi||t.hidpi,this.tmpExtent_=[1/0,1/0,-1/0,-1/0],this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(t,e,i,n){const a=Ye(i),s=this.getProjection()||a;let r=this.getTileGrid();r||(r=this.getTileGridForProjection(s));const o=ai(t,a,s),l=ef(s,a,t,e),u=r.getZForResolution(l,this.zDirection),h=r.getResolution(u),c=r.getTileCoordForCoordAndZ(o,u);if(r.getResolutions().length<=c[0])return;let d=r.getTileCoordExtent(c,this.tmpExtent_);const p=this.gutter_;0!==p&&(d=$(d,h*p,d));const m={QUERY_LAYERS:this.params_.LAYERS};Object.assign(m,t_(this.params_,"GetFeatureInfo"),n);const f=Math.floor((o[0]-d[0])/h),g=Math.floor((d[3]-o[1])/h);return m[this.v13_?"I":"X"]=f,m[this.v13_?"J":"Y"]=g,this.getRequestUrl_(c,d,1,s||a,m)}getLegendUrl(t,e){if(void 0===this.urls[0])return;const i={SERVICE:"WMS",VERSION:Jg,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0===e||void 0===e.LAYER){const t=this.params_.LAYERS;if(Array.isArray(t)&&1!==t.length)return;i.LAYER=t}if(void 0!==t){const e=this.getProjection()?this.getProjection().getMetersPerUnit():1,n=28e-5;i.SCALE=t*e/n}return Object.assign(i,e),Rf(this.urls[0],i)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(t,e,i,n,a){const s=this.urls;if(!s)return;let r;return r=1==s.length?s[0]:s[Pt(cf(t),s.length)],Qg(e,(this.tileGrid||this.getTileGridForProjection(n)).getResolution(t[0]),i,n,r,a,this.serverType_)}getTilePixelRatio(t){return this.hidpi_&&void 0!==this.serverType_?t:1}getKeyForParams_(){let t=0;const e=[];for(const i in this.params_)e[t++]=i+"-"+this.params_[i];return e.join("/")}setParams_(t){this.params_=t,this.updateV13_(),this.setKey(this.getKeyForParams_())}setParams(t){this.setParams_(Object.assign({},t))}updateParams(t){this.setParams_(Object.assign(this.params_,t))}updateV13_(){const t=this.params_.VERSION||Jg;this.v13_=Zg(t,"1.3")>=0}tileUrlFunction(t,e,i){let n=this.getTileGrid();if(n||(n=this.getTileGridForProjection(i)),n.getResolutions().length<=t[0])return;1==e||this.hidpi_&&void 0!==this.serverType_||(e=1);const a=n.getResolution(t[0]);let s=n.getTileCoordExtent(t,this.tmpExtent_);const r=this.gutter_;0!==r&&(s=$(s,a*r,s));const o=Object.assign({},t_(this.params_,"GetMap"));return this.getRequestUrl_(t,s,e,i,o)}};var i_,n_,a_,s_;!function(t){t.Asema="asema",t.Tykkipatteri="tykkipatteri",t.Tykkitie="tykkitie",t.Muu="muu"}(i_||(i_={})),function(t){t["Tulipeske"]="tulipeske",t.Suojahuone="suojahuone",t.Kuoppa="kuoppa",t.Tykkiasema="tykkiasema",t.Rakenne="rakenne",t.Juoksuhauta="hauta",t.Luola="luola",t.Jalusta="jalusta",t.Suojavalli="suojavalli"}(n_||(n_={})),function(t){t.Asema="asema (hauta,suojahuone, tulipeske)",t.Luola="luola",t.Tykkitie="tykkitie",t.Tykkipatteri="tykkipatteri"}(a_||(a_={})),function(t){t.Tukikohta="tukikohta",t.Puolustusasema="laji"}(s_||(s_={}));const r_=t=>t.id?.toString().startsWith("Maalinnoitus_yksikot.")??!1,o_=t=>t.id?.toString().startsWith("Maalinnoitus_kohteet.")??!1,l_=t=>t.id?.toString().startsWith("Maalinnoitus_rajaukset.")??!1;class u_{constructor(t,e){this.createSource=t=>{const e={urls:[t.helsinki.url.wms],params:{LAYERS:t.helsinki.selectedLayers.join(","),TILED:!0},serverType:"geoserver"},i=new e_(e);return i.on("tileloadstart",()=>{this.updateTileLoadingStatus(!0)}),i.on("tileloadend",()=>{this.updateTileLoadingStatus(!1)}),i.on("tileloaderror",()=>{this.updateTileLoadingStatus(!1)}),i},this.updateLayerSource=t=>{this.source=this.createSource(t),this.layer.setSource(this.source),this.updateLayerVisibility(t)},this.updateLayerVisibility=t=>{const{helsinki:{selectedLayers:e,enabled:i}}=t;this.layer.setVisible(i&&e.length>0)},this.identifyFeaturesAt=async(t,e,i,n)=>{const a=this.layer?.getExtent(),s=n.helsinki.selectedLayers.filter(t=>t!==$p.Maalinnoitus_karttatekstit);if(!a||!q(a,t)||0===s.length||!n.helsinki.enabled)return[];if(this.source&&void 0!==e){const n=this.source.getFeatureInfoUrl(t,e,i,{INFO_FORMAT:"application/json",QUERY_LAYERS:s.join(","),FEATURE_COUNT:100,BUFFER:15});if(n)try{const t=await fetch(String(n)),e=await t.json();return this.removeDuplicateIdentifyFeatures(e.features)}catch{return[]}}return[]},this.removeDuplicateIdentifyFeatures=t=>{const e=t.filter(o_);return t.filter(t=>{if(o_(t)){const i=e.find(e=>e.properties.tukikohtanumero===t.properties.tukikohtanumero&&e.properties.olotila===t.properties.olotila);return i?.id===t.id}return!0})},this.selectedFeatureLayersChanged=t=>{this.updateLayerSource(t)},this.opacityChanged=t=>{this.layer.setOpacity(t.helsinki.opacity)},this.getLayer=()=>this.layer,this.updateTileLoadingStatus=e,this.source=this.createSource(t),this.layer=new Ef({extent:[375492.90815974085,6653540.407044016,405531.7569803879,6689393.357339721],source:this.source,visible:t.helsinki.selectedLayers.length>0}),this.opacityChanged(t),this.updateLayerVisibility(t)}}function h_(t,e){return c_(t,e,[]).join("")}function c_(t,e,i){if(t.nodeType==Node.CDATA_SECTION_NODE||t.nodeType==Node.TEXT_NODE)e?i.push(String(t.nodeValue).replace(/(\r\n|\r|\n)/g,"")):i.push(t.nodeValue);else{let n;for(n=t.firstChild;n;n=n.nextSibling)c_(n,e,i)}return i}function d_(t,e){return function(i,n){const a=t.call(e??this,i,n);void 0!==a&&n[n.length-1].push(a)}}function p_(t,e,i){return function(n,a){const s=t.call(i??this,n,a);if(void 0!==s){const t=a[a.length-1],i=void 0!==e?e:n.localName;let r;i in t?r=t[i]:(r=[],t[i]=r),r.push(s)}}}function m_(t,e,i){return function(n,a){const s=t.call(i??this,n,a);void 0!==s&&(a[a.length-1][void 0!==e?e:n.localName]=s)}}function f_(t,e,i){let n,a;for(i=void 0!==i?i:{},n=0,a=t.length;n<a;++n)i[t[n]]=e;return i}function g_(t,e,i,n,a){return n.push(t),function(t,e,i,n){let a;for(a=e.firstElementChild;a;a=a.nextElementSibling){const e=t[a.namespaceURI];if(void 0!==e){const t=e[a.localName];void 0!==t&&t.call(n,a,i)}}}(e,i,n,a),n.pop()}const __=class{read(t){if(!t)return null;if("string"==typeof t){const i=(e=t,(new DOMParser).parseFromString(e,"application/xml"));return this.readFromDocument(i)}var e;return"documentElement"in t?this.readFromDocument(t):this.readFromNode(t)}readFromDocument(t){for(let e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readFromNode(e);return null}readFromNode(t){O()}};function y_(t){return t.getAttributeNS("http://www.w3.org/1999/xlink","href")}function k_(t){return function(t){const e=/^\s*(\d+)\s*$/.exec(t);if(e)return parseInt(e[1],10)}(h_(t,!1))}function v_(t){return h_(t,!1).trim()}const x_=[null,"http://www.opengis.net/ows/1.1"],w_=f_(x_,{ServiceIdentification:m_(function(t,e){return g_({},j_,t,e)}),ServiceProvider:m_(function(t,e){return g_({},O_,t,e)}),OperationsMetadata:m_(function(t,e){return g_({},R_,t,e)})}),b_=f_(x_,{DeliveryPoint:m_(v_),City:m_(v_),AdministrativeArea:m_(v_),PostalCode:m_(v_),Country:m_(v_),ElectronicMailAddress:m_(v_)}),E_=f_(x_,{Value:p_(function(t,e){return v_(t)})}),M_=f_(x_,{AllowedValues:m_(function(t,e){return g_({},E_,t,e)})}),T_=f_(x_,{Phone:m_(function(t,e){return g_({},I_,t,e)}),Address:m_(function(t,e){return g_({},b_,t,e)})}),S_=f_(x_,{HTTP:m_(function(t,e){return g_({},C_,t,e)})}),C_=f_(x_,{Get:p_(function(t,e){const i=y_(t);if(i)return g_({href:i},P_,t,e)}),Post:void 0}),L_=f_(x_,{DCP:m_(function(t,e){return g_({},S_,t,e)})}),R_=f_(x_,{Operation:function(t,e){const i=t.getAttribute("name"),n=g_({},L_,t,e);n&&(e[e.length-1][i]=n)}}),I_=f_(x_,{Voice:m_(v_),Facsimile:m_(v_)}),P_=f_(x_,{Constraint:p_(function(t,e){const i=t.getAttribute("name");if(i)return g_({name:i},M_,t,e)})}),A_=f_(x_,{IndividualName:m_(v_),PositionName:m_(v_),ContactInfo:m_(function(t,e){return g_({},T_,t,e)})}),j_=f_(x_,{Abstract:m_(v_),AccessConstraints:m_(v_),Fees:m_(v_),Title:m_(v_),ServiceTypeVersion:m_(v_),ServiceType:m_(v_)}),O_=f_(x_,{ProviderName:m_(v_),ProviderSite:m_(y_),ServiceContact:m_(function(t,e){return g_({},A_,t,e)})}),F_=class extends __{constructor(){super()}readFromNode(t){return g_({},w_,t,[])||null}},N_=[null,"http://www.opengis.net/wmts/1.0"],G_=[null,"http://www.opengis.net/ows/1.1"],D_=f_(N_,{Contents:m_(function(t,e){return g_({},W_,t,e)})}),W_=f_(N_,{Layer:p_(function(t,e){return g_({},H_,t,e)}),TileMatrixSet:p_(function(t,e){return g_({},Y_,t,e)})}),H_=f_(N_,{Style:p_(function(t,e){const i=g_({},U_,t,e);if(!i)return;const n="true"===t.getAttribute("isDefault");return i.isDefault=n,i}),Format:p_(v_),TileMatrixSetLink:p_(function(t,e){return g_({},B_,t,e)}),Dimension:p_(function(t,e){return g_({},z_,t,e)}),ResourceURL:p_(function(t,e){const i=t.getAttribute("format"),n=t.getAttribute("template"),a=t.getAttribute("resourceType"),s={};return i&&(s.format=i),n&&(s.template=n),a&&(s.resourceType=a),s})},f_(G_,{Title:m_(v_),Abstract:m_(v_),WGS84BoundingBox:m_(q_),BoundingBox:p_(function(t,e){const i=t.getAttribute("crs"),n=g_([],$_,t,e);if(2==n.length)return{extent:z(n),crs:i}}),Identifier:m_(v_)})),U_=f_(N_,{LegendURL:p_(function(t,e){const i={};return i.format=t.getAttribute("format"),i.href=y_(t),i})},f_(G_,{Title:m_(v_),Identifier:m_(v_)})),B_=f_(N_,{TileMatrixSet:m_(v_),TileMatrixSetLimits:m_(function(t,e){return g_([],V_,t,e)})}),V_=f_(N_,{TileMatrixLimits:d_(function(t,e){return g_({},K_,t,e)})}),K_=f_(N_,{TileMatrix:m_(v_),MinTileRow:m_(k_),MaxTileRow:m_(k_),MinTileCol:m_(k_),MaxTileCol:m_(k_)}),z_=f_(N_,{Default:m_(v_),Value:p_(v_)},f_(G_,{Identifier:m_(v_)})),$_=f_(G_,{LowerCorner:d_(Z_),UpperCorner:d_(Z_)}),Y_=f_(N_,{WellKnownScaleSet:m_(v_),TileMatrix:p_(function(t,e){return g_({},X_,t,e)})},f_(G_,{SupportedCRS:m_(v_),Identifier:m_(v_),BoundingBox:m_(q_)})),X_=f_(N_,{TopLeftCorner:m_(Z_),ScaleDenominator:m_(function(t){return function(t){const e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(t);if(e)return parseFloat(e[1])}(h_(t,!1))}),TileWidth:m_(k_),TileHeight:m_(k_),MatrixWidth:m_(k_),MatrixHeight:m_(k_)},f_(G_,{Identifier:m_(v_)}));function q_(t,e){const i=g_([],$_,t,e);if(2==i.length)return z(i)}function Z_(t,e){const i=v_(t).split(/\s+/);if(!i||2!=i.length)return;const n=+i[0],a=+i[1];return isNaN(n)||isNaN(a)?void 0:[n,a]}const J_=class extends __{constructor(){super(),this.owsParser_=new F_}readFromNode(t){let e=t.getAttribute("version");e&&(e=e.trim());let i=this.owsParser_.readFromNode(t);return i?(i.version=e,i=g_(i,D_,t,[]),i||null):null}};class Q_ extends Tf{constructor(t){super({extent:t.extent,origin:t.origin,origins:t.origins,resolutions:t.resolutions,tileSize:t.tileSize,tileSizes:t.tileSizes,sizes:t.sizes}),this.matrixIds_=t.matrixIds}getMatrixId(t){return this.matrixIds_[t]}getMatrixIds(){return this.matrixIds_}}const ty=class extends Yf{constructor(t){const e=void 0!==t.requestEncoding?t.requestEncoding:"KVP",i=t.tileGrid;let n=t.urls;void 0===n&&void 0!==t.url&&(n=Of(t.url)),super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:i,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,urls:n,wrapX:void 0!==t.wrapX&&t.wrapX,transition:t.transition,zDirection:t.zDirection}),this.version_=void 0!==t.version?t.version:"1.0.0",this.format_=void 0!==t.format?t.format:"image/jpeg",this.dimensions_=void 0!==t.dimensions?t.dimensions:{},this.layer_=t.layer,this.matrixSet_=t.matrixSet,this.style_=t.style,this.requestEncoding_=e,this.setKey(this.getKeyForDimensions_()),n&&n.length>0&&(this.tileUrlFunction=Nf(n.map(this.createFromWMTSTemplate.bind(this))))}setUrls(t){this.urls=t;const e=t.join("\n");this.setTileUrlFunction(Nf(t.map(this.createFromWMTSTemplate.bind(this))),e)}getDimensions(){return this.dimensions_}getFormat(){return this.format_}getLayer(){return this.layer_}getMatrixSet(){return this.matrixSet_}getRequestEncoding(){return this.requestEncoding_}getStyle(){return this.style_}getVersion(){return this.version_}getKeyForDimensions_(){const t=this.urls?this.urls.slice(0):[];for(const e in this.dimensions_)t.push(e+"-"+this.dimensions_[e]);return t.join("/")}updateDimensions(t){Object.assign(this.dimensions_,t),this.setKey(this.getKeyForDimensions_())}createFromWMTSTemplate(t){const e=this.requestEncoding_,i={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};"KVP"==e&&Object.assign(i,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),t="KVP"==e?Rf(t,i):t.replace(/\{(\w+?)\}/g,function(t,e){return e.toLowerCase()in i?i[e.toLowerCase()]:t});const n=this.tileGrid,a=this.dimensions_;return function(i,s,r){if(!i)return;const o={TileMatrix:n.getMatrixId(i[0]),TileCol:i[1],TileRow:i[2]};Object.assign(o,a);let l=t;return l="KVP"==e?Rf(l,o):l.replace(/\{(\w+?)\}/g,function(t,e){return encodeURIComponent(o[e])}),l}}};class ey{constructor(t,e){this.getWmtsCapabilities=t=>{switch(t){case Np.Maastokartta:case Np.Taustakartta:case Np.Ortokuva:return this.mmlWmtsCapabilities||(this.mmlWmtsCapabilities=(new J_).read('\x3c!-- https://avoin-karttakuva.maanmittauslaitos.fi/avoin/wmts/1.0.0/WMTSCapabilities.xml --\x3e<Capabilities xmlns="http://www.opengis.net/wmts/1.0" xmlns:ows="http://www.opengis.net/ows/1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:gml="http://www.opengis.net/gml" xsi:schemaLocation="http://www.opengis.net/wmts/1.0 http://schemas.opengis.net/wmts/1.0/wmtsGetCapabilities_response.xsd" version="1.0.0"><ows:ServiceIdentification><ows:Title>Maanmittauslaitoksen Karttakuvapalvelu (WMTS)</ows:Title><ows:Abstract>Kuvaus palvelusta</ows:Abstract><ows:ServiceType>OGC WMTS</ows:ServiceType><ows:ServiceTypeVersion>1.0.0</ows:ServiceTypeVersion><ows:AccessConstraints>Vaatii kyttjtunnuksen</ows:AccessConstraints></ows:ServiceIdentification><ows:ServiceProvider><ows:ProviderName>Maanmittauslaitos</ows:ProviderName><ows:ProviderSite xlink:href="http://www.maanmittauslaitos.fi"></ows:ProviderSite><ows:ServiceContact><ows:IndividualName>Verkkopalvelu - sovellustuki</ows:IndividualName><ows:ContactInfo><ows:Address><ows:ElectronicMailAddress>verkkopalvelut@maanmittauslaitos.fi</ows:ElectronicMailAddress></ows:Address></ows:ContactInfo></ows:ServiceContact></ows:ServiceProvider><ows:OperationsMetadata><ows:Operation name="GetCapabilities"><ows:DCP><ows:HTTP><ows:Get xlink:href="https://avoin-karttakuva.maanmittauslaitos.fi/avoin/wmts?"><ows:Constraint name="GetEncoding"><ows:AllowedValues><ows:Value>KVP</ows:Value></ows:AllowedValues></ows:Constraint></ows:Get></ows:HTTP></ows:DCP></ows:Operation><ows:Operation name="GetTile"><ows:DCP><ows:HTTP><ows:Get xlink:href="https://avoin-karttakuva.maanmittauslaitos.fi/avoin/wmts?"><ows:Constraint name="GetEncoding"><ows:AllowedValues><ows:Value>KVP</ows:Value></ows:AllowedValues></ows:Constraint></ows:Get></ows:HTTP></ows:DCP></ows:Operation><ows:Operation name="GetFeatureInfo"><ows:DCP><ows:HTTP><ows:Get xlink:href="https://avoin-karttakuva.maanmittauslaitos.fi/avoin/wmts?"><ows:Constraint name="GetEncoding"><ows:AllowedValues><ows:Value>KVP</ows:Value></ows:AllowedValues></ows:Constraint></ows:Get></ows:HTTP></ows:DCP></ows:Operation></ows:OperationsMetadata><Contents><Layer><ows:Title>Maastokartta</ows:Title><ows:Identifier>maastokartta</ows:Identifier><Style isDefault="true"><ows:Identifier>default</ows:Identifier></Style><Format>image/png</Format><TileMatrixSetLink><TileMatrixSet>ETRS-TM35FIN</TileMatrixSet></TileMatrixSetLink><TileMatrixSetLink><TileMatrixSet>WGS84_Pseudo-Mercator</TileMatrixSet></TileMatrixSetLink><ResourceURL format="image/png" resourceType="tile" template="https://avoin-karttakuva.maanmittauslaitos.fi/avoin/wmts/1.0.0/maastokartta/default/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}.png"></ResourceURL></Layer><Layer><ows:Title>Kiinteistotunnukset</ows:Title><ows:Identifier>kiinteistotunnukset</ows:Identifier><Style isDefault="true"><ows:Identifier>default</ows:Identifier></Style><Format>image/png</Format><TileMatrixSetLink><TileMatrixSet>ETRS-TM35FIN</TileMatrixSet></TileMatrixSetLink><TileMatrixSetLink><TileMatrixSet>WGS84_Pseudo-Mercator</TileMatrixSet></TileMatrixSetLink><ResourceURL format="image/png" resourceType="tile" template="https://avoin-karttakuva.maanmittauslaitos.fi/avoin/wmts/1.0.0/kiinteistotunnukset/default/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}.png"></ResourceURL></Layer><Layer><ows:Title>Selkokartta</ows:Title><ows:Identifier>selkokartta</ows:Identifier><Style isDefault="true"><ows:Identifier>default</ows:Identifier></Style><Format>image/png</Format><TileMatrixSetLink><TileMatrixSet>ETRS-TM35FIN</TileMatrixSet></TileMatrixSetLink><TileMatrixSetLink><TileMatrixSet>WGS84_Pseudo-Mercator</TileMatrixSet></TileMatrixSetLink><ResourceURL format="image/png" resourceType="tile" template="https://avoin-karttakuva.maanmittauslaitos.fi/avoin/wmts/1.0.0/selkokartta/default/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}.png"></ResourceURL></Layer><Layer><ows:Title>Taustakartta</ows:Title><ows:Identifier>taustakartta</ows:Identifier><Style isDefault="true"><ows:Identifier>default</ows:Identifier></Style><Format>image/png</Format><TileMatrixSetLink><TileMatrixSet>ETRS-TM35FIN</TileMatrixSet></TileMatrixSetLink><TileMatrixSetLink><TileMatrixSet>WGS84_Pseudo-Mercator</TileMatrixSet></TileMatrixSetLink><ResourceURL format="image/png" resourceType="tile" template="https://avoin-karttakuva.maanmittauslaitos.fi/avoin/wmts/1.0.0/taustakartta/default/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}.png"></ResourceURL></Layer><Layer><ows:Title>Kiinteistojaotus</ows:Title><ows:Identifier>kiinteistojaotus</ows:Identifier><Style isDefault="true"><ows:Identifier>default</ows:Identifier></Style><Format>image/png</Format><TileMatrixSetLink><TileMatrixSet>ETRS-TM35FIN</TileMatrixSet></TileMatrixSetLink><TileMatrixSetLink><TileMatrixSet>WGS84_Pseudo-Mercator</TileMatrixSet></TileMatrixSetLink><ResourceURL format="image/png" resourceType="tile" template="https://avoin-karttakuva.maanmittauslaitos.fi/avoin/wmts/1.0.0/kiinteistojaotus/default/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}.png"></ResourceURL></Layer><Layer><ows:Title>Ortokuva</ows:Title><ows:Identifier>ortokuva</ows:Identifier><Style isDefault="true"><ows:Identifier>default</ows:Identifier></Style><Format>image/jpeg</Format><TileMatrixSetLink><TileMatrixSet>ETRS-TM35FIN</TileMatrixSet></TileMatrixSetLink><TileMatrixSetLink><TileMatrixSet>WGS84_Pseudo-Mercator</TileMatrixSet></TileMatrixSetLink><ResourceURL format="image/jpeg" resourceType="tile" template="https://avoin-karttakuva.maanmittauslaitos.fi/avoin/wmts/1.0.0/ortokuva/default/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}.jpg"></ResourceURL></Layer><TileMatrixSet><ows:Identifier>ETRS-TM35FIN</ows:Identifier><ows:BoundingBox crs="urn:ogc:def:crs:EPSG:6.3:3067"><ows:LowerCorner>-548576.000000 6291456.000000</ows:LowerCorner><ows:UpperCorner>1548576.000000 8388608.000000</ows:UpperCorner></ows:BoundingBox><ows:SupportedCRS>urn:ogc:def:crs:EPSG:6.3:3067</ows:SupportedCRS><TileMatrix><ows:Identifier>0</ows:Identifier><ScaleDenominator>29257142.85714285820722579956</ScaleDenominator><TopLeftCorner>-548576.000000 8388608.000000</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>1</MatrixWidth><MatrixHeight>1</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>1</ows:Identifier><ScaleDenominator>14628571.42857142910361289978</ScaleDenominator><TopLeftCorner>-548576.000000 8388608.000000</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>2</MatrixWidth><MatrixHeight>2</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>2</ows:Identifier><ScaleDenominator>7314285.71428571455180644989</ScaleDenominator><TopLeftCorner>-548576.000000 8388608.000000</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>4</MatrixWidth><MatrixHeight>4</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>3</ows:Identifier><ScaleDenominator>3657142.85714285727590322495</ScaleDenominator><TopLeftCorner>-548576.000000 8388608.000000</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>8</MatrixWidth><MatrixHeight>8</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>4</ows:Identifier><ScaleDenominator>1828571.42857142863795161247</ScaleDenominator><TopLeftCorner>-548576.000000 8388608.000000</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>16</MatrixWidth><MatrixHeight>16</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>5</ows:Identifier><ScaleDenominator>914285.71428571431897580624</ScaleDenominator><TopLeftCorner>-548576.000000 8388608.000000</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>32</MatrixWidth><MatrixHeight>32</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>6</ows:Identifier><ScaleDenominator>457142.85714285715948790312</ScaleDenominator><TopLeftCorner>-548576.000000 8388608.000000</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>64</MatrixWidth><MatrixHeight>64</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>7</ows:Identifier><ScaleDenominator>228571.42857142857974395156</ScaleDenominator><TopLeftCorner>-548576.000000 8388608.000000</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>128</MatrixWidth><MatrixHeight>128</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>8</ows:Identifier><ScaleDenominator>114285.71428571428987197578</ScaleDenominator><TopLeftCorner>-548576.000000 8388608.000000</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>256</MatrixWidth><MatrixHeight>256</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>9</ows:Identifier><ScaleDenominator>57142.85714285714493598789</ScaleDenominator><TopLeftCorner>-548576.000000 8388608.000000</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>512</MatrixWidth><MatrixHeight>512</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>10</ows:Identifier><ScaleDenominator>28571.42857142857246799394</ScaleDenominator><TopLeftCorner>-548576.000000 8388608.000000</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>1024</MatrixWidth><MatrixHeight>1024</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>11</ows:Identifier><ScaleDenominator>14285.71428571428623399697</ScaleDenominator><TopLeftCorner>-548576.000000 8388608.000000</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>2048</MatrixWidth><MatrixHeight>2048</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>12</ows:Identifier><ScaleDenominator>7142.85714285714311699849</ScaleDenominator><TopLeftCorner>-548576.000000 8388608.000000</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>4096</MatrixWidth><MatrixHeight>4096</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>13</ows:Identifier><ScaleDenominator>3571.42857142857155849924</ScaleDenominator><TopLeftCorner>-548576.000000 8388608.000000</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>8192</MatrixWidth><MatrixHeight>8192</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>14</ows:Identifier><ScaleDenominator>1785.71428571428577924962</ScaleDenominator><TopLeftCorner>-548576.000000 8388608.000000</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>16384</MatrixWidth><MatrixHeight>16384</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>15</ows:Identifier><ScaleDenominator>892.85714285714288962481</ScaleDenominator><TopLeftCorner>-548576.000000 8388608.000000</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>32768</MatrixWidth><MatrixHeight>32768</MatrixHeight></TileMatrix></TileMatrixSet><TileMatrixSet><ows:Identifier>WGS84_Pseudo-Mercator</ows:Identifier><ows:BoundingBox crs="urn:ogc:def:crs:EPSG:6.3:3857"><ows:LowerCorner>-20037508.342789 -20037508.342789</ows:LowerCorner><ows:UpperCorner>20037508.342789 20037508.342789</ows:UpperCorner></ows:BoundingBox><ows:SupportedCRS>urn:ogc:def:crs:EPSG:6.3:3857</ows:SupportedCRS><TileMatrix><ows:Identifier>0</ows:Identifier><ScaleDenominator>559082264.02871787548065185547</ScaleDenominator><TopLeftCorner>-20037508.342789 20037508.342789</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>1</MatrixWidth><MatrixHeight>1</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>1</ows:Identifier><ScaleDenominator>279541132.01435887813568115234</ScaleDenominator><TopLeftCorner>-20037508.342789 20037508.342789</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>2</MatrixWidth><MatrixHeight>2</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>2</ows:Identifier><ScaleDenominator>139770566.00717940926551818848</ScaleDenominator><TopLeftCorner>-20037508.342789 20037508.342789</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>4</MatrixWidth><MatrixHeight>4</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>3</ows:Identifier><ScaleDenominator>69885283.00358971953392028809</ScaleDenominator><TopLeftCorner>-20037508.342789 20037508.342789</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>8</MatrixWidth><MatrixHeight>8</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>4</ows:Identifier><ScaleDenominator>34942641.50179485976696014404</ScaleDenominator><TopLeftCorner>-20037508.342789 20037508.342789</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>16</MatrixWidth><MatrixHeight>16</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>5</ows:Identifier><ScaleDenominator>17471320.75089742988348007202</ScaleDenominator><TopLeftCorner>-20037508.342789 20037508.342789</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>32</MatrixWidth><MatrixHeight>32</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>6</ows:Identifier><ScaleDenominator>8735660.37544871494174003601</ScaleDenominator><TopLeftCorner>-20037508.342789 20037508.342789</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>64</MatrixWidth><MatrixHeight>64</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>7</ows:Identifier><ScaleDenominator>4367830.18772435747087001801</ScaleDenominator><TopLeftCorner>-20037508.342789 20037508.342789</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>128</MatrixWidth><MatrixHeight>128</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>8</ows:Identifier><ScaleDenominator>2183915.09386217873543500900</ScaleDenominator><TopLeftCorner>-20037508.342789 20037508.342789</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>256</MatrixWidth><MatrixHeight>256</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>9</ows:Identifier><ScaleDenominator>1091957.54693108866922557354</ScaleDenominator><TopLeftCorner>-20037508.342789 20037508.342789</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>512</MatrixWidth><MatrixHeight>512</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>10</ows:Identifier><ScaleDenominator>545978.77346554468385875225</ScaleDenominator><TopLeftCorner>-20037508.342789 20037508.342789</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>1024</MatrixWidth><MatrixHeight>1024</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>11</ows:Identifier><ScaleDenominator>272989.38673277228372171521</ScaleDenominator><TopLeftCorner>-20037508.342789 20037508.342789</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>2048</MatrixWidth><MatrixHeight>2048</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>12</ows:Identifier><ScaleDenominator>136494.69336638617096468806</ScaleDenominator><TopLeftCorner>-20037508.342789 20037508.342789</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>4096</MatrixWidth><MatrixHeight>4096</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>13</ows:Identifier><ScaleDenominator>68247.34668319307093042880</ScaleDenominator><TopLeftCorner>-20037508.342789 20037508.342789</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>8192</MatrixWidth><MatrixHeight>8192</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>14</ows:Identifier><ScaleDenominator>34123.67334159654274117202</ScaleDenominator><TopLeftCorner>-20037508.342789 20037508.342789</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>16384</MatrixWidth><MatrixHeight>16384</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>15</ows:Identifier><ScaleDenominator>17061.83667079827137058601</ScaleDenominator><TopLeftCorner>-20037508.342789 20037508.342789</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>32768</MatrixWidth><MatrixHeight>32768</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>16</ows:Identifier><ScaleDenominator>8530.91833539913568529300</ScaleDenominator><TopLeftCorner>-20037508.342789 20037508.342789</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>65536</MatrixWidth><MatrixHeight>65536</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>17</ows:Identifier><ScaleDenominator>4265.45916769956784264650</ScaleDenominator><TopLeftCorner>-20037508.342789 20037508.342789</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>131072</MatrixWidth><MatrixHeight>131072</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>18</ows:Identifier><ScaleDenominator>2132.72958384978392132325</ScaleDenominator><TopLeftCorner>-20037508.342789 20037508.342789</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>262144</MatrixWidth><MatrixHeight>262144</MatrixHeight></TileMatrix></TileMatrixSet></Contents></Capabilities>')),this.mmlWmtsCapabilities;case Np.Korkeusmalli25m:return this.paituliWmtsCapabilities||(this.paituliWmtsCapabilities=(new J_).read('\x3c!-- https://paituli.csc.fi/geoserver/paituli/gwc/service/wmts?request=GetCapabilities&service=WMTS --\x3e<Capabilities xmlns="http://www.opengis.net/wmts/1.0" xmlns:ows="http://www.opengis.net/ows/1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:gml="http://www.opengis.net/gml" xsi:schemaLocation="http://www.opengis.net/wmts/1.0 http://schemas.opengis.net/wmts/1.0/wmtsGetCapabilities_response.xsd" version="1.0.0"><ows:ServiceIdentification><ows:Title>Paituli WMTS service</ows:Title><ows:Abstract>Paituli OGC APIs: https://paituli.csc.fi/webservices.html</ows:Abstract><ows:ServiceType>OGC WMTS</ows:ServiceType><ows:ServiceTypeVersion>1.0.0</ows:ServiceTypeVersion><ows:Fees>NONE</ows:Fees><ows:AccessConstraints>NONE</ows:AccessConstraints></ows:ServiceIdentification><ows:ServiceProvider><ows:ProviderName>http://geoserver.org/com</ows:ProviderName><ows:ProviderSite xlink:href="http://geoserver.org"/><ows:ServiceContact><ows:IndividualName>giscoord@csc.fi</ows:IndividualName><ows:ContactInfo><ows:Address><ows:Country>Finland</ows:Country><ows:ElectronicMailAddress>giscoord@csc.fi</ows:ElectronicMailAddress></ows:Address></ows:ContactInfo></ows:ServiceContact></ows:ServiceProvider><ows:OperationsMetadata><ows:Operation name="GetCapabilities"><ows:DCP><ows:HTTP><ows:Get xlink:href="https://paituli.csc.fi/geoserver/paituli/gwc/service/wmts?"><ows:Constraint name="GetEncoding"><ows:AllowedValues><ows:Value>KVP</ows:Value></ows:AllowedValues></ows:Constraint></ows:Get></ows:HTTP></ows:DCP></ows:Operation><ows:Operation name="GetTile"><ows:DCP><ows:HTTP><ows:Get xlink:href="https://paituli.csc.fi/geoserver/paituli/gwc/service/wmts?"><ows:Constraint name="GetEncoding"><ows:AllowedValues><ows:Value>KVP</ows:Value></ows:AllowedValues></ows:Constraint></ows:Get></ows:HTTP></ows:DCP></ows:Operation><ows:Operation name="GetFeatureInfo"><ows:DCP><ows:HTTP><ows:Get xlink:href="https://paituli.csc.fi/geoserver/paituli/gwc/service/wmts?"><ows:Constraint name="GetEncoding"><ows:AllowedValues><ows:Value>KVP</ows:Value></ows:AllowedValues></ows:Constraint></ows:Get></ows:HTTP></ows:DCP></ows:Operation></ows:OperationsMetadata><Contents><Layer><ows:Title>MML, Korkeusmalli, 25 m x 25 m, 2000</ows:Title><ows:Identifier>mml_korkeusmalli_25m_2000</ows:Identifier><Style isDefault="true"><ows:Identifier/><LegendURL format="image/png" xlink:href="https://paituli.csc.fi/geoserver/ows?service=WMS&amp;request=GetLegendGraphic&amp;version=1.1.0&amp;format=image%2Fpng&amp;width=61&amp;height=242&amp;layer=paituli%3Amml_korkeusmalli_25m_2000" width="61" height="242" maxScaleDenominator="8000000.0"/></Style><Format>image/png</Format><Format>image/png8</Format><InfoFormat>text/plain</InfoFormat><InfoFormat>application/vnd.ogc.gml</InfoFormat><InfoFormat>text/xml</InfoFormat><InfoFormat>application/vnd.ogc.gml/3.1.1</InfoFormat><InfoFormat>text/xml</InfoFormat><InfoFormat>text/html</InfoFormat><InfoFormat>text/javascript</InfoFormat><InfoFormat>application/json</InfoFormat><TileMatrixSetLink><TileMatrixSet>EPSG:3857</TileMatrixSet><TileMatrixSetLimits><TileMatrixLimits><TileMatrix>EPSG:900913:0</TileMatrix><MinTileRow>0</MinTileRow><MaxTileRow>0</MaxTileRow><MinTileCol>0</MinTileCol><MaxTileCol>0</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:1</TileMatrix><MinTileRow>0</MinTileRow><MaxTileRow>0</MaxTileRow><MinTileCol>1</MinTileCol><MaxTileCol>1</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:2</TileMatrix><MinTileRow>0</MinTileRow><MaxTileRow>1</MaxTileRow><MinTileCol>2</MinTileCol><MaxTileCol>2</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:3</TileMatrix><MinTileRow>1</MinTileRow><MaxTileRow>2</MaxTileRow><MinTileCol>4</MinTileCol><MaxTileCol>4</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:4</TileMatrix><MinTileRow>3</MinTileRow><MaxTileRow>4</MaxTileRow><MinTileCol>8</MinTileCol><MaxTileCol>9</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:5</TileMatrix><MinTileRow>6</MinTileRow><MaxTileRow>9</MaxTileRow><MinTileCol>17</MinTileCol><MaxTileCol>18</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:6</TileMatrix><MinTileRow>13</MinTileRow><MaxTileRow>18</MaxTileRow><MinTileCol>34</MinTileCol><MaxTileCol>37</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:7</TileMatrix><MinTileRow>27</MinTileRow><MaxTileRow>37</MaxTileRow><MinTileCol>69</MinTileCol><MaxTileCol>75</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:8</TileMatrix><MinTileRow>55</MinTileRow><MaxTileRow>75</MaxTileRow><MinTileCol>138</MinTileCol><MaxTileCol>151</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:9</TileMatrix><MinTileRow>111</MinTileRow><MaxTileRow>151</MaxTileRow><MinTileCol>276</MinTileCol><MaxTileCol>303</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:10</TileMatrix><MinTileRow>223</MinTileRow><MaxTileRow>303</MaxTileRow><MinTileCol>552</MinTileCol><MaxTileCol>607</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:11</TileMatrix><MinTileRow>447</MinTileRow><MaxTileRow>607</MaxTileRow><MinTileCol>1104</MinTileCol><MaxTileCol>1214</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:12</TileMatrix><MinTileRow>895</MinTileRow><MaxTileRow>1214</MaxTileRow><MinTileCol>2209</MinTileCol><MaxTileCol>2428</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:13</TileMatrix><MinTileRow>1790</MinTileRow><MaxTileRow>2428</MaxTileRow><MinTileCol>4419</MinTileCol><MaxTileCol>4857</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:14</TileMatrix><MinTileRow>3580</MinTileRow><MaxTileRow>4857</MaxTileRow><MinTileCol>8839</MinTileCol><MaxTileCol>9714</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:15</TileMatrix><MinTileRow>7161</MinTileRow><MaxTileRow>9715</MaxTileRow><MinTileCol>17679</MinTileCol><MaxTileCol>19428</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:16</TileMatrix><MinTileRow>14323</MinTileRow><MaxTileRow>19430</MaxTileRow><MinTileCol>35359</MinTileCol><MaxTileCol>38857</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:17</TileMatrix><MinTileRow>28647</MinTileRow><MaxTileRow>38861</MaxTileRow><MinTileCol>70718</MinTileCol><MaxTileCol>77715</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:18</TileMatrix><MinTileRow>57294</MinTileRow><MaxTileRow>77723</MaxTileRow><MinTileCol>141436</MinTileCol><MaxTileCol>155431</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:19</TileMatrix><MinTileRow>114588</MinTileRow><MaxTileRow>155447</MaxTileRow><MinTileCol>282872</MinTileCol><MaxTileCol>310863</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:20</TileMatrix><MinTileRow>229176</MinTileRow><MaxTileRow>310895</MaxTileRow><MinTileCol>565745</MinTileCol><MaxTileCol>621726</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:21</TileMatrix><MinTileRow>458352</MinTileRow><MaxTileRow>621791</MaxTileRow><MinTileCol>1131491</MinTileCol><MaxTileCol>1243452</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:22</TileMatrix><MinTileRow>916705</MinTileRow><MaxTileRow>1243582</MaxTileRow><MinTileCol>2262982</MinTileCol><MaxTileCol>2486905</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:23</TileMatrix><MinTileRow>1833410</MinTileRow><MaxTileRow>2487165</MaxTileRow><MinTileCol>4525965</MinTileCol><MaxTileCol>4973810</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:24</TileMatrix><MinTileRow>3666820</MinTileRow><MaxTileRow>4974331</MaxTileRow><MinTileCol>9051930</MinTileCol><MaxTileCol>9947620</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:25</TileMatrix><MinTileRow>7333640</MinTileRow><MaxTileRow>9948663</MaxTileRow><MinTileCol>18103861</MinTileCol><MaxTileCol>19895240</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:26</TileMatrix><MinTileRow>14667280</MinTileRow><MaxTileRow>19897327</MaxTileRow><MinTileCol>36207723</MinTileCol><MaxTileCol>39790481</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:27</TileMatrix><MinTileRow>29334560</MinTileRow><MaxTileRow>39794654</MaxTileRow><MinTileCol>72415446</MinTileCol><MaxTileCol>79580963</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:28</TileMatrix><MinTileRow>58669121</MinTileRow><MaxTileRow>79589309</MaxTileRow><MinTileCol>144830892</MinTileCol><MaxTileCol>159161927</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:29</TileMatrix><MinTileRow>117338243</MinTileRow><MaxTileRow>159178618</MaxTileRow><MinTileCol>289661785</MinTileCol><MaxTileCol>318323855</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:900913:30</TileMatrix><MinTileRow>234676487</MinTileRow><MaxTileRow>318357236</MaxTileRow><MinTileCol>579323571</MinTileCol><MaxTileCol>636647710</MaxTileCol></TileMatrixLimits></TileMatrixSetLimits></TileMatrixSetLink><TileMatrixSetLink><TileMatrixSet>EPSG:3067</TileMatrixSet><TileMatrixSetLimits><TileMatrixLimits><TileMatrix>EPSG:3067:0</TileMatrix><MinTileRow>0</MinTileRow><MaxTileRow>0</MaxTileRow><MinTileCol>0</MinTileCol><MaxTileCol>0</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:3067:1</TileMatrix><MinTileRow>0</MinTileRow><MaxTileRow>1</MaxTileRow><MinTileCol>0</MinTileCol><MaxTileCol>1</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:3067:2</TileMatrix><MinTileRow>1</MinTileRow><MaxTileRow>3</MaxTileRow><MinTileCol>1</MinTileCol><MaxTileCol>2</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:3067:3</TileMatrix><MinTileRow>2</MinTileRow><MaxTileRow>6</MaxTileRow><MinTileCol>2</MinTileCol><MaxTileCol>4</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:3067:4</TileMatrix><MinTileRow>4</MinTileRow><MaxTileRow>13</MaxTileRow><MinTileCol>4</MinTileCol><MaxTileCol>9</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:3067:5</TileMatrix><MinTileRow>9</MinTileRow><MaxTileRow>27</MaxTileRow><MinTileCol>9</MinTileCol><MaxTileCol>19</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:3067:6</TileMatrix><MinTileRow>18</MinTileRow><MaxTileRow>55</MaxTileRow><MinTileCol>18</MinTileCol><MaxTileCol>39</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:3067:7</TileMatrix><MinTileRow>36</MinTileRow><MaxTileRow>111</MaxTileRow><MinTileCol>36</MinTileCol><MaxTileCol>78</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:3067:8</TileMatrix><MinTileRow>72</MinTileRow><MaxTileRow>223</MaxTileRow><MinTileCol>72</MinTileCol><MaxTileCol>157</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:3067:9</TileMatrix><MinTileRow>144</MinTileRow><MaxTileRow>447</MaxTileRow><MinTileCol>144</MinTileCol><MaxTileCol>314</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:3067:10</TileMatrix><MinTileRow>289</MinTileRow><MaxTileRow>894</MaxTileRow><MinTileCol>289</MinTileCol><MaxTileCol>629</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:3067:11</TileMatrix><MinTileRow>579</MinTileRow><MaxTileRow>1788</MaxTileRow><MinTileCol>578</MinTileCol><MaxTileCol>1258</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:3067:12</TileMatrix><MinTileRow>1158</MinTileRow><MaxTileRow>3576</MaxTileRow><MinTileCol>1156</MinTileCol><MaxTileCol>2516</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:3067:13</TileMatrix><MinTileRow>2316</MinTileRow><MaxTileRow>7153</MaxTileRow><MinTileCol>2312</MinTileCol><MaxTileCol>5032</MaxTileCol></TileMatrixLimits><TileMatrixLimits><TileMatrix>EPSG:3067:14</TileMatrix><MinTileRow>4633</MinTileRow><MaxTileRow>14307</MaxTileRow><MinTileCol>4625</MinTileCol><MaxTileCol>10065</MaxTileCol></TileMatrixLimits></TileMatrixSetLimits></TileMatrixSetLink><ResourceURL format="image/png" resourceType="tile" template="https://paituli.csc.fi/geoserver/paituli/gwc/service/wmts/rest/mml_korkeusmalli_25m_2000/{style}/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}?format=image/png"/><ResourceURL format="image/png8" resourceType="tile" template="https://paituli.csc.fi/geoserver/paituli/gwc/service/wmts/rest/mml_korkeusmalli_25m_2000/{style}/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}?format=image/png8"/><ResourceURL format="text/plain" resourceType="FeatureInfo" template="https://paituli.csc.fi/geoserver/paituli/gwc/service/wmts/rest/mml_korkeusmalli_25m_2000/{style}/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}/{J}/{I}?format=text/plain"/><ResourceURL format="application/vnd.ogc.gml" resourceType="FeatureInfo" template="https://paituli.csc.fi/geoserver/paituli/gwc/service/wmts/rest/mml_korkeusmalli_25m_2000/{style}/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}/{J}/{I}?format=application/vnd.ogc.gml"/><ResourceURL format="text/xml" resourceType="FeatureInfo" template="https://paituli.csc.fi/geoserver/paituli/gwc/service/wmts/rest/mml_korkeusmalli_25m_2000/{style}/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}/{J}/{I}?format=text/xml"/><ResourceURL format="application/vnd.ogc.gml/3.1.1" resourceType="FeatureInfo" template="https://paituli.csc.fi/geoserver/paituli/gwc/service/wmts/rest/mml_korkeusmalli_25m_2000/{style}/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}/{J}/{I}?format=application/vnd.ogc.gml/3.1.1"/><ResourceURL format="text/xml" resourceType="FeatureInfo" template="https://paituli.csc.fi/geoserver/paituli/gwc/service/wmts/rest/mml_korkeusmalli_25m_2000/{style}/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}/{J}/{I}?format=text/xml"/><ResourceURL format="text/html" resourceType="FeatureInfo" template="https://paituli.csc.fi/geoserver/paituli/gwc/service/wmts/rest/mml_korkeusmalli_25m_2000/{style}/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}/{J}/{I}?format=text/html"/><ResourceURL format="text/javascript" resourceType="FeatureInfo" template="https://paituli.csc.fi/geoserver/paituli/gwc/service/wmts/rest/mml_korkeusmalli_25m_2000/{style}/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}/{J}/{I}?format=text/javascript"/><ResourceURL format="application/json" resourceType="FeatureInfo" template="https://paituli.csc.fi/geoserver/paituli/gwc/service/wmts/rest/mml_korkeusmalli_25m_2000/{style}/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}/{J}/{I}?format=application/json"/><ResourceURL format="application/json" resourceType="TileJSON" template="https://paituli.csc.fi/geoserver/paituli/gwc/service/wmts/rest/mml_korkeusmalli_25m_2000/{style}/tilejson/png?format=application/json"/><ResourceURL format="application/json" resourceType="TileJSON" template="https://paituli.csc.fi/geoserver/paituli/gwc/service/wmts/rest/mml_korkeusmalli_25m_2000/{style}/tilejson/png8?format=application/json"/></Layer><TileMatrixSet><ows:Identifier>EPSG:3067</ows:Identifier><ows:SupportedCRS>urn:ogc:def:crs:EPSG::3067</ows:SupportedCRS><TileMatrix><ows:Identifier>EPSG:3067:0</ows:Identifier><ScaleDenominator>2.925714285714286E7</ScaleDenominator><TopLeftCorner>-548576.0 8388608.0</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>1</MatrixWidth><MatrixHeight>1</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:3067:1</ows:Identifier><ScaleDenominator>1.462857142857143E7</ScaleDenominator><TopLeftCorner>-548576.0 8388608.0</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>2</MatrixWidth><MatrixHeight>2</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:3067:2</ows:Identifier><ScaleDenominator>7314285.714285715</ScaleDenominator><TopLeftCorner>-548576.0 8388608.0</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>4</MatrixWidth><MatrixHeight>4</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:3067:3</ows:Identifier><ScaleDenominator>3657142.8571428573</ScaleDenominator><TopLeftCorner>-548576.0 8388608.0</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>8</MatrixWidth><MatrixHeight>8</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:3067:4</ows:Identifier><ScaleDenominator>1828571.4285714286</ScaleDenominator><TopLeftCorner>-548576.0 8388608.0</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>16</MatrixWidth><MatrixHeight>16</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:3067:5</ows:Identifier><ScaleDenominator>914285.7142857143</ScaleDenominator><TopLeftCorner>-548576.0 8388608.0</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>32</MatrixWidth><MatrixHeight>32</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:3067:6</ows:Identifier><ScaleDenominator>457142.85714285716</ScaleDenominator><TopLeftCorner>-548576.0 8388608.0</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>64</MatrixWidth><MatrixHeight>64</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:3067:7</ows:Identifier><ScaleDenominator>228571.42857142858</ScaleDenominator><TopLeftCorner>-548576.0 8388608.0</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>128</MatrixWidth><MatrixHeight>128</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:3067:8</ows:Identifier><ScaleDenominator>114285.71428571429</ScaleDenominator><TopLeftCorner>-548576.0 8388608.0</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>256</MatrixWidth><MatrixHeight>256</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:3067:9</ows:Identifier><ScaleDenominator>57142.857142857145</ScaleDenominator><TopLeftCorner>-548576.0 8388608.0</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>512</MatrixWidth><MatrixHeight>512</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:3067:10</ows:Identifier><ScaleDenominator>28571.428571428572</ScaleDenominator><TopLeftCorner>-548576.0 8388608.0</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>1024</MatrixWidth><MatrixHeight>1024</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:3067:11</ows:Identifier><ScaleDenominator>14285.714285714286</ScaleDenominator><TopLeftCorner>-548576.0 8388608.0</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>2048</MatrixWidth><MatrixHeight>2048</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:3067:12</ows:Identifier><ScaleDenominator>7142.857142857143</ScaleDenominator><TopLeftCorner>-548576.0 8388608.0</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>4096</MatrixWidth><MatrixHeight>4096</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:3067:13</ows:Identifier><ScaleDenominator>3571.4285714285716</ScaleDenominator><TopLeftCorner>-548576.0 8388608.0</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>8192</MatrixWidth><MatrixHeight>8192</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:3067:14</ows:Identifier><ScaleDenominator>1785.7142857142858</ScaleDenominator><TopLeftCorner>-548576.0 8388608.0</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>16384</MatrixWidth><MatrixHeight>16384</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:3067:15</ows:Identifier><ScaleDenominator>892.8571428571429</ScaleDenominator><TopLeftCorner>-548576.0 8388608.0</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>32768</MatrixWidth><MatrixHeight>32768</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:3067:16</ows:Identifier><ScaleDenominator>446.42857142857144</ScaleDenominator><TopLeftCorner>-548576.0 8388608.0</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>65536</MatrixWidth><MatrixHeight>65536</MatrixHeight></TileMatrix></TileMatrixSet><TileMatrixSet><ows:Identifier>EPSG:3857</ows:Identifier><ows:SupportedCRS>urn:ogc:def:crs:EPSG::3857</ows:SupportedCRS><TileMatrix><ows:Identifier>EPSG:900913:0</ows:Identifier><ScaleDenominator>5.590822639508929E8</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>1</MatrixWidth><MatrixHeight>1</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:1</ows:Identifier><ScaleDenominator>2.7954113197544646E8</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>2</MatrixWidth><MatrixHeight>2</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:2</ows:Identifier><ScaleDenominator>1.3977056598772323E8</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>4</MatrixWidth><MatrixHeight>4</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:3</ows:Identifier><ScaleDenominator>6.988528299386162E7</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>8</MatrixWidth><MatrixHeight>8</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:4</ows:Identifier><ScaleDenominator>3.494264149693081E7</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>16</MatrixWidth><MatrixHeight>16</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:5</ows:Identifier><ScaleDenominator>1.7471320748465404E7</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>32</MatrixWidth><MatrixHeight>32</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:6</ows:Identifier><ScaleDenominator>8735660.374232702</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>64</MatrixWidth><MatrixHeight>64</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:7</ows:Identifier><ScaleDenominator>4367830.187116351</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>128</MatrixWidth><MatrixHeight>128</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:8</ows:Identifier><ScaleDenominator>2183915.0935581755</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>256</MatrixWidth><MatrixHeight>256</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:9</ows:Identifier><ScaleDenominator>1091957.5467790877</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>512</MatrixWidth><MatrixHeight>512</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:10</ows:Identifier><ScaleDenominator>545978.7733895439</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>1024</MatrixWidth><MatrixHeight>1024</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:11</ows:Identifier><ScaleDenominator>272989.38669477194</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>2048</MatrixWidth><MatrixHeight>2048</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:12</ows:Identifier><ScaleDenominator>136494.69334738597</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>4096</MatrixWidth><MatrixHeight>4096</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:13</ows:Identifier><ScaleDenominator>68247.34667369298</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>8192</MatrixWidth><MatrixHeight>8192</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:14</ows:Identifier><ScaleDenominator>34123.67333684649</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>16384</MatrixWidth><MatrixHeight>16384</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:15</ows:Identifier><ScaleDenominator>17061.836668423246</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>32768</MatrixWidth><MatrixHeight>32768</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:16</ows:Identifier><ScaleDenominator>8530.918334211623</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>65536</MatrixWidth><MatrixHeight>65536</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:17</ows:Identifier><ScaleDenominator>4265.4591671058115</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>131072</MatrixWidth><MatrixHeight>131072</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:18</ows:Identifier><ScaleDenominator>2132.7295835529058</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>262144</MatrixWidth><MatrixHeight>262144</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:19</ows:Identifier><ScaleDenominator>1066.364791776453</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>524288</MatrixWidth><MatrixHeight>524288</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:20</ows:Identifier><ScaleDenominator>533.1823958882266</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>1048576</MatrixWidth><MatrixHeight>1048576</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:21</ows:Identifier><ScaleDenominator>266.5911979441133</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>2097152</MatrixWidth><MatrixHeight>2097152</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:22</ows:Identifier><ScaleDenominator>133.29559897205644</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>4194304</MatrixWidth><MatrixHeight>4194304</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:23</ows:Identifier><ScaleDenominator>66.64779948602822</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>8388608</MatrixWidth><MatrixHeight>8388608</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:24</ows:Identifier><ScaleDenominator>33.32389974301429</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>16777216</MatrixWidth><MatrixHeight>16777216</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:25</ows:Identifier><ScaleDenominator>16.661949871507144</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>33554432</MatrixWidth><MatrixHeight>33554432</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:26</ows:Identifier><ScaleDenominator>8.330974935753572</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>67108864</MatrixWidth><MatrixHeight>67108864</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:27</ows:Identifier><ScaleDenominator>4.165487467876786</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>134217728</MatrixWidth><MatrixHeight>134217728</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:28</ows:Identifier><ScaleDenominator>2.0827437339382144</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>268435456</MatrixWidth><MatrixHeight>268435456</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:29</ows:Identifier><ScaleDenominator>1.0413718669692857</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>536870912</MatrixWidth><MatrixHeight>536870912</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:30</ows:Identifier><ScaleDenominator>0.5206859334846429</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>1073741824</MatrixWidth><MatrixHeight>1073741824</MatrixHeight></TileMatrix></TileMatrixSet><TileMatrixSet><ows:Identifier>EPSG:900913</ows:Identifier><ows:SupportedCRS>urn:ogc:def:crs:EPSG::900913</ows:SupportedCRS><TileMatrix><ows:Identifier>EPSG:900913:0</ows:Identifier><ScaleDenominator>5.590822639508929E8</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>1</MatrixWidth><MatrixHeight>1</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:1</ows:Identifier><ScaleDenominator>2.7954113197544646E8</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>2</MatrixWidth><MatrixHeight>2</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:2</ows:Identifier><ScaleDenominator>1.3977056598772323E8</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>4</MatrixWidth><MatrixHeight>4</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:3</ows:Identifier><ScaleDenominator>6.988528299386162E7</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>8</MatrixWidth><MatrixHeight>8</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:4</ows:Identifier><ScaleDenominator>3.494264149693081E7</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>16</MatrixWidth><MatrixHeight>16</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:5</ows:Identifier><ScaleDenominator>1.7471320748465404E7</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>32</MatrixWidth><MatrixHeight>32</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:6</ows:Identifier><ScaleDenominator>8735660.374232702</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>64</MatrixWidth><MatrixHeight>64</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:7</ows:Identifier><ScaleDenominator>4367830.187116351</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>128</MatrixWidth><MatrixHeight>128</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:8</ows:Identifier><ScaleDenominator>2183915.0935581755</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>256</MatrixWidth><MatrixHeight>256</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:9</ows:Identifier><ScaleDenominator>1091957.5467790877</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>512</MatrixWidth><MatrixHeight>512</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:10</ows:Identifier><ScaleDenominator>545978.7733895439</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>1024</MatrixWidth><MatrixHeight>1024</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:11</ows:Identifier><ScaleDenominator>272989.38669477194</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>2048</MatrixWidth><MatrixHeight>2048</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:12</ows:Identifier><ScaleDenominator>136494.69334738597</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>4096</MatrixWidth><MatrixHeight>4096</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:13</ows:Identifier><ScaleDenominator>68247.34667369298</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>8192</MatrixWidth><MatrixHeight>8192</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:14</ows:Identifier><ScaleDenominator>34123.67333684649</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>16384</MatrixWidth><MatrixHeight>16384</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:15</ows:Identifier><ScaleDenominator>17061.836668423246</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>32768</MatrixWidth><MatrixHeight>32768</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:16</ows:Identifier><ScaleDenominator>8530.918334211623</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>65536</MatrixWidth><MatrixHeight>65536</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:17</ows:Identifier><ScaleDenominator>4265.4591671058115</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>131072</MatrixWidth><MatrixHeight>131072</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:18</ows:Identifier><ScaleDenominator>2132.7295835529058</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>262144</MatrixWidth><MatrixHeight>262144</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:19</ows:Identifier><ScaleDenominator>1066.3647917764529</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>524288</MatrixWidth><MatrixHeight>524288</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:20</ows:Identifier><ScaleDenominator>533.1823958882264</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>1048576</MatrixWidth><MatrixHeight>1048576</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:21</ows:Identifier><ScaleDenominator>266.5911979441132</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>2097152</MatrixWidth><MatrixHeight>2097152</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:22</ows:Identifier><ScaleDenominator>133.2955989720566</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>4194304</MatrixWidth><MatrixHeight>4194304</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:23</ows:Identifier><ScaleDenominator>66.6477994860283</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>8388608</MatrixWidth><MatrixHeight>8388608</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:24</ows:Identifier><ScaleDenominator>33.32389974301415</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>16777216</MatrixWidth><MatrixHeight>16777216</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:25</ows:Identifier><ScaleDenominator>16.661949871507076</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>33554432</MatrixWidth><MatrixHeight>33554432</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:26</ows:Identifier><ScaleDenominator>8.330974935753538</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>67108864</MatrixWidth><MatrixHeight>67108864</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:27</ows:Identifier><ScaleDenominator>4.165487467876769</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>134217728</MatrixWidth><MatrixHeight>134217728</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:28</ows:Identifier><ScaleDenominator>2.0827437339383845</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>268435456</MatrixWidth><MatrixHeight>268435456</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:29</ows:Identifier><ScaleDenominator>1.0413718669691923</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>536870912</MatrixWidth><MatrixHeight>536870912</MatrixHeight></TileMatrix><TileMatrix><ows:Identifier>EPSG:900913:30</ows:Identifier><ScaleDenominator>0.5206859334845961</ScaleDenominator><TopLeftCorner>-2.003750834E7 2.0037508E7</TopLeftCorner><TileWidth>256</TileWidth><TileHeight>256</TileHeight><MatrixWidth>1073741824</MatrixWidth><MatrixHeight>1073741824</MatrixHeight></TileMatrix></TileMatrixSet></Contents><ServiceMetadataURL xlink:href="https://paituli.csc.fi/geoserver/paituli/gwc/service/wmts?SERVICE=wmts&amp;REQUEST=getcapabilities&amp;VERSION=1.0.0"/><ServiceMetadataURL xlink:href="https://paituli.csc.fi/geoserver/paituli/gwc/service/wmts/rest/WMTSCapabilities.xml"/></Capabilities>')),this.paituliWmtsCapabilities}},this.createSource=t=>{const{selectedLayer:e,apiKey:i}=t.maanmittauslaitos.basemap,n=function(t,e){const i=t.Contents.Layer,n=i?.find(function(t){return t.Identifier==e.layer});if(!n)return null;const a=t.Contents.TileMatrixSet;let s;s=n.TileMatrixSetLink.length>1?"projection"in e?n.TileMatrixSetLink.findIndex(function(t){const i=a.find(function(e){return e.Identifier==t.TileMatrixSet}).SupportedCRS,n=Ye(i),s=Ye(e.projection);return n&&s?ti(n,s):i==e.projection}):n.TileMatrixSetLink.findIndex(function(t){return t.TileMatrixSet==e.matrixSet}):0,s<0&&(s=0);const r=n.TileMatrixSetLink[s].TileMatrixSet,o=n.TileMatrixSetLink[s].TileMatrixSetLimits;let l=n.Format[0];"format"in e&&(l=e.format),s=n.Style.findIndex(function(t){return"style"in e?t.Title==e.style:t.isDefault}),s<0&&(s=0);const u=n.Style[s].Identifier,h={};"Dimension"in n&&n.Dimension.forEach(function(t,e,i){const n=t.Identifier;let a=t.Default;void 0===a&&(a=t.Value[0]),h[n]=a});const c=t.Contents.TileMatrixSet.find(function(t){return t.Identifier==r});let d;const p=c.SupportedCRS;if(p&&(d=Ye(p)),"projection"in e){const t=Ye(e.projection);t&&(d&&!ti(t,d)||(d=t))}let m=!1;const f=d.getAxisOrientation().startsWith("ne");let g=c.TileMatrix[0],_={MinTileCol:0,MinTileRow:0,MaxTileCol:g.MatrixWidth-1,MaxTileRow:g.MatrixHeight-1};if(o){_=o[o.length-1];const t=c.TileMatrix.find(t=>t.Identifier===_.TileMatrix||c.Identifier+":"+t.Identifier===_.TileMatrix);t&&(g=t)}const y=n.BoundingBox?.find(t=>Ye(t.crs)&&ti(Ye(t.crs),d)),k=28e-5*g.ScaleDenominator/d.getMetersPerUnit(),v=f?[g.TopLeftCorner[1],g.TopLeftCorner[0]]:g.TopLeftCorner,x=g.TileWidth*k,w=g.TileHeight*k;let b=y?.extent??c.BoundingBox;b&&f&&(b=[b[1],b[0],b[3],b[2]]);let E=[v[0]+x*_.MinTileCol,v[1]-w*(1+_.MaxTileRow),v[0]+x*(1+_.MaxTileCol),v[1]-w*_.MinTileRow];if(void 0!==b&&!Z(b,E)){const t=n.WGS84BoundingBox,e=Ye("EPSG:4326").getExtent();if(E=b,t)m=t[0]===e[0]&&t[2]===e[2];else{const t=si(b,c.SupportedCRS,"EPSG:4326");m=t[0]-1e-10<=e[0]&&t[2]+1e-10>=e[2]}}const M=function(t,e,i){const n=[],a=[],s=[],r=[],o=[];i=void 0!==i?i:[];const l="TileMatrix",u="Identifier",h="ScaleDenominator",c="TopLeftCorner",d=Ye(t.SupportedCRS),p=d.getMetersPerUnit(),m=d.getAxisOrientation().startsWith("ne");return t[l].sort(function(t,e){return e[h]-t[h]}),t[l].forEach(function(e){let d;if(d=!(i.length>0)||i.find(function(i){return e[u]==i[l]||!e[u].includes(":")&&t[u]+":"+e[u]===i[l]}),d){a.push(e[u]);const t=28e-5*e[h]/p,i=e.TileWidth,l=e.TileHeight;m?s.push([e[c][1],e[c][0]]):s.push(e[c]),n.push(t),r.push(i==l?i:[i,l]),o.push([e.MatrixWidth,e.MatrixHeight])}}),new Q_({extent:e,origins:s,resolutions:n,matrixIds:a,tileSizes:r,sizes:o})}(c,E,o),T=[];let S=e.requestEncoding;if(S=void 0!==S?S:"","OperationsMetadata"in t&&"GetTile"in t.OperationsMetadata){const e=t.OperationsMetadata.GetTile.DCP.HTTP.Get;for(let t=0,i=e.length;t<i;++t)if(e[t].Constraint){const i=e[t].Constraint.find(function(t){return"GetEncoding"==t.name}).AllowedValues.Value;if(""===S&&(S=i[0]),"KVP"!==S)break;i.includes("KVP")&&T.push(e[t].href)}else e[t].href&&(S="KVP",T.push(e[t].href))}return 0===T.length&&(S="REST",n.ResourceURL.forEach(function(t){"tile"===t.resourceType&&(l=t.format,T.push(t.template))})),{urls:T,layer:e.layer,matrixSet:r,format:l,projection:d,requestEncoding:S,tileGrid:M,style:u,dimensions:h,wrapX:m,crossOrigin:e.crossOrigin}}(this.getWmtsCapabilities(e),{layer:e});if(!n)throw new Error(`Expected layer ${e} were not found from WMTS Capabilities`);const a=new ty(n);return a.setUrls(a.getUrls()?.map(t=>`${t}api-key=${i}&`)||[]),a.on("tileloadstart",()=>{this.updateTileLoadingStatus(!0)}),a.on("tileloadend",()=>{this.updateTileLoadingStatus(!1)}),a.on("tileloaderror",()=>{this.updateTileLoadingStatus(!1)}),a},this.updateLayerSource=t=>{this.source=this.createSource(t),this.layer.setSource(this.source),this.updateLayerVisibility(t)},this.updateLayerVisibility=t=>{const{enabled:e}=t.maanmittauslaitos.basemap;this.layer.setVisible(e)},this.selectedMaanmittauslaitosLayerChanged=t=>{this.updateLayerSource(t)},this.getLayer=()=>this.layer,this.updateTileLoadingStatus=e,this.source=this.createSource(t),this.layer=new Ef({source:this.source}),this.updateLayerVisibility(t)}}class iy{constructor(t,e){this.createSource=t=>{const{selectedLayers:e,url:i}=t.maanmittauslaitos.vanhatKartat,n={urls:[i.wms],params:{LAYERS:e.join(","),TILED:!0},serverType:"geoserver"},a=new e_(n);return a.on("tileloadstart",()=>{this.updateTileLoadingStatus(!0)}),a.on("tileloadend",()=>{this.updateTileLoadingStatus(!1)}),a.on("tileloaderror",()=>{this.updateTileLoadingStatus(!1)}),a},this.updateLayerSource=t=>{this.source=this.createSource(t),this.layer.setSource(this.source),this.updateLayerVisibility(t)},this.updateLayerVisibility=t=>{const{selectedLayers:e,enabled:i}=t.maanmittauslaitos.vanhatKartat;this.layer.setVisible(i&&e.length>0)},this.selectedMaanmittauslaitosVanhatKartatLayerChanged=t=>{this.updateLayerSource(t)},this.opacityChanged=t=>{const{opacity:e}=t.maanmittauslaitos.vanhatKartat;this.layer.setOpacity(e)},this.getLayer=()=>this.layer,this.updateTileLoadingStatus=e,this.source=this.createSource(t),this.layer=new Ef({source:this.source}),this.opacityChanged(t),this.updateLayerVisibility(t)}}const ny="object"==typeof performance&&performance&&"function"==typeof performance.now?performance:Date,ay=new Set,sy="object"==typeof process&&process?process:{},ry=(t,e,i,n)=>{"function"==typeof sy.emitWarning?sy.emitWarning(t,e,i,n):console.error(`[${i}] ${e}: ${t}`)};let oy=globalThis.AbortController,ly=globalThis.AbortSignal;if(void 0===oy){ly=class{onabort;_onabort=[];reason;aborted=!1;addEventListener(t,e){this._onabort.push(e)}},oy=class{constructor(){e()}signal=new ly;abort(t){if(!this.signal.aborted){this.signal.reason=t,this.signal.aborted=!0;for(const e of this.signal._onabort)e(t);this.signal.onabort?.(t)}}};let t="1"!==sy.env?.LRU_CACHE_IGNORE_AC_WARNING;const e=()=>{t&&(t=!1,ry("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",e))}}Symbol("type");const uy=t=>t&&t===Math.floor(t)&&t>0&&isFinite(t),hy=t=>uy(t)?t<=Math.pow(2,8)?Uint8Array:t<=Math.pow(2,16)?Uint16Array:t<=Math.pow(2,32)?Uint32Array:t<=Number.MAX_SAFE_INTEGER?cy:null:null;class cy extends Array{constructor(t){super(t),this.fill(0)}}class dy{heap;length;static#t=!1;static create(t){const e=hy(t);if(!e)return[];dy.#t=!0;const i=new dy(t,e);return dy.#t=!1,i}constructor(t,e){if(!dy.#t)throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new e(t),this.length=0}push(t){this.heap[this.length++]=t}pop(){return this.heap[--this.length]}}class py{#e;#i;#n;#a;#s;#r;#o;#l;get perf(){return this.#l}ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#u;#h;#c;#d;#p;#m;#f;#g;#_;#y;#k;#v;#x;#w;#b;#E;#M;#T;static unsafeExposeInternals(t){return{starts:t.#x,ttls:t.#w,sizes:t.#v,keyMap:t.#c,keyList:t.#d,valList:t.#p,next:t.#m,prev:t.#f,get head(){return t.#g},get tail(){return t.#_},free:t.#y,isBackgroundFetch:e=>t.#S(e),backgroundFetch:(e,i,n,a)=>t.#C(e,i,n,a),moveToTail:e=>t.#L(e),indexes:e=>t.#R(e),rindexes:e=>t.#I(e),isStale:e=>t.#P(e)}}get max(){return this.#e}get maxSize(){return this.#i}get calculatedSize(){return this.#h}get size(){return this.#u}get fetchMethod(){return this.#r}get memoMethod(){return this.#o}get dispose(){return this.#n}get onInsert(){return this.#a}get disposeAfter(){return this.#s}constructor(t){const{max:e=0,ttl:i,ttlResolution:n=1,ttlAutopurge:a,updateAgeOnGet:s,updateAgeOnHas:r,allowStale:o,dispose:l,onInsert:u,disposeAfter:h,noDisposeOnSet:c,noUpdateTTL:d,maxSize:p=0,maxEntrySize:m=0,sizeCalculation:f,fetchMethod:g,memoMethod:_,noDeleteOnFetchRejection:y,noDeleteOnStaleGet:k,allowStaleOnFetchRejection:v,allowStaleOnFetchAbort:x,ignoreFetchAbort:w,perf:b}=t;if(void 0!==b&&"function"!=typeof b?.now)throw new TypeError("perf option must have a now() method if specified");if(this.#l=b??ny,0!==e&&!uy(e))throw new TypeError("max option must be a nonnegative integer");const E=e?hy(e):Array;if(!E)throw new Error("invalid max value: "+e);if(this.#e=e,this.#i=p,this.maxEntrySize=m||this.#i,this.sizeCalculation=f,this.sizeCalculation){if(!this.#i&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if("function"!=typeof this.sizeCalculation)throw new TypeError("sizeCalculation set to non-function")}if(void 0!==_&&"function"!=typeof _)throw new TypeError("memoMethod must be a function if defined");if(this.#o=_,void 0!==g&&"function"!=typeof g)throw new TypeError("fetchMethod must be a function if specified");if(this.#r=g,this.#E=!!g,this.#c=new Map,this.#d=new Array(e).fill(void 0),this.#p=new Array(e).fill(void 0),this.#m=new E(e),this.#f=new E(e),this.#g=0,this.#_=0,this.#y=dy.create(e),this.#u=0,this.#h=0,"function"==typeof l&&(this.#n=l),"function"==typeof u&&(this.#a=u),"function"==typeof h?(this.#s=h,this.#k=[]):(this.#s=void 0,this.#k=void 0),this.#b=!!this.#n,this.#T=!!this.#a,this.#M=!!this.#s,this.noDisposeOnSet=!!c,this.noUpdateTTL=!!d,this.noDeleteOnFetchRejection=!!y,this.allowStaleOnFetchRejection=!!v,this.allowStaleOnFetchAbort=!!x,this.ignoreFetchAbort=!!w,0!==this.maxEntrySize){if(0!==this.#i&&!uy(this.#i))throw new TypeError("maxSize must be a positive integer if specified");if(!uy(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.#A()}if(this.allowStale=!!o,this.noDeleteOnStaleGet=!!k,this.updateAgeOnGet=!!s,this.updateAgeOnHas=!!r,this.ttlResolution=uy(n)||0===n?n:1,this.ttlAutopurge=!!a,this.ttl=i||0,this.ttl){if(!uy(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.#j()}if(0===this.#e&&0===this.ttl&&0===this.#i)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.#e&&!this.#i){const t="LRU_CACHE_UNBOUNDED";(t=>!ay.has(t))(t)&&(ay.add(t),ry("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",t,py))}}getRemainingTTL(t){return this.#c.has(t)?1/0:0}#j(){const t=new cy(this.#e),e=new cy(this.#e);this.#w=t,this.#x=e,this.#O=(i,n,a=this.#l.now())=>{if(e[i]=0!==n?a:0,t[i]=n,0!==n&&this.ttlAutopurge){const t=setTimeout(()=>{this.#P(i)&&this.#F(this.#d[i],"expire")},n+1);t.unref&&t.unref()}},this.#N=i=>{e[i]=0!==t[i]?this.#l.now():0},this.#G=(a,s)=>{if(t[s]){const r=t[s],o=e[s];if(!r||!o)return;a.ttl=r,a.start=o,a.now=i||n();const l=a.now-o;a.remainingTTL=r-l}};let i=0;const n=()=>{const t=this.#l.now();if(this.ttlResolution>0){i=t;const e=setTimeout(()=>i=0,this.ttlResolution);e.unref&&e.unref()}return t};this.getRemainingTTL=a=>{const s=this.#c.get(a);if(void 0===s)return 0;const r=t[s],o=e[s];return r&&o?r-((i||n())-o):1/0},this.#P=a=>{const s=e[a],r=t[a];return!!r&&!!s&&(i||n())-s>r}}#N=()=>{};#G=()=>{};#O=()=>{};#P=()=>!1;#A(){const t=new cy(this.#e);this.#h=0,this.#v=t,this.#D=e=>{this.#h-=t[e],t[e]=0},this.#W=(t,e,i,n)=>{if(this.#S(e))return 0;if(!uy(i)){if(!n)throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");if("function"!=typeof n)throw new TypeError("sizeCalculation must be a function");if(i=n(e,t),!uy(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}return i},this.#H=(e,i,n)=>{if(t[e]=i,this.#i){const i=this.#i-t[e];for(;this.#h>i;)this.#U(!0)}this.#h+=t[e],n&&(n.entrySize=i,n.totalCalculatedSize=this.#h)}}#D=t=>{};#H=(t,e,i)=>{};#W=(t,e,i,n)=>{if(i||n)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0};*#R({allowStale:t=this.allowStale}={}){if(this.#u)for(let e=this.#_;this.#B(e)&&(!t&&this.#P(e)||(yield e),e!==this.#g);)e=this.#f[e]}*#I({allowStale:t=this.allowStale}={}){if(this.#u)for(let e=this.#g;this.#B(e)&&(!t&&this.#P(e)||(yield e),e!==this.#_);)e=this.#m[e]}#B(t){return void 0!==t&&this.#c.get(this.#d[t])===t}*entries(){for(const t of this.#R())void 0===this.#p[t]||void 0===this.#d[t]||this.#S(this.#p[t])||(yield[this.#d[t],this.#p[t]])}*rentries(){for(const t of this.#I())void 0===this.#p[t]||void 0===this.#d[t]||this.#S(this.#p[t])||(yield[this.#d[t],this.#p[t]])}*keys(){for(const t of this.#R()){const e=this.#d[t];void 0===e||this.#S(this.#p[t])||(yield e)}}*rkeys(){for(const t of this.#I()){const e=this.#d[t];void 0===e||this.#S(this.#p[t])||(yield e)}}*values(){for(const t of this.#R())void 0===this.#p[t]||this.#S(this.#p[t])||(yield this.#p[t])}*rvalues(){for(const t of this.#I())void 0===this.#p[t]||this.#S(this.#p[t])||(yield this.#p[t])}[Symbol.iterator](){return this.entries()}[Symbol.toStringTag]="LRUCache";find(t,e={}){for(const i of this.#R()){const n=this.#p[i],a=this.#S(n)?n.__staleWhileFetching:n;if(void 0!==a&&t(a,this.#d[i],this))return this.get(this.#d[i],e)}}forEach(t,e=this){for(const i of this.#R()){const n=this.#p[i],a=this.#S(n)?n.__staleWhileFetching:n;void 0!==a&&t.call(e,a,this.#d[i],this)}}rforEach(t,e=this){for(const i of this.#I()){const n=this.#p[i],a=this.#S(n)?n.__staleWhileFetching:n;void 0!==a&&t.call(e,a,this.#d[i],this)}}purgeStale(){let t=!1;for(const e of this.#I({allowStale:!0}))this.#P(e)&&(this.#F(this.#d[e],"expire"),t=!0);return t}info(t){const e=this.#c.get(t);if(void 0===e)return;const i=this.#p[e],n=this.#S(i)?i.__staleWhileFetching:i;if(void 0===n)return;const a={value:n};if(this.#w&&this.#x){const t=this.#w[e],i=this.#x[e];if(t&&i){const e=t-(this.#l.now()-i);a.ttl=e,a.start=Date.now()}}return this.#v&&(a.size=this.#v[e]),a}dump(){const t=[];for(const e of this.#R({allowStale:!0})){const i=this.#d[e],n=this.#p[e],a=this.#S(n)?n.__staleWhileFetching:n;if(void 0===a||void 0===i)continue;const s={value:a};if(this.#w&&this.#x){s.ttl=this.#w[e];const t=this.#l.now()-this.#x[e];s.start=Math.floor(Date.now()-t)}this.#v&&(s.size=this.#v[e]),t.unshift([i,s])}return t}load(t){this.clear();for(const[e,i]of t){if(i.start){const t=Date.now()-i.start;i.start=this.#l.now()-t}this.set(e,i.value,i)}}set(t,e,i={}){if(void 0===e)return this.delete(t),this;const{ttl:n=this.ttl,start:a,noDisposeOnSet:s=this.noDisposeOnSet,sizeCalculation:r=this.sizeCalculation,status:o}=i;let{noUpdateTTL:l=this.noUpdateTTL}=i;const u=this.#W(t,e,i.size||0,r);if(this.maxEntrySize&&u>this.maxEntrySize)return o&&(o.set="miss",o.maxEntrySizeExceeded=!0),this.#F(t,"set"),this;let h=0===this.#u?void 0:this.#c.get(t);if(void 0===h)h=0===this.#u?this.#_:0!==this.#y.length?this.#y.pop():this.#u===this.#e?this.#U(!1):this.#u,this.#d[h]=t,this.#p[h]=e,this.#c.set(t,h),this.#m[this.#_]=h,this.#f[h]=this.#_,this.#_=h,this.#u++,this.#H(h,u,o),o&&(o.set="add"),l=!1,this.#T&&this.#a?.(e,t,"add");else{this.#L(h);const i=this.#p[h];if(e!==i){if(this.#E&&this.#S(i)){i.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:e}=i;void 0===e||s||(this.#b&&this.#n?.(e,t,"set"),this.#M&&this.#k?.push([e,t,"set"]))}else s||(this.#b&&this.#n?.(i,t,"set"),this.#M&&this.#k?.push([i,t,"set"]));if(this.#D(h),this.#H(h,u,o),this.#p[h]=e,o){o.set="replace";const t=i&&this.#S(i)?i.__staleWhileFetching:i;void 0!==t&&(o.oldValue=t)}}else o&&(o.set="update");this.#T&&this.onInsert?.(e,t,e===i?"update":"replace")}if(0===n||this.#w||this.#j(),this.#w&&(l||this.#O(h,n,a),o&&this.#G(o,h)),!s&&this.#M&&this.#k){const t=this.#k;let e;for(;e=t?.shift();)this.#s?.(...e)}return this}pop(){try{for(;this.#u;){const t=this.#p[this.#g];if(this.#U(!0),this.#S(t)){if(t.__staleWhileFetching)return t.__staleWhileFetching}else if(void 0!==t)return t}}finally{if(this.#M&&this.#k){const t=this.#k;let e;for(;e=t?.shift();)this.#s?.(...e)}}}#U(t){const e=this.#g,i=this.#d[e],n=this.#p[e];return this.#E&&this.#S(n)?n.__abortController.abort(new Error("evicted")):(this.#b||this.#M)&&(this.#b&&this.#n?.(n,i,"evict"),this.#M&&this.#k?.push([n,i,"evict"])),this.#D(e),t&&(this.#d[e]=void 0,this.#p[e]=void 0,this.#y.push(e)),1===this.#u?(this.#g=this.#_=0,this.#y.length=0):this.#g=this.#m[e],this.#c.delete(i),this.#u--,e}has(t,e={}){const{updateAgeOnHas:i=this.updateAgeOnHas,status:n}=e,a=this.#c.get(t);if(void 0!==a){const t=this.#p[a];if(this.#S(t)&&void 0===t.__staleWhileFetching)return!1;if(!this.#P(a))return i&&this.#N(a),n&&(n.has="hit",this.#G(n,a)),!0;n&&(n.has="stale",this.#G(n,a))}else n&&(n.has="miss");return!1}peek(t,e={}){const{allowStale:i=this.allowStale}=e,n=this.#c.get(t);if(void 0===n||!i&&this.#P(n))return;const a=this.#p[n];return this.#S(a)?a.__staleWhileFetching:a}#C(t,e,i,n){const a=void 0===e?void 0:this.#p[e];if(this.#S(a))return a;const s=new oy,{signal:r}=i;r?.addEventListener("abort",()=>s.abort(r.reason),{signal:s.signal});const o={signal:s.signal,options:i,context:n},l=(n,a=!1)=>{const{aborted:r}=s.signal,l=i.ignoreFetchAbort&&void 0!==n;if(i.status&&(r&&!a?(i.status.fetchAborted=!0,i.status.fetchError=s.signal.reason,l&&(i.status.fetchAbortIgnored=!0)):i.status.fetchResolved=!0),r&&!l&&!a)return u(s.signal.reason);const c=h,d=this.#p[e];return(d===h||l&&a&&void 0===d)&&(void 0===n?void 0!==c.__staleWhileFetching?this.#p[e]=c.__staleWhileFetching:this.#F(t,"fetch"):(i.status&&(i.status.fetchUpdated=!0),this.set(t,n,o.options))),n},u=n=>{const{aborted:a}=s.signal,r=a&&i.allowStaleOnFetchAbort,o=r||i.allowStaleOnFetchRejection,l=o||i.noDeleteOnFetchRejection,u=h;if(this.#p[e]===h&&(l&&void 0!==u.__staleWhileFetching?r||(this.#p[e]=u.__staleWhileFetching):this.#F(t,"fetch")),o)return i.status&&void 0!==u.__staleWhileFetching&&(i.status.returnedStale=!0),u.__staleWhileFetching;if(u.__returned===u)throw n};i.status&&(i.status.fetchDispatched=!0);const h=new Promise((e,n)=>{const r=this.#r?.(t,a,o);r&&r instanceof Promise&&r.then(t=>e(void 0===t?void 0:t),n),s.signal.addEventListener("abort",()=>{i.ignoreFetchAbort&&!i.allowStaleOnFetchAbort||(e(void 0),i.allowStaleOnFetchAbort&&(e=t=>l(t,!0)))})}).then(l,t=>(i.status&&(i.status.fetchRejected=!0,i.status.fetchError=t),u(t))),c=Object.assign(h,{__abortController:s,__staleWhileFetching:a,__returned:void 0});return void 0===e?(this.set(t,c,{...o.options,status:void 0}),e=this.#c.get(t)):this.#p[e]=c,c}#S(t){if(!this.#E)return!1;const e=t;return!!e&&e instanceof Promise&&e.hasOwnProperty("__staleWhileFetching")&&e.__abortController instanceof oy}async fetch(t,e={}){const{allowStale:i=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet,noDeleteOnStaleGet:a=this.noDeleteOnStaleGet,ttl:s=this.ttl,noDisposeOnSet:r=this.noDisposeOnSet,size:o=0,sizeCalculation:l=this.sizeCalculation,noUpdateTTL:u=this.noUpdateTTL,noDeleteOnFetchRejection:h=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:c=this.allowStaleOnFetchRejection,ignoreFetchAbort:d=this.ignoreFetchAbort,allowStaleOnFetchAbort:p=this.allowStaleOnFetchAbort,context:m,forceRefresh:f=!1,status:g,signal:_}=e;if(!this.#E)return g&&(g.fetch="get"),this.get(t,{allowStale:i,updateAgeOnGet:n,noDeleteOnStaleGet:a,status:g});const y={allowStale:i,updateAgeOnGet:n,noDeleteOnStaleGet:a,ttl:s,noDisposeOnSet:r,size:o,sizeCalculation:l,noUpdateTTL:u,noDeleteOnFetchRejection:h,allowStaleOnFetchRejection:c,allowStaleOnFetchAbort:p,ignoreFetchAbort:d,status:g,signal:_};let k=this.#c.get(t);if(void 0===k){g&&(g.fetch="miss");const e=this.#C(t,k,y,m);return e.__returned=e}{const e=this.#p[k];if(this.#S(e)){const t=i&&void 0!==e.__staleWhileFetching;return g&&(g.fetch="inflight",t&&(g.returnedStale=!0)),t?e.__staleWhileFetching:e.__returned=e}const a=this.#P(k);if(!f&&!a)return g&&(g.fetch="hit"),this.#L(k),n&&this.#N(k),g&&this.#G(g,k),e;const s=this.#C(t,k,y,m),r=void 0!==s.__staleWhileFetching&&i;return g&&(g.fetch=a?"stale":"refresh",r&&a&&(g.returnedStale=!0)),r?s.__staleWhileFetching:s.__returned=s}}async forceFetch(t,e={}){const i=await this.fetch(t,e);if(void 0===i)throw new Error("fetch() returned undefined");return i}memo(t,e={}){const i=this.#o;if(!i)throw new Error("no memoMethod provided to constructor");const{context:n,forceRefresh:a,...s}=e,r=this.get(t,s);if(!a&&void 0!==r)return r;const o=i(t,r,{options:s,context:n});return this.set(t,o,s),o}get(t,e={}){const{allowStale:i=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet,noDeleteOnStaleGet:a=this.noDeleteOnStaleGet,status:s}=e,r=this.#c.get(t);if(void 0!==r){const e=this.#p[r],o=this.#S(e);return s&&this.#G(s,r),this.#P(r)?(s&&(s.get="stale"),o?(s&&i&&void 0!==e.__staleWhileFetching&&(s.returnedStale=!0),i?e.__staleWhileFetching:void 0):(a||this.#F(t,"expire"),s&&i&&(s.returnedStale=!0),i?e:void 0)):(s&&(s.get="hit"),o?e.__staleWhileFetching:(this.#L(r),n&&this.#N(r),e))}s&&(s.get="miss")}#V(t,e){this.#f[e]=t,this.#m[t]=e}#L(t){t!==this.#_&&(t===this.#g?this.#g=this.#m[t]:this.#V(this.#f[t],this.#m[t]),this.#V(this.#_,t),this.#_=t)}delete(t){return this.#F(t,"delete")}#F(t,e){let i=!1;if(0!==this.#u){const n=this.#c.get(t);if(void 0!==n)if(i=!0,1===this.#u)this.#K(e);else{this.#D(n);const i=this.#p[n];if(this.#S(i)?i.__abortController.abort(new Error("deleted")):(this.#b||this.#M)&&(this.#b&&this.#n?.(i,t,e),this.#M&&this.#k?.push([i,t,e])),this.#c.delete(t),this.#d[n]=void 0,this.#p[n]=void 0,n===this.#_)this.#_=this.#f[n];else if(n===this.#g)this.#g=this.#m[n];else{const t=this.#f[n];this.#m[t]=this.#m[n];const e=this.#m[n];this.#f[e]=this.#f[n]}this.#u--,this.#y.push(n)}}if(this.#M&&this.#k?.length){const t=this.#k;let e;for(;e=t?.shift();)this.#s?.(...e)}return i}clear(){return this.#K("delete")}#K(t){for(const e of this.#I({allowStale:!0})){const i=this.#p[e];if(this.#S(i))i.__abortController.abort(new Error("deleted"));else{const n=this.#d[e];this.#b&&this.#n?.(i,n,t),this.#M&&this.#k?.push([i,n,t])}}if(this.#c.clear(),this.#p.fill(void 0),this.#d.fill(void 0),this.#w&&this.#x&&(this.#w.fill(0),this.#x.fill(0)),this.#v&&this.#v.fill(0),this.#g=0,this.#_=0,this.#y.length=0,this.#h=0,this.#u=0,this.#M&&this.#k){const t=this.#k;let e;for(;e=t?.shift();)this.#s?.(...e)}}}let my;const fy=()=>{if(void 0!==my)return my;try{const t=document.createElement("canvas");my=!(!window.WebGLRenderingContext||!t.getContext("webgl")&&!t.getContext("experimental-webgl"))}catch{my=!1}return my};function gy(t,e){return t[0]=e[0],t[1]=e[1],t[4]=e[2],t[5]=e[3],t[12]=e[4],t[13]=e[5],t}function _y(t,e,i,n,a,s,r){const o=1/(t-e),l=1/(i-n),u=1/(a-s);return(r=r??[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])[0]=-2*o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*l,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*u,r[11]=0,r[12]=(t+e)*o,r[13]=(n+i)*l,r[14]=(s+a)*u,r[15]=1,r}function yy(t,e,i,n,a){return(a=a??[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])[0]=t[0]*e,a[1]=t[1]*e,a[2]=t[2]*e,a[3]=t[3]*e,a[4]=t[4]*i,a[5]=t[5]*i,a[6]=t[6]*i,a[7]=t[7]*i,a[8]=t[8]*n,a[9]=t[9]*n,a[10]=t[10]*n,a[11]=t[11]*n,a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15],a}const ky=34962,vy=34963,xy=35044,wy=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function by(t,e){e=Object.assign({preserveDrawingBuffer:!0,antialias:!Nn},e);const i=wy.length;for(let n=0;n<i;++n)try{const i=t.getContext(wy[n],e);if(i)return i}catch{}return null}function Ey(t){switch(t){case ky:return Float32Array;case vy:return Uint32Array;default:return Float32Array}}const My=class{constructor(t,e){this.array_=null,this.type_=t,B(t===ky||t===vy,"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`"),this.usage_=void 0!==e?e:35044}ofSize(t){return this.array_=new(Ey(this.type_))(t),this}fromArray(t){return this.array_=Ey(this.type_).from(t),this}fromArrayBuffer(t){return this.array_=new(Ey(this.type_))(t),this}getType(){return this.type_}getArray(){return this.array_}setArray(t){const e=Ey(this.type_);if(!(t instanceof e))throw new Error(`Expected ${e}`);this.array_=t}getUsage(){return this.usage_}getSize(){return this.array_?this.array_.length:0}},Ty="webglcontextlost",Sy="webglcontextrestored",Cy=class{constructor(t){this.gl_=t.webGlContext;const e=this.gl_;this.scaleRatio_=t.scaleRatio||1,this.renderTargetTexture_=e.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=e.createFramebuffer(),this.depthBuffer_=e.createRenderbuffer();const i=e.createShader(e.VERTEX_SHADER);e.shaderSource(i,t.vertexShader||"\n  precision mediump float;\n\n  attribute vec2 a_position;\n  varying vec2 v_texCoord;\n  varying vec2 v_screenCoord;\n\n  uniform vec2 u_screenSize;\n\n  void main() {\n    v_texCoord = a_position * 0.5 + 0.5;\n    v_screenCoord = v_texCoord * u_screenSize;\n    gl_Position = vec4(a_position, 0.0, 1.0);\n  }\n"),e.compileShader(i);const n=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(n,t.fragmentShader||"\n  precision mediump float;\n\n  uniform sampler2D u_image;\n  uniform float u_opacity;\n\n  varying vec2 v_texCoord;\n\n  void main() {\n    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;\n  }\n"),e.compileShader(n),this.renderTargetProgram_=e.createProgram(),e.attachShader(this.renderTargetProgram_,i),e.attachShader(this.renderTargetProgram_,n),e.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,-1,1,1,-1,1]),e.STATIC_DRAW),this.renderTargetAttribLocation_=e.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=e.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=e.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=e.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],t.uniforms&&Object.keys(t.uniforms).forEach(i=>{this.uniforms_.push({value:t.uniforms[i],location:e.getUniformLocation(this.renderTargetProgram_,i)})})}getRenderTargetTexture(){return this.renderTargetTexture_}getGL(){return this.gl_}init(t){const e=this.getGL(),i=[e.drawingBufferWidth*this.scaleRatio_,e.drawingBufferHeight*this.scaleRatio_];if(e.bindFramebuffer(e.FRAMEBUFFER,this.getFrameBuffer()),e.bindRenderbuffer(e.RENDERBUFFER,this.getDepthBuffer()),e.viewport(0,0,i[0],i[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==i[0]||this.renderTargetTextureSize_[1]!==i[1]){this.renderTargetTextureSize_=i;const t=0,n=e.RGBA,a=0,s=e.RGBA,r=e.UNSIGNED_BYTE,o=null;e.bindTexture(e.TEXTURE_2D,this.renderTargetTexture_),e.texImage2D(e.TEXTURE_2D,t,n,i[0],i[1],a,s,r,o),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.renderTargetTexture_,0),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,i[0],i[1]),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,this.depthBuffer_)}}apply(t,e,i,n){const a=this.getGL(),s=t.size;if(a.bindFramebuffer(a.FRAMEBUFFER,e?e.getFrameBuffer():null),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,this.renderTargetTexture_),!e){const e=N(a.canvas);if(!t.renderTargets[e]){const i=a.getContextAttributes();i&&i.preserveDrawingBuffer&&(a.clearColor(0,0,0,0),a.clearDepth(1),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT)),t.renderTargets[e]=!0}}a.disable(a.DEPTH_TEST),a.enable(a.BLEND),a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA),a.viewport(0,0,a.drawingBufferWidth,a.drawingBufferHeight),a.bindBuffer(a.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),a.useProgram(this.renderTargetProgram_),a.enableVertexAttribArray(this.renderTargetAttribLocation_),a.vertexAttribPointer(this.renderTargetAttribLocation_,2,a.FLOAT,!1,0,0),a.uniform2f(this.renderTargetUniformLocation_,s[0],s[1]),a.uniform1i(this.renderTargetTextureLocation_,0);const r=t.layerStatesArray[t.layerIndex].opacity;a.uniform1f(this.renderTargetOpacityLocation_,r),this.applyUniforms(t),i&&i(a,t),a.drawArrays(a.TRIANGLES,0,6),n&&n(a,t)}getFrameBuffer(){return this.frameBuffer_}getDepthBuffer(){return this.depthBuffer_}applyUniforms(t){const e=this.getGL();let i,n=1;this.uniforms_.forEach(function(a){if(i="function"==typeof a.value?a.value(t):a.value,i instanceof HTMLCanvasElement||i instanceof ImageData)a.texture||(a.texture=e.createTexture()),e.activeTexture(e[`TEXTURE${n}`]),e.bindTexture(e.TEXTURE_2D,a.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),i instanceof ImageData?e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,i.width,i.height,0,e.UNSIGNED_BYTE,new Uint8Array(i.data)):e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,i),e.uniform1i(a.location,n++);else if(Array.isArray(i))switch(i.length){case 2:return void e.uniform2f(a.location,i[0],i[1]);case 3:return void e.uniform3f(a.location,i[0],i[1],i[2]);case 4:return void e.uniform4f(a.location,i[0],i[1],i[2],i[3]);default:return}else"number"==typeof i&&e.uniform1f(a.location,i)})}},Ly="u_pixelRatio",Ry={};function Iy(t){return"shared/"+t}let Py=0;function Ay(t){switch(t){case 5121:return Uint8Array.BYTES_PER_ELEMENT;case 5123:return Uint16Array.BYTES_PER_ELEMENT;case 5125:return Uint32Array.BYTES_PER_ELEMENT;default:return Float32Array.BYTES_PER_ELEMENT}}const jy=class extends m{constructor(t){super(),t=t||{},this.boundHandleWebGLContextLost_=this.handleWebGLContextLost.bind(this),this.boundHandleWebGLContextRestored_=this.handleWebGLContextRestored.bind(this),this.canvasCacheKey_=t.canvasCacheKey?Iy(t.canvasCacheKey):function(){const t="unique/"+Py;return Py+=1,t}(),this.gl_=function(t){let e=Ry[t];if(!e){const i=document.createElement("canvas");i.width=1,i.height=1,i.style.position="absolute",i.style.left="0",e={users:0,context:by(i)},Ry[t]=e}return e.users+=1,e.context}(this.canvasCacheKey_),this.bufferCache_={},this.extensionCache_={},this.currentProgram_=null,this.needsToBeRecreated_=!1;const e=this.gl_.canvas;e.addEventListener(Ty,this.boundHandleWebGLContextLost_),e.addEventListener(Sy,this.boundHandleWebGLContextRestored_),this.offsetRotateMatrix_=[1,0,0,1,0,0],this.offsetScaleMatrix_=[1,0,0,1,0,0],this.tmpMat4_=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.uniformLocationsByProgram_={},this.attribLocationsByProgram_={},this.uniforms_=[],t.uniforms&&this.setUniforms(t.uniforms),this.postProcessPasses_=t.postProcesses?t.postProcesses.map(t=>new Cy({webGlContext:this.gl_,scaleRatio:t.scaleRatio,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:t.uniforms})):[new Cy({webGlContext:this.gl_})],this.shaderCompileErrors_=null,this.startTime_=Date.now(),this.maxAttributeCount_=this.gl_.getParameter(this.gl_.MAX_VERTEX_ATTRIBS)}setUniforms(t){this.uniforms_=[],this.addUniforms(t)}addUniforms(t){for(const e in t)this.uniforms_.push({name:e,value:t[e]})}canvasCacheKeyMatches(t){return this.canvasCacheKey_===Iy(t)}getExtension(t){if(t in this.extensionCache_)return this.extensionCache_[t];const e=this.gl_.getExtension(t);return this.extensionCache_[t]=e,e}getInstancedRenderingExtension_(){const t=this.getExtension("ANGLE_instanced_arrays");return B(!!t,"WebGL extension 'ANGLE_instanced_arrays' is required for vector rendering"),t}bindBuffer(t){const e=this.gl_,i=N(t);let n=this.bufferCache_[i];n||(n={buffer:t,webGlBuffer:e.createBuffer()},this.bufferCache_[i]=n),e.bindBuffer(t.getType(),n.webGlBuffer)}flushBufferData(t){const e=this.gl_;this.bindBuffer(t),e.bufferData(t.getType(),t.getArray(),t.getUsage())}deleteBuffer(t){const e=N(t);delete this.bufferCache_[e]}disposeInternal(){const t=this.gl_.canvas;t.removeEventListener(Ty,this.boundHandleWebGLContextLost_),t.removeEventListener(Sy,this.boundHandleWebGLContextRestored_),function(t){const e=Ry[t];if(!e)return;if(e.users-=1,e.users>0)return;const i=e.context,n=i.getExtension("WEBGL_lose_context");n&&n.loseContext();const a=i.canvas;a.width=1,a.height=1,delete Ry[t]}(this.canvasCacheKey_),delete this.gl_}prepareDraw(t,e,i){const n=this.gl_,a=this.getCanvas(),s=t.size,r=t.pixelRatio;a.width===s[0]*r&&a.height===s[1]*r||(a.width=s[0]*r,a.height=s[1]*r,a.style.width=s[0]+"px",a.style.height=s[1]+"px");for(let e=this.postProcessPasses_.length-1;e>=0;e--)this.postProcessPasses_[e].init(t);n.bindTexture(n.TEXTURE_2D,null),n.clearColor(0,0,0,0),n.depthRange(0,1),n.clearDepth(1),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),n.enable(n.BLEND),n.blendFunc(n.ONE,e?n.ZERO:n.ONE_MINUS_SRC_ALPHA),i?(n.enable(n.DEPTH_TEST),n.depthFunc(n.LEQUAL)):n.disable(n.DEPTH_TEST)}bindFrameBuffer(t,e){const i=this.getGL();i.bindFramebuffer(i.FRAMEBUFFER,t),e&&i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,e,0)}bindInitialFrameBuffer(){const t=this.getGL(),e=this.postProcessPasses_[0].getFrameBuffer();t.bindFramebuffer(t.FRAMEBUFFER,e);const i=this.postProcessPasses_[0].getRenderTargetTexture();t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i,0)}bindTexture(t,e,i){const n=this.gl_;n.activeTexture(n.TEXTURE0+e),n.bindTexture(n.TEXTURE_2D,t),n.uniform1i(this.getUniformLocation(i),e)}bindAttribute(t,e,i){const n=this.getGL();this.bindBuffer(t);const a=this.getAttributeLocation(e);n.enableVertexAttribArray(a),n.vertexAttribPointer(a,i,n.FLOAT,!1,0,0)}prepareDrawToRenderTarget(t,e,i,n){const a=this.gl_,s=e.getSize();a.bindFramebuffer(a.FRAMEBUFFER,e.getFramebuffer()),a.bindRenderbuffer(a.RENDERBUFFER,e.getDepthbuffer()),a.viewport(0,0,s[0],s[1]),a.bindTexture(a.TEXTURE_2D,e.getTexture()),a.clearColor(0,0,0,0),a.depthRange(0,1),a.clearDepth(1),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.enable(a.BLEND),a.blendFunc(a.ONE,i?a.ZERO:a.ONE_MINUS_SRC_ALPHA),n?(a.enable(a.DEPTH_TEST),a.depthFunc(a.LEQUAL)):a.disable(a.DEPTH_TEST)}drawElements(t,e){const i=this.gl_;this.getExtension("OES_element_index_uint");const n=i.UNSIGNED_INT,a=e-t,s=4*t;i.drawElements(i.TRIANGLES,a,n,s)}drawElementsInstanced(t,e,i){const n=this.gl_;this.getExtension("OES_element_index_uint");const a=this.getInstancedRenderingExtension_(),s=n.UNSIGNED_INT,r=e-t,o=4*t;a.drawElementsInstancedANGLE(n.TRIANGLES,r,s,o,i);for(let t=0;t<this.maxAttributeCount_;t++)a.vertexAttribDivisorANGLE(t,0)}finalizeDraw(t,e,i){for(let n=0,a=this.postProcessPasses_.length;n<a;n++)n===a-1?this.postProcessPasses_[n].apply(t,null,e,i):this.postProcessPasses_[n].apply(t,this.postProcessPasses_[n+1])}getCanvas(){return this.gl_.canvas}getGL(){return this.gl_}applyFrameState(t){const e=t.size,i=t.viewState.rotation,n=t.pixelRatio;this.setUniformFloatValue("u_time",.001*(Date.now()-this.startTime_)),this.setUniformFloatValue("u_zoom",t.viewState.zoom),this.setUniformFloatValue("u_resolution",t.viewState.resolution),this.setUniformFloatValue(Ly,n),this.setUniformFloatVec2("u_viewportSizePx",[e[0],e[1]]),this.setUniformFloatValue("u_rotation",i)}applyHitDetectionUniform(t){const e=this.getUniformLocation("u_hitDetection");this.getGL().uniform1i(e,t?1:0),t&&this.setUniformFloatValue(Ly,.5)}applyUniforms(t){const e=this.gl_;let i,n=0;this.uniforms_.forEach(a=>{if(i="function"==typeof a.value?a.value(t):a.value,i instanceof HTMLCanvasElement||i instanceof HTMLImageElement||i instanceof ImageData||i instanceof WebGLTexture){i instanceof WebGLTexture&&!a.texture?(a.prevValue=void 0,a.texture=i):a.texture||(a.prevValue=void 0,a.texture=e.createTexture()),this.bindTexture(a.texture,n,a.name),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);const t=!(i instanceof HTMLImageElement)||i.complete;i instanceof WebGLTexture||!t||a.prevValue===i||(a.prevValue=i,e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,i)),n++}else if(Array.isArray(i)&&6===i.length)this.setUniformMatrixValue(a.name,gy(this.tmpMat4_,i));else if(Array.isArray(i)&&i.length<=4)switch(i.length){case 2:return void e.uniform2f(this.getUniformLocation(a.name),i[0],i[1]);case 3:return void e.uniform3f(this.getUniformLocation(a.name),i[0],i[1],i[2]);case 4:return void e.uniform4f(this.getUniformLocation(a.name),i[0],i[1],i[2],i[3]);default:return}else"number"==typeof i&&e.uniform1f(this.getUniformLocation(a.name),i)})}useProgram(t,e){this.disableAllAttributes_(),this.gl_.useProgram(t),this.currentProgram_=t,e&&(this.applyFrameState(e),this.applyUniforms(e))}compileShader(t,e){const i=this.gl_,n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}getProgram(t,e){const i=this.gl_,n=this.compileShader(t,i.FRAGMENT_SHADER),a=this.compileShader(e,i.VERTEX_SHADER),s=i.createProgram();if(i.attachShader(s,n),i.attachShader(s,a),i.linkProgram(s),!i.getShaderParameter(n,i.COMPILE_STATUS)){const t=`Fragment shader compilation failed: ${i.getShaderInfoLog(n)}`;throw new Error(t)}if(i.deleteShader(n),!i.getShaderParameter(a,i.COMPILE_STATUS)){const t=`Vertex shader compilation failed: ${i.getShaderInfoLog(a)}`;throw new Error(t)}if(i.deleteShader(a),!i.getProgramParameter(s,i.LINK_STATUS)){const t=`GL program linking failed: ${i.getProgramInfoLog(s)}`;throw new Error(t)}return s}getUniformLocation(t){const e=N(this.currentProgram_);return void 0===this.uniformLocationsByProgram_[e]&&(this.uniformLocationsByProgram_[e]={}),void 0===this.uniformLocationsByProgram_[e][t]&&(this.uniformLocationsByProgram_[e][t]=this.gl_.getUniformLocation(this.currentProgram_,t)),this.uniformLocationsByProgram_[e][t]}getAttributeLocation(t){const e=N(this.currentProgram_);return void 0===this.attribLocationsByProgram_[e]&&(this.attribLocationsByProgram_[e]={}),void 0===this.attribLocationsByProgram_[e][t]&&(this.attribLocationsByProgram_[e][t]=this.gl_.getAttribLocation(this.currentProgram_,t)),this.attribLocationsByProgram_[e][t]}makeProjectionTransform(t,e){const i=t.size,n=t.viewState.rotation,a=t.viewState.resolution,s=t.viewState.center;return wi(e,0,0,2/(a*i[0]),2/(a*i[1]),-n,-s[0],-s[1]),e}setUniformFloatValue(t,e){this.gl_.uniform1f(this.getUniformLocation(t),e)}setUniformFloatVec2(t,e){this.gl_.uniform2fv(this.getUniformLocation(t),e)}setUniformFloatVec4(t,e){this.gl_.uniform4fv(this.getUniformLocation(t),e)}setUniformMatrixValue(t,e){this.gl_.uniformMatrix4fv(this.getUniformLocation(t),!1,e)}disableAllAttributes_(){for(let t=0;t<this.maxAttributeCount_;t++)this.gl_.disableVertexAttribArray(t)}enableAttributeArray_(t,e,i,n,a,s){const r=this.getAttributeLocation(t);r<0||(this.gl_.enableVertexAttribArray(r),this.gl_.vertexAttribPointer(r,e,i,!1,n,a),s&&this.getInstancedRenderingExtension_().vertexAttribDivisorANGLE(r,1))}enableAttributes_(t,e){const i=function(t){let e=0;for(let i=0;i<t.length;i++){const n=t[i];e+=n.size*Ay(n.type)}return e}(t);let n=0;for(let a=0;a<t.length;a++){const s=t[a];s.name&&this.enableAttributeArray_(s.name,s.size,s.type||5126,i,n,e),n+=s.size*Ay(s.type)}}enableAttributes(t){this.enableAttributes_(t,!1)}enableAttributesInstanced(t){this.enableAttributes_(t,!0)}handleWebGLContextLost(t){T(this.bufferCache_),this.currentProgram_=null,t.preventDefault()}handleWebGLContextRestored(){this.needsToBeRecreated_=!0}needsToBeRecreated(){return this.needsToBeRecreated_}createTexture(t,e,i,n){const a=this.gl_;i=i||a.createTexture();const s=n?a.NEAREST:a.LINEAR;a.bindTexture(a.TEXTURE_2D,i),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,s),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,s),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);const r=a.RGBA,o=a.RGBA,l=a.UNSIGNED_BYTE;return e instanceof Uint8Array?a.texImage2D(a.TEXTURE_2D,0,r,t[0],t[1],0,o,l,e):e?a.texImage2D(a.TEXTURE_2D,0,r,o,l,e):a.texImage2D(a.TEXTURE_2D,0,r,t[0],t[1],0,o,l,null),i}},Oy=class extends L{constructor(t){super(),this.tile,this.handleTileChange_=this.handleTileChange_.bind(this),this.gutter=t.gutter||0,this.helper=t.helper,this.loaded=!1,this.ready=!1}setTile(t){if(t!==this.tile)if(this.tile&&this.tile.removeEventListener(o,this.handleTileChange_),this.tile=t,this.loaded=2===t.getState(),this.loaded)this.uploadTile();else{if(t instanceof $m){const e=t.getImage();e instanceof Image&&!e.crossOrigin&&(e.crossOrigin="anonymous")}t.addEventListener(o,this.handleTileChange_)}}uploadTile(){O()}setReady(){this.ready=!0,this.dispatchEvent(o)}handleTileChange_(){2===this.tile.getState()&&(this.loaded=!0,this.uploadTile())}setHelper(t){this.helper=t,this.helper&&this.loaded&&this.uploadTile()}disposeInternal(){this.setHelper(null),this.tile.removeEventListener(o,this.handleTileChange_)}};function Fy(t,e,i){const n=i?t.LINEAR:t.NEAREST;t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,n)}function Ny(t,e,i,n,a,s){const r=t.getGL();let o,l;i instanceof Float32Array?(o=r.FLOAT,t.getExtension("OES_texture_float"),l=null!==t.getExtension("OES_texture_float_linear")):(o=r.UNSIGNED_BYTE,l=!0),Fy(r,e,s&&l);const u=i.byteLength/n[1];let h,c=1;switch(u%8==0?c=8:u%4==0?c=4:u%2==0&&(c=2),a){case 1:h=r.LUMINANCE;break;case 2:h=r.LUMINANCE_ALPHA;break;case 3:h=r.RGB;break;case 4:h=r.RGBA;break;default:throw new Error(`Unsupported number of bands: ${a}`)}const d=r.getParameter(r.UNPACK_ALIGNMENT);r.pixelStorei(r.UNPACK_ALIGNMENT,c),r.texImage2D(r.TEXTURE_2D,0,h,n[0],n[1],0,h,o,i),r.pixelStorei(r.UNPACK_ALIGNMENT,d)}let Gy=null;const Dy=class extends Oy{constructor(t){super(t),this.textures=[],this.renderSize_=Mr(t.grid.getTileSize(t.tile.tileCoord[0])),this.bandCount=NaN;const e=new My(ky,xy);e.fromArray([0,1,1,1,1,0,0,0]),this.helper.flushBufferData(e),this.coords=e,this.setTile(t.tile)}setHelper(t){const e=this.helper?.getGL();if(e){this.helper.deleteBuffer(this.coords);for(let t=0;t<this.textures.length;++t)e.deleteTexture(this.textures[t])}super.setHelper(t),t&&t.flushBufferData(this.coords)}uploadTile(){const t=this.helper,e=t.getGL(),i=this.tile;let n;this.textures.length=0,n=i instanceof $m||i instanceof sf?i.getImage():i.getData();const a=Hm(n);if(a){const t=e.createTexture();return this.textures.push(t),this.bandCount=4,function(t,e,i,n){Fy(t,e,n),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i)}(e,t,a,i.interpolate),void this.setReady()}n=Um(n);const s=i.getSize(),r=[s[0]+2*this.gutter,s[1]+2*this.gutter],o=n instanceof Float32Array,l=r[0]*r[1],u=o?Float32Array:Uint8Array,h=u.BYTES_PER_ELEMENT,c=n.byteLength/r[1];this.bandCount=Math.floor(c/h/r[0]);const d=Math.ceil(this.bandCount/4);if(1===d){const a=e.createTexture();return this.textures.push(a),Ny(t,a,n,r,this.bandCount,i.interpolate),void this.setReady()}const p=new Array(d);for(let t=0;t<d;++t){const i=e.createTexture();this.textures.push(i);const n=t<d-1?4:(this.bandCount-1)%4+1;p[t]=new u(l*n)}let m=0,f=0;const g=r[0]*this.bandCount;for(let t=0;t<r[1];++t){for(let t=0;t<g;++t){const e=n[f+t],i=Math.floor(m/this.bandCount),a=t%this.bandCount,s=p[Math.floor(a/4)];s[i*(s.length/l)+a%4]=e,++m}f+=c/h}for(let e=0;e<d;++e){const n=this.textures[e],a=p[e];Ny(t,n,a,r,a.length/l,i.interpolate)}this.setReady()}getImagePixelData_(t,e,i){const n=this.gutter,a=this.renderSize_[0],s=this.renderSize_[1];Gy||(Gy=Ta(1,1,void 0,{willReadFrequently:!0})),Gy.clearRect(0,0,1,1);const r=t.width-2*n,o=t.height-2*n,l=n+Math.floor(r*(e/a)),u=n+Math.floor(o*(i/s));let h;try{Gy.drawImage(t,l,u,1,1,0,0,1,1),h=Gy.getImageData(0,0,1,1).data}catch{return Gy=null,null}return h}getArrayPixelData_(t,e,i,n){const a=this.gutter,s=this.renderSize_[0],r=this.renderSize_[1],o=e[0],l=e[1],u=o+2*a,h=l+2*a,c=a+Math.floor(o*(i/s)),d=a+Math.floor(l*(n/r));if(t instanceof DataView){const e=t.byteLength/(u*h),i=e*(d*u+c),n=t.buffer.slice(i,i+e);return new DataView(n)}const p=this.bandCount*(d*u+c);return t.slice(p,p+this.bandCount)}getPixelData(t,e){if(!this.loaded)return null;if(this.tile instanceof zm){const i=this.tile.getData(),n=Um(i);if(n){const i=this.tile.getSize();return this.getArrayPixelData_(n,i,t,e)}return this.getImagePixelData_(Hm(i),t,e)}return this.getImagePixelData_(this.tile.getImage(),t,e)}};class Wy extends pf{constructor(t,e){super(t),e=e||{},this.inversePixelTransform_=[1,0,0,1,0,0],this.postProcesses_=e.postProcesses,this.uniforms_=e.uniforms,this.helper,this.onMapChanged_=()=>{this.clearCache(),this.removeHelper()},t.addChangeListener(Es,this.onMapChanged_),this.dispatchPreComposeEvent=this.dispatchPreComposeEvent.bind(this),this.dispatchPostComposeEvent=this.dispatchPostComposeEvent.bind(this)}dispatchPreComposeEvent(t,e){const i=this.getLayer();if(i.hasListener(js)){const n=new fu(js,void 0,e,t);i.dispatchEvent(n)}}dispatchPostComposeEvent(t,e){const i=this.getLayer();if(i.hasListener(Os)){const n=new fu(Os,void 0,e,t);i.dispatchEvent(n)}}reset(t){this.uniforms_=t.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}removeHelper(){this.helper&&(this.helper.dispose(),delete this.helper)}prepareFrame(t){if(this.getLayer().getRenderSource()){let e,i=!0,n=-1;for(let a=0,s=t.layerStatesArray.length;a<s;a++){const s=t.layerStatesArray[a].layer,r=s.getRenderer();if(!(r instanceof Wy)){i=!0;continue}const o=s.getClassName();if((i||o!==e)&&(n+=1,i=!1),e=o,r===this)break}const a="map/"+t.mapId+"/group/"+n;this.helper&&this.helper.canvasCacheKeyMatches(a)&&!this.helper.needsToBeRecreated()||(this.removeHelper(),this.helper=new jy({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:a}),e&&(this.helper.getCanvas().className=e),this.afterHelperCreated())}return this.prepareFrameInternal(t)}afterHelperCreated(){}prepareFrameInternal(t){return!0}clearCache(){}disposeInternal(){this.clearCache(),this.removeHelper(),this.getLayer()?.removeChangeListener(Es,this.onMapChanged_),super.disposeInternal()}dispatchRenderEvent_(t,e,i){const n=this.getLayer();if(n.hasListener(t)){wi(this.inversePixelTransform_,0,0,i.pixelRatio,-i.pixelRatio,0,0,-i.size[1]);const a=new fu(t,this.inversePixelTransform_,i,e);n.dispatchEvent(a)}}preRender(t,e){this.dispatchRenderEvent_(Ps,t,e)}postRender(t,e){this.dispatchRenderEvent_(As,t,e)}}const Hy=Wy;function Uy(t){return 1/(t+2)}function By(t,e){return t.tileIds.has(N(e))}function Vy(t,e,i){const n=t.representationsByZ;i in n||(n[i]=new Set),n[i].add(e),t.tileIds.add(N(e.tile))}function Ky(t,e){const i=t.layerStatesArray[t.layerIndex];i.extent&&(e=yt(e,ci(i.extent,t.viewState.projection)));const n=i.layer.getRenderSource();if(!n.getWrapX()){const i=n.getTileGridForProjection(t.viewState.projection).getExtent();i&&(e=yt(e,i))}return e}function zy(t,e){return`${N(t)},${t.getKey()},${t.getRevision()},${uf(e)}`}const $y=class extends Hy{constructor(t,e){super(t,{uniforms:e.uniforms,postProcesses:e.postProcesses}),this.renderComplete=!1,this.tileTransform_=[1,0,0,1,0,0],this.tempMat4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.tempTileRange_=new qm(0,0,0,0),this.tempTileCoord_=of(0,0,0),this.tempSize_=[0,0];const i=void 0!==e.cacheSize?e.cacheSize:512;this.tileRepresentationCache=new rf(i),this.frameState=null,this.renderedProjection_=void 0}reset(t){super.reset({uniforms:t.uniforms})}prepareFrameInternal(t){this.renderedProjection_?t.viewState.projection!==this.renderedProjection_&&(this.clearCache(),this.renderedProjection_=t.viewState.projection):this.renderedProjection_=t.viewState.projection;const e=this.getLayer().getRenderSource();return!!e&&!bt(Ky(t,t.extent))&&"ready"===e.getState()}createTileRepresentation(t){return O()}enqueueTiles(t,e,i,n,a){const s=t.viewState,r=this.getLayer(),o=r.getRenderSource(),l=o.getTileGridForProjection(s.projection),u=o.getGutterForProjection(s.projection),h=N(o);h in t.wantedTiles||(t.wantedTiles[h]={});const c=t.wantedTiles[h],d=this.tileRepresentationCache,p=r.getMapInternal(),m=Math.max(i-a,l.getMinZoom(),l.getZForResolution(Math.min(r.getMaxResolution(),p?p.getView().getResolutionForZoom(Math.max(r.getMinZoom(),0)):l.getResolution(0)),o.zDirection)),f=s.rotation,g=f?gt(s.center,s.resolution,f,t.size):void 0;for(let a=i;a>=m;--a){const i=l.getTileRangeForExtentAndZ(e,a,this.tempTileRange_),r=l.getResolution(a);for(let e=i.minX;e<=i.maxX;++e)for(let p=i.minY;p<=i.maxY;++p){if(f&&!l.tileCoordIntersectsViewport([a,e,p],g))continue;const i=of(a,e,p,this.tempTileCoord_),m=zy(o,i);let _,y;if(d.containsKey(m)&&(_=d.get(m),y=_.tile),!(_&&_.tile.key===o.getKey()||(y=o.getTile(a,e,p,t.pixelRatio,s.projection),y)))continue;if(By(n,y))continue;_?_.setTile(y):(_=this.createTileRepresentation({tile:y,grid:l,helper:this.helper,gutter:u}),d.set(m,_)),Vy(n,_,a);const k=y.getKey();c[k]=!0,0===y.getState()&&(t.tileQueue.isKeyQueued(k)||t.tileQueue.enqueue([y,h,l.getTileCoordCenter(i),r]))}}}beforeTilesRender(t,e){this.helper.prepareDraw(this.frameState,!e,!0)}beforeTilesMaskRender(t){return!1}renderTile(t,e,i,n,a,s,r,o,l,u,h){}renderTileMask(t,e,i,n){}drawTile_(t,e,i,n,a,s,r){if(!e.ready)return;const o=e.tile.tileCoord,l=uf(o),u=l in s?s[l]:1,h=r.getResolution(i),c=Mr(r.getTileSize(i),this.tempSize_),d=r.getOrigin(i),p=r.getTileCoordExtent(o),m=u<1?-1:Uy(i);u<1&&(t.animate=!0);const f=t.viewState,g=f.center[0],_=f.center[1],y=c[0]+2*n,k=c[1]+2*n,v=y/k,x=(g-d[0])/(c[0]*h),w=(d[1]-_)/(c[1]*h),b=f.resolution/h,E=o[1],M=o[2];!function(t){ki(t,1,0,0,1,0,0)}(this.tileTransform_),xi(this.tileTransform_,2/(t.size[0]*b/y),-2/(t.size[1]*b/y)),function(t,e){const i=Math.cos(e),n=Math.sin(e);yi(t,ki(_i,i,n,-n,i,0,0))}(this.tileTransform_,f.rotation),xi(this.tileTransform_,1,1/v),function(t,e,i){yi(t,ki(_i,1,0,0,1,e,i))}(this.tileTransform_,(c[0]*(E-x)-n)/y,(c[1]*(M-w)-n)/k),this.renderTile(e,this.tileTransform_,t,a,h,c,d,p,m,n,u)}renderFrame(t){this.frameState=t,this.renderComplete=!0;const e=this.helper.getGL();this.preRender(e,t);const i=t.viewState,n=this.getLayer(),a=n.getRenderSource(),s=a.getTileGridForProjection(i.projection),r=a.getGutterForProjection(i.projection),o=Ky(t,t.extent),l=s.getZForResolution(i.resolution,a.zDirection),u={tileIds:new Set,representationsByZ:{}},h=n.getPreload();if(t.nextExtent){const e=s.getZForResolution(i.nextResolution,a.zDirection),n=Ky(t,t.nextExtent);this.enqueueTiles(t,n,e,u,h)}this.enqueueTiles(t,o,l,u,0),h>0&&setTimeout(()=>{this.enqueueTiles(t,o,l-1,u,h-1)},0);const c={};let d=!1;const p=u.representationsByZ;if(l in p){const e=N(this),i=t.time;for(const t of p[l]){const n=t.tile;if(4===n.getState())continue;const a=n.tileCoord;if(t.ready){const t=n.getAlpha(e,i);if(1===t){n.endTransition(e);continue}d=!0,c[uf(a)]=t}if(this.renderComplete=!1,this.findAltTiles_(s,a,l+1,u))continue;const r=s.getMinZoom();for(let t=l-1;t>=r&&!this.findAltTiles_(s,a,t,u);--t);}}const m=Object.keys(p).map(Number).sort(g);if(this.beforeTilesMaskRender(t))for(let t=0,e=m.length;t<e;++t){const e=m[t];for(const t of p[e]){const i=t.tile.tileCoord;if(uf(i)in c)continue;const n=s.getTileCoordExtent(i);this.renderTileMask(t,e,n,Uy(e))}}this.beforeTilesRender(t,d);for(let e=0,i=m.length;e<i;++e){const i=m[e];for(const e of p[i])uf(e.tile.tileCoord)in c||this.drawTile_(t,e,i,r,o,c,s)}if(l in p)for(const e of p[l])uf(e.tile.tileCoord)in c&&this.drawTile_(t,e,l,r,o,c,s);this.beforeFinalize(t),this.helper.finalizeDraw(t,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);const f=this.helper.getCanvas();return this.tileRepresentationCache.expireCache(),this.postRender(e,t),f}beforeFinalize(t){}findAltTiles_(t,e,i,n){const a=t.getTileRangeForTileCoordAndZ(e,i,this.tempTileRange_);if(!a)return!1;let s=!0;const r=this.tileRepresentationCache,o=this.getLayer().getRenderSource();for(let t=a.minX;t<=a.maxX;++t)for(let e=a.minY;e<=a.maxY;++e){const a=zy(o,[i,t,e]);let l=!1;if(r.containsKey(a)){const t=r.get(a);t.ready&&!By(n,t.tile)&&(Vy(n,t,i),l=!0)}l||(s=!1)}return s}clearCache(){super.clearCache();const t=this.tileRepresentationCache;t.forEach(t=>t.dispose()),t.clear()}afterHelperCreated(){super.afterHelperCreated(),this.tileRepresentationCache.forEach(t=>t.setHelper(this.helper))}disposeInternal(){super.disposeInternal(),delete this.frameState}},Yy="u_tileTransform",Xy="u_transitionAlpha",qy="u_depth",Zy="u_renderExtent",Jy="u_resolution",Qy="u_zoom",tk="u_tileTextures",ek="u_texturePixelWidth",ik="u_texturePixelHeight",nk="u_textureResolution",ak="u_textureOriginX",sk="u_textureOriginY",rk="a_textureCoord",ok=[{name:rk,size:2,type:5126}],lk=class extends $y{constructor(t,e){super(t,e),this.program_,this.vertexShader_=e.vertexShader,this.fragmentShader_=e.fragmentShader,this.indices_=new My(vy,xy),this.indices_.fromArray([0,1,3,1,2,3]),this.paletteTextures_=e.paletteTextures||[]}reset(t){if(super.reset(t),this.helper){const t=this.helper.getGL();for(const e of this.paletteTextures_)e.delete(t)}if(this.vertexShader_=t.vertexShader,this.fragmentShader_=t.fragmentShader,this.paletteTextures_=t.paletteTextures||[],this.helper){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_);const t=this.helper.getGL();for(const e of this.paletteTextures_)e.getTexture(t)}}afterHelperCreated(){super.afterHelperCreated();const t=this.helper.getGL();for(const e of this.paletteTextures_)e.getTexture(t);this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.helper.flushBufferData(this.indices_)}removeHelper(){if(this.helper){const t=this.helper.getGL();for(const e of this.paletteTextures_)e.delete(t)}super.removeHelper()}createTileRepresentation(t){return new Dy(t)}beforeTilesRender(t,e){super.beforeTilesRender(t,e),this.helper.useProgram(this.program_,t)}renderTile(t,e,i,n,a,s,r,o,l,u,h){const c=this.helper.getGL();this.helper.bindBuffer(t.coords),this.helper.bindBuffer(this.indices_),this.helper.enableAttributes(ok);let d=0;for(;d<t.textures.length;){const e=`${tk}[${d}]`;this.helper.bindTexture(t.textures[d],d,e),++d}for(let t=0;t<this.paletteTextures_.length;++t){const e=this.paletteTextures_[t],i=e.getTexture(c);this.helper.bindTexture(i,d,e.name),++d}const p=i.viewState,m=s[0]+2*u,f=s[1]+2*u,g=t.tile.tileCoord,_=g[1],y=g[2];this.helper.setUniformMatrixValue(Yy,gy(this.tempMat4,e)),this.helper.setUniformFloatValue(Xy,h),this.helper.setUniformFloatValue(qy,l);let k=n;u>0&&(k=o,yt(k,n,k)),this.helper.setUniformFloatVec4(Zy,k),this.helper.setUniformFloatValue(Jy,p.resolution),this.helper.setUniformFloatValue(Qy,p.zoom),this.helper.setUniformFloatValue(ek,m),this.helper.setUniformFloatValue(ik,f),this.helper.setUniformFloatValue(nk,a),this.helper.setUniformFloatValue(ak,r[0]+_*s[0]*a-u*a),this.helper.setUniformFloatValue(sk,r[1]-y*s[1]*a+u*a),this.helper.drawElements(0,this.indices_.getSize())}getData(t){if(!this.helper.getGL())return null;const e=this.frameState;if(!e)return null;const i=this.getLayer(),n=vi(e.pixelToCoordinateTransform,t.slice()),a=e.viewState,s=i.getExtent();if(s&&!q(ci(s,a.projection),n))return null;const r=i.getSources(z([n]),a.resolution);let o,l,u;for(o=r.length-1;o>=0;--o)if(l=r[o],"ready"===l.getState()){if(u=l.getTileGridForProjection(a.projection),l.getWrapX())break;const t=u.getExtent();if(!t||q(t,n))break}if(o<0)return null;const h=this.tileRepresentationCache;for(let t=u.getZForResolution(a.resolution);t>=u.getMinZoom();--t){const e=u.getTileCoordForCoordAndZ(n,t),i=zy(l,e);if(!h.containsKey(i))continue;const a=h.get(i);if(4===a.tile.getState())return null;if(!a.loaded)continue;const s=u.getOrigin(t),r=Mr(u.getTileSize(t)),o=u.getResolution(t),c=(n[0]-s[0])/o-e[1]*r[0],d=(s[1]-n[1])/o-e[2]*r[1];return a.getPixelData(c,d)}return null}disposeInternal(){const t=this.helper;if(t){const e=t.getGL();for(const t of this.paletteTextures_)t.delete(e);this.paletteTextures_.length=0,e.deleteProgram(this.program_),delete this.program_,t.deleteBuffer(this.indices_)}super.disposeInternal(),delete this.indices_}},uk=class{constructor(t,e){this.name=t,this.data=e,this.texture_=null}getTexture(t){if(!this.texture_){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.data.length/4,1,0,t.RGBA,t.UNSIGNED_BYTE,this.data),this.texture_=e}return this.texture_}delete(t){this.texture_&&t.deleteTexture(this.texture_),this.texture_=null}};function hk(t){const e=t.toString();return e.includes(".")?e:e+".0"}function ck(t){if(t.length<2||t.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return`vec${t.length}(${t.map(hk).join(", ")})`}const dk={};let pk=0;function mk(t){return t in dk||(dk[t]=pk++),dk[t]}function fk(t){return"u_var_"+t}const gk="getBandValue",_k="u_paletteTextures";function yk(t){return(e,i,n)=>{const a=i.args.length,s=new Array(a);for(let t=0;t<a;++t)s[t]=vk(i.args[t],n,e);return t(s,e)}}const kk={[Br]:(t,e)=>{const i=e.args[0].value;i in t.properties||(t.properties[i]={name:i,type:e.type});let n="a_prop_"+i;return Gr(e.type,Sr)&&(n=`(${n} > 0.0)`),n},[Po]:t=>(t.featureId=!0,"a_featureId"),[zr]:t=>(t.geometryType=!0,"a_geometryType"),[$r]:()=>"currentLineMetric",[Vr]:(t,e)=>{const i=e.args[0].value;i in t.variables||(t.variables[i]={name:i,type:e.type});let n=fk(i);return Gr(e.type,Sr)&&(n=`(${n} > 0.0)`),n},[Fo]:(t,e)=>{const i=e.args[0].value;return i in t.properties||(t.properties[i]={name:i,type:e.type}),`(a_prop_${i} != ${hk(-9999999)})`},[Zr]:()=>"u_resolution",[Jr]:()=>"u_zoom",[Qr]:()=>"u_time",[Yr]:yk(t=>`(${t.join(" || ")})`),[Xr]:yk(t=>`(${t.join(" && ")})`),[qr]:yk(([t])=>`(!${t})`),[to]:yk(([t,e])=>`(${t} == ${e})`),[eo]:yk(([t,e])=>`(${t} != ${e})`),[io]:yk(([t,e])=>`(${t} > ${e})`),[no]:yk(([t,e])=>`(${t} >= ${e})`),[ao]:yk(([t,e])=>`(${t} < ${e})`),[so]:yk(([t,e])=>`(${t} <= ${e})`),[ro]:yk(t=>`(${t.join(" * ")})`),[oo]:yk(([t,e])=>`(${t} / ${e})`),[lo]:yk(t=>`(${t.join(" + ")})`),[uo]:yk(([t,e])=>`(${t} - ${e})`),[ho]:yk(([t,e,i])=>`clamp(${t}, ${e}, ${i})`),[co]:yk(([t,e])=>`mod(${t}, ${e})`),[po]:yk(([t,e])=>`pow(${t}, ${e})`),[mo]:yk(([t])=>`abs(${t})`),[fo]:yk(([t])=>`floor(${t})`),[go]:yk(([t])=>`ceil(${t})`),[_o]:yk(([t])=>`floor(${t} + 0.5)`),[yo]:yk(([t])=>`sin(${t})`),[ko]:yk(([t])=>`cos(${t})`),[vo]:yk(([t,e])=>void 0!==e?`atan(${t}, ${e})`:`atan(${t})`),[xo]:yk(([t])=>`sqrt(${t})`),[wo]:yk(t=>{const e=t[0],i=t[t.length-1];let n=null;for(let a=t.length-3;a>=1;a-=2)n=`(${e} == ${t[a]} ? ${t[a+1]} : ${n||i})`;return n}),[bo]:yk(([t,e,i])=>`(${t} >= ${e} && ${t} <= ${i})`),[Eo]:yk(([t,e,...i])=>{let n="";for(let a=0;a<i.length-2;a+=2){const s=i[a],r=n||i[a+1],o=i[a+2],l=i[a+3];let u;u=t===hk(1)?`(${e} - ${s}) / (${o} - ${s})`:`(pow(${t}, (${e} - ${s})) - 1.0) / (pow(${t}, (${o} - ${s})) - 1.0)`,n=`mix(${r}, ${l}, clamp(${u}, 0.0, 1.0))`}return n}),[To]:yk(t=>{const e=t[t.length-1];let i=null;for(let n=t.length-3;n>=0;n-=2)i=`(${t[n]} ? ${t[n+1]} : ${i||e})`;return i}),[So]:yk(([t,...e],i)=>{const n=function(t,e){return`operator_in_${Object.keys(e.functions).length}`}(0,i),a=[];for(let t=0;t<e.length;t+=1)a.push(`  if (inputValue == ${e[t]}) { return true; }`);return i.functions[n]=`bool ${n}(float inputValue) {\n${a.join("\n")}\n  return false;\n}`,`${n}(${t})`}),[Ro]:yk(t=>`vec${t.length}(${t.join(", ")})`),[Io]:yk(t=>{if(1===t.length)return`vec4(vec3(${t[0]} / 255.0), 1.0)`;if(2===t.length)return`vec4(vec3(${t[0]} / 255.0), ${t[1]})`;const e=t.slice(0,3).map(t=>`${t} / 255.0`);if(3===t.length)return`vec4(${e.join(", ")}, 1.0)`;const i=t[3];return`vec4(${e.join(", ")}, ${i})`}),[Ao]:yk(([t,e,i],n)=>{if(!(gk in n.functions)){let t="";const e=n.bandCount||1;for(let i=0;i<e;i++){const n=Math.floor(i/4);let a=i%4;i===e-1&&1===a&&(a=3),t+=`  if (band == ${i+1}.0) {\n    return texture2D(${tk}[${n}], v_textureCoord + vec2(dx, dy))[${a}];\n  }\n`}n.functions[gk]=`float getBandValue(float band, float xOffset, float yOffset) {\n  float dx = xOffset / ${ek};\n  float dy = yOffset / ${ik};\n${t}\n}`}return`${gk}(${t}, ${e??"0.0"}, ${i??"0.0"})`}),[jo]:(t,e)=>{const[i,...n]=e.args,a=n.length,s=new Uint8Array(4*a);for(let t=0;t<n.length;t++){const e=xr(n[t].value),i=4*t;s[i]=e[0],s[i+1]=e[1],s[i+2]=e[2],s[i+3]=255*e[3]}t.paletteTextures||(t.paletteTextures=[]);const r=`${_k}[${t.paletteTextures.length}]`,o=new uk(r,s);return t.paletteTextures.push(o),`texture2D(${r}, vec2((${vk(i,Cr,t)} + 0.5) / ${a}.0, 0.5))`}};function vk(t,e,i){if(t instanceof Wr){const n=kk[t.operator];if(void 0===n)throw new Error(`No compiler defined for this operator: ${JSON.stringify(t.operator)}`);return n(i,t,e)}if((t.type&Cr)>0)return hk(t.value);if((t.type&Sr)>0)return t.value.toString();if((t.type&Lr)>0)return hk(mk(t.value.toString()));if((t.type&Rr)>0)return function(t){const e=xr(t),i=e.length>3?e[3]:1;return ck([e[0]/255,e[1]/255,e[2]/255,i])}(t.value);if((t.type&Ir)>0)return ck(t.value);if((t.type&Pr)>0)return ck(Mr(t.value));throw new Error(`Unexpected expression ${t.value} (expected type ${Fr(e)})`)}function xk(t,e,i){return function(t,e,i,n){return vk(Ur(t,e,i),e,n)}(e,i,Hr(),t)}function wk(t,e){const i=`\n    attribute vec2 ${rk};\n    uniform mat4 ${Yy};\n    uniform float ${ek};\n    uniform float ${ik};\n    uniform float ${nk};\n    uniform float ${ak};\n    uniform float ${sk};\n    uniform float ${qy};\n\n    varying vec2 v_textureCoord;\n    varying vec2 v_mapCoord;\n\n    void main() {\n      v_textureCoord = ${rk};\n      v_mapCoord = vec2(\n        ${ak} + ${nk} * ${ek} * v_textureCoord[0],\n        ${sk} - ${nk} * ${ik} * v_textureCoord[1]\n      );\n      gl_Position = ${Yy} * vec4(${rk}, ${qy}, 1.0);\n    }\n  `,n={variables:{},properties:{},functions:{},bandCount:0,featureId:!1,geometryType:!1,bandCount:e},a=[];if(void 0!==t.color){const e=xk(n,t.color,Rr);a.push(`color = ${e};`)}if(void 0!==t.contrast){const e=xk(n,t.contrast,Cr);a.push(`color.rgb = clamp((${e} + 1.0) * color.rgb - (${e} / 2.0), vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));`)}if(void 0!==t.exposure){const e=xk(n,t.exposure,Cr);a.push(`color.rgb = clamp((${e} + 1.0) * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));`)}if(void 0!==t.saturation){const e=xk(n,t.saturation,Cr);a.push(`\n      float saturation = ${e} + 1.0;\n      float sr = (1.0 - saturation) * 0.2126;\n      float sg = (1.0 - saturation) * 0.7152;\n      float sb = (1.0 - saturation) * 0.0722;\n      mat3 saturationMatrix = mat3(\n        sr + saturation, sr, sr,\n        sg, sg + saturation, sg,\n        sb, sb, sb + saturation\n      );\n      color.rgb = clamp(saturationMatrix * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));\n    `)}if(void 0!==t.gamma){const e=xk(n,t.gamma,Cr);a.push(`color.rgb = pow(color.rgb, vec3(1.0 / ${e}));`)}if(void 0!==t.brightness){const e=xk(n,t.brightness,Cr);a.push(`color.rgb = clamp(color.rgb + ${e}, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));`)}const s={},r=Object.keys(n.variables).length;if(r>1&&!t.variables)throw new Error(`Missing variables in style (expected ${n.variables})`);for(let e=0;e<r;++e){const i=n.variables[Object.keys(n.variables)[e]];if(!(i.name in t.variables))throw new Error(`Missing '${i.name}' in style variables`);s[fk(i.name)]=function(){let e=t.variables[i.name];return"string"==typeof e&&(e=mk(e)),void 0!==e?e:-9999999}}const o=Object.keys(s).map(function(t){return`uniform float ${t};`}),l=Math.ceil(e/4);o.push(`uniform sampler2D ${tk}[${l}];`),n.paletteTextures&&o.push(`uniform sampler2D ${_k}[${n.paletteTextures.length}];`);const u=Object.keys(n.functions).map(function(t){return n.functions[t]});return{vertexShader:i,fragmentShader:`\n    #ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n    #else\n    precision mediump float;\n    #endif\n\n    varying vec2 v_textureCoord;\n    varying vec2 v_mapCoord;\n    uniform vec4 ${Zy};\n    uniform float ${Xy};\n    uniform float ${ek};\n    uniform float ${ik};\n    uniform float ${Jy};\n    uniform float ${Qy};\n\n    ${o.join("\n")}\n\n    ${u.join("\n")}\n\n    void main() {\n      if (\n        v_mapCoord[0] < ${Zy}[0] ||\n        v_mapCoord[1] < ${Zy}[1] ||\n        v_mapCoord[0] > ${Zy}[2] ||\n        v_mapCoord[1] > ${Zy}[3]\n      ) {\n        discard;\n      }\n\n      vec4 color = texture2D(${tk}[0],  v_textureCoord);\n\n      ${a.join("\n")}\n\n      gl_FragColor = color;\n      gl_FragColor.rgb *= gl_FragColor.a;\n      gl_FragColor *= ${Xy};\n    }`,uniforms:s,paletteTextures:n.paletteTextures}}class bk extends bf{constructor(t){const e=(t=t?Object.assign({},t):{}).style||{};delete t.style,super(t),this.sources_=t.sources,this.renderedSource_=null,this.renderedResolution_=NaN,this.style_=e,this.styleVariables_=this.style_.variables||{},this.handleSourceUpdate_(),this.addChangeListener(bs,this.handleSourceUpdate_)}getSources(t,e){const i=this.getSource();return this.sources_?"function"==typeof this.sources_?this.sources_(t,e):this.sources_:i?[i]:[]}getRenderSource(){return this.renderedSource_||this.getSource()}getSourceState(){const t=this.getRenderSource();return t?t.getState():"undefined"}handleSourceUpdate_(){this.hasRenderer()&&this.getRenderer().clearCache();const t=this.getSource();if(t)if("loading"===t.getState()){const e=()=>{"ready"===t.getState()&&(t.removeEventListener("change",e),this.setStyle(this.style_))};t.addEventListener("change",e)}else this.setStyle(this.style_)}getSourceBandCount_(){const t=Number.MAX_SAFE_INTEGER,e=this.getSources([-t,-t,t,t],t);return e&&e.length&&"bandCount"in e[0]?e[0].bandCount:4}createRenderer(){const t=wk(this.style_,this.getSourceBandCount_());return new lk(this,{vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:t.uniforms,cacheSize:this.getCacheSize(),paletteTextures:t.paletteTextures})}renderSources(t,e){const i=this.getRenderer();let n;for(let a=0,s=e.length;a<s;++a)this.renderedSource_=e[a],i.prepareFrame(t)&&(n=i.renderFrame(t));return n}render(t,e){this.rendered=!0;const i=t.viewState,n=this.getSources(t.extent,i.resolution);let a=!0;for(let t=0,e=n.length;t<e;++t){const e=n[t],i=e.getState();if("loading"==i){const t=()=>{"ready"==e.getState()&&(e.removeEventListener("change",t),this.changed())};e.addEventListener("change",t)}a=a&&"ready"==i}const s=this.renderSources(t,n);if(this.getRenderer().renderComplete&&a)return this.renderedResolution_=i.resolution,s;if(this.renderedResolution_>.5*i.resolution){const e=this.getSources(t.extent,this.renderedResolution_).filter(t=>!n.includes(t));if(e.length>0)return this.renderSources(t,e)}return s}setStyle(t){if(this.styleVariables_=t.variables||{},this.style_=t,this.hasRenderer()){const t=wk(this.style_,this.getSourceBandCount_());this.getRenderer().reset({vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:t.uniforms,paletteTextures:t.paletteTextures}),this.changed()}}updateStyleVariables(t){Object.assign(this.styleVariables_,t),this.changed()}}bk.prototype.dispose;const Ek=bk;var Mk=i(8622);const Tk=new Map;function Sk(t,e){Array.isArray(t)||(t=[t]),t.forEach(t=>Tk.set(t,e))}async function Ck(t){const e=Tk.get(t.Compression);if(!e)throw new Error(`Unknown compression method identifier: ${t.Compression}`);return new(await e())(t)}Sk([void 0,1],()=>i.e(121).then(i.bind(i,5121)).then(t=>t.default)),Sk(5,()=>i.e(764).then(i.bind(i,2764)).then(t=>t.default)),Sk(6,()=>{throw new Error("old style JPEG compression is not supported.")}),Sk(7,()=>i.e(457).then(i.bind(i,6457)).then(t=>t.default)),Sk([8,32946],()=>Promise.all([i.e(148),i.e(424)]).then(i.bind(i,424)).then(t=>t.default)),Sk(32773,()=>i.e(30).then(i.bind(i,1030)).then(t=>t.default)),Sk(34887,()=>Promise.all([i.e(148),i.e(414)]).then(i.bind(i,1414)).then(async t=>(await t.zstd.init(),t)).then(t=>t.default)),Sk(50001,()=>i.e(568).then(i.bind(i,6568)).then(t=>t.default));const Lk="undefined"!=typeof navigator&&navigator.hardwareConcurrency||2,Rk=class{constructor(t=Lk,e){this.workers=null,this._awaitingDecoder=null,this.size=t,this.messageId=0,t&&(this._awaitingDecoder=e?Promise.resolve(e):new Promise(t=>{i.e(651).then(i.bind(i,7651)).then(e=>{t(e.create)})}),this._awaitingDecoder.then(e=>{this._awaitingDecoder=null,this.workers=[];for(let i=0;i<t;i++)this.workers.push({worker:e(),idle:!0})}))}async decode(t,e){return this._awaitingDecoder&&await this._awaitingDecoder,0===this.size?Ck(t).then(i=>i.decode(t,e)):new Promise(i=>{const n=this.workers.find(t=>t.idle)||this.workers[Math.floor(Math.random()*this.size)];n.idle=!1;const a=this.messageId++,s=t=>{t.data.id===a&&(n.idle=!0,i(t.data.decoded),n.worker.removeEventListener("message",s))};n.worker.addEventListener("message",s),n.worker.postMessage({fileDirectory:t,buffer:e,id:a},[e])})}destroy(){this.workers&&(this.workers.forEach(t=>{t.worker.terminate()}),this.workers=null)}};function Ik(t){return(e,...i)=>Ak(t,e,i)}function Pk(t,e){return Ik(Nk(t,e).get)}const{apply:Ak,construct:jk,defineProperty:Ok,get:Fk,getOwnPropertyDescriptor:Nk,getPrototypeOf:Gk,has:Dk,ownKeys:Wk,set:Hk,setPrototypeOf:Uk}=Reflect,{EPSILON:Bk,MAX_SAFE_INTEGER:Vk,isFinite:Kk,isNaN:zk}=Number,{iterator:$k,species:Yk,toStringTag:Xk,for:qk}=Symbol,Zk=Object,{create:Jk,defineProperty:Qk,freeze:tv,is:ev}=Zk,iv=Zk.prototype,nv=(iv.__lookupGetter__&&Ik(iv.__lookupGetter__),Zk.hasOwn||Ik(iv.hasOwnProperty),Array),av=(nv.isArray,nv.prototype),sv=(Ik(av.join),Ik(av.push),Ik(av.toLocaleString),av[$k]),rv=Ik(sv),{abs:ov,trunc:lv}=Math,uv=ArrayBuffer,hv=(uv.isView,uv.prototype),cv=(Ik(hv.slice),Pk(hv,"byteLength"),"undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:null),dv=(cv&&Pk(cv.prototype,"byteLength"),Gk(Uint8Array)),pv=(dv.from,dv.prototype),mv=(pv[$k],Ik(pv.keys),Ik(pv.values),Ik(pv.entries),Ik(pv.set),Ik(pv.reverse),Ik(pv.fill),Ik(pv.copyWithin),Ik(pv.sort),Ik(pv.slice),Ik(pv.subarray),Pk(pv,"buffer"),Pk(pv,"byteOffset"),Pk(pv,"length"),Pk(pv,Xk),Uint8Array),fv=Uint16Array,gv=Uint32Array,_v=Float32Array,yv=Gk([][$k]()),kv=Ik(yv.next),vv=Ik(function*(){}().next),xv=Gk(yv),wv=DataView.prototype,bv=Ik(wv.getUint16),Ev=(Ik(wv.setUint16),TypeError,WeakSet.prototype),Mv=(Ik(Ev.add),Ik(Ev.has),WeakMap),Tv=Mv.prototype,Sv=Ik(Tv.get),Cv=(Ik(Tv.has),Ik(Tv.set)),Lv=new Mv,Rv=Jk(null,{next:{value:function(){const t=Sv(Lv,this);return kv(t)}},[$k]:{value:function(){return this}}}),Iv=new Mv,Pv=Jk(xv,{next:{value:function(){const t=Sv(Iv,this);return vv(t)},writable:!0,configurable:!0}});for(const t of Wk(yv))"next"!==t&&Qk(Pv,t,Nk(yv,t));const Av=new uv(4),jv=new _v(Av),Ov=new gv(Av),Fv=new fv(512),Nv=new mv(512);for(let t=0;t<256;++t){const e=t-127;e<-24?(Fv[t]=0,Fv[256|t]=32768,Nv[t]=24,Nv[256|t]=24):e<-14?(Fv[t]=1024>>-e-14,Fv[256|t]=1024>>-e-14|32768,Nv[t]=-e-1,Nv[256|t]=-e-1):e<=15?(Fv[t]=e+15<<10,Fv[256|t]=e+15<<10|32768,Nv[t]=13,Nv[256|t]=13):e<128?(Fv[t]=31744,Fv[256|t]=64512,Nv[t]=24,Nv[256|t]=24):(Fv[t]=31744,Fv[256|t]=64512,Nv[t]=13,Nv[256|t]=13)}const Gv=new gv(2048);for(let t=1;t<1024;++t){let e=t<<13,i=0;for(;!(8388608&e);)e<<=1,i-=8388608;e&=-8388609,i+=947912704,Gv[t]=e|i}for(let t=1024;t<2048;++t)Gv[t]=939524096+(t-1024<<13);const Dv=new gv(64);for(let t=1;t<31;++t)Dv[t]=t<<23;Dv[31]=1199570944,Dv[32]=2147483648;for(let t=33;t<63;++t)Dv[t]=2147483648+(t-32<<23);Dv[63]=3347054592;const Wv=new fv(64);for(let t=1;t<64;++t)32!==t&&(Wv[t]=1024);function Hv(t,e,...i){return function(t){const e=t>>10;return Ov[0]=Gv[Wv[e]+(1023&t)]+Dv[e],jv[0]}(bv(t,e,...function(t){if(t[$k]===sv&&yv.next===kv)return t;const e=Jk(Rv);return Cv(Lv,e,rv(t)),e}(i)))}var Uv=i(7379),Bv=i(563);function Vv(t,e,i,n=1){return new(Object.getPrototypeOf(t).constructor)(e*i*n)}function Kv(t,e,i){return(1-i)*t+i*e}function zv(t,e,i){let n=0;for(let a=e;a<i;++a)n+=t[a];return n}function $v(t,e,i){switch(t){case 1:if(e<=8)return new Uint8Array(i);if(e<=16)return new Uint16Array(i);if(e<=32)return new Uint32Array(i);break;case 2:if(8===e)return new Int8Array(i);if(16===e)return new Int16Array(i);if(32===e)return new Int32Array(i);break;case 3:switch(e){case 16:case 32:return new Float32Array(i);case 64:return new Float64Array(i)}}throw Error("Unsupported data format/bitsPerSample")}const Yv=class{constructor(t,e,i,n,a,s){this.fileDirectory=t,this.geoKeys=e,this.dataView=i,this.littleEndian=n,this.tiles=a?{}:null,this.isTiled=!t.StripOffsets;const r=t.PlanarConfiguration;if(this.planarConfiguration=void 0===r?1:r,1!==this.planarConfiguration&&2!==this.planarConfiguration)throw new Error("Invalid planar configuration.");this.source=s}getFileDirectory(){return this.fileDirectory}getGeoKeys(){return this.geoKeys}getWidth(){return this.fileDirectory.ImageWidth}getHeight(){return this.fileDirectory.ImageLength}getSamplesPerPixel(){return void 0!==this.fileDirectory.SamplesPerPixel?this.fileDirectory.SamplesPerPixel:1}getTileWidth(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}getTileHeight(){return this.isTiled?this.fileDirectory.TileLength:void 0!==this.fileDirectory.RowsPerStrip?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}getBlockWidth(){return this.getTileWidth()}getBlockHeight(t){return this.isTiled||(t+1)*this.getTileHeight()<=this.getHeight()?this.getTileHeight():this.getHeight()-t*this.getTileHeight()}getBytesPerPixel(){let t=0;for(let e=0;e<this.fileDirectory.BitsPerSample.length;++e)t+=this.getSampleByteSize(e);return t}getSampleByteSize(t){if(t>=this.fileDirectory.BitsPerSample.length)throw new RangeError(`Sample index ${t} is out of range.`);return Math.ceil(this.fileDirectory.BitsPerSample[t]/8)}getReaderForSample(t){const e=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[t]:1,i=this.fileDirectory.BitsPerSample[t];switch(e){case 1:if(i<=8)return DataView.prototype.getUint8;if(i<=16)return DataView.prototype.getUint16;if(i<=32)return DataView.prototype.getUint32;break;case 2:if(i<=8)return DataView.prototype.getInt8;if(i<=16)return DataView.prototype.getInt16;if(i<=32)return DataView.prototype.getInt32;break;case 3:switch(i){case 16:return function(t,e){return Hv(this,t,e)};case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}}throw Error("Unsupported data format/bitsPerSample")}getSampleFormat(t=0){return this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[t]:1}getBitsPerSample(t=0){return this.fileDirectory.BitsPerSample[t]}getArrayForSample(t,e){return $v(this.getSampleFormat(t),this.getBitsPerSample(t),e)}async getTileOrStrip(t,e,i,n,a){const s=Math.ceil(this.getWidth()/this.getTileWidth()),r=Math.ceil(this.getHeight()/this.getTileHeight());let o;const{tiles:l}=this;let u,h;1===this.planarConfiguration?o=e*s+t:2===this.planarConfiguration&&(o=i*s*r+e*s+t),this.isTiled?(u=this.fileDirectory.TileOffsets[o],h=this.fileDirectory.TileByteCounts[o]):(u=this.fileDirectory.StripOffsets[o],h=this.fileDirectory.StripByteCounts[o]);const c=(await this.source.fetch([{offset:u,length:h}],a))[0];let d;return null!==l&&l[o]?d=l[o]:(d=(async()=>{let t=await n.decode(this.fileDirectory,c);const i=this.getSampleFormat(),a=this.getBitsPerSample();return function(t,e){return(1!==t&&2!==t||!(e<=32)||e%8!=0)&&(3!==t||16!==e&&32!==e&&64!==e)}(i,a)&&(t=function(t,e,i,n,a,s,r){const o=new DataView(t),l=2===i?1:n,u=$v(e,a,2===i?r*s:r*s*n),h=parseInt("1".repeat(a),2);if(1===e){let t;t=1===i?n*a:a;let e=s*t;7&e&&(e=e+7&-8);for(let t=0;t<r;++t){const i=t*e;for(let e=0;e<s;++e){const n=i+e*l*a;for(let i=0;i<l;++i){const r=n+i*a,c=(t*s+e)*l+i,d=Math.floor(r/8),p=r%8;if(p+a<=8)u[c]=o.getUint8(d)>>8-a-p&h;else if(p+a<=16)u[c]=o.getUint16(d)>>16-a-p&h;else if(p+a<=24){const t=o.getUint16(d)<<8|o.getUint8(d+2);u[c]=t>>24-a-p&h}else u[c]=o.getUint32(d)>>32-a-p&h}}}}return u.buffer}(t,i,this.planarConfiguration,this.getSamplesPerPixel(),a,this.getTileWidth(),this.getBlockHeight(e))),t})(),null!==l&&(l[o]=d)),{x:t,y:e,sample:i,data:await d}}async _readRaster(t,e,i,n,a,s,r,o,l){const u=this.getTileWidth(),h=this.getTileHeight(),c=this.getWidth(),d=this.getHeight(),p=Math.max(Math.floor(t[0]/u),0),m=Math.min(Math.ceil(t[2]/u),Math.ceil(c/u)),f=Math.max(Math.floor(t[1]/h),0),g=Math.min(Math.ceil(t[3]/h),Math.ceil(d/h)),_=t[2]-t[0];let y=this.getBytesPerPixel();const k=[],v=[];for(let t=0;t<e.length;++t)1===this.planarConfiguration?k.push(zv(this.fileDirectory.BitsPerSample,0,e[t])/8):k.push(0),v.push(this.getReaderForSample(e[t]));const x=[],{littleEndian:w}=this;for(let s=f;s<g;++s)for(let r=p;r<m;++r){let o;1===this.planarConfiguration&&(o=this.getTileOrStrip(r,s,0,a,l));for(let p=0;p<e.length;++p){const m=p,f=e[p];2===this.planarConfiguration&&(y=this.getSampleByteSize(f),o=this.getTileOrStrip(r,s,f,a,l));const g=o.then(a=>{const s=a.data,r=new DataView(s),o=this.getBlockHeight(a.y),l=a.y*h,p=a.x*u,f=l+o,g=(a.x+1)*u,x=v[m],b=Math.min(o,o-(f-t[3]),d-l),E=Math.min(u,u-(g-t[2]),c-p);for(let a=Math.max(0,t[1]-l);a<b;++a)for(let s=Math.max(0,t[0]-p);s<E;++s){const o=(a*u+s)*y,h=x.call(r,o+k[m],w);let c;n?(c=(a+l-t[1])*_*e.length+(s+p-t[0])*e.length+m,i[c]=h):(c=(a+l-t[1])*_+s+p-t[0],i[m][c]=h)}});x.push(g)}}if(await Promise.all(x),s&&t[2]-t[0]!==s||r&&t[3]-t[1]!==r){let a;return a=n?function(t,e,i,n,a,s,r="nearest"){switch(r.toLowerCase()){case"nearest":return function(t,e,i,n,a,s){const r=e/n,o=i/a,l=Vv(t,n,a,s);for(let u=0;u<a;++u){const a=Math.min(Math.round(o*u),i-1);for(let i=0;i<n;++i){const o=Math.min(Math.round(r*i),e-1);for(let r=0;r<s;++r){const h=t[a*e*s+o*s+r];l[u*n*s+i*s+r]=h}}}return l}(t,e,i,n,a,s);case"bilinear":case"linear":return function(t,e,i,n,a,s){const r=e/n,o=i/a,l=Vv(t,n,a,s);for(let u=0;u<a;++u){const a=o*u,h=Math.floor(a),c=Math.min(Math.ceil(a),i-1);for(let i=0;i<n;++i){const o=r*i,d=o%1,p=Math.floor(o),m=Math.min(Math.ceil(o),e-1);for(let r=0;r<s;++r){const o=t[h*e*s+p*s+r],f=t[h*e*s+m*s+r],g=t[c*e*s+p*s+r],_=t[c*e*s+m*s+r],y=Kv(Kv(o,f,d),Kv(g,_,d),a%1);l[u*n*s+i*s+r]=y}}}return l}(t,e,i,n,a,s);default:throw new Error(`Unsupported resampling method: '${r}'`)}}(i,t[2]-t[0],t[3]-t[1],s,r,e.length,o):function(t,e,i,n,a,s="nearest"){switch(s.toLowerCase()){case"nearest":return function(t,e,i,n,a){const s=e/n,r=i/a;return t.map(t=>{const o=Vv(t,n,a);for(let l=0;l<a;++l){const a=Math.min(Math.round(r*l),i-1);for(let i=0;i<n;++i){const r=Math.min(Math.round(s*i),e-1),u=t[a*e+r];o[l*n+i]=u}}return o})}(t,e,i,n,a);case"bilinear":case"linear":return function(t,e,i,n,a){const s=e/n,r=i/a;return t.map(t=>{const o=Vv(t,n,a);for(let l=0;l<a;++l){const a=r*l,u=Math.floor(a),h=Math.min(Math.ceil(a),i-1);for(let i=0;i<n;++i){const r=s*i,c=r%1,d=Math.floor(r),p=Math.min(Math.ceil(r),e-1),m=t[u*e+d],f=t[u*e+p],g=t[h*e+d],_=t[h*e+p],y=Kv(Kv(m,f,c),Kv(g,_,c),a%1);o[l*n+i]=y}}return o})}(t,e,i,n,a);default:throw new Error(`Unsupported resampling method: '${s}'`)}}(i,t[2]-t[0],t[3]-t[1],s,r,o),a.width=s,a.height=r,a}return i.width=s||t[2]-t[0],i.height=r||t[3]-t[1],i}async readRasters({window:t,samples:e=[],interleave:i,pool:n=null,width:a,height:s,resampleMethod:r,fillValue:o,signal:l}={}){const u=t||[0,0,this.getWidth(),this.getHeight()];if(u[0]>u[2]||u[1]>u[3])throw new Error("Invalid subsets");const h=(u[2]-u[0])*(u[3]-u[1]),c=this.getSamplesPerPixel();if(e&&e.length){for(let t=0;t<e.length;++t)if(e[t]>=c)return Promise.reject(new RangeError(`Invalid sample index '${e[t]}'.`))}else for(let t=0;t<c;++t)e.push(t);let d;if(i)d=$v(this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,Math.max.apply(null,this.fileDirectory.BitsPerSample),h*e.length),o&&d.fill(o);else{d=[];for(let t=0;t<e.length;++t){const i=this.getArrayForSample(e[t],h);Array.isArray(o)&&t<o.length?i.fill(o[t]):o&&!Array.isArray(o)&&i.fill(o),d.push(i)}}const p=n||await Ck(this.fileDirectory);return await this._readRaster(u,e,d,i,p,a,s,r,l)}async readRGB({window:t,interleave:e=!0,pool:i=null,width:n,height:a,resampleMethod:s,enableAlpha:r=!1,signal:o}={}){const l=t||[0,0,this.getWidth(),this.getHeight()];if(l[0]>l[2]||l[1]>l[3])throw new Error("Invalid subsets");const u=this.fileDirectory.PhotometricInterpretation;if(u===Mk.ub.RGB){let l=[0,1,2];if(this.fileDirectory.ExtraSamples!==Mk.AC.Unspecified&&r){l=[];for(let t=0;t<this.fileDirectory.BitsPerSample.length;t+=1)l.push(t)}return this.readRasters({window:t,interleave:e,samples:l,pool:i,width:n,height:a,resampleMethod:s,signal:o})}let h;switch(u){case Mk.ub.WhiteIsZero:case Mk.ub.BlackIsZero:case Mk.ub.Palette:h=[0];break;case Mk.ub.CMYK:h=[0,1,2,3];break;case Mk.ub.YCbCr:case Mk.ub.CIELab:h=[0,1,2];break;default:throw new Error("Invalid or unsupported photometric interpretation.")}const c={window:l,interleave:!0,samples:h,pool:i,width:n,height:a,resampleMethod:s,signal:o},{fileDirectory:d}=this,p=await this.readRasters(c),m=2**this.fileDirectory.BitsPerSample[0];let f;switch(u){case Mk.ub.WhiteIsZero:f=function(t,e){const{width:i,height:n}=t,a=new Uint8Array(i*n*3);let s;for(let i=0,n=0;i<t.length;++i,n+=3)s=256-t[i]/e*256,a[n]=s,a[n+1]=s,a[n+2]=s;return a}(p,m);break;case Mk.ub.BlackIsZero:f=function(t,e){const{width:i,height:n}=t,a=new Uint8Array(i*n*3);let s;for(let i=0,n=0;i<t.length;++i,n+=3)s=t[i]/e*256,a[n]=s,a[n+1]=s,a[n+2]=s;return a}(p,m);break;case Mk.ub.Palette:f=function(t,e){const{width:i,height:n}=t,a=new Uint8Array(i*n*3),s=e.length/3,r=e.length/3*2;for(let i=0,n=0;i<t.length;++i,n+=3){const o=t[i];a[n]=e[o]/65536*256,a[n+1]=e[o+s]/65536*256,a[n+2]=e[o+r]/65536*256}return a}(p,d.ColorMap);break;case Mk.ub.CMYK:f=function(t){const{width:e,height:i}=t,n=new Uint8Array(e*i*3);for(let e=0,i=0;e<t.length;e+=4,i+=3){const a=t[e],s=t[e+1],r=t[e+2],o=t[e+3];n[i]=(255-a)/256*255*((255-o)/256),n[i+1]=(255-s)/256*255*((255-o)/256),n[i+2]=(255-r)/256*255*((255-o)/256)}return n}(p);break;case Mk.ub.YCbCr:f=function(t){const{width:e,height:i}=t,n=new Uint8ClampedArray(e*i*3);for(let e=0,i=0;e<t.length;e+=3,i+=3){const a=t[e],s=t[e+1],r=t[e+2];n[i]=a+1.402*(r-128),n[i+1]=a-.34414*(s-128)-.71414*(r-128),n[i+2]=a+1.772*(s-128)}return n}(p);break;case Mk.ub.CIELab:f=function(t){const{width:e,height:i}=t,n=new Uint8Array(e*i*3);for(let e=0,i=0;e<t.length;e+=3,i+=3){let a,s,r,o=(t[e+0]+16)/116,l=(t[e+1]<<24>>24)/500+o,u=o-(t[e+2]<<24>>24)/200;l=.95047*(l*l*l>.008856?l*l*l:(l-16/116)/7.787),o=1*(o*o*o>.008856?o*o*o:(o-16/116)/7.787),u=1.08883*(u*u*u>.008856?u*u*u:(u-16/116)/7.787),a=3.2406*l+-1.5372*o+-.4986*u,s=-.9689*l+1.8758*o+.0415*u,r=.0557*l+-.204*o+1.057*u,a=a>.0031308?1.055*a**(1/2.4)-.055:12.92*a,s=s>.0031308?1.055*s**(1/2.4)-.055:12.92*s,r=r>.0031308?1.055*r**(1/2.4)-.055:12.92*r,n[i]=255*Math.max(0,Math.min(1,a)),n[i+1]=255*Math.max(0,Math.min(1,s)),n[i+2]=255*Math.max(0,Math.min(1,r))}return n}(p);break;default:throw new Error("Unsupported photometric interpretation.")}if(!e){const t=new Uint8Array(f.length/3),e=new Uint8Array(f.length/3),i=new Uint8Array(f.length/3);for(let n=0,a=0;n<f.length;n+=3,++a)t[a]=f[n],e[a]=f[n+1],i[a]=f[n+2];f=[t,e,i]}return f.width=p.width,f.height=p.height,f}getTiePoints(){if(!this.fileDirectory.ModelTiepoint)return[];const t=[];for(let e=0;e<this.fileDirectory.ModelTiepoint.length;e+=6)t.push({i:this.fileDirectory.ModelTiepoint[e],j:this.fileDirectory.ModelTiepoint[e+1],k:this.fileDirectory.ModelTiepoint[e+2],x:this.fileDirectory.ModelTiepoint[e+3],y:this.fileDirectory.ModelTiepoint[e+4],z:this.fileDirectory.ModelTiepoint[e+5]});return t}getGDALMetadata(t=null){const e={};if(!this.fileDirectory.GDAL_METADATA)return null;const i=this.fileDirectory.GDAL_METADATA;let n=Bv(i,"Item");n=null===t?n.filter(t=>void 0===Uv(t,"sample")):n.filter(e=>Number(Uv(e,"sample"))===t);for(let t=0;t<n.length;++t){const i=n[t];e[Uv(i,"name")]=i.inner}return e}getGDALNoData(){if(!this.fileDirectory.GDAL_NODATA)return null;const t=this.fileDirectory.GDAL_NODATA;return Number(t.substring(0,t.length-1))}getOrigin(){const t=this.fileDirectory.ModelTiepoint,e=this.fileDirectory.ModelTransformation;if(t&&6===t.length)return[t[3],t[4],t[5]];if(e)return[e[3],e[7],e[11]];throw new Error("The image does not have an affine transformation.")}getResolution(t=null){const e=this.fileDirectory.ModelPixelScale,i=this.fileDirectory.ModelTransformation;if(e)return[e[0],-e[1],e[2]];if(i)return 0===i[1]&&0===i[4]?[i[0],-i[5],i[10]]:[Math.sqrt(i[0]*i[0]+i[4]*i[4]),-Math.sqrt(i[1]*i[1]+i[5]*i[5]),i[10]];if(t){const[e,i,n]=t.getResolution();return[e*t.getWidth()/this.getWidth(),i*t.getHeight()/this.getHeight(),n*t.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}pixelIsArea(){return 1===this.geoKeys.GTRasterTypeGeoKey}getBoundingBox(t=!1){const e=this.getHeight(),i=this.getWidth();if(this.fileDirectory.ModelTransformation&&!t){const[t,n,a,s,r,o,l,u]=this.fileDirectory.ModelTransformation,h=[[0,0],[0,e],[i,0],[i,e]].map(([e,i])=>[s+t*e+n*i,u+r*e+o*i]),c=h.map(t=>t[0]),d=h.map(t=>t[1]);return[Math.min(...c),Math.min(...d),Math.max(...c),Math.max(...d)]}{const t=this.getOrigin(),n=this.getResolution(),a=t[0],s=t[1],r=a+n[0]*i,o=s+n[1]*e;return[Math.min(a,r),Math.min(s,o),Math.max(a,r),Math.max(s,o)]}}};class Xv{constructor(t){this._dataView=new DataView(t)}get buffer(){return this._dataView.buffer}getUint64(t,e){const i=this.getUint32(t,e),n=this.getUint32(t+4,e);let a;if(e){if(a=i+2**32*n,!Number.isSafeInteger(a))throw new Error(`${a} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return a}if(a=2**32*i+n,!Number.isSafeInteger(a))throw new Error(`${a} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return a}getInt64(t,e){let i=0;const n=(128&this._dataView.getUint8(t+(e?7:0)))>0;let a=!0;for(let s=0;s<8;s++){let r=this._dataView.getUint8(t+(e?s:7-s));n&&(a?0!==r&&(r=255&~(r-1),a=!1):r=255&~r),i+=r*256**s}return n&&(i=-i),i}getUint8(t,e){return this._dataView.getUint8(t,e)}getInt8(t,e){return this._dataView.getInt8(t,e)}getUint16(t,e){return this._dataView.getUint16(t,e)}getInt16(t,e){return this._dataView.getInt16(t,e)}getUint32(t,e){return this._dataView.getUint32(t,e)}getInt32(t,e){return this._dataView.getInt32(t,e)}getFloat16(t,e){return Hv(this._dataView,t,e)}getFloat32(t,e){return this._dataView.getFloat32(t,e)}getFloat64(t,e){return this._dataView.getFloat64(t,e)}}class qv{constructor(t,e,i,n){this._dataView=new DataView(t),this._sliceOffset=e,this._littleEndian=i,this._bigTiff=n}get sliceOffset(){return this._sliceOffset}get sliceTop(){return this._sliceOffset+this.buffer.byteLength}get littleEndian(){return this._littleEndian}get bigTiff(){return this._bigTiff}get buffer(){return this._dataView.buffer}covers(t,e){return this.sliceOffset<=t&&this.sliceTop>=t+e}readUint8(t){return this._dataView.getUint8(t-this._sliceOffset,this._littleEndian)}readInt8(t){return this._dataView.getInt8(t-this._sliceOffset,this._littleEndian)}readUint16(t){return this._dataView.getUint16(t-this._sliceOffset,this._littleEndian)}readInt16(t){return this._dataView.getInt16(t-this._sliceOffset,this._littleEndian)}readUint32(t){return this._dataView.getUint32(t-this._sliceOffset,this._littleEndian)}readInt32(t){return this._dataView.getInt32(t-this._sliceOffset,this._littleEndian)}readFloat32(t){return this._dataView.getFloat32(t-this._sliceOffset,this._littleEndian)}readFloat64(t){return this._dataView.getFloat64(t-this._sliceOffset,this._littleEndian)}readUint64(t){const e=this.readUint32(t),i=this.readUint32(t+4);let n;if(this._littleEndian){if(n=e+2**32*i,!Number.isSafeInteger(n))throw new Error(`${n} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return n}if(n=2**32*e+i,!Number.isSafeInteger(n))throw new Error(`${n} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return n}readInt64(t){let e=0;const i=(128&this._dataView.getUint8(t+(this._littleEndian?7:0)))>0;let n=!0;for(let a=0;a<8;a++){let s=this._dataView.getUint8(t+(this._littleEndian?a:7-a));i&&(n?0!==s&&(s=255&~(s-1),n=!1):s=255&~s),e+=s*256**a}return i&&(e=-e),e}readOffset(t){return this._bigTiff?this.readUint64(t):this.readUint32(t)}}function Zv(t){if(void 0!==Object.fromEntries)return Object.fromEntries(t);const e={};for(const[i,n]of t)e[i.toLowerCase()]=n;return e}function Jv(t){return Zv(t.split("\r\n").map(t=>{const e=t.split(":").map(t=>t.trim());return e[0]=e[0].toLowerCase(),e}))}function Qv(t){let e,i,n;return t&&([,e,i,n]=t.match(/bytes (\d+)-(\d+)\/(\d+)/),e=parseInt(e,10),i=parseInt(i,10),n=parseInt(n,10)),{start:e,end:i,total:n}}class tx{async fetch(t,e=void 0){return Promise.all(t.map(t=>this.fetchSlice(t,e)))}async fetchSlice(t){throw new Error(`fetching of slice ${t} not possible, not implemented`)}get fileSize(){return null}async close(){}}class ex extends Map{constructor(t={}){if(super(),!(t.maxSize&&t.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if("number"==typeof t.maxAge&&0===t.maxAge)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=t.maxSize,this.maxAge=t.maxAge||Number.POSITIVE_INFINITY,this.onEviction=t.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(t){if("function"==typeof this.onEviction)for(const[e,i]of t)this.onEviction(e,i.value)}_deleteIfExpired(t,e){return"number"==typeof e.expiry&&e.expiry<=Date.now()&&("function"==typeof this.onEviction&&this.onEviction(t,e.value),this.delete(t))}_getOrDeleteIfExpired(t,e){if(!1===this._deleteIfExpired(t,e))return e.value}_getItemValue(t,e){return e.expiry?this._getOrDeleteIfExpired(t,e):e.value}_peek(t,e){const i=e.get(t);return this._getItemValue(t,i)}_set(t,e){this.cache.set(t,e),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(t,e){this.oldCache.delete(t),this._set(t,e)}*_entriesAscending(){for(const t of this.oldCache){const[e,i]=t;this.cache.has(e)||!1===this._deleteIfExpired(e,i)&&(yield t)}for(const t of this.cache){const[e,i]=t;!1===this._deleteIfExpired(e,i)&&(yield t)}}get(t){if(this.cache.has(t)){const e=this.cache.get(t);return this._getItemValue(t,e)}if(this.oldCache.has(t)){const e=this.oldCache.get(t);if(!1===this._deleteIfExpired(t,e))return this._moveToRecent(t,e),e.value}}set(t,e,{maxAge:i=this.maxAge}={}){const n="number"==typeof i&&i!==Number.POSITIVE_INFINITY?Date.now()+i:void 0;return this.cache.has(t)?this.cache.set(t,{value:e,expiry:n}):this._set(t,{value:e,expiry:n}),this}has(t){return this.cache.has(t)?!this._deleteIfExpired(t,this.cache.get(t)):!!this.oldCache.has(t)&&!this._deleteIfExpired(t,this.oldCache.get(t))}peek(t){return this.cache.has(t)?this._peek(t,this.cache):this.oldCache.has(t)?this._peek(t,this.oldCache):void 0}delete(t){const e=this.cache.delete(t);return e&&this._size--,this.oldCache.delete(t)||e}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(t){if(!(t&&t>0))throw new TypeError("`maxSize` must be a number greater than 0");const e=[...this._entriesAscending()],i=e.length-t;i<0?(this.cache=new Map(e),this.oldCache=new Map,this._size=e.length):(i>0&&this._emitEvictions(e.slice(0,i)),this.oldCache=new Map(e.slice(i)),this.cache=new Map,this._size=0),this.maxSize=t}*keys(){for(const[t]of this)yield t}*values(){for(const[,t]of this)yield t}*[Symbol.iterator](){for(const t of this.cache){const[e,i]=t;!1===this._deleteIfExpired(e,i)&&(yield[e,i.value])}for(const t of this.oldCache){const[e,i]=t;this.cache.has(e)||!1===this._deleteIfExpired(e,i)&&(yield[e,i.value])}}*entriesDescending(){let t=[...this.cache];for(let e=t.length-1;e>=0;--e){const i=t[e],[n,a]=i;!1===this._deleteIfExpired(n,a)&&(yield[n,a.value])}t=[...this.oldCache];for(let e=t.length-1;e>=0;--e){const i=t[e],[n,a]=i;this.cache.has(n)||!1===this._deleteIfExpired(n,a)&&(yield[n,a.value])}}*entriesAscending(){for(const[t,e]of this._entriesAscending())yield[t,e.value]}get size(){if(!this._size)return this.oldCache.size;let t=0;for(const e of this.oldCache.keys())this.cache.has(e)||t++;return Math.min(this._size+t,this.maxSize)}entries(){return this.entriesAscending()}forEach(t,e=this){for(const[i,n]of this.entriesAscending())t.call(e,n,i,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}class ix extends Error{constructor(t){super(t),Error.captureStackTrace&&Error.captureStackTrace(this,ix),this.name="AbortError"}}class nx extends Error{constructor(t,e){super(e),this.errors=t,this.message=e,this.name="AggregateError"}}const ax=nx;class sx{constructor(t,e,i=null){this.offset=t,this.length=e,this.data=i}get top(){return this.offset+this.length}}class rx{constructor(t,e,i){this.offset=t,this.length=e,this.blockIds=i}}class ox extends tx{constructor(t,{blockSize:e=65536,cacheSize:i=100}={}){super(),this.source=t,this.blockSize=e,this.blockCache=new ex({maxSize:i,onEviction:(t,e)=>{this.evictedBlocks.set(t,e)}}),this.evictedBlocks=new Map,this.blockRequests=new Map,this.blockIdsToFetch=new Set,this.abortedBlockIds=new Set}get fileSize(){return this.source.fileSize}async fetch(t,e){const i=[],n=[],a=[];this.evictedBlocks.clear();for(const{offset:e,length:s}of t){let t=e+s;const{fileSize:r}=this;null!==r&&(t=Math.min(t,r));for(let s=Math.floor(e/this.blockSize)*this.blockSize;s<t;s+=this.blockSize){const t=Math.floor(s/this.blockSize);this.blockCache.has(t)||this.blockRequests.has(t)||(this.blockIdsToFetch.add(t),n.push(t)),this.blockRequests.has(t)&&i.push(this.blockRequests.get(t)),a.push(t)}}await async function(){return new Promise(t=>setTimeout(t,undefined))}(),this.fetchBlocks(e);const s=[];for(const t of n)this.blockRequests.has(t)&&s.push(this.blockRequests.get(t));await Promise.allSettled(i),await Promise.allSettled(s);const r=[],o=a.filter(t=>this.abortedBlockIds.has(t)||!this.blockCache.has(t));if(o.forEach(t=>this.blockIdsToFetch.add(t)),o.length>0&&e&&!e.aborted){this.fetchBlocks(null);for(const t of o){const e=this.blockRequests.get(t);if(!e)throw new Error(`Block ${t} is not in the block requests`);r.push(e)}await Promise.allSettled(r)}if(e&&e.aborted)throw new ix("Request was aborted");const l=a.map(t=>this.blockCache.get(t)||this.evictedBlocks.get(t)),u=l.filter(t=>!t);if(u.length)throw new ax(u,"Request failed");const h=new Map(function(t,e){const i=Array.isArray(t)?t:Array.from(t),n=Array.isArray(e)?e:Array.from(e);return i.map((t,e)=>[t,n[e]])}(a,l));return this.readSliceData(t,h)}fetchBlocks(t){if(this.blockIdsToFetch.size>0){const e=this.groupBlocks(this.blockIdsToFetch),i=this.source.fetch(e,t);for(let n=0;n<e.length;++n){const a=e[n];for(const e of a.blockIds)this.blockRequests.set(e,(async()=>{try{const t=(await i)[n],a=e*this.blockSize,s=a-t.offset,r=Math.min(s+this.blockSize,t.data.byteLength),o=t.data.slice(s,r),l=new sx(a,o.byteLength,o,e);this.blockCache.set(e,l),this.abortedBlockIds.delete(e)}catch(i){if("AbortError"!==i.name)throw i;i.signal=t,this.blockCache.delete(e),this.abortedBlockIds.add(e)}finally{this.blockRequests.delete(e)}})())}this.blockIdsToFetch.clear()}}groupBlocks(t){const e=Array.from(t).sort((t,e)=>t-e);if(0===e.length)return[];let i=[],n=null;const a=[];for(const t of e)null===n||n+1===t?(i.push(t),n=t):(a.push(new rx(i[0]*this.blockSize,i.length*this.blockSize,i)),i=[t],n=t);return a.push(new rx(i[0]*this.blockSize,i.length*this.blockSize,i)),a}readSliceData(t,e){return t.map(t=>{let i=t.offset+t.length;null!==this.fileSize&&(i=Math.min(this.fileSize,i));const n=Math.floor(t.offset/this.blockSize),a=Math.floor(i/this.blockSize),s=new ArrayBuffer(t.length),r=new Uint8Array(s);for(let s=n;s<=a;++s){const n=e.get(s),a=n.offset-t.offset;let o,l=0,u=0;a<0?l=-a:a>0&&(u=a),o=n.top-i<0?n.length-l:i-n.offset-l;const h=new Uint8Array(n.data,l,o);r.set(h,u)}return s})}}class lx{get ok(){return this.status>=200&&this.status<=299}get status(){throw new Error("not implemented")}getHeader(t){throw new Error("not implemented")}async getData(){throw new Error("not implemented")}}class ux{constructor(t){this.url=t}async request({headers:t,signal:e}={}){throw new Error("request is not implemented")}}class hx extends lx{constructor(t){super(),this.response=t}get status(){return this.response.status}getHeader(t){return this.response.headers.get(t)}async getData(){return this.response.arrayBuffer?await this.response.arrayBuffer():(await this.response.buffer()).buffer}}class cx extends ux{constructor(t,e){super(t),this.credentials=e}async request({headers:t,signal:e}={}){const i=await fetch(this.url,{headers:t,credentials:this.credentials,signal:e});return new hx(i)}}class dx extends lx{constructor(t,e){super(),this.xhr=t,this.data=e}get status(){return this.xhr.status}getHeader(t){return this.xhr.getResponseHeader(t)}async getData(){return this.data}}class px extends ux{constructRequest(t,e){return new Promise((i,n)=>{const a=new XMLHttpRequest;a.open("GET",this.url),a.responseType="arraybuffer";for(const[e,i]of Object.entries(t))a.setRequestHeader(e,i);a.onload=()=>{const t=a.response;i(new dx(a,t))},a.onerror=n,a.onabort=()=>n(new ix("Request aborted")),a.send(),e&&(e.aborted&&a.abort(),e.addEventListener("abort",()=>a.abort()))})}async request({headers:t,signal:e}={}){return await this.constructRequest(t,e)}}var mx=i(8625),fx=i(6504),gx=i(6580);class _x extends lx{constructor(t,e){super(),this.response=t,this.dataPromise=e}get status(){return this.response.statusCode}getHeader(t){return this.response.headers[t]}async getData(){return await this.dataPromise}}class yx extends ux{constructor(t){super(t),this.parsedUrl=gx.parse(this.url),this.httpApi="http:"===this.parsedUrl.protocol?mx:fx}constructRequest(t,e){return new Promise((i,n)=>{const a=this.httpApi.get({...this.parsedUrl,headers:t},t=>{const e=new Promise(e=>{const i=[];t.on("data",t=>{i.push(t)}),t.on("end",()=>{const t=Buffer.concat(i).buffer;e(t)}),t.on("error",n)});i(new _x(t,e))});a.on("error",n),e&&(e.aborted&&a.destroy(new ix("Request aborted")),e.addEventListener("abort",()=>a.destroy(new ix("Request aborted"))))})}async request({headers:t,signal:e}={}){return await this.constructRequest(t,e)}}class kx extends tx{constructor(t,e,i,n){super(),this.client=t,this.headers=e,this.maxRanges=i,this.allowFullFile=n,this._fileSize=null}async fetch(t,e){return this.maxRanges>=t.length?this.fetchSlices(t,e):(this.maxRanges>0&&t.length,Promise.all(t.map(t=>this.fetchSlice(t,e))))}async fetchSlices(t,e){const i=await this.client.request({headers:{...this.headers,Range:`bytes=${t.map(({offset:t,length:e})=>`${t}-${t+e}`).join(",")}`},signal:e});if(i.ok){if(206===i.status){const{type:n,params:a}=function(t){const[e,...i]=t.split(";").map(t=>t.trim());return{type:e,params:Zv(i.map(t=>t.split("=")))}}(i.getHeader("content-type"));if("multipart/byteranges"===n){const t=function(t,e){let i=null;const n=new TextDecoder("ascii"),a=[],s=`--${e}`,r=`${s}--`;for(let e=0;e<10;++e)n.decode(new Uint8Array(t,e,s.length))===s&&(i=e);if(null===i)throw new Error("Could not find initial boundary");for(;i<t.byteLength;){const e=n.decode(new Uint8Array(t,i,Math.min(s.length+1024,t.byteLength-i)));if(0===e.length||e.startsWith(r))break;if(!e.startsWith(s))throw new Error("Part does not start with boundary");const o=e.substr(s.length+2);if(0===o.length)break;const l=o.indexOf("\r\n\r\n"),u=Jv(o.substr(0,l)),{start:h,end:c,total:d}=Qv(u["content-range"]),p=i+s.length+l+4,m=parseInt(c,10)+1-parseInt(h,10);a.push({headers:u,data:t.slice(p,p+m),offset:h,length:m,fileSize:d}),i=p+m+4}return a}(await i.getData(),a.boundary);return this._fileSize=t[0].fileSize||null,t}const s=await i.getData(),{start:r,end:o,total:l}=Qv(i.getHeader("content-range"));this._fileSize=l||null;const u=[{data:s,offset:r,length:o-r}];if(t.length>1){const i=await Promise.all(t.slice(1).map(t=>this.fetchSlice(t,e)));return u.concat(i)}return u}{if(!this.allowFullFile)throw new Error("Server responded with full file");const t=await i.getData();return this._fileSize=t.byteLength,[{data:t,offset:0,length:t.byteLength}]}}throw new Error("Error fetching data.")}async fetchSlice(t,e){const{offset:i,length:n}=t,a=await this.client.request({headers:{...this.headers,Range:`bytes=${i}-${i+n}`},signal:e});if(a.ok){if(206===a.status){const t=await a.getData(),{total:e}=Qv(a.getHeader("content-range"));return this._fileSize=e||null,{data:t,offset:i,length:n}}{if(!this.allowFullFile)throw new Error("Server responded with full file");const t=await a.getData();return this._fileSize=t.byteLength,{data:t,offset:0,length:t.byteLength}}}throw new Error("Error fetching data.")}get fileSize(){return this._fileSize}}function vx(t,{blockSize:e,cacheSize:i}){return null===e?t:new ox(t,{blockSize:e,cacheSize:i})}function xx(t,{forceXHR:e=!1,...i}={}){return"function"!=typeof fetch||e?"undefined"!=typeof XMLHttpRequest?function(t,{headers:e={},maxRanges:i=0,allowFullFile:n=!1,...a}={}){const s=new px(t);return vx(new kx(s,e,i,n),a)}(t,i):function(t,{headers:e={},maxRanges:i=0,allowFullFile:n=!1,...a}={}){const s=new yx(t);return vx(new kx(s,e,i,n),a)}(t,i):function(t,{headers:e={},credentials:i,maxRanges:n=0,allowFullFile:a=!1,...s}={}){const r=new cx(t,i);return vx(new kx(r,e,n,a),s)}(t,i)}class wx extends tx{constructor(t){super(),this.file=t}async fetchSlice(t,e){return new Promise((i,n)=>{const a=this.file.slice(t.offset,t.offset+t.length),s=new FileReader;s.onload=t=>i(t.target.result),s.onerror=n,s.onabort=n,s.readAsArrayBuffer(a),e&&e.addEventListener("abort",()=>s.abort())})}}function bx(t){switch(t){case Mk.s$.BYTE:case Mk.s$.ASCII:case Mk.s$.SBYTE:case Mk.s$.UNDEFINED:return 1;case Mk.s$.SHORT:case Mk.s$.SSHORT:return 2;case Mk.s$.LONG:case Mk.s$.SLONG:case Mk.s$.FLOAT:case Mk.s$.IFD:return 4;case Mk.s$.RATIONAL:case Mk.s$.SRATIONAL:case Mk.s$.DOUBLE:case Mk.s$.LONG8:case Mk.s$.SLONG8:case Mk.s$.IFD8:return 8;default:throw new RangeError(`Invalid field type: ${t}`)}}function Ex(t,e,i,n){let a=null,s=null;const r=bx(e);switch(e){case Mk.s$.BYTE:case Mk.s$.ASCII:case Mk.s$.UNDEFINED:a=new Uint8Array(i),s=t.readUint8;break;case Mk.s$.SBYTE:a=new Int8Array(i),s=t.readInt8;break;case Mk.s$.SHORT:a=new Uint16Array(i),s=t.readUint16;break;case Mk.s$.SSHORT:a=new Int16Array(i),s=t.readInt16;break;case Mk.s$.LONG:case Mk.s$.IFD:a=new Uint32Array(i),s=t.readUint32;break;case Mk.s$.SLONG:a=new Int32Array(i),s=t.readInt32;break;case Mk.s$.LONG8:case Mk.s$.IFD8:a=new Array(i),s=t.readUint64;break;case Mk.s$.SLONG8:a=new Array(i),s=t.readInt64;break;case Mk.s$.RATIONAL:a=new Uint32Array(2*i),s=t.readUint32;break;case Mk.s$.SRATIONAL:a=new Int32Array(2*i),s=t.readInt32;break;case Mk.s$.FLOAT:a=new Float32Array(i),s=t.readFloat32;break;case Mk.s$.DOUBLE:a=new Float64Array(i),s=t.readFloat64;break;default:throw new RangeError(`Invalid field type: ${e}`)}if(e!==Mk.s$.RATIONAL&&e!==Mk.s$.SRATIONAL)for(let e=0;e<i;++e)a[e]=s.call(t,n+e*r);else for(let e=0;e<i;e+=2)a[e]=s.call(t,n+e*r),a[e+1]=s.call(t,n+(e*r+4));return e===Mk.s$.ASCII?new TextDecoder("utf-8").decode(a):a}class Mx{constructor(t,e,i){this.fileDirectory=t,this.geoKeyDirectory=e,this.nextIFDByteOffset=i}}class Tx extends Error{constructor(t){super(`No image at index ${t}`),this.index=t}}class Sx{async readRasters(t={}){const{window:e,width:i,height:n}=t;let{resX:a,resY:s,bbox:r}=t;const o=await this.getImage();let l=o;const u=await this.getImageCount(),h=o.getBoundingBox();if(e&&r)throw new Error('Both "bbox" and "window" passed.');if(i||n){if(e){const[t,i]=o.getOrigin(),[n,a]=o.getResolution();r=[t+e[0]*n,i+e[1]*a,t+e[2]*n,i+e[3]*a]}const t=r||h;if(i){if(a)throw new Error("Both width and resX passed");a=(t[2]-t[0])/i}if(n){if(s)throw new Error("Both width and resY passed");s=(t[3]-t[1])/n}}if(a||s){const t=[];for(let e=0;e<u;++e){const i=await this.getImage(e),{SubfileType:n,NewSubfileType:a}=i.fileDirectory;(0===e||2===n||1&a)&&t.push(i)}t.sort((t,e)=>t.getWidth()-e.getWidth());for(let e=0;e<t.length;++e){const i=t[e],n=(h[2]-h[0])/i.getWidth(),r=(h[3]-h[1])/i.getHeight();if(l=i,a&&a>n||s&&s>r)break}}let c=e;if(r){const[t,e]=o.getOrigin(),[i,n]=l.getResolution(o);c=[Math.round((r[0]-t)/i),Math.round((r[1]-e)/n),Math.round((r[2]-t)/i),Math.round((r[3]-e)/n)],c=[Math.min(c[0],c[2]),Math.min(c[1],c[3]),Math.max(c[0],c[2]),Math.max(c[1],c[3])]}return l.readRasters({...t,window:c})}}class Cx extends Sx{constructor(t,e,i,n,a={}){super(),this.source=t,this.littleEndian=e,this.bigTiff=i,this.firstIFDOffset=n,this.cache=a.cache||!1,this.ifdRequests=[],this.ghostValues=null}async getSlice(t,e){const i=this.bigTiff?4048:1024;return new qv((await this.source.fetch([{offset:t,length:void 0!==e?e:i}]))[0],t,this.littleEndian,this.bigTiff)}async parseFileDirectoryAt(t){const e=this.bigTiff?20:12,i=this.bigTiff?8:2;let n=await this.getSlice(t);const a=this.bigTiff?n.readUint64(t):n.readUint16(t),s=a*e+(this.bigTiff?16:6);n.covers(t,s)||(n=await this.getSlice(t,s));const r={};let o=t+(this.bigTiff?8:2);for(let t=0;t<a;o+=e,++t){const t=n.readUint16(o),e=n.readUint16(o+2),i=this.bigTiff?n.readUint64(o+4):n.readUint32(o+4);let a,s;const l=bx(e),u=o+(this.bigTiff?12:8);if(l*i<=(this.bigTiff?8:4))a=Ex(n,e,i,u);else{const t=n.readOffset(u),s=bx(e)*i;a=n.covers(t,s)?Ex(n,e,i,t):Ex(await this.getSlice(t,s),e,i,t)}s=1===i&&-1===Mk.NZ.indexOf(t)&&e!==Mk.s$.RATIONAL&&e!==Mk.s$.SRATIONAL?a[0]:a,r[Mk.$[t]]=s}const l=function(t){const e=t.GeoKeyDirectory;if(!e)return null;const i={};for(let n=4;n<=4*e[3];n+=4){const a=Mk.Hm[e[n]],s=e[n+1]?Mk.$[e[n+1]]:null,r=e[n+2],o=e[n+3];let l=null;if(s){if(l=t[s],null==l)throw new Error(`Could not get value of geoKey '${a}'.`);"string"==typeof l?l=l.substring(o,o+r-1):l.subarray&&(l=l.subarray(o,o+r),1===r&&(l=l[0]))}else l=o;i[a]=l}return i}(r),u=n.readOffset(t+i+e*a);return new Mx(r,l,u)}async requestIFD(t){if(this.ifdRequests[t])return this.ifdRequests[t];if(0===t)return this.ifdRequests[t]=this.parseFileDirectoryAt(this.firstIFDOffset),this.ifdRequests[t];if(!this.ifdRequests[t-1])try{this.ifdRequests[t-1]=this.requestIFD(t-1)}catch(e){if(e instanceof Tx)throw new Tx(t);throw e}return this.ifdRequests[t]=(async()=>{const e=await this.ifdRequests[t-1];if(0===e.nextIFDByteOffset)throw new Tx(t);return this.parseFileDirectoryAt(e.nextIFDByteOffset)})(),this.ifdRequests[t]}async getImage(t=0){const e=await this.requestIFD(t);return new Yv(e.fileDirectory,e.geoKeyDirectory,this.dataView,this.littleEndian,this.cache,this.source)}async getImageCount(){let t=0,e=!0;for(;e;)try{await this.requestIFD(t),++t}catch(t){if(!(t instanceof Tx))throw t;e=!1}return t}async getGhostValues(){const t=this.bigTiff?16:8;if(this.ghostValues)return this.ghostValues;let e=await this.getSlice(t,130);if("GDAL_STRUCTURAL_METADATA_SIZE="===Ex(e,Mk.s$.ASCII,30,t)){const i=Ex(e,Mk.s$.ASCII,130,t).split("\n")[0],n=Number(i.split("=")[1].split(" ")[0])+i.length;n>130&&(e=await this.getSlice(t,n));const a=Ex(e,Mk.s$.ASCII,n,t);this.ghostValues={},a.split("\n").filter(t=>t.length>0).map(t=>t.split("=")).forEach(([t,e])=>{this.ghostValues[t]=e})}return this.ghostValues}static async fromSource(t,e,i){const n=(await t.fetch([{offset:0,length:1024}],i))[0],a=new Xv(n),s=a.getUint16(0,0);let r;if(18761===s)r=!0;else{if(19789!==s)throw new TypeError("Invalid byte order value.");r=!1}const o=a.getUint16(2,r);let l;if(42===o)l=!1;else{if(43!==o)throw new TypeError("Invalid magic number.");if(l=!0,8!==a.getUint16(4,r))throw new Error("Unsupported offset byte-size.")}const u=l?a.getUint64(8,r):a.getUint32(4,r);return new Cx(t,r,l,u,e)}close(){return"function"==typeof this.source.close&&this.source.close()}}class Lx extends Sx{constructor(t,e){super(),this.mainFile=t,this.overviewFiles=e,this.imageFiles=[t].concat(e),this.fileDirectoriesPerFile=null,this.fileDirectoriesPerFileParsing=null,this.imageCount=null}async parseFileDirectoriesPerFile(){const t=[this.mainFile.parseFileDirectoryAt(this.mainFile.firstIFDOffset)].concat(this.overviewFiles.map(t=>t.parseFileDirectoryAt(t.firstIFDOffset)));return this.fileDirectoriesPerFile=await Promise.all(t),this.fileDirectoriesPerFile}async getImage(t=0){await this.getImageCount(),await this.parseFileDirectoriesPerFile();let e=0,i=0;for(let n=0;n<this.imageFiles.length;n++){const a=this.imageFiles[n];for(let s=0;s<this.imageCounts[n];s++){if(t===e){const t=await a.requestIFD(i);return new Yv(t.fileDirectory,t.geoKeyDirectory,a.dataView,a.littleEndian,a.cache,a.source)}e++,i++}i=0}throw new RangeError("Invalid image index")}async getImageCount(){if(null!==this.imageCount)return this.imageCount;const t=[this.mainFile.getImageCount()].concat(this.overviewFiles.map(t=>t.getImageCount()));return this.imageCounts=await Promise.all(t),this.imageCount=this.imageCounts.reduce((t,e)=>t+e,0),this.imageCount}}class Rx{constructor(t){this.gl_=t,this.program_=Px(t,"\n  precision mediump float;\n\n  varying vec2 v_texcoord;\n\n  uniform sampler2D u_texture;\n\n  void main() {\n    if (\n      v_texcoord.x < 0.0 ||\n      v_texcoord.y < 0.0 ||\n      v_texcoord.x > 1.0 ||\n      v_texcoord.y > 1.0\n    ) {\n      discard;\n    }\n    gl_FragColor = texture2D(u_texture, v_texcoord);\n  }\n","\n  attribute vec4 a_position;\n  attribute vec4 a_texcoord;\n\n  uniform mat4 u_matrix;\n  uniform mat4 u_textureMatrix;\n\n  varying vec2 v_texcoord;\n\n  void main() {\n    gl_Position = u_matrix * a_position;\n    vec2 texcoord = (u_textureMatrix * a_texcoord).xy;\n    v_texcoord = texcoord;\n  }\n"),this.positionLocation=t.getAttribLocation(this.program_,"a_position"),this.texcoordLocation=t.getAttribLocation(this.program_,"a_texcoord"),this.matrixLocation=t.getUniformLocation(this.program_,"u_matrix"),this.textureMatrixLocation=t.getUniformLocation(this.program_,"u_textureMatrix"),this.textureLocation=t.getUniformLocation(this.program_,"u_texture"),this.positionBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer),this.positions=[0,0,0,1,1,0,1,0,0,1,1,1],t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.positions),t.STATIC_DRAW),this.texcoordBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.texcoordBuffer),this.texcoords=[0,0,0,1,1,0,1,0,0,1,1,1],t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.texcoords),t.STATIC_DRAW)}drawImage(t,e,i,n,a,s,r,o,l,u,h,c,d){const p=this.gl_;void 0===o&&(o=n),void 0===l&&(l=a),void 0===s&&(s=e),void 0===r&&(r=i),void 0===u&&(u=s),void 0===h&&(h=r),void 0===c&&(c=p.canvas.width),void 0===d&&(d=p.canvas.height),p.bindTexture(p.TEXTURE_2D,t),p.useProgram(this.program_),p.bindBuffer(p.ARRAY_BUFFER,this.positionBuffer),p.enableVertexAttribArray(this.positionLocation),p.vertexAttribPointer(this.positionLocation,2,p.FLOAT,!1,0,0),p.bindBuffer(p.ARRAY_BUFFER,this.texcoordBuffer),p.enableVertexAttribArray(this.texcoordLocation),p.vertexAttribPointer(this.texcoordLocation,2,p.FLOAT,!1,0,0);let m=_y(0,c,0,d,-1,1);m=function(t,e,i,n,a){let s,r,o,l,u,h,c,d,p,m,f,g;return t===(a=a??[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])?(a[12]=t[0]*e+t[4]*i+0*t[8]+t[12],a[13]=t[1]*e+t[5]*i+0*t[9]+t[13],a[14]=t[2]*e+t[6]*i+0*t[10]+t[14],a[15]=t[3]*e+t[7]*i+0*t[11]+t[15]):(s=t[0],r=t[1],o=t[2],l=t[3],u=t[4],h=t[5],c=t[6],d=t[7],p=t[8],m=t[9],f=t[10],g=t[11],a[0]=s,a[1]=r,a[2]=o,a[3]=l,a[4]=u,a[5]=h,a[6]=c,a[7]=d,a[8]=p,a[9]=m,a[10]=f,a[11]=g,a[12]=s*e+u*i+0*p+t[12],a[13]=r*e+h*i+0*m+t[13],a[14]=o*e+c*i+0*f+t[14],a[15]=l*e+d*i+0*g+t[15]),a}(m,o,l),m=yy(m,u,h,1),p.uniformMatrix4fv(this.matrixLocation,!1,m);let f=(g=n/e,_=a/i,(y=y??[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])[0]=1,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=1,y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[10]=1,y[11]=0,y[12]=g,y[13]=_,y[14]=0,y[15]=1,y);var g,_,y;f=yy(f,s/e,r/i,1),p.uniformMatrix4fv(this.textureMatrixLocation,!1,f),p.uniform1i(this.textureLocation,0),p.drawArrays(p.TRIANGLES,0,this.positions.length/2)}}function Ix(t,e,i){const n=t.createShader(e);if(null===n)throw new Error("Shader compilation failed");if(t.shaderSource(n,i),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS)){const e=t.getShaderInfoLog(n);if(null===e)throw new Error("Shader info log creation failed");throw new Error(e)}return n}function Px(t,e,i){const n=t.createProgram(),a=Ix(t,t.VERTEX_SHADER,i),s=Ix(t,t.FRAGMENT_SHADER,e);if(null===n)throw new Error("Program creation failed");if(t.attachShader(n,a),t.attachShader(n,s),t.linkProgram(n),!t.getProgramParameter(n,t.LINK_STATUS)){if(null===t.getProgramInfoLog(n))throw new Error("Program info log creation failed");throw new Error}return n}const Ax=[];function jx(t,e,i,n,a,s,r,o,l,u,h,c,d,p){const m=Math.round(n*e),f=Math.round(n*i);let g,_;if(t.canvas.width=m,t.canvas.height=f,_=t.createTexture(),t.bindTexture(t.TEXTURE_2D,_),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),d?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST)),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,m,f,0,t.RGBA,h,null),g=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,g),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,_,0),null===g)throw new Error("Could not create framebuffer");if(null===_)throw new Error("Could not create texture");if(0===l.length)return{width:m,height:f,framebuffer:g,texture:_};const y=[1/0,1/0,-1/0,-1/0];let k,v,x;l.forEach(function(t,e,i){st(y,t.extent)});const w=1/a;if(p&&1===l.length&&0===u)k=l[0].texture,v=l[0].width,x=l[0].width;else{if(k=t.createTexture(),null===_)throw new Error("Could not create texture");v=Math.round(xt(y)*w),x=Math.round(_t(y)*w);const e=t.getParameter(t.MAX_TEXTURE_SIZE),i=Math.max(v,x),n=i>e?e/i:1,a=Math.round(v*n),s=Math.round(x*n);t.bindTexture(t.TEXTURE_2D,k),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),d?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST)),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,a,s,0,t.RGBA,h,null);const r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,k,0);const o=new Rx(t);l.forEach(function(e,i,l){const h=(e.extent[0]-y[0])*w*n,c=-(e.extent[3]-y[3])*w*n,p=xt(e.extent)*w*n,m=_t(e.extent)*w*n;if(t.bindFramebuffer(t.FRAMEBUFFER,r),t.viewport(0,0,a,s),e.clipExtent){const i=(e.clipExtent[0]-y[0])*w*n,a=-(e.clipExtent[3]-y[3])*w*n,s=xt(e.clipExtent)*w*n,r=_t(e.clipExtent)*w*n;t.enable(t.SCISSOR_TEST),t.scissor(d?i:Math.round(i),d?a:Math.round(a),d?s:Math.round(i+s)-Math.round(i),d?r:Math.round(a+r)-Math.round(a))}o.drawImage(e.texture,e.width,e.height,u,u,e.width-2*u,e.height-2*u,d?h:Math.round(h),d?c:Math.round(c),d?p:Math.round(h+p)-Math.round(h),d?m:Math.round(c+m)-Math.round(c),a,s),t.disable(t.SCISSOR_TEST)}),t.deleteFramebuffer(r)}const b=kt(r),E=kt(y),M=t=>{const e=(t[0][0]-b[0])/s*n,i=-(t[0][1]-b[1])/s*n;return{u1:(t[1][0]-b[0])/s*n,v1:-(t[1][1]-b[1])/s*n,u0:e,v0:i,u2:(t[2][0]-b[0])/s*n,v2:-(t[2][1]-b[1])/s*n}};t.bindFramebuffer(t.FRAMEBUFFER,g),t.viewport(0,0,m,f);{const e=[],i=[],n=Px(t,"\n  precision mediump float;\n\n  varying vec2 v_texcoord;\n\n  uniform sampler2D u_texture;\n\n  void main() {\n    if (v_texcoord.x < 0.0 || v_texcoord.x > 1.0 || v_texcoord.y < 0.0 || v_texcoord.y > 1.0) {\n      discard;\n    }\n    gl_FragColor = texture2D(u_texture, v_texcoord);\n  }\n","\n  attribute vec4 a_position;\n  attribute vec2 a_texcoord;\n\n  varying vec2 v_texcoord;\n\n  uniform mat4 u_matrix;\n\n  void main() {\n     gl_Position = u_matrix * a_position;\n     v_texcoord = a_texcoord;\n  }\n");t.useProgram(n);const s=t.getUniformLocation(n,"u_texture");t.bindTexture(t.TEXTURE_2D,k),t.uniform1i(s,0),o.getTriangles().forEach(function(t,n,s){const r=t.source,o=t.target,{u1:l,v1:u,u0:h,v0:c,u2:d,v2:p}=M(o),m=(r[0][0]-E[0])/a/v,f=-(r[0][1]-E[1])/a/x,g=(r[1][0]-E[0])/a/v,_=-(r[1][1]-E[1])/a/x,y=(r[2][0]-E[0])/a/v,k=-(r[2][1]-E[1])/a/x;e.push(l,u,h,c,d,p),i.push(g,_,m,f,y,k)});const r=_y(0,m,f,0,-1,1),l=t.getUniformLocation(n,"u_matrix");t.uniformMatrix4fv(l,!1,r);const u=t.getAttribLocation(n,"a_position"),h=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,h),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e),t.STATIC_DRAW),t.vertexAttribPointer(u,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(u);const c=t.getAttribLocation(n,"a_texcoord"),d=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,d),t.bufferData(t.ARRAY_BUFFER,new Float32Array(i),t.STATIC_DRAW),t.vertexAttribPointer(c,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(c),t.drawArrays(t.TRIANGLES,0,e.length/2)}if(c){const e=Px(t,"\n  precision mediump float;\n\n  uniform vec4 u_val;\n  void main() {\n     gl_FragColor = u_val;\n  }\n","\n  attribute vec4 a_position;\n\n  uniform mat4 u_matrix;\n\n  void main() {\n     gl_Position = u_matrix * a_position;\n  }\n");t.useProgram(e);const i=_y(0,m,f,0,-1,1),n=t.getUniformLocation(e,"u_matrix");t.uniformMatrix4fv(n,!1,i);const a=Array.isArray(c)?c:[0,0,0,255],s=t.getUniformLocation(e,"u_val");t.uniform4fv(s,a);const r=t.getAttribLocation(e,"a_position"),l=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,l),t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(r);const u=o.getTriangles().reduce(function(t,e){const i=e.target,{u1:n,v1:a,u0:s,v0:r,u2:o,v2:l}=M(i);return t.concat([n,a,s,r,s,r,o,l,o,l,n,a])},[]);t.bufferData(t.ARRAY_BUFFER,new Float32Array(u),t.STATIC_DRAW),t.drawArrays(t.LINES,0,u.length/2)}return{width:m,height:f,framebuffer:g,texture:_}}const Ox=class extends zm{constructor(t){super({tileCoord:t.tileCoord,loader:()=>Promise.resolve(new Uint8ClampedArray(4)),interpolate:t.interpolate,transition:t.transition}),this.renderEdges_=void 0!==t.renderEdges&&t.renderEdges,this.pixelRatio_=t.pixelRatio,this.gutter_=t.gutter,this.reprojData_=null,this.reprojError_=null,this.reprojSize_=void 0,this.sourceTileGrid_=t.sourceTileGrid,this.targetTileGrid_=t.targetTileGrid,this.wrappedTileCoord_=t.wrappedTileCoord||t.tileCoord,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const e=t.sourceProj,i=e.getExtent(),n=t.sourceTileGrid.getExtent();this.clipExtent_=e.canWrapX()?n?yt(i,n):i:n;const a=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_),s=this.targetTileGrid_.getExtent();let r=this.sourceTileGrid_.getExtent();const o=s?yt(a,s):a;if(0===ht(o))return void(this.state=4);i&&(r=r?yt(r,i):i);const l=this.targetTileGrid_.getResolution(this.wrappedTileCoord_[0]),u=t.targetProj,h=nf(e,u,o,l);if(!isFinite(h)||h<=0)return void(this.state=4);const c=void 0!==t.errorThreshold?t.errorThreshold:.5;if(this.triangulation_=new af(e,u,o,r,h*c,l,t.transformMatrix),0===this.triangulation_.getTriangles().length)return void(this.state=4);this.sourceZ_=this.sourceTileGrid_.getZForResolution(h);let d=this.triangulation_.calculateSourceExtent();if(r&&(e.canWrapX()?(d[1]=St(d[1],r[1],r[3]),d[3]=St(d[3],r[1],r[3])):d=yt(d,r)),ht(d)){let n=0,a=0;e.canWrapX()&&(n=xt(i),a=Math.floor((d[0]-i[0])/n)),Tt(d.slice(),e,!0).forEach(e=>{const i=this.sourceTileGrid_.getTileRangeForExtentAndZ(e,this.sourceZ_),s=t.getTileFunction;for(let t=i.minX;t<=i.maxX;t++)for(let e=i.minY;e<=i.maxY;e++){const i=s(this.sourceZ_,t,e,this.pixelRatio_);if(i){const t=a*n;this.sourceTiles_.push({tile:i,offset:t})}}++a}),0===this.sourceTiles_.length&&(this.state=4)}else this.state=4}getSize(){return this.reprojSize_}getData(){return this.reprojData_}getError(){return this.reprojError_}reproject_(){const t=[];let e=!1;if(this.sourceTiles_.forEach(i=>{const n=i.tile;if(!n||2!==n.getState())return;const a=n.getSize(),s=this.gutter_;let r;const o=Um(n.getData());o?r=o:(e=!0,r=function(t){Vm||(Vm=Ta(t.width,t.height,void 0,{willReadFrequently:!0}));const e=Vm.canvas,i=t.width;e.width!==i&&(e.width=i);const n=t.height;return e.height!==n&&(e.height=n),Vm.clearRect(0,0,i,n),Vm.drawImage(t,0,0),Vm.getImageData(0,0,i,n).data}(Hm(n.getData())));const l=[a[0]+2*s,a[1]+2*s],u=r instanceof Float32Array,h=l[0]*l[1],c=u?Float32Array:Uint8ClampedArray,d=new c(r.buffer),p=c.BYTES_PER_ELEMENT,m=p*d.length/h,f=d.byteLength/l[1],g=Math.floor(f/p/l[0]),_=this.sourceTileGrid_.getTileCoordExtent(n.tileCoord);_[0]+=i.offset,_[2]+=i.offset;const y=this.clipExtent_?.slice();y&&(y[0]+=i.offset,y[2]+=i.offset),t.push({extent:_,clipExtent:y,data:d,dataType:c,bytesPerPixel:m,pixelSize:l,bandCount:g})}),this.sourceTiles_.length=0,0===t.length)return this.state=3,void this.changed();const i=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(i),a="number"==typeof n?n:n[0],s="number"==typeof n?n:n[1],r=Math.round(a*this.pixelRatio_),o=Math.round(s*this.pixelRatio_),l=this.targetTileGrid_.getResolution(i),u=this.sourceTileGrid_.getResolution(this.sourceZ_),h=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_),c=t[0].bandCount,d=new t[0].dataType(c*r*o),p=function(t,e,i){let n;return n=i&&i.length?i.shift():Hn?new OffscreenCanvas(t||300,e||300):document.createElement("canvas"),t&&(n.width=t),e&&(n.height=e),n.getContext("webgl",{premultipliedAlpha:!1,antialias:!1})}(r,o,Ax);let m;const f=p.RGBA;let g;t[0].dataType==Float32Array?(g=p.FLOAT,p.getExtension("WEBGL_color_buffer_float"),p.getExtension("OES_texture_float"),p.getExtension("EXT_float_blend"),m=null!==p.getExtension("OES_texture_float_linear")&&this.interpolate):(g=p.UNSIGNED_BYTE,m=this.interpolate);for(let e=Math.ceil(c/4)-1;e>=0;--e){const i=[];for(let n=0,a=t.length;n<a;++n){const a=t[n],s=a.pixelSize,r=s[0],o=s[1],l=new a.dataType(4*r*o),u=a.data;let h=4*e;for(let t=0,e=l.length;t<e;t+=4)l[t]=u[h],l[t+1]=u[h+1],l[t+2]=u[h+2],l[t+3]=u[h+3],h+=c;const d=p.createTexture();p.bindTexture(p.TEXTURE_2D,d),m?(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR)):(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.NEAREST),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.NEAREST)),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texImage2D(p.TEXTURE_2D,0,f,r,o,0,f,g,l),i.push({extent:a.extent,clipExtent:a.clipExtent,texture:d,width:r,height:o})}const{framebuffer:n,width:r,height:o}=jx(p,a,s,this.pixelRatio_,u,l,h,this.triangulation_,i,this.gutter_,g,this.renderEdges_,m),_=r,y=4*o,k=new t[0].dataType(_*y);p.bindFramebuffer(p.FRAMEBUFFER,n),p.readPixels(0,0,r,o,p.RGBA,g,k);let v=4*e;for(let t=0,e=k.length;t<e;t+=4){const e=(_-1-(t/y|0))*y+t%y;d[v]=k[e],d[v+1]=k[e+1],d[v+2]=k[e+2],d[v+3]=k[e+3],v+=c}}if(function(t){const e=t.canvas;e.width=1,e.height=1,t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT)}(p),Ax.push(p.canvas),e){const t=Ta(a,s),e=new ImageData(d,a);t.putImageData(e,0,0),this.reprojData_=t.canvas}else this.reprojData_=d;this.reprojSize_=[r,o],this.state=2,this.changed()}load(){if(0!==this.state&&3!==this.state)return;this.state=1,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:e})=>{const i=e.getState();if(0!==i&&1!==i)return;t++;const n=R(e,o,()=>{const i=e.getState();2!=i&&3!=i&&4!=i||(P(n),t--,0===t&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(n)}),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t}){0==t.getState()&&t.load()})}unlistenSources_(){this.sourcesListenerKeys_.forEach(P),this.sourcesListenerKeys_=null}},Fx=class extends Hf{constructor(t){const e=void 0===t.projection?"EPSG:3857":t.projection;let i=t.tileGrid;void 0===i&&e&&(i=function(t){const e=t||{},i=e.extent||Ye("EPSG:3857").getExtent(),n={extent:i,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:Cf(i,e.maxZoom,e.tileSize,e.maxResolution)};return new Tf(n)}({extent:Lf(e),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize})),super({cacheSize:.1,attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:e,tileGrid:i,state:t.state,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,zDirection:t.zDirection}),this.gutter_=void 0!==t.gutter?t.gutter:0,this.tileSize_=t.tileSize?Mr(t.tileSize):null,this.tileSizes_=null,this.tileLoadingKeys_={},this.loader_=t.loader,this.handleTileChange_=this.handleTileChange_.bind(this),this.bandCount=void 0===t.bandCount?4:t.bandCount,this.tileGridForProjection_={},this.crossOrigin_=t.crossOrigin||"anonymous",this.transformMatrix=null}setTileSizes(t){this.tileSizes_=t}getTileSize(t){if(this.tileSizes_)return this.tileSizes_[t];if(this.tileSize_)return this.tileSize_;const e=this.getTileGrid();return e?Mr(e.getTileSize(t)):[256,256]}getGutterForProjection(t){const e=this.getProjection();return e&&!ti(e,t)||this.transformMatrix?0:this.gutter_}setLoader(t){this.loader_=t}getReprojTile_(t,e,i,n,a,s){const r=this.tileGrid||this.getTileGridForProjection(a||n),o=Math.max.apply(null,r.getResolutions().map((t,e)=>{const i=Mr(r.getTileSize(e)),n=this.getTileSize(e);return Math.max(n[0]/i[0],n[1]/i[1])})),l=this.getTileGridForProjection(n),u=[t,e,i],h=this.getTileCoordForTileUrlFunction(u,n),c=Object.assign({sourceProj:a||n,sourceTileGrid:r,targetProj:n,targetTileGrid:l,tileCoord:u,wrappedTileCoord:h,pixelRatio:o,gutter:this.gutter_,getTileFunction:(t,e,i,n)=>this.getTile(t,e,i,n,void 0,s),transformMatrix:this.transformMatrix},this.tileOptions),d=new Ox(c);return d.key=this.getKey(),d}getTile(t,e,i,n,a,s){const r=this.getProjection();if(a&&(r&&!ti(r,a)||this.transformMatrix))return this.getReprojTile_(t,e,i,a,r,s);const l=this.getTileSize(t),u=this.loader_,h=new AbortController,c={signal:h.signal,crossOrigin:this.crossOrigin_},d=this.getTileCoordForTileUrlFunction([t,e,i]);if(!d)return null;const p=hf(this,this.getKey(),t,e,i);if(s&&s.containsKey(p))return s.get(p);const m=d[0],f=d[1],g=d[2],_=this.getTileGrid()?.getFullTileRange(m);_&&(c.maxY=_.getHeight()-1);const y=Object.assign({tileCoord:[t,e,i],loader:function(){return M(function(){return u(m,f,g,c)})},size:l,controller:h},this.tileOptions),k=new zm(y);return k.key=this.getKey(),k.addEventListener(o,this.handleTileChange_),s?.set(p,k),k}handleTileChange_(t){const e=t.target,i=N(e),n=e.getState();let a;1==n?(this.tileLoadingKeys_[i]=!0,a=Uf):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],a=3==n?Vf:2==n?Bf:void 0),a&&this.dispatchEvent(new Wf(a,e))}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||ti(e,t))&&!this.transformMatrix)return this.tileGrid;const i=N(t);return i in this.tileGridForProjection_||(this.tileGridForProjection_[i]=Sf(t)),this.tileGridForProjection_[i]}setTileGridForProjection(t,e){const i=Ye(t);if(i){const t=N(i);t in this.tileGridForProjection_||(this.tileGridForProjection_[t]=e)}}};function Nx(t,e){if(!t)return!1;if(!0===t)return!0;if(3!==e.getSamplesPerPixel())return!1;const i=e.fileDirectory.PhotometricInterpretation,n=Mk.ub;return i===n.CMYK||i===n.YCbCr||i===n.CIELab||i===n.ICCLab}const Gx="STATISTICS_MAXIMUM",Dx="STATISTICS_MINIMUM";let Wx;function Hx(){return Wx||(Wx=new Rk),Wx}function Ux(t){try{return t.getBoundingBox(!0)}catch{return[0,0,t.getWidth(),t.getHeight()]}}function Bx(t){try{return t.getOrigin().slice(0,2)}catch{return[0,t.getHeight()]}}function Vx(t,e){try{return t.getResolution(e)}catch{return[e.getWidth()/t.getWidth(),e.getHeight()/t.getHeight()]}}function Kx(t){const e=t.geoKeys;if(!e)return null;if(e.ProjectedCSTypeGeoKey&&32767!==e.ProjectedCSTypeGeoKey){const t="EPSG:"+e.ProjectedCSTypeGeoKey;let i=Ye(t);if(!i){const n=Jt(e.ProjLinearUnitsGeoKey);n&&(i=new te({code:t,units:n}))}return i}if(e.GeographicTypeGeoKey&&32767!==e.GeographicTypeGeoKey){const t="EPSG:"+e.GeographicTypeGeoKey;let i=Ye(t);if(!i){const n=Jt(e.GeogAngularUnitsGeoKey);n&&(i=new te({code:t,units:n}))}return i}return null}function zx(t){return t.getImageCount().then(function(e){const i=new Array(e);for(let n=0;n<e;++n)i[n]=t.getImage(n);return Promise.all(i)})}function $x(t,e){let i;return i=t.blob?async function(t,e){return Cx.fromSource(new wx(t),e)}(t.blob):t.overviews?async function(t,e=[],i={},n){const a=await Cx.fromSource(xx(t,i),n),s=await Promise.all(e.map(t=>Cx.fromSource(xx(t,i))));return new Lx(a,s)}(t.url,t.overviews,e):async function(t,e={},i){return Cx.fromSource(xx(t,e),i)}(t.url,e),i.then(zx)}function Yx(t,e,i,n,a){if(Array.isArray(t)){const s=t.length;if(!Array.isArray(e)||s!=e.length){const t=new Error(n);throw a(t),t}for(let r=0;r<s;++r)Yx(t[r],e[r],i,n,a);return}if(Math.abs(t-e)>i*t)throw new Error(n)}function Xx(t){return t instanceof Int8Array?-128:t instanceof Int16Array?-32768:t instanceof Int32Array?-2147483648:t instanceof Float32Array?12e-39:0}function qx(t){return t instanceof Int8Array?127:t instanceof Uint8Array||t instanceof Uint8ClampedArray?255:t instanceof Int16Array?32767:t instanceof Uint16Array?65535:t instanceof Int32Array?2147483647:t instanceof Uint32Array?4294967295:t instanceof Float32Array?34e37:255}class Zx extends Fx{constructor(t){super({state:"loading",tileGrid:null,projection:t.projection||null,transition:t.transition,interpolate:!1!==t.interpolate,wrapX:t.wrapX}),this.sourceInfo_=t.sources;const e=this.sourceInfo_.length;this.sourceOptions_=t.sourceOptions,this.sourceImagery_=new Array(e),this.sourceMasks_=new Array(e),this.resolutionFactors_=new Array(e),this.samplesPerPixel_,this.nodataValues_,this.metadata_,this.normalize_=!1!==t.normalize,this.addAlpha_=!1,this.error_=null,this.convertToRGB_=t.convertToRGB||!1,this.setKey(this.sourceInfo_.map(t=>t.url).join(","));const i=this,n=new Array(e);for(let t=0;t<e;++t)n[t]=$x(this.sourceInfo_[t],this.sourceOptions_);Promise.all(n).then(function(t){i.configure_(t)}).catch(function(t){zt(t),i.error_=t,i.setState("error")})}getError(){return this.error_}determineProjection(t){const e=t[0];for(let t=e.length-1;t>=0;--t){const i=Kx(e[t]);if(i){this.projection=i;break}}}determineTransformMatrix(t){const e=t[0];for(let t=e.length-1;t>=0;--t){const i=e[t].fileDirectory.ModelTransformation;if(i){const[t,e,n,a,s,r,o,l]=i,u=yi(yi([1/Math.sqrt(t*t+s*s),0,0,-1/Math.sqrt(e*e+r*r),a,l],[t,s,e,r,0,0]),[1,0,0,1,-a,-l]);this.transformMatrix=u,this.addAlpha_=!0;break}}}configure_(t){let e,i,n,a,s;const r=new Array(t.length),o=new Array(t.length),l=new Array(t.length);let u=0;const h=t.length;for(let c=0;c<h;++c){const h=[],d=[];t[c].forEach(t=>{4&~(t.fileDirectory.NewSubfileType||0)?h.push(t):d.push(t)});const p=h.length;if(d.length>0&&d.length!==p)throw new Error(`Expected one mask per image found ${d.length} masks and ${p} images`);let m,f;const g=new Array(p),_=new Array(p),y=new Array(p);o[c]=new Array(p),l[c]=new Array(p);for(let t=0;t<p;++t){const e=h[t],i=e.getGDALNoData();l[c][t]=e.getGDALMetadata(0),o[c][t]=i;const n=this.sourceInfo_[c].bands;r[c]=n?n.length:e.getSamplesPerPixel();const a=p-(t+1);m||(m=Ux(e)),f||(f=Bx(e));const s=Vx(e,h[0]);y[a]=s[0];const u=[e.getTileWidth(),e.getTileHeight()];u[0]!==u[1]&&u[1]<256&&(u[0]=256,u[1]=256),g[a]=u;const d=s[0]/Math.abs(s[1]);_[a]=[u[0],u[1]/d]}if(e?yt(e,m,e):e=m,i?Yx(i,f,0,`Origin mismatch for source ${c}, got [${f}] but expected [${i}]`,this.viewRejector):i=f,s){s.length-u>y.length&&(u=s.length-y.length);const t=s[s.length-1]/y[y.length-1];this.resolutionFactors_[c]=t;const e=y.map(e=>e*t),i=`Resolution mismatch for source ${c}, got [${e}] but expected [${s}]`;Yx(s.slice(u,s.length),e,.02,i,this.viewRejector)}else s=y,this.resolutionFactors_[c]=1;n?Yx(n.slice(u,n.length),_,.01,`Tile size mismatch for source ${c}`,this.viewRejector):n=_,a?Yx(a.slice(u,a.length),g,0,`Tile size mismatch for source ${c}`,this.viewRejector):a=g,this.sourceImagery_[c]=h.reverse(),this.sourceMasks_[c]=d.reverse()}for(let t=0,e=this.sourceImagery_.length;t<e;++t){const e=this.sourceImagery_[t];for(;e.length<s.length;)e.unshift(void 0)}this.getProjection()||this.determineProjection(t),this.determineTransformMatrix(t),this.samplesPerPixel_=r,this.nodataValues_=o,this.metadata_=l;t:for(let t=0;t<h;++t){if(void 0!==this.sourceInfo_[t].nodata){this.addAlpha_=!0;break}if(this.sourceMasks_[t].length){this.addAlpha_=!0;break}const e=o[t],i=this.sourceInfo_[t].bands;if(i){for(let t=0;t<i.length;++t)if(null!==e[i[t]-1]){this.addAlpha_=!0;break t}}else for(let t=0;t<e.length;++t)if(null!==e[t]){this.addAlpha_=!0;break t}}let c=this.addAlpha_?1:0;for(let t=0;t<h;++t)c+=r[t];this.bandCount=c;const d=new Tf({extent:e,minZoom:u,origin:i,resolutions:s,tileSizes:n});this.tileGrid=d,this.setTileSizes(a),this.setLoader(this.loadTile_.bind(this)),this.setState("ready"),2===s.length?s=[s[0],s[1],s[1]/2]:1===s.length&&(s=[2*s[0],s[0],s[0]/2]);let p=e;if(this.transformMatrix){const t=bi([1,0,0,1,0,0],this.transformMatrix.slice());p=Et(e,Je(e=>vi(t,e)))}this.viewResolver({showFullExtent:!0,projection:this.projection,resolutions:s,center:li(pt(p),this.projection),extent:hi(p,this.projection),zoom:1})}loadTile_(t,e,i,n){const a=this.getTileSize(t),s=this.sourceImagery_.length,r=new Array(2*s),o=this.nodataValues_,l=this.sourceInfo_,u=Hx();for(let h=0;h<s;++h){const c=l[h],d=this.resolutionFactors_[h],p=[Math.round(e*(a[0]*d)),Math.round(i*(a[1]*d)),Math.round((e+1)*(a[0]*d)),Math.round((i+1)*(a[1]*d))],m=this.sourceImagery_[h][t];let f,g;c.bands&&(f=c.bands.map(function(t){return t-1})),g="nodata"in c&&null!==c.nodata?c.nodata:f?f.map(function(t){return o[h][t]}):o[h];const _={window:p,width:a[0],height:a[1],samples:f,fillValue:g,pool:u,interleave:!1,signal:n.signal};Nx(this.convertToRGB_,m)?r[h]=m.readRGB(_):r[h]=m.readRasters(_);const y=s+h,k=this.sourceMasks_[h][t];r[y]=k?k.readRasters({window:p,width:a[0],height:a[1],samples:[0],pool:u,interleave:!1}):Promise.resolve(null)}return Promise.all(r).then(this.composeTile_.bind(this,a)).catch(function(t){throw zt(t),t})}composeTile_(t,e){const i=this.metadata_,n=this.sourceInfo_,a=this.sourceImagery_.length,s=this.bandCount,r=this.samplesPerPixel_,o=this.nodataValues_,l=this.normalize_,u=this.addAlpha_,h=t[0]*t[1],c=h*s;let d;d=l?new Uint8Array(c):new Float32Array(c);let p=0;for(let t=0;t<h;++t){let s=u;for(let h=0;h<a;++h){const c=n[h];let m,f,g=c.min,_=c.max;if(l){const t=i[h][0];void 0===g&&(g=t&&Dx in t?parseFloat(t[Dx]):Xx(e[h][0])),void 0===_&&(_=t&&Gx in t?parseFloat(t[Gx]):qx(e[h][0])),m=255/(_-g),f=-g*m}for(let i=0;i<r[h];++i){const n=e[h][i][t];let a;if(a=l?St(m*n+f,0,255):n,u){let t=c.nodata;if(void 0===t){let e;e=c.bands?c.bands[i]-1:i,t=o[h][e]}const e=isNaN(t);(!e&&n!==t||e&&!isNaN(n))&&(s=!1,d[p]=a)}else d[p]=a;p++}if(!s){const i=e[a+h];i&&!i[0][t]&&(s=!0)}}u&&(s||(d[p]=255),p++)}return d}}Zx.prototype.getView;const Jx=Zx,Qx={color:["match",["round",["*",["band",1],255]],0,[0,0,0,0],1,[255,255,255,1],[0,0,0,0]]};class tw{constructor(t){this.year=t,this.source=new Jx({sources:[{url:`https://maannousu.info/api/v2/ice/${this.year}`,bands:[1]}],sourceOptions:{cacheSize:50},convertToRGB:!1,normalize:!0,interpolate:!1}),this.layer=new Ek({source:this.source,style:Qx,visible:!0})}getYear(){return this.year}getLayer(){return this.layer}getSource(){return this.source}}class ew{constructor({settings:t,onMapRenderCompleteOnce:e}){this.layerGroup=new Is,this.layers=new py({max:5,dispose:t=>{this.layerGroup.getLayers().remove(t.getLayer())}}),this.onYearChange=t=>{if(!t.maannousuInfo.enabled||!fy())return;const e=t.maannousuInfo.selectedLayer;if(i=e,!Object.values(Wp).includes(i))return void this.hideAllLayers();var i;const n=this.layers.get(e);if(n)this.setLayerVisible(n);else{const t=new tw(e);this.layers.set(e,t),t.getSource().once("tileloadend",()=>{this.onMapRenderCompleteOnce?.(()=>{this.setLayerVisible(t)})}),this.layerGroup.getLayers().push(t.getLayer())}},this.setLayerVisible=t=>{t.getLayer().setVisible(!0),this.layers.forEach(e=>{e.getYear()!==t.getYear()&&e.getLayer().isVisible()&&e.getLayer().setVisible(!1)})},this.hideAllLayers=()=>{this.layers.forEach(t=>{t.getLayer().setVisible(!1)})},this.removeAllLayers=()=>{this.layers.clear()},this.onMapRenderCompleteOnce=e,this.onYearChange(t)}getLayerGroup(){return this.layerGroup}updateLayerVisibility(t){t.maannousuInfo.enabled?this.onYearChange(t):this.removeAllLayers()}opacityChanged(t){this.layerGroup.setOpacity(t.maannousuInfo.opacity)}}let iw;const nw=()=>{if(void 0!==iw)return iw;const t=navigator.userAgentData;return iw=!(!t||!t.mobile)||!!/Mobi|Android|iPhone|iPad/i.test(navigator.userAgent),iw};class aw{constructor(t,e){this.year=t,this.source=new Jx({sources:[{url:`https://maannousu.info/api/v2/${this.year}`,bands:[1]}],sourceOptions:{cacheSize:nw()?25:50},convertToRGB:!1,normalize:!0,interpolate:!1}),this.layer=new Ek({source:this.source,style:this.createStyle(e),visible:!0})}getYear(){return this.year}getLayer(){return this.layer}getSource(){return this.source}updateLayerStyle(t){this.layer.setStyle(this.createStyle(t))}createStyle(t){const e=[0,0,0,0];return{color:["match",["round",["*",["band",1],255]],0,[0,0,0,0],1,(()=>{switch(t.maanmittauslaitos.basemap.selectedLayer){case Np.Maastokartta:const e=t.mapZoom;if(e<=4.6)return[153,224,255,1];if(e>4.6&&e<7)return[153,255,255,1];if(e>=7)return[128,255,255,1];case Np.Taustakartta:return[201,236,250,1];case Np.Ortokuva:return[31,32,58,1];default:return[201,236,250,1]}})(),2,[255,255,255,1],255,e,e]}}}class sw{constructor({settings:t,onMapRenderCompleteOnce:e,updateTileLoadingStatus:i}){this.layerGroup=new Is,this.layers=new py({max:nw()?5:10,dispose:t=>{this.layerGroup.getLayers().remove(t.getLayer())}}),this.onYearChange=t=>{if(!t.maannousuInfo.enabled||!fy())return;const e=t.maannousuInfo.selectedLayer;if(parseInt(e)===(new Date).getFullYear())return void this.hideAllLayers();const i=e;this.updateTileLoadingStatus(!1);const n=this.layers.get(i);if(n)this.setLayerVisible(n);else{this.updateTileLoadingStatus(!0);const n=new aw(e,t);this.layers.set(i,n),n.getSource().once("tileloadend",()=>{this.onMapRenderCompleteOnce(()=>{this.setLayerVisible(n),this.updateTileLoadingStatus(!1)})}),this.layerGroup.getLayers().push(n.getLayer())}},this.setLayerVisible=t=>{t.getLayer().setVisible(!0),this.layers.forEach(e=>{e.getYear()!==t.getYear()&&e.getLayer().isVisible()&&e.getLayer().setVisible(!1)})},this.hideAllLayers=()=>{this.layers.forEach(t=>{t.getLayer().setVisible(!1)})},this.removeAllLayers=()=>{this.layers.clear()},this.onMapRenderCompleteOnce=e,this.updateTileLoadingStatus=i,this.onYearChange(t)}getLayerGroup(){return this.layerGroup}updateLayerVisibility(t){t.maannousuInfo.enabled?this.onYearChange(t):this.removeAllLayers()}opacityChanged(t){this.layerGroup.setOpacity(t.maannousuInfo.opacity)}onMaanmittauslaitosSelectedLayerChange(t){this.layers.forEach(e=>{e.updateLayerStyle(t)})}onZoomChanged(t){this.layers.forEach(e=>{e.updateLayerStyle(t)})}}function rw(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function ow(t,e,i){if(null!==t)for(var n,a,s,r,o,l,u,h,c=0,d=0,p=t.type,m="FeatureCollection"===p,f="Feature"===p,g=m?t.features.length:1,_=0;_<g;_++){o=(h=!!(u=m?t.features[_].geometry:f?t.geometry:t)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var y=0;y<o;y++){var k=0,v=0;if(null!==(r=h?u.geometries[y]:u)){l=r.coordinates;var x=r.type;switch(c=!i||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case"Point":if(!1===e(l,d,_,k,v))return!1;d++,k++;break;case"LineString":case"MultiPoint":for(n=0;n<l.length;n++){if(!1===e(l[n],d,_,k,v))return!1;d++,"MultiPoint"===x&&k++}"LineString"===x&&k++;break;case"Polygon":case"MultiLineString":for(n=0;n<l.length;n++){for(a=0;a<l[n].length-c;a++){if(!1===e(l[n][a],d,_,k,v))return!1;d++}"MultiLineString"===x&&k++,"Polygon"===x&&v++}"Polygon"===x&&k++;break;case"MultiPolygon":for(n=0;n<l.length;n++){for(v=0,a=0;a<l[n].length;a++){for(s=0;s<l[n][a].length-c;s++){if(!1===e(l[n][a][s],d,_,k,v))return!1;d++}v++}k++}break;case"GeometryCollection":for(n=0;n<r.geometries.length;n++)if(!1===ow(r.geometries[n],e,i))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}Math.PI;var lw=function(t,e={}){let i=0,n=0,a=0;return ow(t,function(t){i+=t[0],n+=t[1],a++},!0),function(t,e,i={}){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!rw(t[0])||!rw(t[1]))throw new Error("coordinates must contain numbers");return function(t,e,i={}){const n={type:"Feature"};return(0===i.id||i.id)&&(n.id=i.id),i.bbox&&(n.bbox=i.bbox),n.properties=e||{},n.geometry=t,n}({type:"Point",coordinates:t},e,i)}([i/a,n/a],e.properties)};const uw={Point:function(t){let e;return e=void 0!==t.m&&void 0!==t.z?new en([t.x,t.y,t.z,t.m],"XYZM"):void 0!==t.z?new en([t.x,t.y,t.z],"XYZ"):void 0!==t.m?new en([t.x,t.y,t.m],"XYM"):new en([t.x,t.y]),e},LineString:function(t){const e=dw(t);return new ju(t.paths[0],e)},Polygon:function(t){const e=dw(t);return new kn(t.rings,e)},MultiPoint:function(t){const e=dw(t);return new Fu(t.points,e)},MultiLineString:function(t){const e=dw(t);return new Gu(t.paths,e)},MultiPolygon:function(t){const e=dw(t);return new Wu(t.rings,e)}},hw={Point:function(t,e){const i=t.getCoordinates();let n;const a=t.getLayout();if("XYZ"===a)n={x:i[0],y:i[1],z:i[2]};else if("XYM"===a)n={x:i[0],y:i[1],m:i[2]};else if("XYZM"===a)n={x:i[0],y:i[1],z:i[2],m:i[3]};else{if("XY"!==a)throw new Error("Invalid geometry layout");n={x:i[0],y:i[1]}}return n},LineString:function(t,e){const i=pw(t);return{hasZ:i.hasZ,hasM:i.hasM,paths:[t.getCoordinates()]}},Polygon:function(t,e){const i=pw(t);return{hasZ:i.hasZ,hasM:i.hasM,rings:t.getCoordinates(!1)}},MultiPoint:function(t,e){const i=pw(t);return{hasZ:i.hasZ,hasM:i.hasM,points:t.getCoordinates()}},MultiLineString:function(t,e){const i=pw(t);return{hasZ:i.hasZ,hasM:i.hasM,paths:t.getCoordinates()}},MultiPolygon:function(t,e){const i=pw(t),n=t.getCoordinates(!1),a=[];for(let t=0;t<n.length;t++)for(let e=n[t].length-1;e>=0;e--)a.push(n[t][e]);return{hasZ:i.hasZ,hasM:i.hasM,rings:a}}};function cw(t,e){if(!t)return null;let i;if("number"==typeof t.x&&"number"==typeof t.y)i="Point";else if(t.points)i="MultiPoint";else if(t.paths)i=1===t.paths.length?"LineString":"MultiLineString";else if(t.rings){const e=t,n=dw(e),a=function(t,e){const i=[],n=[],a=[];let s,r;for(s=0,r=t.length;s<r;++s)i.length=0,Hi(i,0,t[s],e.length),pn(i,0,i.length,e.length)?n.push([t[s]]):a.push(t[s]);for(;a.length;){const t=a.shift();let e=!1;for(s=n.length-1;s>=0;s--){const i=n[s][0];if(Z(new Qi(i).getExtent(),new Qi(t).getExtent())){n[s].push(t),e=!0;break}}e||n.push([t.reverse()])}return n}(e.rings,n);1===a.length?(i="Polygon",t=Object.assign({},t,{rings:a[0]})):(i="MultiPolygon",t=Object.assign({},t,{rings:a}))}return Ku((0,uw[i])(t),!1,e)}function dw(t){let e="XY";return!0===t.hasZ&&!0===t.hasM?e="XYZM":!0===t.hasZ?e="XYZ":!0===t.hasM&&(e="XYM"),e}function pw(t){const e=t.getLayout();return{hasZ:"XYZ"===e||"XYZM"===e,hasM:"XYM"===e||"XYZM"===e}}function mw(t,e){return(0,hw[t.getType()])(Ku(t,!0,e),e)}const fw=new class extends qu{constructor(t){t=t||{},super(),this.geometryName_=t.geometryName}readFeatureFromObject(t,e,i){const n=t,a=cw(n.geometry,e),s=new K;if(this.geometryName_&&s.setGeometryName(this.geometryName_),s.setGeometry(a),n.attributes){s.setProperties(n.attributes,!0);const t=n.attributes[i];void 0!==t&&s.setId(t)}return s}readFeaturesFromObject(t,e){if(e=e||{},t.features){const i=[],n=t.features;for(let a=0,s=n.length;a<s;++a)i.push(this.readFeatureFromObject(n[a],e,t.objectIdFieldName));return i}return[this.readFeatureFromObject(t,e)]}readGeometryFromObject(t,e){return cw(t,e)}readProjectionFromObject(t){return t.spatialReference&&void 0!==t.spatialReference.wkid?Ye("EPSG:"+t.spatialReference.wkid):null}writeGeometryObject(t,e){return mw(t,this.adaptOptions(e))}writeFeatureObject(t,e){e=this.adaptOptions(e);const i={};if(!t.hasProperties())return i.attributes={},i;const n=t.getProperties(),a=t.getGeometry();if(a){i.geometry=mw(a,e);const s=e&&(e.dataProjection||e.featureProjection);s&&(i.geometry.spatialReference={wkid:Number(Ye(s).getCode().split(":").pop())}),delete n[t.getGeometryName()]}return S(n)?i.attributes={}:i.attributes=n,i}writeFeaturesObject(t,e){e=this.adaptOptions(e);const i=[];for(let n=0,a=t.length;n<a;++n)i.push(this.writeFeatureObject(t[n],e));return{features:i}}},gw=new Qu,_w=t=>gw.writeFeaturesObject(fw.readFeatures(t)).features[0],yw=(t,e)=>{if(Zp(e)){if(cm(e))return Rw(e.properties.nimi);if(dm(e))return Rw(e.properties.Nimi);if(Cm(e)||lm(e)||um(e)||hm(e)||om(e)||rm(e))return Rw(e.properties.kohdenimi);if(pm(e)||mm(e))return Rw(e.properties.VARK_nimi);if(r_(e)){const{laji:i,lajinumero:n,yksikko:a}=e.properties,s=t(`data.helsinki.yksikkoLaji.${i}`,{defaultValue:i});return`${n} ${t(`data.helsinki.yksikko.${a}`,{defaultValue:a??s})}`.trim()}if(o_(e)){const{tukikohtanumero:i,kohdetyyppi:n}=e.properties;return`${i} ${t(`data.helsinki.kohdetyyppi.${n}`,{defaultValue:n})}`}if(l_(e)){const{tukikohtanumero:i,lajinumero:n,rajaustyyppi:a}=e.properties;return`${n??i} ${t(`data.helsinki.rajaustyyppi.${a}`,{defaultValue:a})}`}if(qp(e))return`${e.properties.name}, ${e.properties.registerName}`;if(Om(e))return e.properties.name;if(Fm(e))return t(`data.viabundus.road.${e.properties.roadType}`);if(Nm(e))return e.properties.name}else if(Zf(e))switch(e.layerName){case Bp.Fornminnen:return`${Rw(e.attributes["Fornlmnings ID"])} ${[Rw(e.attributes.Namn),e.attributes.typeAndDating?.map(({Und_typ:e})=>t(`data.ahvenanmaa.subType.${e}`,e??"")).filter(t=>!!t).join(", ")??""].filter(t=>!!t).join(", ")}`;case Bp.MaritimaFornminnen:return`${Rw(e.attributes.MfornID)} ${Rw(e.attributes.Namn)}`}return""},kw=(t,e=!1)=>`images/${t}${e?"_3d":""}.png`,vw=t=>{switch(t){case Up.Muinaisjaannokset_piste:return["images/muinaisjaannos_kohde.png"];case Up.Muinaisjaannokset_alue:return["images/muinaisjaannos_alue.png"];case Up.Muu_kulttuuriperintokohde_piste:return["images/muu_kulttuuriperintokohde_kohde.png"];case Up.Muu_kulttuuriperintokohde_alue:return["images/muu-kulttuuriperintokohde-alue.png"];case Up.RKY_alue:return["images/rky_alue.png"];case Up.RKY_viiva:return["images/rky_viiva.png"];case Up.RKY_piste:return["images/rky_piste.png"];case Up.Maailmanperinto_alue:return["images/maailmanperinto_alue.png"];case Up.Maailmanperinto_piste:return["images/maailmanperinto_piste.png"];case Up.Suojellut_rakennukset_alue:return["images/rakennusperintorekisteri_alue.png"];case Up.Suojellut_rakennukset_piste:return["images/rakennusperintorekisteri_rakennus.png"];case Up.VARK_pisteet:return["images/vark_piste.png"];case Up.VARK_alueet:return["images/vark_alue.png"];case Up.Lytpaikka_piste:return["images/loytopaikka_piste.png"];case Up.Lytpaikka_alue:return["images/loytopaikka_alue.png"];case Up.Havaintokohde_piste:return[kw("havaintokohde_piste")];case Up.Havaintokohde_alue:return[kw("havaintokohde_alue")];case Up.Luonnonmuodostuma_piste:return[kw("luonnonmuodostuma_piste")];case Up.Luonnonmuodostuma_alue:return[kw("luonnonmuodostuma_alue")];case Up.Mahdollinen_muinaisjnns_piste:return[kw("mahdollinen_muinaisjaannos_piste")];case Up.Mahdollinen_muinaisjnns_alue:return[kw("mahdollinen_muinaisjaannos_alue")];case Up.Muu_kohde_piste:return[kw("muu_kohde_piste")];case Up.Muu_kohde_alue:return[kw("muu_kohde_alue")];case Up.PoistettuKiinteMuijaisjnnsPiste:return[kw("poistettu_kiintea_muinaisjaannos_piste")];case Up.PoistettuKiinteMuijaisjnnsAlue:return[kw("poistettu_kiintea_muinaisjaannos_alue")];case Up.Alakohde_piste:return[kw("alakohde_piste")];case Bp.Fornminnen:return["images/ahvenanmaa_muinaisjaannos.png"];case Bp.MaritimaFornminnen:return["images/ahvenanmaa_hylky.png"];case Vp.ModelLayer:return["images/3d_malli_circle.png","images/3d_malli_square.png"];case Kp.MaisemanMuisti:return["images/maiseman-muisti.png"];case $p.Maalinnoitus_kohteet:return["images/maalinnoitus-asema.png","images/maalinnoitus-luola.png","images/maalinnoitus-tykkitie.png","images/maalinnoitus-tykkipatteri.png"];case $p.Maalinnoitus_rajaukset:return["images/maalinnoitus-tukikohdan-raja.png","images/maalinnoitus-puolustusaseman-raja.png"];case $p.Maalinnoitus_karttatekstit:return["images/maalinnoitus-teksti-viite.png"];case $p.Maalinnoitus_yksikot:return["images/maalinnoitus-yksikko.png"];case Yp.Viabundus:return["images/viabundus-kaupunki.png"]}},xw=t=>{if(Zp(t)){if(Cm(t))return String(t.properties.mjtunnus);if(lm(t)||um(t)||hm(t))return String(t.properties.ID);if(dm(t)||cm(t))return String(t.properties.OBJECTID);if(om(t)||rm(t))return String(t.properties.KOHDEID);if(pm(t)||mm(t))return String(t.properties.VARK_ID);if(r_(t)||o_(t)||l_(t))return String(t.properties.id);if(qp(t))return String(t.properties.id);if(Om(t)||Fm(t))return`${t.properties.type}-${t.properties.id}`;if(Nm(t))return`${t.properties.type}-${t.properties.nodesid}`}else if(Zf(t))switch(t.layerName){case Bp.Fornminnen:return t.attributes["Fornlmnings ID"];case Bp.MaritimaFornminnen:return t.attributes.MfornID}throw new Error(`Tuntematon feature: ${JSON.stringify(t)}`)},ww=(t,e)=>{let i=`https://www.kyppi.fi/palveluikkuna/mjreki/read/asp/r_kohde_det.aspx?KOHDE_ID=${t}`;return e===Op.SV&&(i=i.replace("r_kohde_det.aspx","rsv_kohde_det.aspx")),i},bw=t=>{if(Zp(t)){if(im(t))return Up.Muinaisjaannokset_piste;if(nm(t))return Up.Muinaisjaannokset_alue;if(am(t))return Up.Muu_kulttuuriperintokohde_piste;if(sm(t))return Up.Muu_kulttuuriperintokohde_alue;if(rm(t))return Up.Suojellut_rakennukset_piste;if(om(t))return Up.Suojellut_rakennukset_alue;if(lm(t))return Up.RKY_alue;if(um(t))return Up.RKY_piste;if(hm(t))return Up.RKY_viiva;if(dm(t))return Up.Maailmanperinto_alue;if(cm(t))return Up.Maailmanperinto_piste;if(pm(t))return Up.VARK_pisteet;if(mm(t))return Up.VARK_alueet;if(fm(t))return Up.Lytpaikka_piste;if(gm(t))return Up.Lytpaikka_alue;if(_m(t))return Up.Muu_kohde_piste;if(ym(t))return Up.Muu_kohde_alue;if(km(t))return Up.Luonnonmuodostuma_piste;if(vm(t))return Up.Luonnonmuodostuma_alue;if(wm(t))return Up.Havaintokohde_piste;if(bm(t))return Up.Havaintokohde_alue;if(Em(t))return Up.Mahdollinen_muinaisjnns_piste;if(Mm(t))return Up.Mahdollinen_muinaisjnns_alue;if(Tm(t))return Up.PoistettuKiinteMuijaisjnnsPiste;if(Sm(t))return Up.PoistettuKiinteMuijaisjnnsAlue;if(xm(t))return Up.Alakohde_piste;if(r_(t))return $p.Maalinnoitus_yksikot;if(o_(t))return $p.Maalinnoitus_kohteet;if(l_(t))return $p.Maalinnoitus_rajaukset;if((t=>t.id?.toString().startsWith("Maalinnoitus_karttatekstit.")??!1)(t))return $p.Maalinnoitus_karttatekstit;if(qp(t))return Kp.MaisemanMuisti;if(jp(t))return Vp.ModelLayer;if(Gm(t))return Yp.Viabundus}if(Jp(t)&&Zf(t))return t.layerName;throw new Error(`Tuntematon feature ${JSON.stringify(t)}`)},Ew=t=>{if(Zp(t))return Mw(t);if(Jp(t)){const e=_w(t);return Mw(e)}},Mw=t=>{switch(t.geometry.type){case"Point":return t.geometry.coordinates;case"MultiPoint":case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":case"GeometryCollection":return lw(t).geometry.coordinates}},Tw=t=>Object.values(Qp).includes(t),Sw=t=>(Lm(t)?[t.properties.tyyppi]:pm(t)||mm(t)?[t.properties.Tyyppi]:[]).flatMap(t=>Rw(t).replace("taide, muistomerkit","taide-muistomerkit").split(", ").map(t=>"taide-muistomerkit"===t?"taide, muistomerkit":t)),Cw=t=>{const e=(Lm(t)?[t.properties.alatyyppi]:pm(t)||mm(t)?[t.properties.Alatyyppi]:[]).flatMap(t=>Rw(t).replace("rajamerkit, puu","rajamerkit-puu").split(", ").map(t=>"rajamerkit-puu"===t?"rajamerkit, puu":t));return e.length>1?e.filter(t=>"ei mritelty"!==t):e},Lw=t=>{const e=(Lm(t)?[t.properties.ajoitus]:pm(t)||mm(t)?[t.properties.Ajoitus,t.properties.Ajoitus2]:[]).flatMap(t=>Rw(t).split(", "));return e.length>1?e.filter(t=>t!==tm.eiMritelty):e},Rw=t=>t?"null"===(t=t.trim()).toLowerCase()?"":t.split(", ").map(t=>t.trim()).filter(t=>!!t).map(t=>t.replace(",","")).filter(t=>!!t).join(", "):"";class Iw{constructor(t){this.featuresForRegisterId=new Map,this.fetchGeoJson=async t=>{const e=await fetch(t.maisemanMuisti.url.geojson);return await e.json()},this.updateLayerSource=async t=>{const e=await this.fetchGeoJson(t);e.features.forEach(t=>{const e=t.properties.id.toString(),i=this.featuresForRegisterId.get(e);i?i.push(t):this.featuresForRegisterId.set(e,[t])}),this.source=new zg({features:(new Qu).readFeatures(e)}),this.layer.setSource(this.source)},this.updateLayerVisibility=t=>{const{maisemanMuisti:{enabled:e}}=t;this.layer.setVisible(e)},this.getFeaturesForFeatureRegisterId=t=>this.featuresForRegisterId.get(t)||[],this.addMaisemanMuistiFeaturesToFeature=t=>({...t,maisemanMuisti:this.getFeaturesForFeatureRegisterId(xw(t))}),this.getLayer=()=>this.layer,this.style=new Hl({image:new Sl({fill:new Il({color:"#f1615b"}),stroke:new Fl({color:"black",width:1}),points:5,radius:15,radius2:8,angle:0})}),this.source=new zg({features:[]}),this.layer=new Dg({source:this.source,style:this.style,visible:t.maisemanMuisti.enabled}),this.updateLayerSource(t)}}class Pw{constructor(t){this.featuresForRegisterId=new Map,this.fetchGeoJson=async t=>{const e=await fetch(t.models.url.geojson);return await e.json()},this.styleForFeature=t=>{switch(t.getGeometry()?.getType()){case"Point":{const e=t.getProperties();return e.registryItem.type===Up.Muinaisjaannokset_piste?this.stylePointCircle:e.registryItem.type===Up.Suojellut_rakennukset_piste?this.stylePointSquare:this.stylePointCircle}case"Polygon":return this.stylePolygon;default:return this.stylePointCircle}},this.updateLayerSource=async t=>{const e=await this.fetchGeoJson(t);e.features.forEach(t=>{const e=t.properties.registryItem.id.toString(),i=this.featuresForRegisterId.get(e);i?i.push(t):this.featuresForRegisterId.set(e,[t])}),this.source=new zg({features:(new Qu).readFeatures(e)}),this.layer.setSource(this.source)},this.updateLayerVisibility=t=>{const{models:{enabled:e}}=t;this.layer.setVisible(e)},this.getFeaturesForFeatureRegisterId=(t,e)=>(this.featuresForRegisterId.get(t)||[]).filter(t=>t.properties.registryItem.type===e),this.addModelsToFeature=t=>({...t,models:this.getFeaturesForFeatureRegisterId(xw(t),bw(t))}),this.getLayer=()=>this.layer,this.stylePointCircle=new Hl({image:new Ll({stroke:new Fl({color:"black",width:2}),radius:7})}),this.stylePointSquare=new Hl({image:new Sl({stroke:new Fl({color:"black",width:2}),points:4,radius:7,angle:Math.PI/4})}),this.stylePolygon=new Hl({stroke:new Fl({color:"black",width:4}),fill:new Il({color:"rgba(255, 255, 255, 0.01)"})}),this.source=new zg({features:[]}),this.layer=new Dg({source:this.source,visible:t.models.enabled,style:this.styleForFeature}),this.updateLayerSource(t)}}const Aw={type:"FeatureCollection",features:[]};class jw{constructor(t,e){this.createSource=t=>{const{url:e,selectedLayers:i}=t.museovirasto,n={urls:[e.wms],params:{LAYERS:i.join(","),TILED:!0,CQL_FILTER:this.getLayerFilter(t)},serverType:"geoserver"},a=new e_(n);return a.on("tileloadstart",()=>{this.updateTileLoadingStatus(!0)}),a.on("tileloadend",()=>{this.updateTileLoadingStatus(!1)}),a.on("tileloaderror",()=>{this.updateTileLoadingStatus(!1)}),a},this.updateLayerSource=t=>{this.source=this.createSource(t),this.layer.setSource(this.source),this.updateLayerVisibility(t)},this.updateLayerVisibility=t=>{const{museovirasto:{selectedLayers:e,enabled:i}}=t;this.layer.setVisible(i&&e.length>0)},this.selectedFeatureLayersChanged=t=>{this.updateLayerSource(t)},this.selectedMuinaisjaannosTypesChanged=t=>{this.updateLayerSource(t)},this.selectedMuinaisjaannosDatingsChanged=t=>{this.updateLayerSource(t)},this.identifyFeaturesAt=async(t,e,i,n)=>{if(!this.source||void 0===e||0===n.museovirasto.selectedLayers.length||!n.museovirasto.enabled)return Aw;const a=this.source.getFeatureInfoUrl(t,e,i,{INFO_FORMAT:"application/json",QUERY_LAYERS:n.museovirasto.selectedLayers.join(","),FEATURE_COUNT:100,BUFFER:15});if(a){const t=await fetch(String(a));return await t.json()}return Aw},this.findFeatures=async(t,e)=>{if(!e.museovirasto.enabled)return Aw;let i=e.museovirasto.selectedLayers;if(i.includes(Up.Muinaisjaannokset_alue)&&(i=i.filter(t=>t!==Up.Muinaisjaannokset_alue)),0===i.length)return Aw;let n=!1;isNaN(parseInt(t))||(n=!0);const a=i.map(e=>{if(n){const i=(t=>{switch(t){case Up.Muinaisjaannokset_piste:case Up.Muinaisjaannokset_alue:case Up.Muu_kulttuuriperintokohde_alue:case Up.Muu_kulttuuriperintokohde_piste:case Up.Lytpaikka_piste:case Up.Lytpaikka_alue:case Up.Havaintokohde_piste:case Up.Havaintokohde_alue:case Up.Luonnonmuodostuma_piste:case Up.Luonnonmuodostuma_alue:case Up.Mahdollinen_muinaisjnns_piste:case Up.Mahdollinen_muinaisjnns_alue:case Up.Muu_kohde_piste:case Up.Muu_kohde_alue:case Up.PoistettuKiinteMuijaisjnnsPiste:case Up.PoistettuKiinteMuijaisjnnsAlue:case Up.Alakohde_piste:return"mjtunnus";case Up.Suojellut_rakennukset_alue:case Up.Suojellut_rakennukset_piste:return"KOHDEID";case Up.RKY_alue:case Up.RKY_piste:case Up.RKY_viiva:return"ID";case Up.VARK_pisteet:case Up.VARK_alueet:return"VARK_ID";case Up.Maailmanperinto_piste:case Up.Maailmanperinto_alue:return}})(e);return i?{layer:e,filter:`${i} = ${t}`}:void 0}return{layer:e,filter:`${Im(e)} ILIKE '%${t}%'`}}).filter(t=>!!t);return{type:"FeatureCollection",features:(await Promise.all(a.map(({layer:t,filter:i})=>{const n=new URLSearchParams({service:"WFS",acceptversions:"2.0.0",request:"GetFeature",typeNames:t,count:"50",outputFormat:"application/json",cql_filter:i}),a=new URL(e.museovirasto.url.wfs);return a.search=String(n),fetch(String(a)).then(t=>t.json())}))).flatMap(({features:t})=>t)}},this.opacityChanged=t=>{this.layer.setOpacity(t.museovirasto.opacity)},this.getLayerFilter=t=>{const{selectedLayers:e,selectedMuinaisjaannosDatings:i,selectedMuinaisjaannosTypes:n}=t.museovirasto,a=i.length!=Object.values(tm).length,s=n.length!=Object.values(Qp).length;return a||s?e.map(t=>{switch(t){case Up.Havaintokohde_piste:case Up.Luonnonmuodostuma_piste:case Up.Lytpaikka_piste:case Up.Mahdollinen_muinaisjnns_piste:case Up.Muu_kohde_piste:case Up.Muu_kulttuuriperintokohde_piste:case Up.PoistettuKiinteMuijaisjnnsPiste:case Up.Muinaisjaannokset_piste:{if(0===i.length||0===n.length)return"EXCLUDE";const t=[];if(a){const e=i.map(t=>`ajoitus LIKE '%${t}%'`).join(" OR ");t.push(`(${e})`)}if(s){const e=n.map(t=>`tyyppi LIKE '%${t}%'`).join(" OR ");t.push(`(${e})`)}return t.join(" AND ")}default:return"INCLUDE"}}).join(";"):""},this.getLayer=()=>this.layer,this.updateTileLoadingStatus=e,this.source=this.createSource(t),this.layer=new Ef({source:this.source}),this.opacityChanged(t),this.updateLayerVisibility(t)}}var Ow=i(7334),Fw=i.n(Ow);class Nw{constructor(t,e){this.updateLayerSource=async t=>{this.updateGeoJsonLoadingStatus(!0);const e=await this.fetchGeoJson(t);this.source=new zg({features:(new Qu).readFeatures(e)}),this.layer.setSource(this.source),this.updateGeoJsonLoadingStatus(!1)},this.fetchGeoJson=async t=>{const e=await fetch(t.viabundus.url.geojson);return await e.json()},this.updateLayerVisibility=t=>{const{viabundus:{enabled:e}}=t;this.layer.setVisible(e),e&&0===this.source?.getFeatures().length&&this.updateLayerSource(t)},this.opacityChanged=t=>{this.layer.setOpacity(t.viabundus.opacity)},this.yearChanged=Fw()(t=>{this.layer.setStyle(Jw(t))},200),this.findFeatures=(t,e)=>{if(!e.viabundus.enabled)return[];const i=new Qu,n=t.toLowerCase(),a=this.source?.getFeatures().filter(t=>t.getProperties().type===Pm.place||t.getProperties().type===Pm.road).filter(t=>Gw(t,e.viabundus.selectedYear)).filter(t=>t.getProperties().type===Pm.place?String(t.getProperties().name??"").toLowerCase().includes(n):t.getProperties().type===Pm.road?String(t.getProperties().descriptionFI??"").toLowerCase().includes(n)||String(t.getProperties().descriptionEN??"").toLowerCase().includes(n):void 0)??[];return this.removeDuplicateRoadFeatures(i.writeFeaturesObject(a).features)},this.getLayer=()=>this.layer,this.removeDuplicateRoadFeatures=t=>{const e=t.filter(t=>Fm(t)).reduce((t,e)=>t.some(t=>t.properties.roadType===e.properties.roadType&&t.properties.fromyear===e.properties.fromyear&&t.properties.toyear===e.properties.toyear&&t.properties.descriptionFI===e.properties.descriptionFI&&t.properties.descriptionEN===e.properties.descriptionEN)?t:[...t,e],[]);return[...t.filter(t=>!Fm(t)),...e]},this.updateGeoJsonLoadingStatus=e,this.source=new zg({features:[]}),this.layer=new Dg({source:this.source,style:Jw(t.viabundus.selectedYear),visible:!1,opacity:t.viabundus.opacity}),this.updateLayerVisibility(t)}}const Gw=(t,e)=>{const i=t.getProperties();switch(i.type){case Pm.place:return i.Is_Town?Dw(e,i.Town_From,i.Town_To):i.Is_Settlement?Dw(e,i.Settlement_From,i.Settlement_To):i.Is_Bridge?Dw(e,i.Bridge_From,i.Bridge_To):i.Is_Harbour?Dw(e,i.Harbour_From,i.Harbour_To):i.Is_Fair?Dw(e,i.Fair_From,i.Fair_To):!!i.Is_Toll&&Dw(e,i.Toll_From,i.Toll_To);case Pm.road:case Pm.townOutline:return Dw(e,i.fromyear,i.toyear)}},Dw=(t,e,i)=>!(e&&e>t||i&&i<t),Ww=new Hl({stroke:new Fl({color:"#cc0000",width:3})}),Hw=new Hl({stroke:new Fl({color:"#cc0000",width:3,lineDash:[20,5]})}),Uw=new Hl({stroke:new Fl({color:"#663300",width:3,lineDash:[20,5]})}),Bw=new Hl({stroke:new Fl({color:"#017acc",width:3})}),Vw=new Hl({stroke:new Fl({color:"#017acc",width:3,lineDash:[20,5]})}),Kw=new Hl({image:new jl({src:"images/viabundus-kaupunki.png",anchor:[.5,1]})}),zw=new Hl({image:new jl({src:"images/viabundus-asuttu-paikka.png",anchor:[.5,1]})}),$w=new Hl({image:new jl({src:"images/viabundus-satama.png",anchor:[.5,1]})}),Yw=new Hl({image:new jl({src:"images/viabundus-silta.png",anchor:[.5,1]})}),Xw=new Hl({image:new jl({src:"images/viabundus-markkinat.png",anchor:[.5,1]})}),qw=new Hl({image:new jl({src:"images/viabundus-tulli.png",anchor:[.5,1]})}),Zw=new Hl({stroke:new Fl({color:"#000000",width:1.5}),fill:new Il({color:"rgba(238, 218, 216, 0.5)"})}),Jw=t=>e=>{if(!Gw(e,t))return;const i=e.getProperties();switch(i.type){case Pm.place:return i.Is_Town?Kw:i.Is_Settlement?zw:i.Is_Bridge?Yw:i.Is_Harbour?$w:i.Is_Fair?Xw:i.Is_Toll?qw:void 0;case Pm.road:switch(i.roadType){case Am.land:return i.certainty===jm.Uncertain?Hw:Ww;case Am.winter:return Uw;case Am.coast:return i.certainty===jm.Uncertain?Vw:Bw;default:return Ww}case Pm.townOutline:return Zw;default:return}},Qw="EPSG:3067",tb=[385249.63630000036,6672695.7579];var eb=Symbol.for("immer-nothing"),ib=Symbol.for("immer-draftable"),nb=Symbol.for("immer-state");function ab(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var sb=Object.getPrototypeOf;function rb(t){return!!t&&!!t[nb]}function ob(t){return!!t&&(hb(t)||Array.isArray(t)||!!t[ib]||!!t.constructor?.[ib]||fb(t)||gb(t))}var lb=Object.prototype.constructor.toString(),ub=new WeakMap;function hb(t){if(!t||"object"!=typeof t)return!1;const e=Object.getPrototypeOf(t);if(null===e||e===Object.prototype)return!0;const i=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(i===Object)return!0;if("function"!=typeof i)return!1;let n=ub.get(i);return void 0===n&&(n=Function.toString.call(i),ub.set(i,n)),n===lb}function cb(t,e,i=!0){0===db(t)?(i?Reflect.ownKeys(t):Object.keys(t)).forEach(i=>{e(i,t[i],t)}):t.forEach((i,n)=>e(n,i,t))}function db(t){const e=t[nb];return e?e.type_:Array.isArray(t)?1:fb(t)?2:gb(t)?3:0}function pb(t,e){return 2===db(t)?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function mb(t,e,i){const n=db(t);2===n?t.set(e,i):3===n?t.add(i):t[e]=i}function fb(t){return t instanceof Map}function gb(t){return t instanceof Set}function _b(t){return t.copy_||t.base_}function yb(t,e){if(fb(t))return new Map(t);if(gb(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const i=hb(t);if(!0===e||"class_only"===e&&!i){const e=Object.getOwnPropertyDescriptors(t);delete e[nb];let i=Reflect.ownKeys(e);for(let n=0;n<i.length;n++){const a=i[n],s=e[a];!1===s.writable&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(e[a]={configurable:!0,writable:!0,enumerable:s.enumerable,value:t[a]})}return Object.create(sb(t),e)}{const e=sb(t);if(null!==e&&i)return{...t};const n=Object.create(e);return Object.assign(n,t)}}function kb(t,e=!1){return xb(t)||rb(t)||!ob(t)||(db(t)>1&&Object.defineProperties(t,{set:vb,add:vb,clear:vb,delete:vb}),Object.freeze(t),e&&Object.values(t).forEach(t=>kb(t,!0))),t}var vb={value:function(){ab(2)}};function xb(t){return null===t||"object"!=typeof t||Object.isFrozen(t)}var wb,bb={};function Eb(t){const e=bb[t];return e||ab(0),e}function Mb(){return wb}function Tb(t,e){e&&(Eb("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function Sb(t){Cb(t),t.drafts_.forEach(Rb),t.drafts_=null}function Cb(t){t===wb&&(wb=t.parent_)}function Lb(t){return wb={drafts_:[],parent_:wb,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Rb(t){const e=t[nb];0===e.type_||1===e.type_?e.revoke_():e.revoked_=!0}function Ib(t,e){e.unfinalizedDrafts_=e.drafts_.length;const i=e.drafts_[0];return void 0!==t&&t!==i?(i[nb].modified_&&(Sb(e),ab(4)),ob(t)&&(t=Pb(e,t),e.parent_||jb(e,t)),e.patches_&&Eb("Patches").generateReplacementPatches_(i[nb].base_,t,e.patches_,e.inversePatches_)):t=Pb(e,i,[]),Sb(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==eb?t:void 0}function Pb(t,e,i){if(xb(e))return e;const n=t.immer_.shouldUseStrictIteration(),a=e[nb];if(!a)return cb(e,(n,s)=>Ab(t,a,e,n,s,i),n),e;if(a.scope_!==t)return e;if(!a.modified_)return jb(t,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const e=a.copy_;let s=e,r=!1;3===a.type_&&(s=new Set(e),e.clear(),r=!0),cb(s,(n,s)=>Ab(t,a,e,n,s,i,r),n),jb(t,e,!1),i&&t.patches_&&Eb("Patches").generatePatches_(a,i,t.patches_,t.inversePatches_)}return a.copy_}function Ab(t,e,i,n,a,s,r){if(null==a)return;if("object"!=typeof a&&!r)return;const o=xb(a);if(!o||r){if(rb(a)){const r=Pb(t,a,s&&e&&3!==e.type_&&!pb(e.assigned_,n)?s.concat(n):void 0);if(mb(i,n,r),!rb(r))return;t.canAutoFreeze_=!1}else r&&i.add(a);if(ob(a)&&!o){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;if(e&&e.base_&&e.base_[n]===a&&o)return;Pb(t,a),e&&e.scope_.parent_||"symbol"==typeof n||!(fb(i)?i.has(n):Object.prototype.propertyIsEnumerable.call(i,n))||jb(t,a)}}}function jb(t,e,i=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&kb(e,i)}var Ob={get(t,e){if(e===nb)return t;const i=_b(t);if(!pb(i,e))return function(t,e,i){const n=Gb(e,i);return n?"value"in n?n.value:n.get?.call(t.draft_):void 0}(t,i,e);const n=i[e];return t.finalized_||!ob(n)?n:n===Nb(t.base_,e)?(Wb(t),t.copy_[e]=Hb(n,t)):n},has:(t,e)=>e in _b(t),ownKeys:t=>Reflect.ownKeys(_b(t)),set(t,e,i){const n=Gb(_b(t),e);if(n?.set)return n.set.call(t.draft_,i),!0;if(!t.modified_){const n=Nb(_b(t),e),r=n?.[nb];if(r&&r.base_===i)return t.copy_[e]=i,t.assigned_[e]=!1,!0;if(((a=i)===(s=n)?0!==a||1/a==1/s:a!=a&&s!=s)&&(void 0!==i||pb(t.base_,e)))return!0;Wb(t),Db(t)}var a,s;return t.copy_[e]===i&&(void 0!==i||e in t.copy_)||Number.isNaN(i)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=i,t.assigned_[e]=!0),!0},deleteProperty:(t,e)=>(void 0!==Nb(t.base_,e)||e in t.base_?(t.assigned_[e]=!1,Wb(t),Db(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0),getOwnPropertyDescriptor(t,e){const i=_b(t),n=Reflect.getOwnPropertyDescriptor(i,e);return n?{writable:!0,configurable:1!==t.type_||"length"!==e,enumerable:n.enumerable,value:i[e]}:n},defineProperty(){ab(11)},getPrototypeOf:t=>sb(t.base_),setPrototypeOf(){ab(12)}},Fb={};function Nb(t,e){const i=t[nb];return(i?_b(i):t)[e]}function Gb(t,e){if(!(e in t))return;let i=sb(t);for(;i;){const t=Object.getOwnPropertyDescriptor(i,e);if(t)return t;i=sb(i)}}function Db(t){t.modified_||(t.modified_=!0,t.parent_&&Db(t.parent_))}function Wb(t){t.copy_||(t.copy_=yb(t.base_,t.scope_.immer_.useStrictShallowCopy_))}function Hb(t,e){const i=fb(t)?Eb("MapSet").proxyMap_(t,e):gb(t)?Eb("MapSet").proxySet_(t,e):function(t,e){const i=Array.isArray(t),n={type_:i?1:0,scope_:e?e.scope_:Mb(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,s=Ob;i&&(a=[n],s=Fb);const{revoke:r,proxy:o}=Proxy.revocable(a,s);return n.draft_=o,n.revoke_=r,o}(t,e);return(e?e.scope_:Mb()).drafts_.push(i),i}function Ub(t){if(!ob(t)||xb(t))return t;const e=t[nb];let i,n=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,i=yb(t,e.scope_.immer_.useStrictShallowCopy_),n=e.scope_.immer_.shouldUseStrictIteration()}else i=yb(t,!0);return cb(i,(t,e)=>{mb(i,t,Ub(e))},n),e&&(e.finalized_=!1),i}cb(Ob,(t,e)=>{Fb[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}}),Fb.deleteProperty=function(t,e){return Fb.set.call(this,t,e,void 0)},Fb.set=function(t,e,i){return Ob.set.call(this,t[0],e,i,t[0])};var Bb=new class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,e,i)=>{if("function"==typeof t&&"function"!=typeof e){const i=e;e=t;const n=this;return function(t=i,...a){return n.produce(t,t=>e.call(this,t,...a))}}let n;if("function"!=typeof e&&ab(6),void 0!==i&&"function"!=typeof i&&ab(7),ob(t)){const a=Lb(this),s=Hb(t,void 0);let r=!0;try{n=e(s),r=!1}finally{r?Sb(a):Cb(a)}return Tb(a,i),Ib(n,a)}if(!t||"object"!=typeof t){if(n=e(t),void 0===n&&(n=t),n===eb&&(n=void 0),this.autoFreeze_&&kb(n,!0),i){const e=[],a=[];Eb("Patches").generateReplacementPatches_(t,n,e,a),i(e,a)}return n}ab(1)},this.produceWithPatches=(t,e)=>{if("function"==typeof t)return(e,...i)=>this.produceWithPatches(e,e=>t(e,...i));let i,n;return[this.produce(t,e,(t,e)=>{i=t,n=e}),i,n]},"boolean"==typeof t?.autoFreeze&&this.setAutoFreeze(t.autoFreeze),"boolean"==typeof t?.useStrictShallowCopy&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),"boolean"==typeof t?.useStrictIteration&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){var e;ob(t)||ab(8),rb(t)&&(rb(e=t)||ab(10),t=Ub(e));const i=Lb(this),n=Hb(t,void 0);return n[nb].isManual_=!0,Cb(i),n}finishDraft(t,e){const i=t&&t[nb];i&&i.isManual_||ab(9);const{scope_:n}=i;return Tb(n,e),Ib(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,e){let i;for(i=e.length-1;i>=0;i--){const n=e[i];if(0===n.path.length&&"replace"===n.op){t=n.value;break}}i>-1&&(e=e.slice(i+1));const n=Eb("Patches").applyPatches_;return rb(t)?n(t,e):this.produce(t,t=>n(t,e))}},Vb=(Bb.produce,Bb.setUseStrictIteration.bind(Bb));function Kb(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var zb=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")(),$b=()=>Math.random().toString(36).substring(7).split("").join("."),Yb={INIT:`@@redux/INIT${$b()}`,REPLACE:`@@redux/REPLACE${$b()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${$b()}`};function Xb(t){if("object"!=typeof t||null===t)return!1;let e=t;for(;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||null===Object.getPrototypeOf(t)}function qb(t,e,i){if("function"!=typeof t)throw new Error(Kb(2));if("function"==typeof e&&"function"==typeof i||"function"==typeof i&&"function"==typeof arguments[3])throw new Error(Kb(0));if("function"==typeof e&&void 0===i&&(i=e,e=void 0),void 0!==i){if("function"!=typeof i)throw new Error(Kb(1));return i(qb)(t,e)}let n=t,a=e,s=new Map,r=s,o=0,l=!1;function u(){r===s&&(r=new Map,s.forEach((t,e)=>{r.set(e,t)}))}function h(){if(l)throw new Error(Kb(3));return a}function c(t){if("function"!=typeof t)throw new Error(Kb(4));if(l)throw new Error(Kb(5));let e=!0;u();const i=o++;return r.set(i,t),function(){if(e){if(l)throw new Error(Kb(6));e=!1,u(),r.delete(i),s=null}}}function d(t){if(!Xb(t))throw new Error(Kb(7));if(void 0===t.type)throw new Error(Kb(8));if("string"!=typeof t.type)throw new Error(Kb(17));if(l)throw new Error(Kb(9));try{l=!0,a=n(a,t)}finally{l=!1}return(s=r).forEach(t=>{t()}),t}return d({type:Yb.INIT}),{dispatch:d,subscribe:c,getState:h,replaceReducer:function(t){if("function"!=typeof t)throw new Error(Kb(10));n=t,d({type:Yb.REPLACE})},[zb]:function(){const t=c;return{subscribe(e){if("object"!=typeof e||null===e)throw new Error(Kb(11));function i(){const t=e;t.next&&t.next(h())}return i(),{unsubscribe:t(i)}},[zb](){return this}}}}}function Zb(...t){return 0===t.length?t=>t:1===t.length?t[0]:t.reduce((t,e)=>(...i)=>t(e(...i)))}function Jb(t){return Xb(t)&&"type"in t&&"string"==typeof t.type}function Qb(t){return({dispatch:e,getState:i})=>n=>a=>"function"==typeof a?a(e,i,t):n(a)}var tE=Qb(),eE=Qb,iE="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?Zb:Zb.apply(null,arguments)};function nE(t,e){function i(...i){if(e){let n=e(...i);if(!n)throw new Error(DE(0));return{type:t,payload:n.payload,..."meta"in n&&{meta:n.meta},..."error"in n&&{error:n.error}}}return{type:t,payload:i[0]}}return i.toString=()=>`${t}`,i.type=t,i.match=e=>Jb(e)&&e.type===t,i}"undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__;var aE=class t extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,t.prototype)}static get[Symbol.species](){return t}concat(...t){return super.concat.apply(this,t)}prepend(...e){return 1===e.length&&Array.isArray(e[0])?new t(...e[0].concat(this)):new t(...e.concat(this))}},sE=t=>e=>{setTimeout(e,t)};function rE(t){const e=function(t){const{thunk:e=!0,immutableCheck:i=!0,serializableCheck:n=!0,actionCreatorCheck:a=!0}=t??{};let s=new aE;return e&&("boolean"==typeof e?s.push(tE):s.push(eE(e.extraArgument))),s},{reducer:i,middleware:n,devTools:a=!0,duplicateMiddlewareCheck:s=!0,preloadedState:r,enhancers:o}=t||{};let l,u;if("function"==typeof i)l=i;else{if(!Xb(i))throw new Error(DE(1));l=function(t){const e=Object.keys(t),i={};for(let n=0;n<e.length;n++){const a=e[n];"function"==typeof t[a]&&(i[a]=t[a])}const n=Object.keys(i);let a;try{!function(t){Object.keys(t).forEach(e=>{const i=t[e];if(void 0===i(void 0,{type:Yb.INIT}))throw new Error(Kb(12));if(void 0===i(void 0,{type:Yb.PROBE_UNKNOWN_ACTION()}))throw new Error(Kb(13))})}(i)}catch(t){a=t}return function(t={},e){if(a)throw a;let s=!1;const r={};for(let a=0;a<n.length;a++){const o=n[a],l=i[o],u=t[o],h=l(u,e);if(void 0===h)throw e&&e.type,new Error(Kb(14));r[o]=h,s=s||h!==u}return s=s||n.length!==Object.keys(t).length,s?r:t}}(i)}u="function"==typeof n?n(e):e();let h=Zb;a&&(h=iE({trace:!1,..."object"==typeof a&&a}));const c=function(...t){return e=>(i,n)=>{const a=e(i,n);let s=()=>{throw new Error(Kb(15))};const r={getState:a.getState,dispatch:(t,...e)=>s(t,...e)},o=t.map(t=>t(r));return s=Zb(...o)(a.dispatch),{...a,dispatch:s}}}(...u),d=(t=>function(e){const{autoBatch:i=!0}=e??{};let n=new aE(t);return i&&n.push(((t={type:"raf"})=>e=>(...i)=>{const n=e(...i);let a=!0,s=!1,r=!1;const o=new Set,l="tick"===t.type?queueMicrotask:"raf"===t.type?"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:sE(10):"callback"===t.type?t.queueNotification:sE(t.timeout),u=()=>{r=!1,s&&(s=!1,o.forEach(t=>t()))};return Object.assign({},n,{subscribe(t){const e=n.subscribe(()=>a&&t());return o.add(t),()=>{e(),o.delete(t)}},dispatch(t){try{return a=!t?.meta?.RTK_autoBatch,s=!a,s&&(r||(r=!0,l(u))),n.dispatch(t)}finally{a=!0}}})})("object"==typeof i?i:void 0)),n})(c);return qb(l,r,h(..."function"==typeof o?o(d):d()))}Vb(!1);var oE=(t=21)=>{let e="",i=t;for(;i--;)e+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return e},lE="listener",uE="completed",hE="cancelled",cE=`task-${hE}`,dE=`task-${uE}`,pE=`${lE}-${hE}`,mE=`${lE}-${uE}`,fE=class{constructor(t){this.code=t,this.message=`task ${hE} (reason: ${t})`}name="TaskAbortError";message},gE=(t,e)=>{if("function"!=typeof t)throw new TypeError(DE(32))},_E=()=>{},yE=(t,e=_E)=>(t.catch(e),t),kE=(t,e)=>(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)),vE=(t,e)=>{const i=t.signal;i.aborted||("reason"in i||Object.defineProperty(i,"reason",{enumerable:!0,value:e,configurable:!0,writable:!0}),t.abort(e))},xE=t=>{if(t.aborted){const{reason:e}=t;throw new fE(e)}};function wE(t,e){let i=_E;return new Promise((n,a)=>{const s=()=>a(new fE(t.reason));t.aborted?s():(i=kE(t,s),e.finally(()=>i()).then(n,a))}).finally(()=>{i=_E})}var bE=t=>e=>yE(wE(t,e).then(e=>(xE(t),e))),EE=t=>{const e=bE(t);return t=>e(new Promise(e=>setTimeout(e,t)))},{assign:ME}=Object,TE={},SE="listenerMiddleware",CE=(t,e)=>(i,n)=>{gE(i);const a=new AbortController;var s;s=a,kE(t,()=>vE(s,t.reason));const r=(async()=>{try{return await Promise.resolve(),{status:"ok",value:await(async()=>{xE(t),xE(a.signal);const e=await i({pause:bE(a.signal),delay:EE(a.signal),signal:a.signal});return xE(a.signal),e})()}}catch(t){return{status:t instanceof fE?"cancelled":"rejected",error:t}}finally{vE(a,dE)}})();return n?.autoJoin&&e.push(r.catch(_E)),{result:bE(t)(r),cancel(){vE(a,cE)}}},LE=t=>{let{type:e,actionCreator:i,matcher:n,predicate:a,effect:s}=t;if(e)a=nE(e).match;else if(i)e=i.type,a=i.match;else if(n)a=n;else if(!a)throw new Error(DE(21));return gE(s),{predicate:a,type:e,effect:s}},RE=ME(t=>{const{type:e,predicate:i,effect:n}=LE(t);return{id:oE(),effect:n,type:e,predicate:i,pending:new Set,unsubscribe:()=>{throw new Error(DE(22))}}},{withTypes:()=>RE}),IE=(t,e)=>{const{type:i,effect:n,predicate:a}=LE(e);return Array.from(t.values()).find(t=>("string"==typeof i?t.type===i:t.predicate===a)&&t.effect===n)},PE=t=>{t.pending.forEach(t=>{vE(t,pE)})},AE=(t,e,i)=>{try{t(e,i)}catch(t){setTimeout(()=>{throw t},0)}},jE=ME(nE(`${SE}/add`),{withTypes:()=>jE}),OE=nE(`${SE}/removeAll`),FE=ME(nE(`${SE}/remove`),{withTypes:()=>FE}),NE=(...t)=>{console.error(`${SE}/error`,...t)},GE=(t={})=>{const e=new Map,i=new Map,{extra:n,onError:a=NE}=t;gE(a);const s=t=>{return(i=IE(e,t)??RE(t)).unsubscribe=()=>e.delete(i.id),e.set(i.id,i),t=>{i.unsubscribe(),t?.cancelActive&&PE(i)};var i};ME(s,{withTypes:()=>s});const r=t=>{const i=IE(e,t);return i&&(i.unsubscribe(),t.cancelActive&&PE(i)),!!i};ME(r,{withTypes:()=>r});const o=async(t,r,o,l)=>{const u=new AbortController,h=((t,e)=>(i,n)=>yE((async(i,n)=>{xE(e);let a=()=>{};const s=[new Promise((e,n)=>{let s=t({predicate:i,effect:(t,i)=>{i.unsubscribe(),e([t,i.getState(),i.getOriginalState()])}});a=()=>{s(),n()}})];null!=n&&s.push(new Promise(t=>setTimeout(t,n,null)));try{const t=await wE(e,Promise.race(s));return xE(e),t}finally{a()}})(i,n)))(s,u.signal),c=[];try{t.pending.add(u),(t=>{const e=i.get(t)??0;i.set(t,e+1)})(t),await Promise.resolve(t.effect(r,ME({},o,{getOriginalState:l,condition:(t,e)=>h(t,e).then(Boolean),take:h,delay:EE(u.signal),pause:bE(u.signal),extra:n,signal:u.signal,fork:CE(u.signal,c),unsubscribe:t.unsubscribe,subscribe:()=>{e.set(t.id,t)},cancelActiveListeners:()=>{t.pending.forEach((t,e,i)=>{t!==u&&(vE(t,pE),i.delete(t))})},cancel:()=>{vE(u,pE),t.pending.delete(u)},throwIfCancelled:()=>{xE(u.signal)}})))}catch(t){t instanceof fE||AE(a,t,{raisedBy:"effect"})}finally{await Promise.all(c),vE(u,mE),(t=>{const e=i.get(t)??1;1===e?i.delete(t):i.set(t,e-1)})(t),t.pending.delete(u)}},l=((t,e)=>()=>{for(const t of e.keys())PE(t);t.clear()})(e,i);return{middleware:t=>i=>n=>{if(!Jb(n))return i(n);if(jE.match(n))return s(n.payload);if(OE.match(n))return void l();if(FE.match(n))return r(n.payload);let u=t.getState();const h=()=>{if(u===TE)throw new Error(DE(23));return u};let c;try{if(c=i(n),e.size>0){const i=t.getState(),s=Array.from(e.values());for(const e of s){let s=!1;try{s=e.predicate(n,i,u)}catch(t){s=!1,AE(a,t,{raisedBy:"predicate"})}s&&o(e,n,t,h)}}}finally{u=TE}return c},startListening:s,stopListening:r,clearListeners:l}};function DE(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}Symbol.for("rtk-state-proxy-original");const WE=(t,e)=>({...t,ahvenanmaa:{...t.ahvenanmaa,selectedLayers:e}}),HE=(t,e)=>({...t,ahvenanmaa:{...t.ahvenanmaa,opacity:e}}),UE=(t,e)=>({...t,ahvenanmaa:{...t.ahvenanmaa,enabled:e}}),BE=(t,e)=>({...t,gtk:{...t.gtk,selectedLayers:e}}),VE=(t,e)=>({...t,gtk:{...t.gtk,opacity:e}}),KE=(t,e)=>({...t,gtk:{...t.gtk,enabled:e}}),zE=(t,e)=>({...t,helsinki:{...t.helsinki,selectedLayers:e}}),$E=(t,e)=>({...t,helsinki:{...t.helsinki,opacity:e}}),YE=(t,e)=>({...t,helsinki:{...t.helsinki,enabled:e}}),XE=(t,e)=>({...t,linkedFeature:e}),qE=(t,e)=>({...t,maanmittauslaitos:{...t.maanmittauslaitos,basemap:{...t.maanmittauslaitos.basemap,selectedLayer:e}}}),ZE=(t,e)=>({...t,maanmittauslaitos:{...t.maanmittauslaitos,basemap:{...t.maanmittauslaitos.basemap,enabled:e}}}),JE=(t,e)=>({...t,maanmittauslaitos:{...t.maanmittauslaitos,vanhatKartat:{...t.maanmittauslaitos.vanhatKartat,selectedLayers:e}}}),QE=(t,e)=>({...t,maanmittauslaitos:{...t.maanmittauslaitos,vanhatKartat:{...t.maanmittauslaitos.vanhatKartat,opacity:e}}}),tM=(t,e)=>({...t,maanmittauslaitos:{...t.maanmittauslaitos,vanhatKartat:{...t.maanmittauslaitos.vanhatKartat,enabled:e}}}),eM=(t,e)=>({...t,maannousuInfo:{...t.maannousuInfo,selectedLayer:e}}),iM=(t,e)=>({...t,maannousuInfo:{...t.maannousuInfo,opacity:e}}),nM=(t,e)=>({...t,maannousuInfo:{...t.maannousuInfo,enabled:e}}),aM=(t,e)=>({...t,maannousuInfo:{...t.maannousuInfo,placement:e}}),sM=(t,e)=>({...t,maisemanMuisti:{...t.maisemanMuisti,enabled:e}}),rM=(t,e)=>({...t,models:{...t.models,enabled:e}}),oM=(t,e)=>({...t,museovirasto:{...t.museovirasto,selectedLayers:e}}),lM=(t,e)=>({...t,museovirasto:{...t.museovirasto,opacity:e}}),uM=(t,e)=>({...t,museovirasto:{...t.museovirasto,enabled:e}}),hM=(t,e)=>({...t,museovirasto:{...t.museovirasto,selectedMuinaisjaannosTypes:e}}),cM=(t,e)=>({...t,museovirasto:{...t.museovirasto,selectedMuinaisjaannosDatings:e}}),dM=(t,e)=>({...t,viabundus:{...t.viabundus,opacity:e}}),pM=(t,e)=>({...t,viabundus:{...t.viabundus,enabled:e}}),mM=(t,e)=>({...t,viabundus:{...t.viabundus,selectedYear:e}});var fM;!function(t){t.Search="searchPage",t.Info="infoPage",t.Settings="settingsPage",t.Details="detailsPage"}(fM||(fM={}));const gM=(t,e)=>({...t,language:e}),_M=(t,e)=>{if(null==t)throw new Error("State must be defined");switch(e.type){case Dm.ZOOM_CHANGED:return{...t,mapZoom:e.zoom};case Dm.MAP_CENTER_CHANGED:return{...t,mapCenterCoordinates:e.coordinates};case Dm.SET_LINKED_FEATURE:return XE(t,e.linkedFeature);case Dm.MAP_FEATURE_IDENTIFICATION_COMPLETE:{const{identifiedMapFeatures:i}=e;return 0===i.features.length||t.identifiedMapFeatures?.requestTimestamp&&t.identifiedMapFeatures?.requestTimestamp>e.identifiedMapFeatures.requestTimestamp?t:{...t,visiblePage:fM.Details,identifiedMapFeatures:i}}case Dm.SEARCH_FEATURES:return{...t,search:void 0};case Dm.SEARCH_FEATURES_COMPLETE:return{...t,search:{features:e.searchResultFeatures}};case Dm.SELECT_VISIBLE_LAYERS:switch(e.layerGroup){case Fp.MMLPohjakartta:return qE(t,e.layer);case Fp.MMLVanhatKartat:return JE(t,e.layers);case Fp.GTK:return BE(t,e.layers);case Fp.MaannousuInfo:return eM(t,e.layer);case Fp.Helsinki:return zE(t,e.layers);case Fp.Museovirasto:return oM(t,e.layers);case Fp.Ahvenanmaa:return WE(t,e.layers);default:return t}case Dm.CHANGE_LAYER_OPACITY:switch(e.layerGroup){case Fp.MMLVanhatKartat:return QE(t,e.opacity);case Fp.GTK:return VE(t,e.opacity);case Fp.MaannousuInfo:return iM(t,e.opacity);case Fp.Museovirasto:return lM(t,e.opacity);case Fp.Ahvenanmaa:return HE(t,e.opacity);case Fp.Helsinki:return $E(t,e.opacity);case Fp.Viabundus:return dM(t,e.opacity);default:return t}case Dm.ENABLE_LAYER_GROUP:switch(e.layerGroup){case Fp.MMLPohjakartta:return ZE(t,e.enabled);case Fp.MMLVanhatKartat:return tM(t,e.enabled);case Fp.GTK:return KE(t,e.enabled);case Fp.MaannousuInfo:return nM(t,e.enabled);case Fp.Museovirasto:return uM(t,e.enabled);case Fp.Ahvenanmaa:return UE(t,e.enabled);case Fp.Helsinki:return YE(t,e.enabled);case Fp.Viabundus:return pM(t,e.enabled);case Fp.Models:return rM(t,e.enabled);case Fp.MaisemanMuisti:return sM(t,e.enabled);default:return t}case Dm.SELECT_VISIBLE_MUINAISJNNS_TYPE:return hM(t,e.types);case Dm.SELECT_VISIBLE_MUINAISJNNS_DATING:return cM(t,e.datings);case Dm.CHANGE_LANGUAGE:return gM(t,e.language);case Dm.SHOW_LOADING_ANIMATION:return((t,e)=>{const i=e?t.concurrentPendingJobsCounter+1:t.concurrentPendingJobsCounter-1;return{...t,concurrentPendingJobsCounter:i,showLoadingAnimation:i>0}})(t,e.show);case Dm.SHOW_PAGE:return{...t,visiblePage:e.pageId};case Dm.MOVE_MAANNOUSU_LAYER:return aM(t,e.placement);case Dm.SELECT_VIABUNDUS_YEAR:return mM(t,e.year);default:return t}};let yM,kM;const vM=t=>{kM.startListening(t)};i(6443),i(6378);const xM=t=>"string"==typeof t,wM=()=>{let t,e;const i=new Promise((i,n)=>{t=i,e=n});return i.resolve=t,i.reject=e,i},bM=t=>null==t?"":""+t,EM=/###/g,MM=t=>t&&t.indexOf("###")>-1?t.replace(EM,"."):t,TM=t=>!t||xM(t),SM=(t,e,i)=>{const n=xM(e)?e.split("."):e;let a=0;for(;a<n.length-1;){if(TM(t))return{};const e=MM(n[a]);!t[e]&&i&&(t[e]=new i),t=Object.prototype.hasOwnProperty.call(t,e)?t[e]:{},++a}return TM(t)?{}:{obj:t,k:MM(n[a])}},CM=(t,e,i)=>{const{obj:n,k:a}=SM(t,e,Object);if(void 0!==n||1===e.length)return void(n[a]=i);let s=e[e.length-1],r=e.slice(0,e.length-1),o=SM(t,r,Object);for(;void 0===o.obj&&r.length;)s=`${r[r.length-1]}.${s}`,r=r.slice(0,r.length-1),o=SM(t,r,Object),o?.obj&&void 0!==o.obj[`${o.k}.${s}`]&&(o.obj=void 0);o.obj[`${o.k}.${s}`]=i},LM=(t,e)=>{const{obj:i,k:n}=SM(t,e);if(i&&Object.prototype.hasOwnProperty.call(i,n))return i[n]},RM=(t,e,i)=>{for(const n in e)"__proto__"!==n&&"constructor"!==n&&(n in t?xM(t[n])||t[n]instanceof String||xM(e[n])||e[n]instanceof String?i&&(t[n]=e[n]):RM(t[n],e[n],i):t[n]=e[n]);return t},IM=t=>t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var PM={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const AM=t=>xM(t)?t.replace(/[&<>"'\/]/g,t=>PM[t]):t,jM=[" ",",","?","!",";"],OM=new class{constructor(t){this.capacity=t,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(t){const e=this.regExpMap.get(t);if(void 0!==e)return e;const i=new RegExp(t);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(t,i),this.regExpQueue.push(t),i}}(20),FM=(t,e,i=".")=>{if(!t)return;if(t[e]){if(!Object.prototype.hasOwnProperty.call(t,e))return;return t[e]}const n=e.split(i);let a=t;for(let t=0;t<n.length;){if(!a||"object"!=typeof a)return;let e,s="";for(let r=t;r<n.length;++r)if(r!==t&&(s+=i),s+=n[r],e=a[s],void 0!==e){if(["string","number","boolean"].indexOf(typeof e)>-1&&r<n.length-1)continue;t+=r-t+1;break}a=e}return a},NM=t=>t?.replace("_","-"),GM={type:"logger",log(t){this.output("log",t)},warn(t){this.output("warn",t)},error(t){this.output("error",t)},output(t,e){console?.[t]?.apply?.(console,e)}};class DM{constructor(t,e={}){this.init(t,e)}init(t,e={}){this.prefix=e.prefix||"i18next:",this.logger=t||GM,this.options=e,this.debug=e.debug}log(...t){return this.forward(t,"log","",!0)}warn(...t){return this.forward(t,"warn","",!0)}error(...t){return this.forward(t,"error","")}deprecate(...t){return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}forward(t,e,i,n){return n&&!this.debug?null:(xM(t[0])&&(t[0]=`${i}${this.prefix} ${t[0]}`),this.logger[e](t))}create(t){return new DM(this.logger,{prefix:`${this.prefix}:${t}:`,...this.options})}clone(t){return(t=t||this.options).prefix=t.prefix||this.prefix,new DM(this.logger,t)}}var WM=new DM;class HM{constructor(){this.observers={}}on(t,e){return t.split(" ").forEach(t=>{this.observers[t]||(this.observers[t]=new Map);const i=this.observers[t].get(e)||0;this.observers[t].set(e,i+1)}),this}off(t,e){this.observers[t]&&(e?this.observers[t].delete(e):delete this.observers[t])}emit(t,...e){this.observers[t]&&Array.from(this.observers[t].entries()).forEach(([t,i])=>{for(let n=0;n<i;n++)t(...e)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([i,n])=>{for(let a=0;a<n;a++)i.apply(i,[t,...e])})}}class UM extends HM{constructor(t,e={ns:["translation"],defaultNS:"translation"}){super(),this.data=t||{},this.options=e,void 0===this.options.keySeparator&&(this.options.keySeparator="."),void 0===this.options.ignoreJSONStructure&&(this.options.ignoreJSONStructure=!0)}addNamespaces(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}removeNamespaces(t){const e=this.options.ns.indexOf(t);e>-1&&this.options.ns.splice(e,1)}getResource(t,e,i,n={}){const a=void 0!==n.keySeparator?n.keySeparator:this.options.keySeparator,s=void 0!==n.ignoreJSONStructure?n.ignoreJSONStructure:this.options.ignoreJSONStructure;let r;t.indexOf(".")>-1?r=t.split("."):(r=[t,e],i&&(Array.isArray(i)?r.push(...i):xM(i)&&a?r.push(...i.split(a)):r.push(i)));const o=LM(this.data,r);return!o&&!e&&!i&&t.indexOf(".")>-1&&(t=r[0],e=r[1],i=r.slice(2).join(".")),!o&&s&&xM(i)?FM(this.data?.[t]?.[e],i,a):o}addResource(t,e,i,n,a={silent:!1}){const s=void 0!==a.keySeparator?a.keySeparator:this.options.keySeparator;let r=[t,e];i&&(r=r.concat(s?i.split(s):i)),t.indexOf(".")>-1&&(r=t.split("."),n=e,e=r[1]),this.addNamespaces(e),CM(this.data,r,n),a.silent||this.emit("added",t,e,i,n)}addResources(t,e,i,n={silent:!1}){for(const n in i)(xM(i[n])||Array.isArray(i[n]))&&this.addResource(t,e,n,i[n],{silent:!0});n.silent||this.emit("added",t,e,i)}addResourceBundle(t,e,i,n,a,s={silent:!1,skipCopy:!1}){let r=[t,e];t.indexOf(".")>-1&&(r=t.split("."),n=i,i=e,e=r[1]),this.addNamespaces(e);let o=LM(this.data,r)||{};s.skipCopy||(i=JSON.parse(JSON.stringify(i))),n?RM(o,i,a):o={...o,...i},CM(this.data,r,o),s.silent||this.emit("added",t,e,i)}removeResourceBundle(t,e){this.hasResourceBundle(t,e)&&delete this.data[t][e],this.removeNamespaces(e),this.emit("removed",t,e)}hasResourceBundle(t,e){return void 0!==this.getResource(t,e)}getResourceBundle(t,e){return e||(e=this.options.defaultNS),this.getResource(t,e)}getDataByLanguage(t){return this.data[t]}hasLanguageSomeTranslations(t){const e=this.getDataByLanguage(t);return!!(e&&Object.keys(e)||[]).find(t=>e[t]&&Object.keys(e[t]).length>0)}toJSON(){return this.data}}var BM={processors:{},addPostProcessor(t){this.processors[t.name]=t},handle(t,e,i,n,a){return t.forEach(t=>{e=this.processors[t]?.process(e,i,n,a)??e}),e}};const VM=Symbol("i18next/PATH_KEY");function KM(t,e){const{[VM]:i}=t(function(){const t=[],e=Object.create(null);let i;return e.get=(n,a)=>(i?.revoke?.(),a===VM?t:(t.push(a),i=Proxy.revocable(n,e),i.proxy)),Proxy.revocable(Object.create(null),e).proxy}());return i.join(e?.keySeparator??".")}const zM={},$M=t=>!xM(t)&&"boolean"!=typeof t&&"number"!=typeof t;class YM extends HM{constructor(t,e={}){super(),((t,e,i)=>{["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"].forEach(t=>{e[t]&&(i[t]=e[t])})})(0,t,this),this.options=e,void 0===this.options.keySeparator&&(this.options.keySeparator="."),this.logger=WM.create("translator")}changeLanguage(t){t&&(this.language=t)}exists(t,e={interpolation:{}}){const i={...e};if(null==t)return!1;const n=this.resolve(t,i);if(void 0===n?.res)return!1;const a=$M(n.res);return!1!==i.returnObjects||!a}extractFromKey(t,e){let i=void 0!==e.nsSeparator?e.nsSeparator:this.options.nsSeparator;void 0===i&&(i=":");const n=void 0!==e.keySeparator?e.keySeparator:this.options.keySeparator;let a=e.ns||this.options.defaultNS||[];const s=i&&t.indexOf(i)>-1,r=!(this.options.userDefinedKeySeparator||e.keySeparator||this.options.userDefinedNsSeparator||e.nsSeparator||((t,e,i)=>{e=e||"",i=i||"";const n=jM.filter(t=>e.indexOf(t)<0&&i.indexOf(t)<0);if(0===n.length)return!0;const a=OM.getRegExp(`(${n.map(t=>"?"===t?"\\?":t).join("|")})`);let s=!a.test(t);if(!s){const e=t.indexOf(i);e>0&&!a.test(t.substring(0,e))&&(s=!0)}return s})(t,i,n));if(s&&!r){const e=t.match(this.interpolator.nestingRegexp);if(e&&e.length>0)return{key:t,namespaces:xM(a)?[a]:a};const s=t.split(i);(i!==n||i===n&&this.options.ns.indexOf(s[0])>-1)&&(a=s.shift()),t=s.join(n)}return{key:t,namespaces:xM(a)?[a]:a}}translate(t,e,i){let n="object"==typeof e?{...e}:e;if("object"!=typeof n&&this.options.overloadTranslationOptionHandler&&(n=this.options.overloadTranslationOptionHandler(arguments)),"object"==typeof n&&(n={...n}),n||(n={}),null==t)return"";"function"==typeof t&&(t=KM(t,{...this.options,...n})),Array.isArray(t)||(t=[String(t)]);const a=void 0!==n.returnDetails?n.returnDetails:this.options.returnDetails,s=void 0!==n.keySeparator?n.keySeparator:this.options.keySeparator,{key:r,namespaces:o}=this.extractFromKey(t[t.length-1],n),l=o[o.length-1];let u=void 0!==n.nsSeparator?n.nsSeparator:this.options.nsSeparator;void 0===u&&(u=":");const h=n.lng||this.language,c=n.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if("cimode"===h?.toLowerCase())return c?a?{res:`${l}${u}${r}`,usedKey:r,exactUsedKey:r,usedLng:h,usedNS:l,usedParams:this.getUsedParamsDetails(n)}:`${l}${u}${r}`:a?{res:r,usedKey:r,exactUsedKey:r,usedLng:h,usedNS:l,usedParams:this.getUsedParamsDetails(n)}:r;const d=this.resolve(t,n);let p=d?.res;const m=d?.usedKey||r,f=d?.exactUsedKey||r,g=void 0!==n.joinArrays?n.joinArrays:this.options.joinArrays,_=!this.i18nFormat||this.i18nFormat.handleAsObject,y=void 0!==n.count&&!xM(n.count),k=YM.hasDefaultValue(n),v=y?this.pluralResolver.getSuffix(h,n.count,n):"",x=n.ordinal&&y?this.pluralResolver.getSuffix(h,n.count,{ordinal:!1}):"",w=y&&!n.ordinal&&0===n.count,b=w&&n[`defaultValue${this.options.pluralSeparator}zero`]||n[`defaultValue${v}`]||n[`defaultValue${x}`]||n.defaultValue;let E=p;_&&!p&&k&&(E=b);const M=$M(E),T=Object.prototype.toString.apply(E);if(!(_&&E&&M&&["[object Number]","[object Function]","[object RegExp]"].indexOf(T)<0)||xM(g)&&Array.isArray(E))if(_&&xM(g)&&Array.isArray(p))p=p.join(g),p&&(p=this.extendTranslation(p,t,n,i));else{let e=!1,a=!1;!this.isValidLookup(p)&&k&&(e=!0,p=b),this.isValidLookup(p)||(a=!0,p=r);const o=(n.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&a?void 0:p,c=k&&b!==p&&this.options.updateMissing;if(a||e||c){if(this.logger.log(c?"updateKey":"missingKey",h,l,r,c?b:p),s){const t=this.resolve(r,{...n,keySeparator:!1});t&&t.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let t=[];const e=this.languageUtils.getFallbackCodes(this.options.fallbackLng,n.lng||this.language);if("fallback"===this.options.saveMissingTo&&e&&e[0])for(let i=0;i<e.length;i++)t.push(e[i]);else"all"===this.options.saveMissingTo?t=this.languageUtils.toResolveHierarchy(n.lng||this.language):t.push(n.lng||this.language);const i=(t,e,i)=>{const a=k&&i!==p?i:o;this.options.missingKeyHandler?this.options.missingKeyHandler(t,l,e,a,c,n):this.backendConnector?.saveMissing&&this.backendConnector.saveMissing(t,l,e,a,c,n),this.emit("missingKey",t,l,e,p)};this.options.saveMissing&&(this.options.saveMissingPlurals&&y?t.forEach(t=>{const e=this.pluralResolver.getSuffixes(t,n);w&&n[`defaultValue${this.options.pluralSeparator}zero`]&&e.indexOf(`${this.options.pluralSeparator}zero`)<0&&e.push(`${this.options.pluralSeparator}zero`),e.forEach(e=>{i([t],r+e,n[`defaultValue${e}`]||b)})}):i(t,r,b))}p=this.extendTranslation(p,t,n,d,i),a&&p===r&&this.options.appendNamespaceToMissingKey&&(p=`${l}${u}${r}`),(a||e)&&this.options.parseMissingKeyHandler&&(p=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${l}${u}${r}`:r,e?p:void 0,n))}else{if(!n.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const t=this.options.returnedObjectHandler?this.options.returnedObjectHandler(m,E,{...n,ns:o}):`key '${r} (${this.language})' returned an object instead of string.`;return a?(d.res=t,d.usedParams=this.getUsedParamsDetails(n),d):t}if(s){const t=Array.isArray(E),e=t?[]:{},i=t?f:m;for(const t in E)if(Object.prototype.hasOwnProperty.call(E,t)){const a=`${i}${s}${t}`;e[t]=k&&!p?this.translate(a,{...n,defaultValue:$M(b)?b[t]:void 0,joinArrays:!1,ns:o}):this.translate(a,{...n,joinArrays:!1,ns:o}),e[t]===a&&(e[t]=E[t])}p=e}}return a?(d.res=p,d.usedParams=this.getUsedParamsDetails(n),d):p}extendTranslation(t,e,i,n,a){if(this.i18nFormat?.parse)t=this.i18nFormat.parse(t,{...this.options.interpolation.defaultVariables,...i},i.lng||this.language||n.usedLng,n.usedNS,n.usedKey,{resolved:n});else if(!i.skipInterpolation){i.interpolation&&this.interpolator.init({...i,interpolation:{...this.options.interpolation,...i.interpolation}});const s=xM(t)&&(void 0!==i?.interpolation?.skipOnVariables?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let r;if(s){const e=t.match(this.interpolator.nestingRegexp);r=e&&e.length}let o=i.replace&&!xM(i.replace)?i.replace:i;if(this.options.interpolation.defaultVariables&&(o={...this.options.interpolation.defaultVariables,...o}),t=this.interpolator.interpolate(t,o,i.lng||this.language||n.usedLng,i),s){const e=t.match(this.interpolator.nestingRegexp);r<(e&&e.length)&&(i.nest=!1)}!i.lng&&n&&n.res&&(i.lng=this.language||n.usedLng),!1!==i.nest&&(t=this.interpolator.nest(t,(...t)=>a?.[0]!==t[0]||i.context?this.translate(...t,e):(this.logger.warn(`It seems you are nesting recursively key: ${t[0]} in key: ${e[0]}`),null),i)),i.interpolation&&this.interpolator.reset()}const s=i.postProcess||this.options.postProcess,r=xM(s)?[s]:s;return null!=t&&r?.length&&!1!==i.applyPostProcessor&&(t=BM.handle(r,t,e,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...n,usedParams:this.getUsedParamsDetails(i)},...i}:i,this)),t}resolve(t,e={}){let i,n,a,s,r;return xM(t)&&(t=[t]),t.forEach(t=>{if(this.isValidLookup(i))return;const o=this.extractFromKey(t,e),l=o.key;n=l;let u=o.namespaces;this.options.fallbackNS&&(u=u.concat(this.options.fallbackNS));const h=void 0!==e.count&&!xM(e.count),c=h&&!e.ordinal&&0===e.count,d=void 0!==e.context&&(xM(e.context)||"number"==typeof e.context)&&""!==e.context,p=e.lngs?e.lngs:this.languageUtils.toResolveHierarchy(e.lng||this.language,e.fallbackLng);u.forEach(t=>{this.isValidLookup(i)||(r=t,zM[`${p[0]}-${t}`]||!this.utils?.hasLoadedNamespace||this.utils?.hasLoadedNamespace(r)||(zM[`${p[0]}-${t}`]=!0,this.logger.warn(`key "${n}" for languages "${p.join(", ")}" won't get resolved as namespace "${r}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),p.forEach(n=>{if(this.isValidLookup(i))return;s=n;const r=[l];if(this.i18nFormat?.addLookupKeys)this.i18nFormat.addLookupKeys(r,l,n,t,e);else{let t;h&&(t=this.pluralResolver.getSuffix(n,e.count,e));const i=`${this.options.pluralSeparator}zero`,a=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(h&&(e.ordinal&&0===t.indexOf(a)&&r.push(l+t.replace(a,this.options.pluralSeparator)),r.push(l+t),c&&r.push(l+i)),d){const n=`${l}${this.options.contextSeparator||"_"}${e.context}`;r.push(n),h&&(e.ordinal&&0===t.indexOf(a)&&r.push(n+t.replace(a,this.options.pluralSeparator)),r.push(n+t),c&&r.push(n+i))}}let o;for(;o=r.pop();)this.isValidLookup(i)||(a=o,i=this.getResource(n,t,o,e))}))})}),{res:i,usedKey:n,exactUsedKey:a,usedLng:s,usedNS:r}}isValidLookup(t){return!(void 0===t||!this.options.returnNull&&null===t||!this.options.returnEmptyString&&""===t)}getResource(t,e,i,n={}){return this.i18nFormat?.getResource?this.i18nFormat.getResource(t,e,i,n):this.resourceStore.getResource(t,e,i,n)}getUsedParamsDetails(t={}){const e=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],i=t.replace&&!xM(t.replace);let n=i?t.replace:t;if(i&&void 0!==t.count&&(n.count=t.count),this.options.interpolation.defaultVariables&&(n={...this.options.interpolation.defaultVariables,...n}),!i){n={...n};for(const t of e)delete n[t]}return n}static hasDefaultValue(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&"defaultValue"===e.substring(0,12)&&void 0!==t[e])return!0;return!1}}class XM{constructor(t){this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=WM.create("languageUtils")}getScriptPartFromCode(t){if(!(t=NM(t))||t.indexOf("-")<0)return null;const e=t.split("-");return 2===e.length?null:(e.pop(),"x"===e[e.length-1].toLowerCase()?null:this.formatLanguageCode(e.join("-")))}getLanguagePartFromCode(t){if(!(t=NM(t))||t.indexOf("-")<0)return t;const e=t.split("-");return this.formatLanguageCode(e[0])}formatLanguageCode(t){if(xM(t)&&t.indexOf("-")>-1){let e;try{e=Intl.getCanonicalLocales(t)[0]}catch(t){}return e&&this.options.lowerCaseLng&&(e=e.toLowerCase()),e||(this.options.lowerCaseLng?t.toLowerCase():t)}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}isSupportedCode(t){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}getBestMatchFromCodes(t){if(!t)return null;let e;return t.forEach(t=>{if(e)return;const i=this.formatLanguageCode(t);this.options.supportedLngs&&!this.isSupportedCode(i)||(e=i)}),!e&&this.options.supportedLngs&&t.forEach(t=>{if(e)return;const i=this.getScriptPartFromCode(t);if(this.isSupportedCode(i))return e=i;const n=this.getLanguagePartFromCode(t);if(this.isSupportedCode(n))return e=n;e=this.options.supportedLngs.find(t=>t===n?t:t.indexOf("-")<0&&n.indexOf("-")<0?void 0:t.indexOf("-")>0&&n.indexOf("-")<0&&t.substring(0,t.indexOf("-"))===n||0===t.indexOf(n)&&n.length>1?t:void 0)}),e||(e=this.getFallbackCodes(this.options.fallbackLng)[0]),e}getFallbackCodes(t,e){if(!t)return[];if("function"==typeof t&&(t=t(e)),xM(t)&&(t=[t]),Array.isArray(t))return t;if(!e)return t.default||[];let i=t[e];return i||(i=t[this.getScriptPartFromCode(e)]),i||(i=t[this.formatLanguageCode(e)]),i||(i=t[this.getLanguagePartFromCode(e)]),i||(i=t.default),i||[]}toResolveHierarchy(t,e){const i=this.getFallbackCodes((!1===e?[]:e)||this.options.fallbackLng||[],t),n=[],a=t=>{t&&(this.isSupportedCode(t)?n.push(t):this.logger.warn(`rejecting language code not found in supportedLngs: ${t}`))};return xM(t)&&(t.indexOf("-")>-1||t.indexOf("_")>-1)?("languageOnly"!==this.options.load&&a(this.formatLanguageCode(t)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&a(this.getScriptPartFromCode(t)),"currentOnly"!==this.options.load&&a(this.getLanguagePartFromCode(t))):xM(t)&&a(this.formatLanguageCode(t)),i.forEach(t=>{n.indexOf(t)<0&&a(this.formatLanguageCode(t))}),n}}const qM={zero:0,one:1,two:2,few:3,many:4,other:5},ZM={select:t=>1===t?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class JM{constructor(t,e={}){this.languageUtils=t,this.options=e,this.logger=WM.create("pluralResolver"),this.pluralRulesCache={}}addRule(t,e){this.rules[t]=e}clearCache(){this.pluralRulesCache={}}getRule(t,e={}){const i=NM("dev"===t?"en":t),n=e.ordinal?"ordinal":"cardinal",a=JSON.stringify({cleanedCode:i,type:n});if(a in this.pluralRulesCache)return this.pluralRulesCache[a];let s;try{s=new Intl.PluralRules(i,{type:n})}catch(i){if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),ZM;if(!t.match(/-|_/))return ZM;const n=this.languageUtils.getLanguagePartFromCode(t);s=this.getRule(n,e)}return this.pluralRulesCache[a]=s,s}needsPlural(t,e={}){let i=this.getRule(t,e);return i||(i=this.getRule("dev",e)),i?.resolvedOptions().pluralCategories.length>1}getPluralFormsOfKey(t,e,i={}){return this.getSuffixes(t,i).map(t=>`${e}${t}`)}getSuffixes(t,e={}){let i=this.getRule(t,e);return i||(i=this.getRule("dev",e)),i?i.resolvedOptions().pluralCategories.sort((t,e)=>qM[t]-qM[e]).map(t=>`${this.options.prepend}${e.ordinal?`ordinal${this.options.prepend}`:""}${t}`):[]}getSuffix(t,e,i={}){const n=this.getRule(t,i);return n?`${this.options.prepend}${i.ordinal?`ordinal${this.options.prepend}`:""}${n.select(e)}`:(this.logger.warn(`no plural rule found for: ${t}`),this.getSuffix("dev",e,i))}}const QM=(t,e,i,n=".",a=!0)=>{let s=((t,e,i)=>{const n=LM(t,i);return void 0!==n?n:LM(e,i)})(t,e,i);return!s&&a&&xM(i)&&(s=FM(t,i,n),void 0===s&&(s=FM(e,i,n))),s},tT=t=>t.replace(/\$/g,"$$$$");class eT{constructor(t={}){this.logger=WM.create("interpolator"),this.options=t,this.format=t?.interpolation?.format||(t=>t),this.init(t)}init(t={}){t.interpolation||(t.interpolation={escapeValue:!0});const{escape:e,escapeValue:i,useRawValueToEscape:n,prefix:a,prefixEscaped:s,suffix:r,suffixEscaped:o,formatSeparator:l,unescapeSuffix:u,unescapePrefix:h,nestingPrefix:c,nestingPrefixEscaped:d,nestingSuffix:p,nestingSuffixEscaped:m,nestingOptionsSeparator:f,maxReplaces:g,alwaysFormat:_}=t.interpolation;this.escape=void 0!==e?e:AM,this.escapeValue=void 0===i||i,this.useRawValueToEscape=void 0!==n&&n,this.prefix=a?IM(a):s||"{{",this.suffix=r?IM(r):o||"}}",this.formatSeparator=l||",",this.unescapePrefix=u?"":h||"-",this.unescapeSuffix=this.unescapePrefix?"":u||"",this.nestingPrefix=c?IM(c):d||IM("$t("),this.nestingSuffix=p?IM(p):m||IM(")"),this.nestingOptionsSeparator=f||",",this.maxReplaces=g||1e3,this.alwaysFormat=void 0!==_&&_,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const t=(t,e)=>t?.source===e?(t.lastIndex=0,t):new RegExp(e,"g");this.regexp=t(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=t(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=t(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(t,e,i,n){let a,s,r;const o=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},l=t=>{if(t.indexOf(this.formatSeparator)<0){const a=QM(e,o,t,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(a,void 0,i,{...n,...e,interpolationkey:t}):a}const a=t.split(this.formatSeparator),s=a.shift().trim(),r=a.join(this.formatSeparator).trim();return this.format(QM(e,o,s,this.options.keySeparator,this.options.ignoreJSONStructure),r,i,{...n,...e,interpolationkey:s})};this.resetRegExp();const u=n?.missingInterpolationHandler||this.options.missingInterpolationHandler,h=void 0!==n?.interpolation?.skipOnVariables?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:t=>tT(t)},{regex:this.regexp,safeValue:t=>this.escapeValue?tT(this.escape(t)):tT(t)}].forEach(e=>{for(r=0;a=e.regex.exec(t);){const i=a[1].trim();if(s=l(i),void 0===s)if("function"==typeof u){const e=u(t,a,n);s=xM(e)?e:""}else if(n&&Object.prototype.hasOwnProperty.call(n,i))s="";else{if(h){s=a[0];continue}this.logger.warn(`missed to pass in variable ${i} for interpolating ${t}`),s=""}else xM(s)||this.useRawValueToEscape||(s=bM(s));const o=e.safeValue(s);if(t=t.replace(a[0],o),h?(e.regex.lastIndex+=s.length,e.regex.lastIndex-=a[0].length):e.regex.lastIndex=0,r++,r>=this.maxReplaces)break}}),t}nest(t,e,i={}){let n,a,s;const r=(t,e)=>{const i=this.nestingOptionsSeparator;if(t.indexOf(i)<0)return t;const n=t.split(new RegExp(`${i}[ ]*{`));let a=`{${n[1]}`;t=n[0],a=this.interpolate(a,s);const r=a.match(/'/g),o=a.match(/"/g);((r?.length??0)%2==0&&!o||o.length%2!=0)&&(a=a.replace(/'/g,'"'));try{s=JSON.parse(a),e&&(s={...e,...s})}catch(e){return this.logger.warn(`failed parsing options string in nesting for key ${t}`,e),`${t}${i}${a}`}return s.defaultValue&&s.defaultValue.indexOf(this.prefix)>-1&&delete s.defaultValue,t};for(;n=this.nestingRegexp.exec(t);){let o=[];s={...i},s=s.replace&&!xM(s.replace)?s.replace:s,s.applyPostProcessor=!1,delete s.defaultValue;const l=/{.*}/.test(n[1])?n[1].lastIndexOf("}")+1:n[1].indexOf(this.formatSeparator);if(-1!==l&&(o=n[1].slice(l).split(this.formatSeparator).map(t=>t.trim()).filter(Boolean),n[1]=n[1].slice(0,l)),a=e(r.call(this,n[1].trim(),s),s),a&&n[0]===t&&!xM(a))return a;xM(a)||(a=bM(a)),a||(this.logger.warn(`missed to resolve ${n[1]} for nesting ${t}`),a=""),o.length&&(a=o.reduce((t,e)=>this.format(t,e,i.lng,{...i,interpolationkey:n[1].trim()}),a.trim())),t=t.replace(n[0],a),this.regexp.lastIndex=0}return t}}const iT=t=>{const e={};return(i,n,a)=>{let s=a;a&&a.interpolationkey&&a.formatParams&&a.formatParams[a.interpolationkey]&&a[a.interpolationkey]&&(s={...s,[a.interpolationkey]:void 0});const r=n+JSON.stringify(s);let o=e[r];return o||(o=t(NM(n),a),e[r]=o),o(i)}},nT=t=>(e,i,n)=>t(NM(i),n)(e);class aT{constructor(t={}){this.logger=WM.create("formatter"),this.options=t,this.init(t)}init(t,e={interpolation:{}}){this.formatSeparator=e.interpolation.formatSeparator||",";const i=e.cacheInBuiltFormats?iT:nT;this.formats={number:i((t,e)=>{const i=new Intl.NumberFormat(t,{...e});return t=>i.format(t)}),currency:i((t,e)=>{const i=new Intl.NumberFormat(t,{...e,style:"currency"});return t=>i.format(t)}),datetime:i((t,e)=>{const i=new Intl.DateTimeFormat(t,{...e});return t=>i.format(t)}),relativetime:i((t,e)=>{const i=new Intl.RelativeTimeFormat(t,{...e});return t=>i.format(t,e.range||"day")}),list:i((t,e)=>{const i=new Intl.ListFormat(t,{...e});return t=>i.format(t)})}}add(t,e){this.formats[t.toLowerCase().trim()]=e}addCached(t,e){this.formats[t.toLowerCase().trim()]=iT(e)}format(t,e,i,n={}){const a=e.split(this.formatSeparator);if(a.length>1&&a[0].indexOf("(")>1&&a[0].indexOf(")")<0&&a.find(t=>t.indexOf(")")>-1)){const t=a.findIndex(t=>t.indexOf(")")>-1);a[0]=[a[0],...a.splice(1,t)].join(this.formatSeparator)}const s=a.reduce((t,e)=>{const{formatName:a,formatOptions:s}=(t=>{let e=t.toLowerCase().trim();const i={};if(t.indexOf("(")>-1){const n=t.split("(");e=n[0].toLowerCase().trim();const a=n[1].substring(0,n[1].length-1);"currency"===e&&a.indexOf(":")<0?i.currency||(i.currency=a.trim()):"relativetime"===e&&a.indexOf(":")<0?i.range||(i.range=a.trim()):a.split(";").forEach(t=>{if(t){const[e,...n]=t.split(":"),a=n.join(":").trim().replace(/^'+|'+$/g,""),s=e.trim();i[s]||(i[s]=a),"false"===a&&(i[s]=!1),"true"===a&&(i[s]=!0),isNaN(a)||(i[s]=parseInt(a,10))}})}return{formatName:e,formatOptions:i}})(e);if(this.formats[a]){let e=t;try{const r=n?.formatParams?.[n.interpolationkey]||{},o=r.locale||r.lng||n.locale||n.lng||i;e=this.formats[a](t,o,{...s,...n,...r})}catch(t){this.logger.warn(t)}return e}return this.logger.warn(`there was no format function for ${a}`),t},t);return s}}class sT extends HM{constructor(t,e,i,n={}){super(),this.backend=t,this.store=e,this.services=i,this.languageUtils=i.languageUtils,this.options=n,this.logger=WM.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=n.maxParallelReads||10,this.readingCalls=0,this.maxRetries=n.maxRetries>=0?n.maxRetries:5,this.retryTimeout=n.retryTimeout>=1?n.retryTimeout:350,this.state={},this.queue=[],this.backend?.init?.(i,n.backend,n)}queueLoad(t,e,i,n){const a={},s={},r={},o={};return t.forEach(t=>{let n=!0;e.forEach(e=>{const r=`${t}|${e}`;!i.reload&&this.store.hasResourceBundle(t,e)?this.state[r]=2:this.state[r]<0||(1===this.state[r]?void 0===s[r]&&(s[r]=!0):(this.state[r]=1,n=!1,void 0===s[r]&&(s[r]=!0),void 0===a[r]&&(a[r]=!0),void 0===o[e]&&(o[e]=!0)))}),n||(r[t]=!0)}),(Object.keys(a).length||Object.keys(s).length)&&this.queue.push({pending:s,pendingCount:Object.keys(s).length,loaded:{},errors:[],callback:n}),{toLoad:Object.keys(a),pending:Object.keys(s),toLoadLanguages:Object.keys(r),toLoadNamespaces:Object.keys(o)}}loaded(t,e,i){const n=t.split("|"),a=n[0],s=n[1];e&&this.emit("failedLoading",a,s,e),!e&&i&&this.store.addResourceBundle(a,s,i,void 0,void 0,{skipCopy:!0}),this.state[t]=e?-1:2,e&&i&&(this.state[t]=0);const r={};this.queue.forEach(i=>{((t,e,i)=>{const{obj:n,k:a}=SM(t,e,Object);n[a]=n[a]||[],n[a].push(i)})(i.loaded,[a],s),((t,e)=>{void 0!==t.pending[e]&&(delete t.pending[e],t.pendingCount--)})(i,t),e&&i.errors.push(e),0!==i.pendingCount||i.done||(Object.keys(i.loaded).forEach(t=>{r[t]||(r[t]={});const e=i.loaded[t];e.length&&e.forEach(e=>{void 0===r[t][e]&&(r[t][e]=!0)})}),i.done=!0,i.errors.length?i.callback(i.errors):i.callback())}),this.emit("loaded",r),this.queue=this.queue.filter(t=>!t.done)}read(t,e,i,n=0,a=this.retryTimeout,s){if(!t.length)return s(null,{});if(this.readingCalls>=this.maxParallelReads)return void this.waitingReads.push({lng:t,ns:e,fcName:i,tried:n,wait:a,callback:s});this.readingCalls++;const r=(r,o)=>{if(this.readingCalls--,this.waitingReads.length>0){const t=this.waitingReads.shift();this.read(t.lng,t.ns,t.fcName,t.tried,t.wait,t.callback)}r&&o&&n<this.maxRetries?setTimeout(()=>{this.read.call(this,t,e,i,n+1,2*a,s)},a):s(r,o)},o=this.backend[i].bind(this.backend);if(2!==o.length)return o(t,e,r);try{const i=o(t,e);i&&"function"==typeof i.then?i.then(t=>r(null,t)).catch(r):r(null,i)}catch(t){r(t)}}prepareLoading(t,e,i={},n){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),n&&n();xM(t)&&(t=this.languageUtils.toResolveHierarchy(t)),xM(e)&&(e=[e]);const a=this.queueLoad(t,e,i,n);if(!a.toLoad.length)return a.pending.length||n(),null;a.toLoad.forEach(t=>{this.loadOne(t)})}load(t,e,i){this.prepareLoading(t,e,{},i)}reload(t,e,i){this.prepareLoading(t,e,{reload:!0},i)}loadOne(t,e=""){const i=t.split("|"),n=i[0],a=i[1];this.read(n,a,"read",void 0,void 0,(i,s)=>{i&&this.logger.warn(`${e}loading namespace ${a} for language ${n} failed`,i),!i&&s&&this.logger.log(`${e}loaded namespace ${a} for language ${n}`,s),this.loaded(t,i,s)})}saveMissing(t,e,i,n,a,s={},r=()=>{}){if(!this.services?.utils?.hasLoadedNamespace||this.services?.utils?.hasLoadedNamespace(e)){if(null!=i&&""!==i){if(this.backend?.create){const o={...s,isUpdate:a},l=this.backend.create.bind(this.backend);if(l.length<6)try{let a;a=5===l.length?l(t,e,i,n,o):l(t,e,i,n),a&&"function"==typeof a.then?a.then(t=>r(null,t)).catch(r):r(null,a)}catch(t){r(t)}else l(t,e,i,n,r,o)}t&&t[0]&&this.store.addResource(t[0],e,i,n)}}else this.logger.warn(`did not save key "${i}" as the namespace "${e}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")}}const rT=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:t=>{let e={};if("object"==typeof t[1]&&(e=t[1]),xM(t[1])&&(e.defaultValue=t[1]),xM(t[2])&&(e.tDescription=t[2]),"object"==typeof t[2]||"object"==typeof t[3]){const i=t[3]||t[2];Object.keys(i).forEach(t=>{e[t]=i[t]})}return e},interpolation:{escapeValue:!0,format:t=>t,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),oT=t=>(xM(t.ns)&&(t.ns=[t.ns]),xM(t.fallbackLng)&&(t.fallbackLng=[t.fallbackLng]),xM(t.fallbackNS)&&(t.fallbackNS=[t.fallbackNS]),t.supportedLngs?.indexOf?.("cimode")<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),"boolean"==typeof t.initImmediate&&(t.initAsync=t.initImmediate),t),lT=()=>{};class uT extends HM{constructor(t={},e){var i;if(super(),this.options=oT(t),this.services={},this.logger=WM,this.modules={external:[]},i=this,Object.getOwnPropertyNames(Object.getPrototypeOf(i)).forEach(t=>{"function"==typeof i[t]&&(i[t]=i[t].bind(i))}),e&&!this.isInitialized&&!t.isClone){if(!this.options.initAsync)return this.init(t,e),this;setTimeout(()=>{this.init(t,e)},0)}}init(t={},e){this.isInitializing=!0,"function"==typeof t&&(e=t,t={}),null==t.defaultNS&&t.ns&&(xM(t.ns)?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));const i=rT();this.options={...i,...this.options,...oT(t)},this.options.interpolation={...i.interpolation,...this.options.interpolation},void 0!==t.keySeparator&&(this.options.userDefinedKeySeparator=t.keySeparator),void 0!==t.nsSeparator&&(this.options.userDefinedNsSeparator=t.nsSeparator);const n=t=>t?"function"==typeof t?new t:t:null;if(!this.options.isClone){let t;this.modules.logger?WM.init(n(this.modules.logger),this.options):WM.init(null,this.options),t=this.modules.formatter?this.modules.formatter:aT;const e=new XM(this.options);this.store=new UM(this.options.resources,this.options);const a=this.services;a.logger=WM,a.resourceStore=this.store,a.languageUtils=e,a.pluralResolver=new JM(e,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==i.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),!t||this.options.interpolation.format&&this.options.interpolation.format!==i.interpolation.format||(a.formatter=n(t),a.formatter.init&&a.formatter.init(a,this.options),this.options.interpolation.format=a.formatter.format.bind(a.formatter)),a.interpolator=new eT(this.options),a.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},a.backendConnector=new sT(n(this.modules.backend),a.resourceStore,a,this.options),a.backendConnector.on("*",(t,...e)=>{this.emit(t,...e)}),this.modules.languageDetector&&(a.languageDetector=n(this.modules.languageDetector),a.languageDetector.init&&a.languageDetector.init(a,this.options.detection,this.options)),this.modules.i18nFormat&&(a.i18nFormat=n(this.modules.i18nFormat),a.i18nFormat.init&&a.i18nFormat.init(this)),this.translator=new YM(this.services,this.options),this.translator.on("*",(t,...e)=>{this.emit(t,...e)}),this.modules.external.forEach(t=>{t.init&&t.init(this)})}if(this.format=this.options.interpolation.format,e||(e=lT),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const t=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);t.length>0&&"dev"!==t[0]&&(this.options.lng=t[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(t=>{this[t]=(...e)=>this.store[t](...e)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(t=>{this[t]=(...e)=>(this.store[t](...e),this)});const a=wM(),s=()=>{const t=(t,i)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),a.resolve(i),e(t,i)};if(this.languages&&!this.isInitialized)return t(null,this.t.bind(this));this.changeLanguage(this.options.lng,t)};return this.options.resources||!this.options.initAsync?s():setTimeout(s,0),a}loadResources(t,e=lT){let i=e;const n=xM(t)?t:this.language;if("function"==typeof t&&(i=t),!this.options.resources||this.options.partialBundledLanguages){if("cimode"===n?.toLowerCase()&&(!this.options.preload||0===this.options.preload.length))return i();const t=[],e=e=>{e&&"cimode"!==e&&this.services.languageUtils.toResolveHierarchy(e).forEach(e=>{"cimode"!==e&&t.indexOf(e)<0&&t.push(e)})};n?e(n):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(t=>e(t)),this.options.preload?.forEach?.(t=>e(t)),this.services.backendConnector.load(t,this.options.ns,t=>{t||this.resolvedLanguage||!this.language||this.setResolvedLanguage(this.language),i(t)})}else i(null)}reloadResources(t,e,i){const n=wM();return"function"==typeof t&&(i=t,t=void 0),"function"==typeof e&&(i=e,e=void 0),t||(t=this.languages),e||(e=this.options.ns),i||(i=lT),this.services.backendConnector.reload(t,e,t=>{n.resolve(),i(t)}),n}use(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===t.type&&(this.modules.backend=t),("logger"===t.type||t.log&&t.warn&&t.error)&&(this.modules.logger=t),"languageDetector"===t.type&&(this.modules.languageDetector=t),"i18nFormat"===t.type&&(this.modules.i18nFormat=t),"postProcessor"===t.type&&BM.addPostProcessor(t),"formatter"===t.type&&(this.modules.formatter=t),"3rdParty"===t.type&&this.modules.external.push(t),this}setResolvedLanguage(t){if(t&&this.languages&&!(["cimode","dev"].indexOf(t)>-1)){for(let t=0;t<this.languages.length;t++){const e=this.languages[t];if(!(["cimode","dev"].indexOf(e)>-1)&&this.store.hasLanguageSomeTranslations(e)){this.resolvedLanguage=e;break}}!this.resolvedLanguage&&this.languages.indexOf(t)<0&&this.store.hasLanguageSomeTranslations(t)&&(this.resolvedLanguage=t,this.languages.unshift(t))}}changeLanguage(t,e){this.isLanguageChangingTo=t;const i=wM();this.emit("languageChanging",t);const n=t=>{this.language=t,this.languages=this.services.languageUtils.toResolveHierarchy(t),this.resolvedLanguage=void 0,this.setResolvedLanguage(t)},a=(a,s)=>{s?this.isLanguageChangingTo===t&&(n(s),this.translator.changeLanguage(s),this.isLanguageChangingTo=void 0,this.emit("languageChanged",s),this.logger.log("languageChanged",s)):this.isLanguageChangingTo=void 0,i.resolve((...t)=>this.t(...t)),e&&e(a,(...t)=>this.t(...t))},s=e=>{t||e||!this.services.languageDetector||(e=[]);const i=xM(e)?e:e&&e[0],s=this.store.hasLanguageSomeTranslations(i)?i:this.services.languageUtils.getBestMatchFromCodes(xM(e)?[e]:e);s&&(this.language||n(s),this.translator.language||this.translator.changeLanguage(s),this.services.languageDetector?.cacheUserLanguage?.(s)),this.loadResources(s,t=>{a(t,s)})};return t||!this.services.languageDetector||this.services.languageDetector.async?!t&&this.services.languageDetector&&this.services.languageDetector.async?0===this.services.languageDetector.detect.length?this.services.languageDetector.detect().then(s):this.services.languageDetector.detect(s):s(t):s(this.services.languageDetector.detect()),i}getFixedT(t,e,i){const n=(t,e,...a)=>{let s;s="object"!=typeof e?this.options.overloadTranslationOptionHandler([t,e].concat(a)):{...e},s.lng=s.lng||n.lng,s.lngs=s.lngs||n.lngs,s.ns=s.ns||n.ns,""!==s.keyPrefix&&(s.keyPrefix=s.keyPrefix||i||n.keyPrefix);const r=this.options.keySeparator||".";let o;return s.keyPrefix&&Array.isArray(t)?o=t.map(t=>("function"==typeof t&&(t=KM(t,{...this.options,...e})),`${s.keyPrefix}${r}${t}`)):("function"==typeof t&&(t=KM(t,{...this.options,...e})),o=s.keyPrefix?`${s.keyPrefix}${r}${t}`:t),this.t(o,s)};return xM(t)?n.lng=t:n.lngs=t,n.ns=e,n.keyPrefix=i,n}t(...t){return this.translator?.translate(...t)}exists(...t){return this.translator?.exists(...t)}setDefaultNamespace(t){this.options.defaultNS=t}hasLoadedNamespace(t,e={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const i=e.lng||this.resolvedLanguage||this.languages[0],n=!!this.options&&this.options.fallbackLng,a=this.languages[this.languages.length-1];if("cimode"===i.toLowerCase())return!0;const s=(t,e)=>{const i=this.services.backendConnector.state[`${t}|${e}`];return-1===i||0===i||2===i};if(e.precheck){const t=e.precheck(this,s);if(void 0!==t)return t}return!(!this.hasResourceBundle(i,t)&&this.services.backendConnector.backend&&(!this.options.resources||this.options.partialBundledLanguages)&&(!s(i,t)||n&&!s(a,t)))}loadNamespaces(t,e){const i=wM();return this.options.ns?(xM(t)&&(t=[t]),t.forEach(t=>{this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}),this.loadResources(t=>{i.resolve(),e&&e(t)}),i):(e&&e(),Promise.resolve())}loadLanguages(t,e){const i=wM();xM(t)&&(t=[t]);const n=this.options.preload||[],a=t.filter(t=>n.indexOf(t)<0&&this.services.languageUtils.isSupportedCode(t));return a.length?(this.options.preload=n.concat(a),this.loadResources(t=>{i.resolve(),e&&e(t)}),i):(e&&e(),Promise.resolve())}dir(t){if(t||(t=this.resolvedLanguage||(this.languages?.length>0?this.languages[0]:this.language)),!t)return"rtl";try{const e=new Intl.Locale(t);if(e&&e.getTextInfo){const t=e.getTextInfo();if(t&&t.direction)return t.direction}}catch(t){}const e=this.services?.languageUtils||new XM(rT());return t.toLowerCase().indexOf("-latn")>1?"ltr":["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(e.getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(t={},e){const i=new uT(t,e);return i.createInstance=uT.createInstance,i}cloneInstance(t={},e=lT){const i=t.forkResourceStore;i&&delete t.forkResourceStore;const n={...this.options,...t,isClone:!0},a=new uT(n);if(void 0===t.debug&&void 0===t.prefix||(a.logger=a.logger.clone(t)),["store","services","language"].forEach(t=>{a[t]=this[t]}),a.services={...this.services},a.services.utils={hasLoadedNamespace:a.hasLoadedNamespace.bind(a)},i){const t=Object.keys(this.store.data).reduce((t,e)=>(t[e]={...this.store.data[e]},t[e]=Object.keys(t[e]).reduce((i,n)=>(i[n]={...t[e][n]},i),t[e]),t),{});a.store=new UM(t,n),a.services.resourceStore=a.store}return a.translator=new YM(a.services,n),a.translator.on("*",(t,...e)=>{a.emit(t,...e)}),a.init(n,e),a.translator.options=n,a.translator.backendConnector.services.utils={hasLoadedNamespace:a.hasLoadedNamespace.bind(a)},a}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const hT=uT.createInstance();hT.createInstance,hT.dir,hT.init,hT.loadResources,hT.reloadResources,hT.use,hT.changeLanguage,hT.getFixedT,hT.t,hT.exists,hT.setDefaultNamespace,hT.hasLoadedNamespace,hT.loadNamespaces,hT.loadLanguages;var cT=i(6540),dT=i(5338),pT=i(4915),mT=i.n(pT),fT=/\s([^'"/\s><]+?)[\s/>]|([^\s=]+)=\s?(".*?"|'.*?')/g;function gT(t){var e={type:"tag",name:"",voidElement:!1,attrs:{},children:[]},i=t.match(/<\/?([^\s]+?)[/\s>]/);if(i&&(e.name=i[1],(mT()[i[1]]||"/"===t.charAt(t.length-2))&&(e.voidElement=!0),e.name.startsWith("!--"))){var n=t.indexOf("--\x3e");return{type:"comment",comment:-1!==n?t.slice(4,n):""}}for(var a=new RegExp(fT),s=null;null!==(s=a.exec(t));)if(s[0].trim())if(s[1]){var r=s[1].trim(),o=[r,""];r.indexOf("=")>-1&&(o=r.split("=")),e.attrs[o[0]]=o[1],a.lastIndex--}else s[2]&&(e.attrs[s[2]]=s[3].trim().substring(1,s[3].length-1));return e}var _T=/<[a-zA-Z0-9\-\!\/](?:"[^"]*"|'[^']*'|[^'">])*>/g,yT=/^\s*$/,kT=Object.create(null);function vT(t,e){switch(e.type){case"text":return t+e.content;case"tag":return t+="<"+e.name+(e.attrs?function(t){var e=[];for(var i in t)e.push(i+'="'+t[i]+'"');return e.length?" "+e.join(" "):""}(e.attrs):"")+(e.voidElement?"/>":">"),e.voidElement?t:t+e.children.reduce(vT,"")+"</"+e.name+">";case"comment":return t+"\x3c!--"+e.comment+"--\x3e"}}var xT={parse:function(t,e){e||(e={}),e.components||(e.components=kT);var i,n=[],a=[],s=-1,r=!1;if(0!==t.indexOf("<")){var o=t.indexOf("<");n.push({type:"text",content:-1===o?t:t.substring(0,o)})}return t.replace(_T,function(o,l){if(r){if(o!=="</"+i.name+">")return;r=!1}var u,h="/"!==o.charAt(1),c=o.startsWith("\x3c!--"),d=l+o.length,p=t.charAt(d);if(c){var m=gT(o);return s<0?(n.push(m),n):((u=a[s]).children.push(m),n)}if(h&&(s++,"tag"===(i=gT(o)).type&&e.components[i.name]&&(i.type="component",r=!0),i.voidElement||r||!p||"<"===p||i.children.push({type:"text",content:t.slice(d,t.indexOf("<",d))}),0===s&&n.push(i),(u=a[s-1])&&u.children.push(i),a[s]=i),(!h||i.voidElement)&&(s>-1&&(i.voidElement||i.name===o.slice(2,-1))&&(s--,i=-1===s?n:a[s]),!r&&"<"!==p&&p)){u=-1===s?n:a[s].children;var f=t.indexOf("<",d),g=t.slice(d,-1===f?void 0:f);yT.test(g)&&(g=" "),(f>-1&&s+u.length>=0||" "!==g)&&u.push({type:"text",content:g})}}),n},stringify:function(t){return t.reduce(function(t,e){return t+vT("",e)},"")}};const wT=xT,bT=(t,e,i,n)=>{const a=[i,{code:e,...n||{}}];if(t?.services?.logger?.forward)return t.services.logger.forward(a,"warn","react-i18next::",!0);LT(a[0])&&(a[0]=`react-i18next:: ${a[0]}`),t?.services?.logger?.warn?t.services.logger.warn(...a):console?.warn&&console.warn(...a)},ET={},MT=(t,e,i,n)=>{LT(i)&&ET[i]||(LT(i)&&(ET[i]=new Date),bT(t,e,i,n))},TT=(t,e)=>()=>{if(t.isInitialized)e();else{const i=()=>{setTimeout(()=>{t.off("initialized",i)},0),e()};t.on("initialized",i)}},ST=(t,e,i)=>{t.loadNamespaces(e,TT(t,i))},CT=(t,e,i,n)=>{if(LT(i)&&(i=[i]),t.options.preload&&t.options.preload.indexOf(e)>-1)return ST(t,i,n);i.forEach(e=>{t.options.ns.indexOf(e)<0&&t.options.ns.push(e)}),t.loadLanguages(e,TT(t,n))},LT=t=>"string"==typeof t,RT=t=>"object"==typeof t&&null!==t,IT=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,PT={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},AT=t=>PT[t];let jT={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:t=>t.replace(IT,AT)};const OT=()=>jT;let FT;const NT=()=>FT,GT=(t,e)=>{if(!t)return!1;const i=t.props?.children??t.children;return e?i.length>0:!!i},DT=t=>{if(!t)return[];const e=t.props?.children??t.children;return t.props?.i18nIsDynamicList?WT(e):e},WT=t=>Array.isArray(t)?t:[t],HT=(t,e,i,n)=>{if(!t)return"";let a="";const s=WT(t),r=e?.transSupportBasicHtmlNodes?e.transKeepBasicHtmlNodesFor??[]:[];return s.forEach((t,s)=>{if(LT(t))a+=`${t}`;else{if((0,cT.isValidElement)(t)){const{props:o,type:l}=t,u=Object.keys(o).length,h=r.indexOf(l)>-1,c=o.children;if(!c&&h&&!u)return void(a+=`<${l}/>`);if(!c&&(!h||u)||o.i18nIsDynamicList)return void(a+=`<${s}></${s}>`);if(h&&1===u&&LT(c))return void(a+=`<${l}>${c}</${l}>`);const d=HT(c,e,i,n);return void(a+=`<${s}>${d}</${s}>`)}if(null!==t){if(RT(t)){const{format:e,...s}=t,r=Object.keys(s);if(1===r.length){const t=e?`${r[0]}, ${e}`:r[0];return void(a+=`{{${t}}}`)}return void bT(i,"TRANS_INVALID_OBJ","Invalid child - Object should only have keys {{ value, format }} (format is optional).",{i18nKey:n,child:t})}bT(i,"TRANS_INVALID_VAR","Passed in a variable like {number} - pass variables for interpolation as full objects like {{number}}.",{i18nKey:n,child:t})}else bT(i,"TRANS_NULL_VALUE","Passed in a null value as child",{i18nKey:n})}}),a},UT=(t,e,i)=>{const n=t.key||e,a=(0,cT.cloneElement)(t,{key:n});return!a.props||!a.props.children||i.indexOf(`${e}/>`)<0&&i.indexOf(`${e} />`)<0?a:(0,cT.createElement)(function(){return(0,cT.createElement)(cT.Fragment,null,a)},{key:n})};function BT({children:t,count:e,parent:i,i18nKey:n,context:a,tOptions:s={},values:r,defaults:o,components:l,ns:u,i18n:h,t:c,shouldUnescape:d,...p}){const m=h||NT();if(!m)return MT(m,"NO_I18NEXT_INSTANCE","Trans: You need to pass in an i18next instance using i18nextReactModule",{i18nKey:n}),t;const f=c||m.t.bind(m)||(t=>t),g={...OT(),...m.options?.react};let _=u||f.ns||m.options?.defaultNS;_=LT(_)?[_]:_||["translation"];const y=HT(t,g,m,n),k=o||s?.defaultValue||y||g.transEmptyNodeValue||("function"==typeof n?KM(n):n),{hashTransKey:v}=g,x=n||(v?v(y||k):y||k);m.options?.interpolation?.defaultVariables&&(r=r&&Object.keys(r).length>0?{...r,...m.options.interpolation.defaultVariables}:{...m.options.interpolation.defaultVariables});const w=r||void 0!==e&&!m.options?.interpolation?.alwaysFormat||!t?s.interpolation:{interpolation:{...s.interpolation,prefix:"#$?",suffix:"?$#"}},b={...s,context:a||s.context,count:e,...r,...w,defaultValue:k,ns:_};let E=x?f(x,b):k;E===x&&k&&(E=k);const M=((t,e,i,n)=>t?Array.isArray(t)?((t,e)=>t.map((t,i)=>UT(t,i,e)))(t,e):RT(t)?((t,e)=>{const i={};return Object.keys(t).forEach(n=>{Object.assign(i,{[n]:UT(t[n],n,e)})}),i})(t,e):(MT(i,"TRANS_INVALID_COMPONENTS",'<Trans /> "components" prop expects an object or array',{i18nKey:n}),null):null)(l,E,m,n);let T=M||t,S=null;var C;RT(C=M)&&!Array.isArray(C)&&Object.keys(C).reduce((t,e)=>t&&Number.isNaN(Number.parseFloat(e)),!0)&&(S=M,T=t);const L=((t,e,i,n,a,s,r)=>{if(""===i)return[];const o=a.transKeepBasicHtmlNodesFor||[],l=i&&new RegExp(o.map(t=>`<${t}`).join("|")).test(i);if(!(t||e||l||r))return[i];const u=e??{},h=t=>{WT(t).forEach(t=>{LT(t)||(GT(t)?h(DT(t)):RT(t)&&!(0,cT.isValidElement)(t)&&Object.assign(u,t))})};h(t);const c=((t,e=[],i={})=>{if(!t)return t;const n=[...e,...Object.keys(i)];let a="",s=0;for(;s<t.length;)if("<"===t[s]){let e=!1;const i=t.slice(s).match(/^<\/(\d+|[a-zA-Z][a-zA-Z0-9-]*)>/);if(i){const t=i[1];(/^\d+$/.test(t)||n.includes(t))&&(e=!0,a+=i[0],s+=i[0].length)}if(!e){const i=t.slice(s).match(/^<(\d+|[a-zA-Z][a-zA-Z0-9-]*)(\s+[\w-]+(?:=(?:"[^"]*"|'[^']*'|[^\s>]+))?)*\s*(\/)?>/);if(i){const t=i[1];(/^\d+$/.test(t)||n.includes(t))&&(e=!0,a+=i[0],s+=i[0].length)}}e||(a+="&lt;",s+=1)}else a+=t[s],s+=1;return a})(i,o,u),d=wT.parse(`<0>${c}</0>`),p={...u,...s},m=(t,e,i)=>{const n=DT(t),a=g(n,e.children,i);return(t=>Array.isArray(t)&&t.every(cT.isValidElement))(n)&&0===a.length||t.props?.i18nIsDynamicList?n:a},f=(t,e,i,n,a)=>{t.dummy?(t.children=e,i.push((0,cT.cloneElement)(t,{key:n},a?void 0:e))):i.push(...cT.Children.map([t],t=>{const i="data-i18n-is-dynamic-list",s={key:n,[i]:void 0};return t&&t.props&&Object.keys(t.props).forEach(e=>{"ref"!==e&&"children"!==e&&"i18nIsDynamicList"!==e&&e!==i&&(s[e]=t.props[e])}),(0,cT.cloneElement)(t,s,a?null:e)}))},g=(t,i,s)=>{const u=WT(t);return WT(i).reduce((t,i,h)=>{const c=i.children?.[0]?.content&&n.services.interpolator.interpolate(i.children[0].content,p,n.language);if("tag"===i.type){let r=u[parseInt(i.name,10)];!r&&e&&(r=e[i.name]),1!==s.length||r||(r=s[0][i.name]),r||(r={});const d=0!==Object.keys(i.attrs).length?((t,e)=>{const i={...e};return i.props=Object.assign(t.props,e.props),i})({props:i.attrs},r):r,_=(0,cT.isValidElement)(d),y=_&&GT(i,!0)&&!i.voidElement,k=l&&RT(d)&&d.dummy&&!_,v=RT(e)&&Object.hasOwnProperty.call(e,i.name);if(LT(d)){const e=n.services.interpolator.interpolate(d,p,n.language);t.push(e)}else if(GT(d)||y){const e=m(d,i,s);f(d,e,t,h)}else if(k){const e=g(u,i.children,s);f(d,e,t,h)}else if(Number.isNaN(parseFloat(i.name)))if(v){const e=m(d,i,s);f(d,e,t,h,i.voidElement)}else if(a.transSupportBasicHtmlNodes&&o.indexOf(i.name)>-1)if(i.voidElement)t.push((0,cT.createElement)(i.name,{key:`${i.name}-${h}`}));else{const e=g(u,i.children,s);t.push((0,cT.createElement)(i.name,{key:`${i.name}-${h}`},e))}else if(i.voidElement)t.push(`<${i.name} />`);else{const e=g(u,i.children,s);t.push(`<${i.name}>${e}</${i.name}>`)}else if(RT(d)&&!_){const e=i.children[0]?c:null;e&&t.push(e)}else f(d,c,t,h,1!==i.children.length||!c)}else if("text"===i.type){const e=a.transWrapTextNodes,s=r?a.unescape(n.services.interpolator.interpolate(i.content,p,n.language)):n.services.interpolator.interpolate(i.content,p,n.language);e?t.push((0,cT.createElement)(e,{key:`${i.name}-${h}`},s)):t.push(s)}return t},[])},_=g([{dummy:!0,children:t||[]}],d,WT(t||[]));return DT(_[0])})(T,S,E,m,g,b,d),R=i??g.defaultTransParent;return R?(0,cT.createElement)(R,p,L):L}const VT={type:"3rdParty",init(t){((t={})=>{jT={...jT,...t}})(t.options.react),(t=>{FT=t})(t)}},KT=(0,cT.createContext)();class zT{constructor(){this.usedNamespaces={}}addUsedNamespaces(t){t.forEach(t=>{this.usedNamespaces[t]||(this.usedNamespaces[t]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}function $T({children:t,count:e,parent:i,i18nKey:n,context:a,tOptions:s={},values:r,defaults:o,components:l,ns:u,i18n:h,t:c,shouldUnescape:d,...p}){const{i18n:m,defaultNS:f}=(0,cT.useContext)(KT)||{},g=h||m||NT(),_=c||g?.t.bind(g);return BT({children:t,count:e,parent:i,i18nKey:n,context:a,tOptions:s,values:r,defaults:o,components:l,ns:u||_?.ns||f||g?.options?.defaultNS,i18n:g,t:c,shouldUnescape:d,...p})}Error;const YT={"&nbsp;":"","&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'","&copy;":"","&reg;":"","&trade;":"","&hellip;":"","&ndash;":"","&mdash;":"","&lsquo;":"","&rsquo;":"","&sbquo;":"","&ldquo;":"","&rdquo;":"","&bdquo;":"","&dagger;":"","&Dagger;":"","&bull;":"","&prime;":"","&Prime;":"","&lsaquo;":"","&rsaquo;":"","&sect;":"","&para;":"","&middot;":"","&ensp;":"","&emsp;":"","&thinsp;":"","&euro;":"","&pound;":"","&yen;":"","&cent;":"","&curren;":"","&times;":"","&divide;":"","&minus;":"","&plusmn;":"","&ne;":"","&le;":"","&ge;":"","&asymp;":"","&equiv;":"","&infin;":"","&int;":"","&sum;":"","&prod;":"","&radic;":"","&part;":"","&permil;":"","&deg;":"","&micro;":"","&larr;":"","&uarr;":"","&rarr;":"","&darr;":"","&harr;":"","&crarr;":"","&lArr;":"","&uArr;":"","&rArr;":"","&dArr;":"","&hArr;":"","&alpha;":"","&beta;":"","&gamma;":"","&delta;":"","&epsilon;":"","&zeta;":"","&eta;":"","&theta;":"","&iota;":"","&kappa;":"","&lambda;":"","&mu;":"","&nu;":"","&xi;":"","&omicron;":"","&pi;":"","&rho;":"","&sigma;":"","&tau;":"","&upsilon;":"","&phi;":"","&chi;":"","&psi;":"","&omega;":"","&Alpha;":"","&Beta;":"","&Gamma;":"","&Delta;":"","&Epsilon;":"","&Zeta;":"","&Eta;":"","&Theta;":"","&Iota;":"","&Kappa;":"","&Lambda;":"","&Mu;":"","&Nu;":"","&Xi;":"","&Omicron;":"","&Pi;":"","&Rho;":"","&Sigma;":"","&Tau;":"","&Upsilon;":"","&Phi;":"","&Chi;":"","&Psi;":"","&Omega;":"","&Agrave;":"","&Aacute;":"","&Acirc;":"","&Atilde;":"","&Auml;":"","&Aring;":"","&AElig;":"","&Ccedil;":"","&Egrave;":"","&Eacute;":"","&Ecirc;":"","&Euml;":"","&Igrave;":"","&Iacute;":"","&Icirc;":"","&Iuml;":"","&ETH;":"","&Ntilde;":"","&Ograve;":"","&Oacute;":"","&Ocirc;":"","&Otilde;":"","&Ouml;":"","&Oslash;":"","&Ugrave;":"","&Uacute;":"","&Ucirc;":"","&Uuml;":"","&Yacute;":"","&THORN;":"","&szlig;":"","&agrave;":"","&aacute;":"","&acirc;":"","&atilde;":"","&auml;":"","&aring;":"","&aelig;":"","&ccedil;":"","&egrave;":"","&eacute;":"","&ecirc;":"","&euml;":"","&igrave;":"","&iacute;":"","&icirc;":"","&iuml;":"","&eth;":"","&ntilde;":"","&ograve;":"","&oacute;":"","&ocirc;":"","&otilde;":"","&ouml;":"","&oslash;":"","&ugrave;":"","&uacute;":"","&ucirc;":"","&uuml;":"","&yacute;":"","&thorn;":"","&yuml;":"","&iexcl;":"","&iquest;":"","&fnof;":"","&circ;":"","&tilde;":"","&OElig;":"","&oelig;":"","&Scaron;":"","&scaron;":"","&Yuml;":"","&ordf;":"","&ordm;":"","&macr;":"","&acute;":"","&cedil;":"","&sup1;":"","&sup2;":"","&sup3;":"","&frac14;":"","&frac12;":"","&frac34;":"","&spades;":"","&clubs;":"","&hearts;":"","&diams;":"","&loz;":"","&oline;":"","&frasl;":"","&weierp;":"","&image;":"","&real;":"","&alefsym;":""};new RegExp(Object.keys(YT).map(t=>t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).join("|"),"g");var XT=i(9888);const qT={t:(t,e)=>LT(e)?e:RT(e)&&LT(e.defaultValue)?e.defaultValue:Array.isArray(t)?t[t.length-1]:t,ready:!1},ZT=()=>()=>{},JT=(t,e={})=>{const{i18n:i}=e,{i18n:n,defaultNS:a}=(0,cT.useContext)(KT)||{},s=i||n||NT();s&&!s.reportNamespaces&&(s.reportNamespaces=new zT),s||MT(s,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const r=(0,cT.useMemo)(()=>({...OT(),...s?.options?.react,...e}),[s,e]),{useSuspense:o,keyPrefix:l}=r,u=t||a||s?.options?.defaultNS,h=LT(u)?[u]:u||["translation"],c=(0,cT.useMemo)(()=>h,h);s?.reportNamespaces?.addUsedNamespaces?.(c);const d=(0,cT.useRef)(0),p=(0,cT.useCallback)(t=>{if(!s)return ZT;const{bindI18n:e,bindI18nStore:i}=r,n=()=>{d.current+=1,t()};return e&&s.on(e,n),i&&s.store.on(i,n),()=>{e&&e.split(" ").forEach(t=>s.off(t,n)),i&&i.split(" ").forEach(t=>s.store.off(t,n))}},[s,r]),m=(0,cT.useRef)(),f=(0,cT.useCallback)(()=>{if(!s)return qT;const t=!(!s.isInitialized&&!s.initializedStoreOnce)&&c.every(t=>((t,e,i={})=>e.languages&&e.languages.length?e.hasLoadedNamespace(t,{lng:i.lng,precheck:(e,n)=>{if(i.bindI18n&&i.bindI18n.indexOf("languageChanging")>-1&&e.services.backendConnector.backend&&e.isLanguageChangingTo&&!n(e.isLanguageChangingTo,t))return!1}}):(MT(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0))(t,s,r)),i=e.lng||s.language,n=d.current,a=m.current;if(a&&a.ready===t&&a.lng===i&&a.keyPrefix===l&&a.revision===n)return a;const o={t:s.getFixedT(i,"fallback"===r.nsMode?c:c[0],l),ready:t,lng:i,keyPrefix:l,revision:n};return m.current=o,o},[s,c,l,r,e.lng]),[g,_]=(0,cT.useState)(0),{t:y,ready:k}=(0,XT.useSyncExternalStore)(p,f,f);(0,cT.useEffect)(()=>{if(s&&!k&&!o){const t=()=>_(t=>t+1);e.lng?CT(s,e.lng,c,t):ST(s,c,t)}},[s,e.lng,c,k,o,g]);const v=s||{},x=(0,cT.useRef)(null),w=(0,cT.useRef)(),b=t=>{const e=Object.getOwnPropertyDescriptors(t);e.__original&&delete e.__original;const i=Object.create(Object.getPrototypeOf(t),e);if(!Object.prototype.hasOwnProperty.call(i,"__original"))try{Object.defineProperty(i,"__original",{value:t,writable:!1,enumerable:!1,configurable:!1})}catch(t){}return i},E=(0,cT.useMemo)(()=>{const t=v,e=t?.language;let i=t;t&&(x.current&&x.current.__original===t?w.current!==e?(i=b(t),x.current=i,w.current=e):i=x.current:(i=b(t),x.current=i,w.current=e));const n=[y,i,k];return n.t=y,n.i18n=i,n.ready=k,n},[y,v,k,v.resolvedLanguage,v.language,v.languages]);if(s&&o&&!k)throw new Promise(t=>{const i=()=>t();e.lng?CT(s,e.lng,c,i):ST(s,c,i)});return E};var QT=i(8418);var tS={notify(){},get:()=>[]};var eS=(()=>!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement))(),iS=(()=>"undefined"!=typeof navigator&&"ReactNative"===navigator.product)(),nS=(()=>eS||iS?cT.useLayoutEffect:cT.useEffect)();Object.defineProperty,Object.getOwnPropertyNames,Object.getOwnPropertySymbols,Object.getOwnPropertyDescriptor,Object.getPrototypeOf,Object.prototype;var aS=Symbol.for("react-redux-context"),sS="undefined"!=typeof globalThis?globalThis:{};function rS(){if(!cT.createContext)return{};const t=sS[aS]??=new Map;let e=t.get(cT.createContext);return e||(e=cT.createContext(null),t.set(cT.createContext,e)),e}var oS=rS(),lS=function(t){const{children:e,context:i,serverState:n,store:a}=t,s=cT.useMemo(()=>{const t=function(t,e){let i,n=tS,a=0,s=!1;function r(){u.onStateChange&&u.onStateChange()}function o(){a++,i||(i=e?e.addNestedSub(r):t.subscribe(r),n=function(){let t=null,e=null;return{clear(){t=null,e=null},notify(){var e;e=()=>{let e=t;for(;e;)e.callback(),e=e.next},e()},get(){const e=[];let i=t;for(;i;)e.push(i),i=i.next;return e},subscribe(i){let n=!0;const a=e={callback:i,next:null,prev:e};return a.prev?a.prev.next=a:t=a,function(){n&&null!==t&&(n=!1,a.next?a.next.prev=a.prev:e=a.prev,a.prev?a.prev.next=a.next:t=a.next)}}}}())}function l(){a--,i&&0===a&&(i(),i=void 0,n.clear(),n=tS)}const u={addNestedSub:function(t){o();const e=n.subscribe(t);let i=!1;return()=>{i||(i=!0,e(),l())}},notifyNestedSubs:function(){n.notify()},handleChangeWrapper:r,isSubscribed:function(){return s},trySubscribe:function(){s||(s=!0,o())},tryUnsubscribe:function(){s&&(s=!1,l())},getListeners:()=>n};return u}(a);return{store:a,subscription:t,getServerState:n?()=>n:void 0}},[a,n]),r=cT.useMemo(()=>a.getState(),[a]);nS(()=>{const{subscription:t}=s;return t.onStateChange=t.notifyNestedSubs,t.trySubscribe(),r!==a.getState()&&t.notifyNestedSubs(),()=>{t.tryUnsubscribe(),t.onStateChange=void 0}},[s,r]);const o=i||oS;return cT.createElement(o.Provider,{value:s},e)};function uS(t=oS){return function(){return cT.useContext(t)}}var hS=uS();function cS(t=oS){const e=t===oS?hS:uS(t),i=()=>{const{store:t}=e();return t};return Object.assign(i,{withTypes:()=>i}),i}var dS=cS();function pS(t=oS){const e=t===oS?dS:cS(t),i=()=>e().dispatch;return Object.assign(i,{withTypes:()=>i}),i}var mS=pS(),fS=(t,e)=>t===e;function gS(t=oS){const e=t===oS?hS:uS(t),i=(t,i={})=>{const{equalityFn:n=fS}="function"==typeof i?{equalityFn:i}:i,a=e(),{store:s,subscription:r,getServerState:o}=a,l=(cT.useRef(!0),cT.useCallback({[t.name]:e=>t(e)}[t.name],[t])),u=(0,QT.useSyncExternalStoreWithSelector)(r.addNestedSub,s.getState,o||s.getState,l,n);return cT.useDebugValue(u),u};return Object.assign(i,{withTypes:()=>i}),i}var _S=gS();const yS=JSON.parse('{"common":{"Ennen ajanlaskun alkua":"BCE","Jlkeen ajanlaskun alun":"CE","button":{"close":"Close","languageSelection":"Select language","zoomOut":"Zoom out","zoomIn":"Zoom in","settings":"Map settings","search":"Search sites","info":"User guide","positioning":"Centre the map on your current location","fullscreen":"Fullscreen mode","maannousuInfo":{"Edellinen vuosi":"Previous year","Seuraava vuosi":"Next year"},"featureLocationLink":"Link directly to this feature"},"features":{"Alue":"Area","Viiva":"Line (e.g. road)","Rakennettu alue":"Built-up area","Rakennus":"Building","Kohde":"Site","3D-malli":"3D model","Valtakunnallisesti merkittv muinaisjnns":"Nationally significant ancient monument","aluerajaukset":"Area boundaries","keskipisteet":"Centroids"},"organization":{"Maanmittauslaitos":"National Land Survey of Finland","Museovirasto":"Finnish Heritage Agency","Ahvenanmaan paikallishallinto":"Government of land","Geologian tutkimuskeskus":"Geological Survey of Finland","Helsingin kaupunki":"City of Helsinki","viabundus":"Viabundus project","Maannousu.info":"Maannousu.info"}},"linkedFeature":{"header":"Linked feature","showOnMap":"Show on map","showFeatureDetails":"Show details","remove":"Remove link"},"info":{"title":"About this site","dataUpdates":{"title":"Data update frequency","description":"Update interval of datasets:","mml":"In real time","museovirasto":"New sites with a delay of 024 hours, detailed information available in real time via click","ahvenanmaa":"In real time","gtk":"In real time","helsinki":"In real time","viabundus":"Updated manually. Currently using dataset version 2, published on 25 April 2025","Maannousu.info":"In real time"},"symbols":"Map symbols","siteInfo":{"title":"About the site","registerInfo":"This site displays map data from the following registers","info1":"All displayed sites are open data retrieved from the map services provided by the register maintainers.","info2":"You can open an information window for a site by clicking it on the map. From there you can follow a link to more detailed information on the maintainers website. The icon next to the site title (<i className=\'bi bi-geo-alt-fill\' aria-hidden=\'true\' />) provides a permanent link to the sites map location.","3DModelsInfo":"For some sites, 3D models are also available from the <a href=\'./3d/\' target=\'_blank\'>database</a>, which lists 3D models created by hobbyists and official institutions (museums, the Finnish Heritage Agency, Government of land) via the <a href=\'https://sketchfab.com\' target=\'_blank\'>Sketchfab</a> service.","positioningTitle":"Positioning","positioningInfo":"By default, the map centres on your current location if you allow your browser to share it. You can also centre the map later using the <i className=\'bi bi-crosshair\' aria-hidden=\'true\' /> button.","searchTitle":"Search","searchInfo":"Sites from the Finnish Heritage Agencys registers can be searched by name in the search view (<i className=\'bi bi-search\' aria-hidden=\'true\' />). Clicking a search result centres the map on the site and adds a location marker (<img src=\'images/map-pin-small.png\' />).","settingsTitle":"Settings","settingsInfo":"You can switch between background and topographic maps in settings (<i className=\'bi bi-gear\' aria-hidden=\'true\' />). From the same view, you can hide sites from the Heritage Agencys registers by type, or filter ancient monuments by period  for example, view only Iron Age monuments.","feedbackTitle":"Feedback","feedbackInfo":"Feedback on this site is welcome at <a href=\'mailto:antti.kekki@gmail.com\'>antti.kekki@gmail.com</a>.","developersTitle":"Developers","developersInfo":"Coding: Antti Kekki<br/>Translations: Jenni Lucenius and Mikko Helminen"},"licences":{"title":"Open data, licences and source code","museovirasto":"Information from the Finnish Heritage Agencys registers is retrieved via an <a href=\'https://www.museovirasto.fi/fi/palvelut-ja-ohjeet/tietojarjestelmat/kulttuuriympariston-tietojarjestelmat/kulttuuriympaeristoen-paikkatietoaineistot\' target=\'_blank\'>open WMS interface</a> (the spatial data is published under a <a href=\'https://creativecommons.org/licenses/by/4.0/deed.fi\' target=\'_blank\'>Creative Commons CC BY 4.0 licence</a>).","ahvenanmaa":"Information from the Government of land registers is retrieved via an <a href=\'https://www.kartor.ax/datasets\' target=\'_blank\'>open WMS interface</a> (the spatial data is published under a <a href=\'https://creativecommons.org/licenses/by/4.0/deed.fi\' target=\'_blank\'>Creative Commons CC BY 4.0 licence</a>).","maanmittauslaitos":"Background, orthophoto and base maps are retrieved via the National Land Survey of Finlands <a href=\'https://www.maanmittauslaitos.fi/kartat-ja-paikkatieto/asiantuntevalle-kayttajalle/kartta-ja-paikkatietojen-rajapintapalvelut-17\' target=\'_blank\'>open WMTS interface</a> (spatial data is published under a <a href=\'https://creativecommons.org/licenses/by/4.0/deed.fi\' target=\'_blank\'>Creative Commons CC BY 4.0 licence</a>).","maanmittauslaitosPaituli":"<a href=\'https://www.maanmittauslaitos.fi/sites/maanmittauslaitos.fi/files/attachments/2024/04/Vanhatkartat2024_verkkoon.pdf\' target=\'_blank\'>Old maps</a> and the NLS elevation model are retrieved via CSCs (IT Centre for Science) Paituli service <a href=\'https://paituli.csc.fi/webservices.html\' target=\'_blank\'>open WMS and WMTS interfaces</a> (datasets published under a <a href=\'https://creativecommons.org/licenses/by/4.0/deed.fi\' target=\'_blank\'>Creative Commons CC BY 4.0 licence</a>).","gtk":"Shoreline displacement and soil data are retrieved via the Geological Survey of Finlands <a href=\'https://www.gtk.fi/palvelut/aineistot-ja-verkkopalvelut/rajapintapalvelut/maapera-karttatasot-wms-rajapinnassa/\' target=\'_blank\'>open WMS interface</a>. The ancient shoreline dataset is published under a <a href=\'https://www.gtk.fi/peruslisenssi/\' target=\'_blank\'>basic licence</a> (special permission for use granted 15 January 2021). The soil dataset is published under an <a href=\'https://www.gtk.fi/avoin-lisenssi/\' target=\'_blank\'>open licence</a> (<a href=\'https://creativecommons.org/licenses/by/4.0/deed.fi\' target=\'_blank\'>Creative Commons CC BY 4.0</a>).","maannousuInfo":"The Maannousu.info shoreline displacement map is retrieved via an <a href=\'https://maannousu.info/integration\' target=\'_blank\'>open GeoTIFF interface</a> (data published under a <a href=\'https://creativecommons.org/licenses/by/4.0/deed.fi\' target=\'_blank\'>Creative Commons CC BY 4.0 licence</a>).","helsinki":"The First World War fortifications dataset is retrieved via the City of Helsinkis <a href=\'https://hri.fi/data/fi/dataset/helsingin-ensimmaisen-maailmansodan-aikaiset-maalinnoitukset\' target=\'_blank\'>open WMS interface</a> (data published under a <a href=\'https://creativecommons.org/licenses/by/4.0/deed.fi\' target=\'_blank\'>Creative Commons CC BY 4.0 licence</a>).","viabundus":"The Viabundus project dataset of medieval roads and settlements was downloaded from the <a href=\'https://www.landesgeschichte.uni-goettingen.de/handelsstrassen/info.php?lang=fin\' target=\'_blank\'>project website</a> (version 2) and edited. Both the original and modified spatial datasets are published under a <a href=\'https://creativecommons.org/licenses/by-sa/4.0/deed.fi\' target=\'_blank\'>CC BY-SA 4.0 licence</a>. The modified dataset can be downloaded in GeoJSON format at <a href=\'./viabundus/Viabundus-finland.geojson\' target=\'_blank\'>muinaismuistot.info/viabundus/Viabundus-finland.geojson</a>.","maisemanmuisti":"The spatial data for the book *Memory of the Landscape  Nationally Significant Ancient Monuments* is available from the <a href=\'./maisemanmuisti/\' target=\'_blank\'>database</a> compiling the 205 sites listed in the book. Copyright for the books content belongs to the Finnish Heritage Agency, which has granted permission for the datasets use.","3DModels":"The 3D models come from an open <a href=\'./3d/\' target=\'_blank\'>database</a> listing models created by hobbyists and official institutions (museums, the Finnish Heritage Agency, Government of land). Each models licence is listed individually in the database.","sourceCode":"The technical implementation of this site is <a href=\'https://github.com/anttikekki/muinaismuistot\' target=\'_blank\'>open source</a>, licensed under <a href=\'https://github.com/anttikekki/muinaismuistot/blob/master/LICENSE\' target=\'_blank\'>MIT</a>."},"versionHistory":{"title":"Version history","2025-10":"<p>Added dataset from the <a href=\'https://www.landesgeschichte.uni-goettingen.de/handelsstrassen/info.php?lang=fin\' target=\'_blank\'>Viabundus project</a>.</p><p>Added find spots, observation sites, potential ancient monuments, natural formations, removed monuments, other sites and subsites from the Finnish Heritage Agencys Ancient Monument Register.</p><p>The linked feature on the map is now highlighted in the site list. A dedicated control button for it has also been added to the left side of the map.</p><p>Added English translation of the website.</p>","2025-09":"<p>Added ability to download site spatial data in GeoJSON format.</p><p>Added visible identifiers for Finnish Heritage Agency datasets (e.g. ancient monument number).</p><p>Fixed 3D models for lands maritime sites.</p><p>Added the <a href=\'https://www.maanmittauslaitos.fi/tutkimus/teematietoa/korkeusmallit\' target=\'_blank\'>elevation model</a> from the National Land Survey (MML) to base maps.</p><p>Added the Finnish Heritage Agencys <a href=\'https://www.kyppi.fi/palveluikkuna/VARKL/asp/v_default.aspx\' target=\'_blank\'>Nationally Significant Archaeological Sites (VARK)</a>.</p><p>Added GTKs soil map.</p>","2025-05":"<p>Added the land uplift map from <a href=\'https://maannousu.info/\' target=\'_blank\'>Maannousu.info</a>.</p>","2025-04":"<p>Added historical maps from the National Land Surveys <a href=\'https://www.maanmittauslaitos.fi/ajankohtaista/yli-30-000-vanhaa-karttaa-jopa-150-vuoden-takaa-nyt-paikkatietona\' target=\'_blank\'>collection of over 30,000 old maps</a>.</p>","2024-01":"<p>Added the Finnish Heritage Agencys \'Other Cultural Heritage Site\' map layer for both points and areas. Previously, these were included in the \'Fixed Ancient Monuments\' layer, but on the new server they are a separate layer.</p>","2023-12":"<p>Switched the Finnish Heritage Agencys map service from the closed ArcGIS <a href=\'https://kartta.nba.fi\' target=\'_blank\'>kartta.nba.fi</a> server to the new <a href=\'https://geoserver.museovirasto.fi/geoserver\' target=\'_blank\'>geoserver.museovirasto.fi</a> server. Filtering of fixed ancient monuments on the map is still broken.</p>","2022-04":"<p>Added support for <a href=\'https://en.wikipedia.org/wiki/Progressive_web_application\' target=\'_blank\'>Progressive Web Application</a>. The website can now be added as a shortcut to a mobile device home screen, opening in a version without a browser address bar.</p>","2021-03":"<p>Added the City of Helsinkis dataset on <a href=\'https://hri.fi/data/fi/dataset/helsingin-ensimmaisen-maailmansodan-aikaiset-maalinnoitukset\' target=\'_blank\'>First World War fortifications</a> as a map layer.</p>","2021-02":"<p>Added the Geological Survey of Finlands <a href=\'https://tupa.gtk.fi/paikkatieto/meta/ancient_shorelines.html\' target=\'_blank\'>Ancient Shorelines</a> dataset as a map layer.</p>","2021-01":"<p>Added Swedish translations (thanks to Jenni Lucenius and Mikko Helminen!).</p><p>The type and subtype of fixed ancient monuments are now links to the <a href=\'http://akp.nba.fi\' target=\'_blank\'>Guide to Archaeological Cultural Heritage</a> website.</p><p>Added full-screen mode.</p>","2020-11":"<p>Added spatial data from the book <a href=\'./maisemanmuisti/\' target=\'_blank\'>Memory of the Landscape  Nationally Significant Ancient Monuments</a> to the map, highlighted with <img src=\'images/maiseman-muisti.png\' />.</p><p>Map layer visibility settings are now updated in the browser address bar, allowing reloading the page to restore previous settings.</p>","2020-04":"<p>Added <a href=\'./3d/\' target=\'_blank\'>3D model database</a> and highlights (<img src=\'images/3d_malli_circle.png\' /><img src=\'images/3d_malli_square.png\' />) for sites that have 3D models available.</p>","2020-02":"<p>Location tracking now updates automatically on the map.</p>","2019-08":"<p>Switched to land Governments new <a href=\'https://www.kartor.ax/datasets/fornminnen\'>kartor.ax</a> map service. Site search now also works for land sites.</p>","2018-12":"<p>Switched to the National Land Surveys new <a href=\'https://www.maanmittauslaitos.fi/kartat-ja-paikkatieto/asiantuntevalle-kayttajalle/kartta-ja-paikkatietojen-rajapintapalvelut-17\'>map service</a>, improving the base maps clarity, enabling the <a href=\'https://www.maanmittauslaitos.fi/kartat-ja-paikkatieto/asiantuntevalle-kayttajalle/tuotekuvaukset/ortokuva\'>Orthophotos</a> layer, and displaying the brown \'Other Cultural Heritage Site\' points.</p>","2017-11":"<p>Added the land Governments <a href=\'http://www.regeringen.ax/kulturarv/arkeologi-fornlamningar/fornlamningsregistret\' target=\'_blank\'>Ancient Monument Register</a> to the map.</p>","2015-10":"<p>First version released.</p>"}},"settings":{"title":"Settings","common":{"transparency":"Transparency ({{transparency}} %)"},"mml":{"title":"National Land Survey of Finland datasets","basemap":{"title":"Base map","layer":{"maastokartta":"Topographic map","taustakartta":"Background map","ortokuva":"Orthophoto","mml_korkeusmalli_25m_2000":"Elevation model 25 m"}},"vanhatKartat":{"title":"Old maps","section":{"topografisetKartat":"Topographic maps (<a href=\'https://www.maanmittauslaitos.fi/sites/maanmittauslaitos.fi/files/attachments/2024/04/Vanhatkartat2024_verkkoon.pdf\' target=\'_blank\'>more info</a>)","yleiskartta":"General map (<a href=\'https://www.maanmittauslaitos.fi/sites/maanmittauslaitos.fi/files/attachments/2024/04/Vanhatkartat2024_verkkoon.pdf\' target=\'_blank\'>more info</a>)","pitjnkartasto":"Parish map series (<a href=\'https://www.maanmittauslaitos.fi/sites/maanmittauslaitos.fi/files/attachments/2024/04/Vanhatkartat2024_verkkoon.pdf\' target=\'_blank\'>more info</a>)","taloudellinenKartta":"Economic map (<a href=\'https://www.maanmittauslaitos.fi/sites/maanmittauslaitos.fi/files/attachments/2024/04/Vanhatkartat2024_verkkoon.pdf\' target=\'_blank\'>more info</a>)","maastokartat":"Base map 1:20,000 / 1:25,000 and Topographic map 1:50,000 (<a href=\'https://www.maanmittauslaitos.fi/sites/maanmittauslaitos.fi/files/attachments/2024/04/Vanhatkartat2024_verkkoon.pdf\' target=\'_blank\'>more info</a>)"},"layer":{"mml_ven_topo_21k_1871_1919":"Russian topographic map, 1:21,000, 18711919","mml_ven_topo_42k_1870_1944":"Russian topographic map, 1:42,000, 18701944","mml_ven_topo_42k_192x":"Russian topographic map, 1:42,000, 1920s","mml_ven_topo_84k_1916-1917":"Russian topographic map, 1:84,000, 19161917","mml_yleiskartta_400k_1863-1879":"General map (raster), 1:400,000, 18631879","mml_yleiskartta_400k_1880-1899":"General map (raster), 1:400,000, 18801899","mml_yleiskartta_400k_1900-1919":"General map (raster), 1:400,000, 19001919","mml_yleiskartta_400k_1920-1939":"General map (raster), 1:400,000, 19201939","mml_yleiskartta_400k_1940-1972":"General map (raster), 1:400,000, 19401972","mml_yleiskartta_400k_1954-1975":"General map (raster), 1:400,000, 19541975","mml_yleiskartta_400k_1983-1992":"General map (raster), 1:400,000, 19831992","mml_yleiskartta_500k_1996":"General map (raster), 1:500,000, 1996","mml_yleiskartta_500k_2000":"General map (raster), 1:500,000, 2000","mml_pitajakartta_20k_1912-1968":"Parish map, 1:20,000, 19121968","mml_taloudellinen_100k_1911-1970":"Economic map, 1:100,000, 19111970","mml_topo_100k_1928_1947":"Terrain, base or topographic map, 1:100,000, 19281947","mml_topo_100k_1948_1989":"Terrain, base or topographic map, 1:100,000, 19481989","mml_topo_20k_1924-1948":"Terrain, base or topographic map, 1:20,000, 19241948","mml_topo_20k_1947-1959":"Terrain, base or topographic map, 1:20,000, 19471959","mml_topo_20k_1960-1969":"Terrain, base or topographic map, 1:20,000, 19601969","mml_topo_20k_1970-1979":"Terrain, base or topographic map, 1:20,000, 19701979","mml_topo_20k_1980-1997":"Terrain, base or topographic map, 1:20,000, 19801997","mml_topo_50k_1922-1946":"Terrain, base or topographic map, 1:50,000, 19221946","mml_topo_50k_1964-2006":"Terrain, base or topographic map, 1:50,000, 19642006","mml_topo_50k_2005-2020":"Terrain, base or topographic map, 1:50,000, 20052020"}},"licence":" National Land Survey of Finland (<a href=\'https://creativecommons.org/licenses/by/4.0/deed.fi\'>CC BY 4.0</a>)"},"gtk":{"title":"Geological Survey of Finland datasets","licence":" Geological Survey of Finland"},"maannousuInfo":{"title":"Maannousu.info land uplift map","info":"Land uplift calculation model: <a href=\'https://maannousu.info/model-v2\' target=\'_blank\'>Glacial Land Adjustment Regenerator (Glare)</a>","info2":"Land uplift can be viewed for the period 10,000 BCE  1900 CE. The year can be selected from the bottom of the map. For the years 10,000 BCE  8500 BCE, the continental ice sheet over the Nordic countries is also shown.","licence":"<a href=\'https://creativecommons.org/licenses/by/4.0/deed.fi\'>CC BY 4.0</a>","webGLError":"Your browser does not support WebGL technology required to display Maannousu.info maps. Unfortunately, Maannousu.info maps will not work on your device.","placementSwitch":"Hide sites located below sea level"},"museovirasto":{"title":"Finnish Heritage Agency datasets","licence":" Finnish Heritage Agency (<a href=\'https://creativecommons.org/licenses/by/4.0/deed.fi\'>CC BY 4.0</a>)","filters":{"title":"Sites from the Ancient Monument Register Shown on the Map","info":"The filter applies only to point locations in the Ancient Monument Register, not to area features.","type":"Type","dating":"Dating"}},"ahvenanmaa":{"title":"Government of land datasets","licence":" Government of land (<a href=\'https://creativecommons.org/licenses/by/4.0/deed.fi\'>CC BY 4.0</a>)"},"helsinki":{"title":"City of Helsinki datasets","licence":" City of Helsinki (<a href=\'https://creativecommons.org/licenses/by/4.0/deed.fi\'>CC BY 4.0</a>)"},"viabundus":{"title":"Viabundus project datasets","year":"Year ({{selectedYear}})","licence":" Viabundus project (<a href=\'https://creativecommons.org/licenses/by-sa/4.0/deed.fi\'>CC BY-SA 4.0</a>)"},"3Dmodels":{"title":"3D models"},"maisemanMuisti":{"title":"Memory of the Landscape  Nationally Significant Ancient Monuments"}},"search":{"title":"Search sites","info":"You can search by site name (e.g. Turun linna) or register ID (e.g. 200284 or Sa 14.1).","placeholder":"Enter the name or part of a name","searchButton":"Search","error":"The search term must contain at least three characters","searchResultTitle":"Search Results","resultCount":"items"},"details":{"title":"Selected sites","finnishHeritageAgencyMoreInfoLink":"More information about the site is available from the Finnish Heritage Agencys <a href=\'{{url}}\' target=\'_blank\'>{{ registerName }}</a>.","registerLink":{"fromMuinaisjaannos":"from the Ancient Monument Register","fromRKY":"from the rky.fi register","fromMaailmanperinto":"from the Finnish Heritage Agency website","fromRakennusperint":"from the Architectural Heritage Register","fromVark":"from the VARK area register"},"field":{"id":"Identifier","alakohdetunnus":"Subsite identifier","varkId":"VARK identifier","feature":"Site","name":"Name","featureName":"Site name","buildingName":"Building name","municipality":"Municipality","region":"Region","village":"Village","description":"Description","location":"Location","type":"Type","subType":"Subtype","dating":"Dating","typeAndDating":"Type and dating","mainCategory":"Main category","subCategory":"Subtype","mainEra":"Main period","period":"Period","featureCount":"Count","precision":"Accuracy","legislation":"Legislation","featureType":"Category","protectionGroup":"Protection group","maalinnoitus":{"tukikohta":"Base","puolustusasema":"Defensive position","olotila":"Condition","mittaustieto":"Measurement data","yksikk":"Unit","yksiknTyyppi":"Unit type","yksikknumero":"Unit number","rakennustapa":"Construction method","rakennushistoria":"Construction history","kohteenTyyppi":"Site type","rajauksenTyyppi":"Boundary type"},"downloadGeometry":"Download GeoJSON spatial data","muinaisjnnkset":"Ancient monuments","lhteet":"Sources","yleisetLhteet":"General sources","markkinapivt":"Market days","rekonstruktiotarkkuus":"Reconstruction accuracy","asukasluku":"Estimated population"},"3d":{"title":"3D models of the site","infoHeading":"More about the 3D models","infoText1":"These 3D models come from the <a href=\'./3d/\' target=\'_blank\'>database</a>, which lists models created by hobbyists and official institutions (museums, the Finnish Heritage Agency, Government of land) through the <a href=\'https://sketchfab.com\' target=\'_blank\'>Sketchfab</a> service.","infoText2":"You can start a model using the arrow button. Once started, press <kbd>f</kbd> or use the lower-right button to enter full-screen mode.","controls":{"title":"Model controls","rotateTitle":"Rotation","rotate":"Hold down the left mouse button and move the mouse. On touch screens, hold your finger on the model and move it.","zoomTitle":"Zoom in and out","zoom":"Use the mouse wheel. On touch screens, use the two-finger pinch gesture.","focusTitle":"Move focus point","focus":"Hold down the right mouse button and move the mouse. On touch screens, hold two fingers down and move them."}}},"data":{"register":{"name":{"Muinaisjnnsrekisteri":"Ancient Monument Register","Valtakunnallisesti merkittvt rakennetut kulttuuriympristt":"Nationally Significant Built Cultural Environments","Maailmanperintkohteet":"World Heritage Sites","Rakennusperintrekisteri":"Architectural Heritage Register","vark":"Nationally Significant Archaeological Sites (VARK)","Ahvenanmaan muinaisjnnsrekisteri":"land Ancient Monument Register","Ahvenanmaan merellinen kulttuuriperintrekisteri":"land Maritime Cultural Heritage Register","3Dmodels":"3D Models","maisemanMuisti":"Memory of the Landscape  Nationally Significant Ancient Monuments","maalinnoitus":"First World War Fortifications of Helsinki","muinaisrannat":"Ancient Shorelines","MaannousuInfo":"Maannousu.info Land Uplift Map","viabundus":"Viabundus Project"},"nameWithLink":{"Muinaisjnnsrekisteri":"Ancient Monument Register (<a href=\'https://www.kyppi.fi/palveluikkuna/mjreki/read/asp/r_default.aspx\' target=\'_blank\'>more info</a>)","Valtakunnallisesti merkittvt rakennetut kulttuuriympristt":"Nationally Significant Built Cultural Environments (<a href=\'http://www.rky.fi/\' target=\'_blank\'>more info</a>)","Maailmanperintkohteet":"World Heritage Sites (<a href=\'https://www.museovirasto.fi/fi/tietoa-meista/kansainvalinen-toiminta/maailmanperintokohteet-suomessa\' target=\'_blank\'>more info</a>)","Rakennusperintrekisteri":"Architectural Heritage Register (<a href=\'https://www.kyppi.fi/palveluikkuna/rapea/read/asp/r_default.aspx\' target=\'_blank\'>more info</a>)","vark":"Nationally Significant Archaeological Sites (VARK) (<a href=\'https://www.kyppi.fi/palveluikkuna/VARKL/asp/v_default.aspx\' target=\'_blank\'>more info</a>)","Ahvenanmaan muinaisjnnsrekisteri":"land Ancient Monument Register (<a href=\'https://hub.arcgis.com/datasets/aland::fornminnen-1/\' target=\'_blank\'>more info</a>)","Ahvenanmaan merellinen kulttuuriperintrekisteri":"land Maritime Cultural Heritage Register (<a href=\'https://hub.arcgis.com/datasets/aland::maritimt-kulturarv-vrak-1/\' target=\'_blank\'>more info</a>)","3Dmodels":"3D Models (<a href=\'./3d/\' target=\'_blank\'>more info</a>)","maisemanMuisti":"Memory of the Landscape  Nationally Significant Ancient Monuments (<a href=\'./maisemanmuisti/\' target=\'_blank\'>more info</a>)","maalinnoitus":"First World War Fortifications of Helsinki (<a href=\'https://hri.fi/data/fi/dataset/helsingin-ensimmaisen-maailmansodan-aikaiset-maalinnoitukset\' target=\'_blank\'>more info</a>)","MaannousuInfo":"Land Uplift Map (<a href=\'https://maannousu.info\' target=\'_blank\'>more info</a>)","viabundus":"Viabundus Project (<a href=\'https://www.landesgeschichte.uni-goettingen.de/handelsstrassen/info.php?lang=fin\' target=\'_blank\'>more info</a>)"}},"featureType":{"Kiinte muinaisjnns":"Fixed ancient monument","Muu kulttuuriperintkohde":"Other cultural heritage site","Kiinte muinaisjnns (alue)":"Fixed ancient monument (area)","Muu kulttuuriperintkohde (alue)":"Other cultural heritage site (area)","Valtakunnallisesti merkittv muinaisjnns":"Nationally significant ancient monument","Rakennettu kulttuuriymprist":"Built cultural environment","Maailmanperintkohde":"World Heritage Site","Rakennusperintkohde":"Architectural heritage site","varkPiste":"Nationally Significant Archaeological Sites (VARK), centroids","varkAlue":"Nationally Significant Archaeological Sites (VARK), area boundaries","lytpaikkaPiste":"Findspot","lytpaikkaAlue":"Findspot (area)","muuKohdePiste":"Other site","muuKohdeAlue":"Other site (area)","luonnonmuodostumaPiste":"Natural formation","luonnonmuodostumaAlue":"Natural formation (area)","havaintokohdePiste":"Observation site","havaintokohdeAlue":"Observation site (area)","mahdollinenMuinaisjnnsPiste":"Possible ancient monument","mahdollinenMuinaisjnnsAlue":"Possible ancient monument (area)","poistettuKiinteMuijaisjnnsPiste":"Removed fixed ancient monument","poistettuKiinteMuijaisjnnsAlue":"Removed fixed ancient monument (area)","alakohdePiste":"Subsite","Ahvenanmaan muinaisjnnsrekisterin kohde":"Site from the land Ancient Monument Register","Ahvenanmaan merellisen kulttuuriperintrekisterin kohde":"Site from the land Maritime Cultural Heritage Register","maalinnoitus":"First World War Fortifications of Helsinki","viabundus":"Viabundus dataset","viabundus-tieverkko":"Road network, Viabundus dataset","viabundus-kaupungin-rajat":"City boundaries, Viabundus dataset"},"gtk":{"layer":{"muinaisrannat":"Ancient shorelines (<a href=\'https://tupa.gtk.fi/paikkatieto/meta/ancient_shorelines.html\' target=\'_blank\'>more info</a>)","maapera_200k_maalaji":"Soil map 1:200,000, soil types"},"feature":{"supra-akvaattinen":"Supra-aquatic  area remaining above sea level after the Ice Age","yoldia":"Area covered by the Yoldia Sea or Ancylus Lake (11,6007,200 BCE)","litorina":"Area covered by the Litorina Sea (8,5004,000 BCE)","maalajit_ohut_turvekerros":"Thin peat layer (Tvo, 0.30.6 m)","maalajit_soistuma":"Bog or wetland (Tvs, < 0.3 m)","maalajit_vesi":"Water","maalajit_kartoittamaton":"Unmapped","maalajit_taytemaa":"Fill soil","maalajit_paksu_turvekerros":"Thick peat layer, usually over 0.6 m","maalajit_lieju":"Mud, humus content over 6 %","maalajit_savi":"Clay","maalajit_liejuinen_hienorakenteinen_maalaji":"Muddy fine-grained soil, humus content 26 %","maalajit_hienorakenteinen_maalaji":"Fine-grained soil, main grain type unspecified","maalajit_karkearakenteinen_maalaaji":"Coarse-grained soil, main grain type unspecified","maalajit_sekalajitteinen_maalaji":"Mixed-grained soil, main grain type unspecified","maalajit_kivia":"Stony","maalajit_rakka":"Block field","maalajit_kalliomaa":"Bedrock soil, surface cover up to 1 m (usually till)","maalajit_kalliopaljastuma":"Rock outcrop"}},"helsinki":{"layer":{"Maalinnoitus_karttatekstit":"Unit names","Maalinnoitus_yksikot":"Units and their numbers","Maalinnoitus_kohteet":"Sites","Maalinnoitus_rajaukset":"Boundaries"},"feature":{"asema":"Trench, shelter, gun position","luola":"Cave","tykkipatteri":"Gun battery","tykkitie":"Gun road","puolustusasemanRaja":"Defensive position boundary","tukikohdanRaja":"Base boundary"},"featureType":{"kohde":"Site","yksikk":"Unit","rajaus":"Boundary"},"yksikkoLaji":{"asema":"Position","tykkipatteri":"Gun battery","tykkitie":"Gun road","muu":"Other"},"yksikko":{"tulipeske":"Firing position","suojahuone":"Shelter","kuoppa":"Pit","tykkiasema":"Gun emplacement","rakenne":"Structure","hauta":"Trench","luola":"Cave","jalusta":"Base","suojavalli":"Protective embankment"},"kohdetyyppi":{"asema (hauta,suojahuone, tulipeske)":"Position (trench, shelter, firing position)","luola":"Cave","tykkitie":"Gun road","tykkipatteri":"Gun battery"},"rajaustyyppi":{"tukikohta":"Base","laji":"Defensive position"}},"viabundus":{"place":{"settlement":"Settlement","town":"Town","fair":"Fair","toll":"Toll station","bridge":"Bridge","ferry":"Ferry","harbour":"Harbour","lock":"Lock"},"road":{"canal":"Canal","coast":"Navigable waterway","coastUncertain":"Uncertain alignment of navigable waterway","ferry":"Ferry","land":"Road","landUncertain":"Uncertain road alignment","river":"River","winter":"Winter road"},"roadCertainty":{"1":"Certain","2":"Partly uncertain","3":"Uncertain"},"townOutline":"Town boundaries","population":{"year":"Year","inhabitants":"Inhabitants"}},"museovirasto":{"muinaisjnnsAjoitusTimespan":{"esihistoriallinen":"8600 BCE  1200 CE","kivikautinen":"8850  1700 BCE","varhaismetallikautinen":"1800 BCE  300 CE","pronssikautinen":"1700  500 BCE","rautakautinen":"500 BCE  1200 CE","keskiaikainen":"1200  1520 CE","historiallinen":"from 1200 CE onwards","moderni":"from 1800 CE onwards"},"muinaisjnnsAjoitus":{"ajoittamaton":"undated","ei mritelty":"undefined","esihistoriallinen":"prehistoric","historiallinen":"historic","keskiaikainen":"medieval","kivikautinen":"Stone Age","moderni":"modern","moniperiodinen":"multi-period","pronssikautinen":"Bronze Age","rautakautinen ja/tai keskiaikainen":"Iron Age and/or medieval","rautakautinen":"Iron Age","varhaismetallikautinen":"Early Metal Period"},"varkAjoitusTimespan":{"esihistoriallinen":"8600 BCE  1200 CE","kivikautinen":"8850  1700 BCE","mesoliittinen":"8850  5200 BCE","neoliittinen":"5200  1700 BCE","varhaismetallikautinen":"1800 BCE  300 CE","pronssikautinen":"1700  500 BCE","rautakautinen":"500 BCE  1200 CE","esiroomalainen aika":"Pre-Roman period (500 BCE  50 CE)","nuorempi roomalaisaika":"Later Roman period (150/200  375/400 CE)","vanhempi roomalaisaika":"Early Roman period (0/50  150/200 CE)","merovingiaika":"Merovingian period (550/600  800/825 CE)","viikinkiaika":"Viking Age (800/825  1025/1050/1075 CE)","ristiretkiaika":"Crusade period (1025/1050/1075  1150/1200 CE)","keskiaikainen":"1200  1520 CE","historiallinen":"from 1200 CE onwards","moderni":"from 1800 CE onwards"},"varkAjoitus":{"1100-luku":"12th century","1200-luku":"13th century","1300-luku":"14th century","1400-luku":"15th century","1500-luku":"16th century","1600-luku":"17th century","1700-luku":"18th century","1800-luku":"19th century","1900-luku":"20th century","Vaasa-aika 15231617":"Vasa period 15231617","ajoittamaton":"undated","autonomian aika 18091917":"Era of Autonomy 18091917","ei mritelty":"undefined","esihistoriallinen":"prehistoric","esiroomalainen aika":"Pre-Roman period","historiallinen":"historic","kansainvaellusaika":"Migration period","keskiaikainen":"medieval","kivikautinen":"Stone Age","merovingiaika":"Merovingian period","mesoliittinen":"Mesolithic","moderni":"modern","neoliittinen":"Neolithic","nuorempi roomalaisaika":"Later Roman period","pronssikautinen":"Bronze Age","rautakautinen":"Iron Age","rautakautinen ja/tai keskiaikainen":"Iron Age and/or medieval","ristiretkiaika":"Crusade period","suurvalta-aika 16171721":"Great Power period 16171721","toinen maailmansota 19391945":"Second World War 19391945","vanhempi roomalaisaika":"Early Roman period","vapauden aika ja kustavilainen aika 17211809":"Age of Liberty and Gustavian period 17211809","varhaismetallikautinen":"Early Metal Period","viikinkiaika":"Viking Age"},"type":{"alusten hylyt":"shipwrecks","asuinpaikat":"settlement sites","ei mritelty":"undefined","hautapaikat":"burial sites","kirkkorakenteet":"church structures","kivirakenteet":"stone structures","kulkuvylt":"routes and roads","kultti- ja tarinapaikat":"ritual and legendary sites","luonnonmuodostumat":"natural formations","lytpaikat":"findspots","maarakenteet":"earthworks","muinaisjnnsryhmt":"groups of ancient monuments","puolustusvarustukset":"defensive structures","puurakenteet":"wooden structures","raaka-aineen hankintapaikat":"raw material extraction sites","tapahtumapaikat":"event sites","teollisuuskohteet":"industrial sites","taide, muistomerkit":"art and memorials","ty- ja valmistuspaikat":"work and production sites"},"subtype":{"aallonmurtajat":"breakwaters","aidat":"fences","ammusvarastot":"ammunition depots","asumuspainanteet":"dwelling depressions","ei mritelty":"undefined","ersijat":"hunting cabins","haaksirikkopaikat":"shipwreck sites","hakkaukset":"engravings","hangakset":"fish traps","hautakammiot":"burial chambers","hautakummut":"burial mounds","hautarykkit":"burial cairns","hautasaaret":"burial islands","hautausmaat":"cemeteries","hiekanottokuopat":"sand pits","hiilimiilut":"charcoal kilns","hirsivarustukset":"timber structures","hospitaalit ja sairaalat":"hospitals","hylyt (metalli)":"wrecks (metal)","hylyt (puu)":"wrecks (wood)","hyrysahat":"steam sawmills","irtolytpaikat":"findspots (stray finds)","jatulintarhat":"stone labyrinths (Jatulintarha)","joukkohaudat":"mass graves","jtinkirkot":"giants churches","kaivannot":"trenches or ditches","kaiverrukset":"carvings","kaivokset":"mines","kaivot":"wells","kalastuspaikat":"fishing sites","kalkkiuunit":"lime kilns","kalliomaalaukset":"rock paintings","kalliopiirrokset":"rock carvings","kanavat":"canals","kapulatiet":"corduroy roads","karsikkopaikat":"memorial tree sites (karsikko)","kartanot":"manor houses","kaskirykkit":"burning-field cairns","kaupungit":"towns","keittokuopat":"cooking pits","kellarit":"cellars","kellotapulinpaikat":"belfry sites","kentt (gieddi)":"fields (gieddi)","keramiikkatehtaat":"ceramics factories","kestikievarit":"inns or hostels","keshaudat":"summer graves","kiinnitysrenkaat":"mooring rings","kirkkohaudat":"church burials","kirkkomaat":"churchyards","kirkonpaikat":"church sites","kirkonrauniot":"church ruins","kiukaat":"stoves or fireplaces","kiviaidat":"stone fences","kivilatomukset":"stone settings","kivilinnat":"stone castles","kivimuurit":"stone walls","kivipydt":"stone tables","kivivallit":"stone embankments","kivivarustukset":"stone fortifications","kodanpohjat":"hut floors","kompassiruusut":"compass roses","kullanhuuhdonnan jnnkset":"gold panning remains","kummelit":"cairns or seamarks","kummut":"mounds","kuninkaankartanot":"royal manors","kuopat":"pits","kuparinsulattamot":"copper smelters","kuppikivet":"cup-marked stones","kylnpaikat":"village sites","krjpaikat":"court sites","ksittelypaikat":"processing sites","ktkt":"caches or hoards","laiturit":"piers","laivalatomukset":"stone ship settings","laivanrakennuspaikat":"shipbuilding sites","lapinpadot":"small wooden dams (Lapinpatos)","lapinrauniot":"Lapp cairns","lasitehtaat":"glassworks","latomukset":"stone settings","liesikiveykset":"fireplace stone settings","liesilatomukset (rran)":"fireplace constructions (rran)","linnakkeet":"forts","linnamalmit":"hillforts","linnat":"castles","linnavuoret":"hillforts","linnoitukset":"fortifications","linnustuspaikat":"hunting sites","louhokset":"quarries","luolat":"caves","luostarinpaikat":"monastery sites","luotsi- ja tulliasemat":"pilot and customs stations","lhteet":"springs","maanmittauspisteet":"survey points","maavallit":"earth embankments","majakat":"lighthouses","manufaktuurit":"manufactories","markkinapaikat":"marketplaces","masuunit":"blast furnaces","merimerkit":"seamarks","merkkikivet":"marker stones","merkkipuut":"marker trees","miekanhiontakivet":"sword sharpening stones","muinaislinnat":"ancient castles or hillforts","muinaispellot":"ancient fields","muistomerkit":"memorials","muistopaikat":"memorial places","mkituvat":"crofters cottages","nauriskuopat":"turnip pits","optiset lenntinasemat":"optical telegraph stations","ortodoksikalmistot":"Orthodox cemeteries","painanteet":"depressions","painolastipaikat":"ballast sites","pajat":"smithies or workshops","palokuoppahaudat":"cremation pits","panssariesteet":"anti-tank obstacles","paperitehtaat":"paper mills","pappilat":"parsonages","piilopirtit":"hiding cabins","piiskauspetjt":"whipping pines","pikiruukit":"tar distilleries","pirunpellot":"devils fields (block fields)","pitkospuut":"duckboards","polttokenttkalmistot":"cremation cemeteries","polut":"paths","poroaidat":"reindeer fences","portaat":"stairs","potaskauunit":"potash kilns","puistot":"parks","purnut":"log structures","puutarhat":"gardens","pyyntikuopat":"hunting pits","pyyntitukikohdat":"hunting bases","rajamerkit":"boundary markers","rajamerkit, puu":"boundary markers, wooden","rakkakuopat":"block-field pits","rangaistuspaikat":"execution sites","rantakivikot":"shore stone alignments","ratapohjat":"railway beds","raudanvalmistuspaikat":"iron production sites","rautaruukit":"ironworks","ristikivet":"cross stones","ruuhet":"dugout boats","ruumiskalmistot":"inhumation cemeteries","ruttohautausmaat":"plague cemeteries","ryssnuunit":"Russian ovens (WWI)","rykkit":"stone cairns","salpietarikeittimt":"saltpetre works","satamat":"harbours","savupiiput":"chimneys","seidat":"sacred Smi stones (seidas)","sillanpaikat":"bridge sites","sillat":"bridges","sirpalekivikasat":"shrapnel stone piles","sotilasleirit":"military camps","sudenkuopat":"wolf pits","suojahuoneet":"shelters","taistelukaivannot":"battle trenches","taistelupaikat":"battle sites","talonpohjat":"house foundations","tarhakalmistot":"fenced cemeteries","tarinapaikat":"legendary sites","telakat":"shipyards","terva- ja trpttitehtaat":"tar and turpentine factories","tervahaudat":"tar kilns","terveyslhteet":"healing springs","tienpohjat":"old roadbeds","tiilenpolttouunit":"brick kilns","tiilitehtaat":"brickworks","tomtning-jnnkset":"tomtning remains (Smi dwelling remains)","tornit":"towers","torpat":"crofts","tsasounanpaikat":"chapel sites (tsasouna)","tulipeskkeet":"firing positions","tulisijat":"hearths","tupasijat":"hut fireplaces","tuulimyllyt":"windmills","tykkiasemat":"gun emplacements","tykkitiet":"gun roads","thystysasemat":"observation posts","uhrikivet":"sacrificial stones","uhrilehdot":"sacred groves","uhripuut":"sacrificial trees","uittolaitteet":"log driving structures","uunit":"ovens","valkamat":"landing places","vallihaudat":"moats","vallit":"embankments","valonheitinasemat":"searchlight positions","veneenvetopaikat":"boat hauling sites","vesimyllyt":"watermills","vesisahat":"water-powered sawmills","viljelmt":"cultivation areas","viljelyrykkit":"field clearance cairns","virkatalot":"official residences","virstanpylvt":"milestones","yhdyshaudat":"connecting trenches","yksinistalot":"isolated farms"},"featureType":{"kiinte muinaisjnns":"fixed ancient monument","muu kulttuuriperintkohde":"other cultural heritage site"}},"ahvenanmaa":{"type":{"Uppgifter saknas":"Information missing","Agrara lmningar":"Agrarian remains","Bebyggelselmningar":"Settlement remains","Befstningsanlggningar":"Defensive structures","Boplatser":"Dwelling sites","Gravar":"Burial sites","Industriell-/produktionsplatser":"Industrial and production sites","Jakt och fngst":"Hunting and trapping remains","Kommunikations-/maritima lmningar":"Communication and maritime heritage","Kult, offer och folktro":"Cult, sacrificial and folklore sites","Ristningar och minnesmrken":"Carvings and monuments","vriga lmningar":"Other remains"},"subType":{"Uppgifter saknas":"information missing","artilleristllning":"artillery position","avrttningsplats":"execution site","befstning":"fortification","begravningsplats":"burial ground","bevakning/signalering":"observation/signalling site","boplats":"dwelling site","brokista":"stone cist","brott/tkt":"quarry/pit","brunn/kallklla":"well/spring","bytomt/grdstomt":"village or farmstead site","depofynd":"hoard","domarring":"stone circle (thing stones)","flygstation":"airfield","fornborg":"ancient fort","fossil ker":"ancient field","fltbefstning":"field fortification","fngstgrop":"hunting pit","frtjningsanordning":"mooring device","frvaringsanlggning":"storage pit","grav":"grave","gravhg":"burial mound","gravrse":"burial cairn","gruvlmning":"mine","grnsmrke":"boundary marker","hamnanlggning":"harbour structure","husgrund":"building foundation","hgnad":"fence or enclosure","hggravflt":"mound cemetery","industrilmning":"industrial site","kastalgrund":"castle mound or tower base","kyrka/kapell":"church/chapel","labyrint":"stone labyrinth","minnesmrke":"memorial","offerplats":"sacrificial site","ristning":"rock carving","rjningsrse":"clearance cairn","rsegravflt":"cairn cemetery","sjmrke":"seamark","skeppssttning":"stone ship setting","skrvstenshg":"fire-cracked stone mound","slott":"castle","stenkompass":"stone compass rose","stenugn":"stone oven","tomtning":"tomtning (ancient hut foundation)","traditionsplats":"legendary or tradition site","transport/frrd":"transport/storage site","treudd":"triangular stone setting (treudd)","varv":"shipbuilding site","vglmning":"road remain"},"dating":{"Frhistorisk tid":"Prehistoric period","Historisk tid":"Historic period","Stenlder":"Stone Age","Bronslder":"Bronze Age","Jrnlder":"Iron Age","Medeltid":"Middle Ages","Sentid":"Early modern period","Uppgifter saknas":"Information missing"},"subDating":{"1600-tal":"17th century","1700-tal":"18th century","1800-tal":"19th century","1900-tal":"20th century","Tidigneolitikum":"Early Neolithic","Yngre jrnlder":"Late Iron Age","yngre bronslder":"Late Bronze Age","yngre jrnlder":"Late Iron Age","ldre jrnlder":"Early Iron Age","ldre jrnlder":"Early Iron Age"}}}}'),kS=JSON.parse('{"common":{"Ennen ajanlaskun alkua":"eaa.","Jlkeen ajanlaskun alun":"jaa.","button":{"close":"Sulje","languageSelection":"Valitse kieli","zoomOut":"Loitonna","zoomIn":"Lhenn","settings":"Kartan asetukset","search":"Hae kohteita","info":"Ohjeita sivuston kyttn","positioning":"Keskit kartta nykyiseen sijaintiisi","fullscreen":"Kokoruudun tila","maannousuInfo":{"Edellinen vuosi":"Edellinen vuosi","Seuraava vuosi":"Seuraava vuosi"},"featureLocationLink":"Linkki suoraan thn kohteeseen"},"features":{"Alue":"Alue","Viiva":"Viiva (esim. tie)","Rakennettu alue":"Rakennettu alue","Rakennus":"Rakennus","Kohde":"Kohde","3D-malli":"3D-malli","Valtakunnallisesti merkittv muinaisjnns":"Valtakunnallisesti merkittv muinaisjnns","aluerajaukset":"Aluerajaukset","keskipisteet":"Keskipisteet"},"organization":{"Maanmittauslaitos":"Maanmittauslaitos","Museovirasto":"Museovirasto","Ahvenanmaan paikallishallinto":"Ahvenanmaan paikallishallinto","Geologian tutkimuskeskus":"Geologian tutkimuskeskus","Helsingin kaupunki":"Helsingin kaupunki","viabundus":"Viabundus-projekti","Maannousu.info":"Maannousu.info"}},"linkedFeature":{"header":"Linkitetty kohde","showOnMap":"Nyt kartalla","showFeatureDetails":"Nyt tiedot","remove":"Poista linkitys"},"info":{"title":"Listietoja sivustosta","dataUpdates":{"title":"Paikkatietoaineiston ajantasaisuus","description":"Aineistojen pivitystiheys:","mml":"Realiaikaisesti","museovirasto":"Uudet kohteet 0-24 tunnin viiveell, klikkaamalla nytettvt tarkemmat tiedot realiaikaisesti","ahvenanmaa":"Realiaikaisesti","gtk":"Realiaikaisesti","helsinki":"Realiaikaisesti","viabundus":"Manuaalisesti. Nyt kytss on aineiston versio 2, joka on julkaistu 25.4.2025","Maannousu.info":"Realiaikaisesti"},"symbols":"Karttasymbolit","siteInfo":{"title":"Tietoa sivustosta","registerInfo":"Tll sivustolla net kartalla seuraavien rekisterien tiedot","info1":"Kaikki nytettvt kohteet ovat avointa dataa ja haettu rekisterin yllpitjn tarjoamasta karttapalvelusta.","info2":"Kohteista saa listietoikkunan nkyviin klikkaamalla kohdetta kartalla. Tst nkymst on mys linkki kohteen listietoihin rekisterin yllpitjn sivustolla. Kohteen otsikon vieress olevasta kuvakkeesta (<i className=\'bi bi-geo-alt-fill\' aria-hidden=\'true\' />) saa talteen pysyvn linkin kohteen sijaintiin kartalla.","3DModelsInfo":"Joillekin kohteille on saataville mys 3D-malleja <a href=\'./3d/\' target=\'_blank\'>tietokannasta</a>, joka listaa harrastajien sek virallisen toimijoiden (museot, Museovirasto, Ahvenanmaan paikallioshallinto) tekemi 3D-mallinnuksia <a href=\'https://sketchfab.com\' target=\'_blank\'>Sketchfab</a> -palvelusta.","positioningTitle":"Paikannus","positioningInfo":"Kartta keskitetn oletuksena nykyiseen sijaintiisi jos annat selaimelle luvan luovuttaa se tieto. Keskityksen nykyiseen sijaintiin voi suorittaa mys myhemmin <i className=\'bi bi-crosshair\' aria-hidden=\'true\' /> painikkeesta.","searchTitle":"Haku","searchInfo":"Museoviraston rekisterien kohteita pystyy hakemaan nimen perusteella hakunkymss (<i className=\'bi bi-search\' aria-hidden=\'true\' />). Hakutuloksen klikkaaminen keskitt kartan kohteeseen ja lis siihen paikkamerkin <img src=\'images/map-pin-small.png\' />.","settingsTitle":"Asetukset","settingsInfo":"Pohjakartan voi vaihtaa taustakartan ja maastokartan vlill asetuksista (<i className=\'bi bi-gear\' aria-hidden=\'true\' />). Samasta nkymst voi piilottaa Museoviraston rekisterien kohteita tyypin ja muinaisjnnksi mys ajoituksen mukaan jos haluaa tarkastella esimerkiksi pelkstn muinaisjnnksi rautakaudelta.","feedbackTitle":"Palaute","feedbackInfo":"Palautetta sivustosta otetaan mielelln vastaan osoitteeseen <a href=\'mailto:antti.kekki@gmail.com\'>antti.kekki@gmail.com</a>","developersTitle":"Kehittjt","developersInfo":"Koodaus: Antti Kekki<br/>Knnkset: Jenni Lucenius ja Mikko Helminen"},"licences":{"title":"Avoin data, lisenssit ja lhdekoodi","museovirasto":"Museoviraston rekistereist tietoa haetaan <a href=\'https://www.museovirasto.fi/fi/palvelut-ja-ohjeet/tietojarjestelmat/kulttuuriympariston-tietojarjestelmat/kulttuuriympaeristoen-paikkatietoaineistot\' target=\'_blank\'>avoimen WMS-rajapinnan</a> kautta (paikkatietoaineisto on julkaistu <a href=\'https://creativecommons.org/licenses/by/4.0/deed.fi\' target=\'_blank\'>Creative Commons CC By 4.0 -lisenssill</a>).","ahvenanmaa":"Ahvenanmaan maakuntahallinnon rekisterist tietoa haetaan <a href=\'https://www.kartor.ax/datasets\' target=\'_blank\'>avoimen WMS-rajapinnan</a> kautta (paikkatietoaineisto on julkaistu <a href=\'https://creativecommons.org/licenses/by/4.0/deed.fi\' target=\'_blank\'>Creative Commons CC By 4.0 -lisenssill</a>).","maanmittauslaitos":"Tausta-, ortokuva- ja peruskartta haetaan Maanmittauslaitoksen <a href=\'https://www.maanmittauslaitos.fi/kartat-ja-paikkatieto/asiantuntevalle-kayttajalle/kartta-ja-paikkatietojen-rajapintapalvelut-17\' target=\'_blank\'>avoimen WMTS-rajapinnan</a> kautta (paikkatietoaineisto on julkaistu <a href=\'https://creativecommons.org/licenses/by/4.0/deed.fi\' target=\'_blank\'>Creative Commons CC By 4.0 -lisenssill</a>).","maanmittauslaitosPaituli":"<a href=\'https://www.maanmittauslaitos.fi/sites/maanmittauslaitos.fi/files/attachments/2024/04/Vanhatkartat2024_verkkoon.pdf\' target=\'_blank\'>Vanhat kartat</a> ja MLL:n korkeusmalli haetaan CSC:n (Tieteen tietotekniikan keskus) Paituli-palvelun <a href=\'https://paituli.csc.fi/webservices.html\' target=\'_blank\'>avoimien WMS- ja WMTS-rajapintojen</a> kautta (paikkatietoaineistot on julkaistu <a href=\'https://creativecommons.org/licenses/by/4.0/deed.fi\' target=\'_blank\'>Creative Commons CC By 4.0 -lisenssill</a>).","gtk":"Muinaisrantojen ja maapern aineistot haetaan Geologian tutkimuskeskuksen <a href=\'https://www.gtk.fi/palvelut/aineistot-ja-verkkopalvelut/rajapintapalvelut/maapera-karttatasot-wms-rajapinnassa/\' target=\'_blank\'>avoimen WMS-rajapinnan</a> kautta. Muinaisrantojen paikkatietoaineisto on julkaistu <a href=\'https://www.gtk.fi/peruslisenssi/\' target=\'_blank\'>peruslisenssill</a> (erillislupa aineiston kyttn saatu 15.1.2021). Maapern  paikkatietoaineisto on julkaistu <a href=\'https://www.gtk.fi/avoin-lisenssi/\' target=\'_blank\'>avoimella lisenssill</a> (<a href=\'https://creativecommons.org/licenses/by/4.0/deed.fi\' target=\'_blank\'>Creative Commons CC By 4.0</a>).","maannousuInfo":"Maannousu.info sivuston maannousua kuvaava kartta <a href=\'https://maannousu.info/integration\' target=\'_blank\'>avoimen GeoTIFF-rajapinnan</a> kautta (paikkatietoaineisto on julkaistu <a href=\'https://creativecommons.org/licenses/by/4.0/deed.fi\' target=\'_blank\'>Creative Commons CC By 4.0 -lisenssill</a>).","helsinki":"Helsingin ensimmisen maailmansodan aikaisten maalinnoitusten aineisto haetaan Helsingin kaupungin <a href=\'https://hri.fi/data/fi/dataset/helsingin-ensimmaisen-maailmansodan-aikaiset-maalinnoitukset\' target=\'_blank\'>avoimen WMS-rajapinnan</a> kautta (paikkatietoaineisto on julkaistu <a href=\'https://creativecommons.org/licenses/by/4.0/deed.fi\' target=\'_blank\'>Creative Commons CC By 4.0 -lisenssill</a>).","viabundus":"Viabundus-projektin aineisto keskiaikaisesta tieverkosta ja asutuksesta on ladattu <a href=\'https://www.landesgeschichte.uni-goettingen.de/handelsstrassen/info.php?lang=fin\' target=\'_blank\'>projektin sivustolta</a> (versio 2) ja sit muokattu. Alkuperinen ja muokattu paikkatietoaineisto on julkaistu <a href=\'https://creativecommons.org/licenses/by-sa/4.0/deed.fi\' target=\'_blank\'>CC BY-SA 4.0 -lisenssill</a>. Muokatun aineiston voi ladata GeoJSON-muodossa osoitteesta <a href=\'./viabundus/Viabundus-finland.geojson\' target=\'_blank\'>muinaismuistot.info/viabundus/Viabundus-finland.geojson</a>.","maisemanmuisti":"Maiseman muisti - Valtakunnallisesti merkittvt muinaisjnnkset -kirjan paikkatieto on <a href=\'./maisemanmuisti/\' target=\'_blank\'>tietokannasta</a> johon on koottu kirjan listaamat 205 kohdetta. Kirjan sislln tekijanoikeus on Museovirastolla, jolta on kysytty lupa aineiston kyttn.","3DModels":"3D-mallit ovat avoimesta <a href=\'./3d/\' target=\'_blank\'>tietokannasta</a>, joka listaa harrastajien sek virallisen toimijoiden (museot, Museovirasto, Ahvenanmaan paikallioshallinto) tekemi 3D-mallinnuksia. Mallien lisenssit on listattu tietokannassa mallikohtaisesti.","sourceCode":"Tmn sivuston tekninen toteutus on <a href=\'https://github.com/anttikekki/muinaismuistot\' target=\'_blank\'>avointa lhdekoodia</a>, lisenssin on <a href=\'https://github.com/anttikekki/muinaismuistot/blob/master/LICENSE\' target=\'_blank\'>MIT</a>."},"versionHistory":{"title":"Versiohistoria","2025-10":"<p>Listty <a href=\'https://www.landesgeschichte.uni-goettingen.de/handelsstrassen/info.php?lang=fin\' target=\'_blank\'>Viabundus-hankkeen</a> aineisto.</p><p>Listty Museoviraston muinaisjnnsrekisterin lytpaikat, havaintokohteet, mahdolliset muinaisjnnkset, luonnonmuodostumat, poistetut muinaisjnnkset, muut kohteet ja alakohteet.</p><p>Kartalla linkitetty kohde nkyy korostettuna kohdelistauksessa. Sille on mys erillinen kontrollipainike kartan vasemmassa reunassa.</p><p>Listty sivustolle englanninkielinen knns.</p>","2025-09":"<p>Listty mahdollisuus ladata kohteen paikkatieto GeoJSON-muodossa.</p><p>Listty Museoviraston aineiston tunnisteet nkyviin (esim muinaisjnnsnumero).</p><p>Korjattu Ahvenanmaan merikohteiden 3D-mallien toimivuus.</p><p>Listty MML:n <a href=\'https://www.maanmittauslaitos.fi/tutkimus/teematietoa/korkeusmallit\' target=\'_blank\'>korkeusmalli</a> pohjakarttoihin.</p><p>Listty Museoviraston <a href=\'https://www.kyppi.fi/palveluikkuna/VARKL/asp/v_default.aspx\' target=\'_blank\'>Valtakunnallisesti merkittvt arkeologiset kohteet (VARK)</a>.</p><p>Listty GTK:n maalajien kartta.</p>","2025-05":"<p>Listty <a href=\'https://maannousu.info/\' target=\'_blank\'>Maannousu.info</a> sivuston maannousukartta.</p>","2025-04":"<p>Listty Maanmittauslaitoksen <a href=\'https://www.maanmittauslaitos.fi/ajankohtaista/yli-30-000-vanhaa-karttaa-jopa-150-vuoden-takaa-nyt-paikkatietona\' target=\'_blank\'>vanhoja karttoja</a>.</p>","2024-01":"<p>Listty Museoviraston Muu kulttuuperintkohde -karttataso pisteille ja alueille. Nm sisltyivt vanhalla karttapalvelimella Kiintet muinaisjnnkset -karttatasolle mutta uudess palvelimessa ne ovat erillinen taso.</p>","2023-12":"<p>Vaihdettu Museoviraston karttapalvelin suljetusta ArcGIS <a href=\'https://kartta.nba.fi\' target=\'_blank\'>kartta.nba.fi</a> palvelimesta uuteen <a href=\'https://geoserver.museovirasto.fi/geoserver\' target=\'_blank\'>geoserver.museovirasto.fi</a> palvelimeen. Kiinteiden muinaisjnnsten filtterinti kartalla on yh rikki.</p>","2022-04":"<p>Listty <a href=\'https://en.wikipedia.org/wiki/Progressive_web_application\' target=\'_blank\'>Progressive web application</a>-tuki. Nyt sivustoon voi list pikakuvakkeen lylaitteen typydlle, josta aukeutuvassa versiossa ei ny selaimen osoitepalkkia.</p>","2021-03":"<p>Listty Helsingin kaupungin <a href=\'https://hri.fi/data/fi/dataset/helsingin-ensimmaisen-maailmansodan-aikaiset-maalinnoitukset\' target=\'_blank\'>Helsingin ensimmisen maailmansodan aikaiset maalinnoitukset</a>-aineisto karttatasona.</p>","2021-02":"<p>Listty <a href=\'https://www.gtk.fi/\' target=\'_blank\'> Geologian tutkimuskeskuksen</a> <a href=\'https://tupa.gtk.fi/paikkatieto/meta/ancient_shorelines.html\' target=\'_blank\'>Muinaisrannat</a>-aineisto karttatasona.</p>","2021-01":"<p>Listty knnkset ruotsin kielelle (kiitos Jenni Lucenius ja Mikko Helminen!).</p><p>Kiinteiden muinaisjnnsten tyyppi ja alatyyppi ovat nyt linkkej <a href=\'http://akp.nba.fi\' target=\'_blank\'>Arkeologisen kulttuuriperinnn opas</a> -sivustolle.</p><p>Kokoruudun tila.</p>","2020-11":"<p>Listty <a href=\'./maisemanmuisti/\' target=\'_blank\'>Maiseman muisti - Valtakunnallisesti merkittvt muinaisjnnkset</a> -kirjan paikkatietoaineisto kartalle <img src=\'images/maiseman-muisti.png\' /> korostuksella.</p><p>Karttatasojen nkyvyyksien asetukset pivitetn nyt selaimen osoitepalkkiin jolloin sivun lataaminen uudelleen palauttaa samat asetukset.</p>","2020-04":"<p>Listty 3D-mallien <a href=\'./3d/\' target=\'_blank\'>tietokanta</a> ja karttaan <img src=\'images/3d_malli_circle.png\' /><img src=\'images/3d_malli_square.png\' /> korostus kohteille, joille lytyy 3D-malleja.</p>","2020-02":"<p>Paikannus pivitt nyt automaattisesti omaa sijaintia kartalla.</p>","2019-08":"<p>Siirrytty kyttmn Ahvenanmaan maakuntahallinnon uutta <a href=\'https://www.kartor.ax/datasets/fornminnen\'>kartor.ax</a> karttapalvelua. Samalla kohteiden haku alkoi toimimaan mys Ahvenanmaan kohteille.</p>","2018-12":"<p>Siirrytty kyttmn Maanmittauslaitoksen uutta <a href=\'https://www.maanmittauslaitos.fi/kartat-ja-paikkatieto/asiantuntevalle-kayttajalle/kartta-ja-paikkatietojen-rajapintapalvelut-17\'>karttapalvelua</a>, jonka myt taustakartan ulkonk muuttui selkemmksi, <a href=\'https://www.maanmittauslaitos.fi/kartat-ja-paikkatieto/asiantuntevalle-kayttajalle/tuotekuvaukset/ortokuva\'>Ortokuvat</a> karttataso saatiin kyttn ja ruskeat \'Muu kulttuuriperintkohde\' -pisteet saatiin kartalle.</p>","2017-11":"<p>Listty kartalle Ahvenanmaan maakuntahallinnon <a href=h\'ttp://www.regeringen.ax/kulturarv/arkeologi-fornlamningar/fornlamningsregistret\'>muinaijnnsten rekisteri</a>.</p>","2015-10":"<p>Ensimminen versio julkaistu.</p>"}},"settings":{"title":"Asetukset","common":{"transparency":"Lpinkyvyys ({{transparency}} %)"},"mml":{"title":"Maanmittauslaitoksen aineistot","basemap":{"title":"Pohjakartta","layer":{"maastokartta":"Maastokartta","taustakartta":"Taustakartta","ortokuva":"Ortokuva","mml_korkeusmalli_25m_2000":"Korkeusmalli 25m"}},"vanhatKartat":{"title":"Vanhat kartat","section":{"topografisetKartat":"Topografiset kartat (<a href=\'https://www.maanmittauslaitos.fi/sites/maanmittauslaitos.fi/files/attachments/2024/04/Vanhatkartat2024_verkkoon.pdf\' target=\'_blank\'>listietoa</a>)","yleiskartta":"Yleiskartta (<a href=\'https://www.maanmittauslaitos.fi/sites/maanmittauslaitos.fi/files/attachments/2024/04/Vanhatkartat2024_verkkoon.pdf\' target=\'_blank\'>listietoa</a>)","pitjnkartasto":"Pitjnkartasto (<a href=\'https://www.maanmittauslaitos.fi/sites/maanmittauslaitos.fi/files/attachments/2024/04/Vanhatkartat2024_verkkoon.pdf\' target=\'_blank\'>listietoa</a>)","taloudellinenKartta":"Taloudellinen kartta (<a href=\'https://www.maanmittauslaitos.fi/sites/maanmittauslaitos.fi/files/attachments/2024/04/Vanhatkartat2024_verkkoon.pdf\' target=\'_blank\'>listietoa</a>)","maastokartat":"Peruskartasto 1:20 000/1:25 000 sek Topografinen kartta 1:50 000 (<a href=\'https://www.maanmittauslaitos.fi/sites/maanmittauslaitos.fi/files/attachments/2024/04/Vanhatkartat2024_verkkoon.pdf\' target=\'_blank\'>listietoa</a>)"},"layer":{"mml_ven_topo_21k_1871_1919":"Venlinen topografinen kartta, 1:21 000, 1871-1919","mml_ven_topo_42k_1870_1944":"Venlinen topografinen kartta, 1:42 000, 1870-1944","mml_ven_topo_42k_192x":"Venlinen topografinen kartta, 1:42 000, 192x","mml_ven_topo_84k_1916-1917":"Venlinen topografinen kartta, 1:84 000, 1916-1917","mml_yleiskartta_400k_1863-1879":"Yleiskartta (rasteri), 1:400 000, 1863-1879","mml_yleiskartta_400k_1880-1899":"Yleiskartta (rasteri), 1:400 000, 1880-1899","mml_yleiskartta_400k_1900-1919":"Yleiskartta (rasteri), 1:400 000, 1900-1919","mml_yleiskartta_400k_1920-1939":"Yleiskartta (rasteri), 1:400 000, 1920-1939","mml_yleiskartta_400k_1940-1972":"Yleiskartta (rasteri), 1:400 000, 1940-1972","mml_yleiskartta_400k_1954-1975":"Yleiskartta (rasteri), 1:400 000, 1954-1975","mml_yleiskartta_400k_1983-1992":"Yleiskartta (rasteri), 1:400 000, 1983-1992","mml_yleiskartta_500k_1996":"Yleiskartta (rasteri), 1:500 000, 1996","mml_yleiskartta_500k_2000":"Yleiskartta (rasteri), 1:500 000, 2000","mml_pitajakartta_20k_1912-1968":"Pitjkartta, 1:20 000, 1912-1968","mml_taloudellinen_100k_1911-1970":"Taloudellinen kartta, 1:100 000, 1911-1970","mml_topo_100k_1928_1947":"Maasto-, perus- tai topografinen kartta, 1:100 000, 1928-1947","mml_topo_100k_1948_1989":"Maasto-, perus- tai topografinen kartta, 1:100 000, 1948-1989","mml_topo_20k_1924-1948":"Maasto-, perus- tai topografinen kartta, 1:20 000, 1924-1948","mml_topo_20k_1947-1959":"Maasto-, perus- tai topografinen kartta, 1:20 000, 1947-1959","mml_topo_20k_1960-1969":"Maasto-, perus- tai topografinen kartta, 1:20 000, 1960-1969","mml_topo_20k_1970-1979":"Maasto-, perus- tai topografinen kartta, 1:20 000, 1970-1979","mml_topo_20k_1980-1997":"Maasto-, perus- tai topografinen kartta, 1:20 000, 1980-1997","mml_topo_50k_1922-1946":"Maasto-, perus- tai topografinen kartta, 1:50 000, 1922-1946","mml_topo_50k_1964-2006":"Maasto-, perus- tai topografinen kartta, 1:50 000, 1964-2006","mml_topo_50k_2005-2020":"Maasto-, perus- tai topografinen kartta, 1:50 000, 2005-2020"}},"licence":" Maanmittauslaitos (<a href=\'https://creativecommons.org/licenses/by/4.0/deed.fi\'>CC BY 4.0</a>)"},"gtk":{"title":"Geologian tutkimuskeskuksen aineistot","licence":" Geologian tutkimuskeskus"},"maannousuInfo":{"title":"Maannousu.info maannousukartta","info":"Maannousun laskentamalli: <a href=\'https://maannousu.info/model-v2\' target=\'_blank\'>Glacial Land Adjustment Regenerator (Glare)</a>","info2":"Maannousua pystyy tarkkailemaan aikavlill 10 000 eaa. - 1900 jaa. Vuosi valitaan kartan alareunasta. Vuosina 10 000 eaa. - 8500 eaa. nytetn mys jkauden mannerj Pohjoismaissa.","licence":"<a href=\'https://creativecommons.org/licenses/by/4.0/deed.fi\'>CC BY 4.0</a>","webGLError":"Selaimesi ei tue WebGL-teknologiaa, jota tarvitaan Maannousu.info karttojen nyttmisess. Maannousu.info kartat eivt valitettavasti toimi laitteellasi.","placementSwitch":"Piilota merenpinnan alle jvt kohteet"},"museovirasto":{"title":"Museoviraston aineistot","licence":" Museovirasto (<a href=\'https://creativecommons.org/licenses/by/4.0/deed.fi\'>CC BY 4.0</a>)","filters":{"title":"Kartalla nkyvt Muinaisjnnsrekisterin kohteet","info":"Rajoitus toimii vain muinaisjnnsrekisterin pisteille mutta ei alueille.","type":"Tyyppi","dating":"Ajoitus"}},"ahvenanmaa":{"title":"Ahvenanmaan paikallishallinnon aineistot","licence":" lands landskapsregering (<a href=\'https://creativecommons.org/licenses/by/4.0/deed.fi\'>CC BY 4.0</a>)"},"helsinki":{"title":"Helsingin kaupungin aineistot","licence":" Helsingin kaupunki (<a href=\'https://creativecommons.org/licenses/by/4.0/deed.fi\'>CC BY 4.0</a>)"},"viabundus":{"title":"Viabundus-projektin aineistot","year":"Vuosi ({{selectedYear}})","licence":" Viabundus-projekti (<a href=\'https://creativecommons.org/licenses/by-sa/4.0/deed.fi\'>CC BY-SA 4.0</a>)"},"3Dmodels":{"title":"3D-mallit"},"maisemanMuisti":{"title":"Maiseman muisti - Valtakunnallisesti merkittvt muinaisjnnkset"}},"search":{"title":"Hae kohteita","info":"Voit hakea kohteen nimell (esim. Turun linna) tai rekisterin tunnuksella (esim. 200284 tai Sa 14.1)","placeholder":"Kirjoita kohteen nimi tai sen osa","searchButton":"Hae","error":"Hakusanan pit olla vhintn kolme merkki","searchResultTitle":"Hakutulokset","resultCount":"kpl"},"details":{"title":"Valitut kohteet","finnishHeritageAgencyMoreInfoLink":"Lis tietoa kohteesta Museoviraston <a href=\'{{url}}\' target=\'_blank\'>{{ registerName }}</a>.","registerLink":{"fromMuinaisjaannos":"Muinaisjnnsrekisterist","fromRKY":"rky.fi rekisterist","fromMaailmanperinto":"Museoviraston sivuilta","fromRakennusperint":"Rakennusperintrekisterist","fromVark":"VARK-alueiden rekisterist"},"field":{"id":"Tunniste","alakohdetunnus":"Alakohdetunnus","varkId":"VARK-tunniste","feature":"Kohde","name":"Nimi","featureName":"Kohdenimi","buildingName":"Rakennusnimi","municipality":"Kunta","region":"Maakunta","village":"Kyl","description":"Kuvaus","location":"Sijainti","type":"Tyyppi","subType":"Alatyyppi","dating":"Ajoitus","typeAndDating":"Tyyppi ja ajoitus","mainCategory":"Pkategoria","subCategory":"Alatyyppi","mainEra":"Paikakausi","period":"Periodi","featureCount":"Lukumr","precision":"Tarkkuus","legislation":"Laki","featureType":"Laji","protectionGroup":"Suojeluryhm","maalinnoitus":{"tukikohta":"Tukikohta","puolustusasema":"Puolustusasema","olotila":"Olotila","mittaustieto":"Mittaustieto","yksikk":"Yksikk","yksiknTyyppi":"Yksikn tyyppi","yksikknumero":"Yksikknumero","rakennustapa":"Rakennustapa","rakennushistoria":"Rakennushistoria","kohteenTyyppi":"Kohtee tyyppi","rajauksenTyyppi":"Rajauksen tyyppi"},"downloadGeometry":"Lataa GeoJSON paikkatieto","muinaisjnnkset":"Muinaisjnnkset","lhteet":"Lhteet","yleisetLhteet":"Yleiset lhteet","markkinapivt":"Markkinapivt","rekonstruktiotarkkuus":"Rekonstruktion tarkkuus","asukasluku":"Arvioitu vkiluku"},"3d":{"title":"Kohteen 3D-mallit","infoHeading":"Listietoa 3D-malleista","infoText1":"Nm 3D-mallit ovat <a href=\'./3d/\' target=\'_blank\'>tietokannasta</a>, joka listaa harrastajien sek virallisten toimijoiden (museot, Museovirasto, Ahvenanmaan paikallishallinto) tekemi 3D-mallinnuksia <a href=\'https://sketchfab.com\' target=\'_blank\'>Sketchfab</a>-palvelusta.","infoText2":"Mallit saa kynnistetty nuolipainikkeesta. Kynnistymisen jlkeen mallin saa koko ruudun tilaan painamalla nppimistlt <kbd>f</kbd> painiketta tai oikean alareunan painikkeesta","controls":{"title":"Mallin ohjaus","rotateTitle":"Kntminen","rotate":"pid vasen hiirenpainike pohjaan painettuna ja liikuta hiirt. Kosketusnytill pid sormi painettuna ja liikuta sormea.","zoomTitle":"Suurennus ja pienennys","zoom":"kyt hiiren rullaa. Kosketusnytill kyt kahden sormen nipistyselett.","focusTitle":"Kohdistuksen siirtminen","focus":"pid oikea hiirenpainike pohjaan painettuna ja liikuta hiirt. Kosketusnytill pid kaksi sormea painettuna ja liikuta sormia."}}},"data":{"register":{"name":{"Muinaisjnnsrekisteri":"Muinaisjnnsrekisteri","Valtakunnallisesti merkittvt rakennetut kulttuuriympristt":"Valtakunnallisesti merkittvt rakennetut kulttuuriympristt","Maailmanperintkohteet":"Maailmanperintkohteet","Rakennusperintrekisteri":"Rakennusperintrekisteri","vark":"Valtakunnallisesti merkittvt arkeologiset kohteet (VARK)","Ahvenanmaan muinaisjnnsrekisteri":"Ahvenanmaan muinaisjnnsrekisteri","Ahvenanmaan merellinen kulttuuriperintrekisteri":"Ahvenanmaan merellinen kulttuuriperintrekisteri","3Dmodels":"3D-mallit","maisemanMuisti":"Maiseman muisti - Valtakunnallisesti merkittvt muinaisjnnkset","maalinnoitus":"Helsingin ensimmisen maailmansodan aikaiset maalinnoitukset","muinaisrannat":"Muinaisrannat","MaannousuInfo":"Maannousu.info maannousukartta","viabundus":"Viabundus-projekti"},"nameWithLink":{"Muinaisjnnsrekisteri":"Muinaisjnnsrekisterit (<a href=\'https://www.kyppi.fi/palveluikkuna/mjreki/read/asp/r_default.aspx\' target=\'_blank\'>listietoa</a>)","Valtakunnallisesti merkittvt rakennetut kulttuuriympristt":"Valtakunnallisesti merkittvt rakennetut kulttuuriympristt (<a href=\'http://www.rky.fi/\' target=\'_blank\'>listietoa</a>)","Maailmanperintkohteet":"Maailmanperintkohteet (<a href=\'https://www.museovirasto.fi/fi/tietoa-meista/kansainvalinen-toiminta/maailmanperintokohteet-suomessa\' target=\'_blank\'>listietoa</a>)","Rakennusperintrekisteri":"Rakennusperintrekisteri (<a href=\'https://www.kyppi.fi/palveluikkuna/rapea/read/asp/r_default.aspx\' target=\'_blank\'>listietoa</a>)","vark":"Valtakunnallisesti merkittvt arkeologiset kohteet (VARK) (<a href=\'https://www.kyppi.fi/palveluikkuna/VARKL/asp/v_default.aspx\' target=\'_blank\'>listietoa</a>)","Ahvenanmaan muinaisjnnsrekisteri":"Ahvenanmaan muinaisjnnsrekisteri (<a href=\'https://hub.arcgis.com/datasets/aland::fornminnen-1/\' target=\'_blank\'>listietoa</a>)","Ahvenanmaan merellinen kulttuuriperintrekisteri":"Ahvenanmaan merellinen kulttuuriperintrekisteri (<a href=\'https://hub.arcgis.com/datasets/aland::maritimt-kulturarv-vrak-1/\' target=\'_blank\'>listietoa</a>)","3Dmodels":"3D-mallit (<a href=\'./3d/\' target=\'_blank\'>listietoa</a>)","maisemanMuisti":"Maiseman muisti - Valtakunnallisesti merkittvt muinaisjnnkset (<a href=\'./maisemanmuisti/\' target=\'_blank\'>listietoa</a>)","maalinnoitus":"Helsingin ensimmisen maailmansodan aikaiset maalinnoitukset (<a href=\'https://hri.fi/data/fi/dataset/helsingin-ensimmaisen-maailmansodan-aikaiset-maalinnoitukset\' target=\'_blank\'>listietoa</a>)","MaannousuInfo":"Maannousukartta (<a href=\'https://maannousu.info\' target=\'_blank\'>listietoa</a>)","viabundus":"Viabundus-projekti (<a href=\'https://www.landesgeschichte.uni-goettingen.de/handelsstrassen/info.php?lang=fin\' target=\'_blank\'>listietoa</a>)"}},"featureType":{"Kiinte muinaisjnns":"Kiinte muinaisjnns","Muu kulttuuriperintkohde":"Muu kulttuuriperintkohde","Kiinte muinaisjnns (alue)":"Kiinte muinaisjnns (alue)","Muu kulttuuriperintkohde (alue)":"Muu kulttuuriperintkohde (alue)","Valtakunnallisesti merkittv muinaisjnns":"Valtakunnallisesti merkittv muinaisjnns","Rakennettu kulttuuriymprist":"Rakennettu kulttuuriymprist","Maailmanperintkohde":"Maailmanperintkohde","Rakennusperintkohde":"Rakennusperintkohde","varkPiste":"Valtakunnallisesti merkittvt arkeologiset kohteet (VARK), keskipisteet","varkAlue":"Valtakunnallisesti merkittvt arkeologiset kohteet (VARK), aluerajaukset","lytpaikkaPiste":"Lytpaikka","lytpaikkaAlue":"Lytpaikka (alue)","muuKohdePiste":"Muu kohde","muuKohdeAlue":"Muu kohde (alue)","luonnonmuodostumaPiste":"Luonnonmuodostuma","luonnonmuodostumaAlue":"Luonnonmuodostuma (alue)","havaintokohdePiste":"Havaintokohde","havaintokohdeAlue":"Havaintokohde (alue)","mahdollinenMuinaisjnnsPiste":"Mahdollinen muinaisjnns","mahdollinenMuinaisjnnsAlue":"Mahdollinen muinaisjnns (alue)","poistettuKiinteMuijaisjnnsPiste":"Poistettu kiinte muinaisjnns","poistettuKiinteMuijaisjnnsAlue":"Poistettu kiinte muinaisjnns (alue)","alakohdePiste":"Alakohde","Ahvenanmaan muinaisjnnsrekisterin kohde":"Ahvenanmaan muinaisjnnsrekisterin kohde","Ahvenanmaan merellisen kulttuuriperintrekisterin kohde":"Ahvenanmaan merellisen kulttuuriperintrekisterin kohde","maalinnoitus":"Helsingin ensimmisen maailmansodan aikaiset maalinnoitukset","viabundus":"Viabundus-aineisto","viabundus-tieverkko":"Tieverkko, Viabundus-aineisto","viabundus-kaupungin-rajat":"Kaupungin rajat, Viabundus-aineisto"},"gtk":{"layer":{"muinaisrannat":"Muinaisrannat (<a href=\'https://tupa.gtk.fi/paikkatieto/meta/ancient_shorelines.html\' target=\'_blank\'>listietoa</a>)","maapera_200k_maalaji":"Maaper 1:200 000, maalajit"},"feature":{"supra-akvaattinen":"Supra-akvaattinen, jkauden jlkeen vedenpinnan ylpuolelle jnyt alue","yoldia":"Yoldiameren tai Ancylusjrven peittm alue (11 600  7 200 eaa.)","litorina":"Litorinameren peittm alue (8 500  4 000 eaa.)","maalajit_ohut_turvekerros":"Ohut turvekerros (Tvo, 0,3-0,6 m)","maalajit_soistuma":"Soistuma (Tvs, <0,3)","maalajit_vesi":"Vesi","maalajit_kartoittamaton":"Kartoittamaton","maalajit_taytemaa":"Tytemaa","maalajit_paksu_turvekerros":"Paksu turvekerros, yleens yli 0,6 m","maalajit_lieju":"Lieju, humuspitoisuus yli 6 %","maalajit_savi":"Savi","maalajit_liejuinen_hienorakenteinen_maalaji":"Liejuinen hienorakeinen maalaji, humuspitoisuus 2-6 %","maalajit_hienorakenteinen_maalaji":"Hienojakoinen maalaji, plajitetta ei selvitetty","maalajit_karkearakenteinen_maalaaji":"Karkearakeinen maalaji, plajitetta ei selvitetty","maalajit_sekalajitteinen_maalaji":"Sekalajitteinen maalaji, plajitetta ei selvitetty","maalajit_kivia":"Kivi","maalajit_rakka":"Rakka","maalajit_kalliomaa":"Kalliomaa, maanpeite enintn 1m (yleens moreenia)","maalajit_kalliopaljastuma":"Kalliopaljastuma"}},"helsinki":{"layer":{"Maalinnoitus_karttatekstit":"Yksikiden nimet","Maalinnoitus_yksikot":"Yksikt ja niiden numerot","Maalinnoitus_kohteet":"Kohteet","Maalinnoitus_rajaukset":"Rajat"},"feature":{"asema":"Juoksuhauta, suojahuone, tuliasema","luola":"Luola","tykkipatteri":"Tykkipatteri","tykkitie":"Tykkitie","puolustusasemanRaja":"Puolustusaseman raja","tukikohdanRaja":"Tukikohdan raja"},"featureType":{"kohde":"kohde","yksikk":"yksikk","rajaus":"rajaus"},"yksikkoLaji":{"asema":"Asema","tykkipatteri":"Tykkipatteri","tykkitie":"Tykkitie","muu":"Muu"},"yksikko":{"tulipeske":"Tulipeske","suojahuone":"Suojahuone","kuoppa":"Kuoppa","tykkiasema":"Tykkiasema","rakenne":"Rakenne","hauta":"Juoksuhauta","luola":"Luola","jalusta":"Jalusta","suojavalli":"Suojavalli"},"kohdetyyppi":{"asema (hauta,suojahuone, tulipeske)":"Asema (juoksuhauta, suojahuone, tulipeske)","luola":"Luola","tykkitie":"Tykkitie","tykkipatteri":"Tykkipatteri"},"rajaustyyppi":{"tukikohta":"Tukikohta","laji":"Puolustusasema"}},"viabundus":{"place":{"settlement":"Asuttu paikka","town":"Kaupunki","fair":"Markkinat","toll":"Tulli","bridge":"Silta","ferry":"Lautta","harbour":"Satama","lock":"Sulku"},"road":{"canal":"Kanaali","coast":"Kulkukelpoinen vesivyl","coastUncertain":"Kulkukelpoisen vesivyln epvarma linjaus","ferry":"Lautta","land":"Maantie","landUncertain":"Maantien epvarma linjaus","river":"Joki","winter":"Talvitie"},"roadCertainty":{"1":"Varma","2":"Osittain epvarma","3":"Epvarma"},"townOutline":"Kaupungin rajat","population":{"year":"Vuosi","inhabitants":"Asukkaita"}},"museovirasto":{"muinaisjnnsAjoitusTimespan":{"esihistoriallinen":"8600 eaa. - 1200 jaa.","kivikautinen":"8850 - 1700 eaa.","varhaismetallikautinen":"1800 eaa. - 300 jaa.","pronssikautinen":"1700 - 500 eaa.","rautakautinen":"500 eaa. - 1200 jaa.","keskiaikainen":"1200 - 1520 jaa","historiallinen":"1200 jaa. -","moderni":"1800 jaa. -"},"muinaisjnnsAjoitus":{"ajoittamaton":"ajoittamaton","ei mritelty":"ei mritelty","esihistoriallinen":"esihistoriallinen","historiallinen":"historiallinen","keskiaikainen":"keskiaikainen","kivikautinen":"kivikautinen","moderni":"moderni","moniperiodinen":"moniperiodinen","pronssikautinen":"pronssikautinen","rautakautinen ja/tai keskiaikainen":"rautakautinen ja/tai keskiaikainen","rautakautinen":"rautakautinen","varhaismetallikautinen":"varhaismetallikautinen"},"varkAjoitusTimespan":{"esihistoriallinen":"8600 eaa. - 1200 jaa.","kivikautinen":"8850 - 1700 eaa.","mesoliittinen":"8850 - 5200 eaa.","neoliittinen":"5200 - 1700 eaa.","varhaismetallikautinen":"1800 eaa. - 300 jaa.","pronssikautinen":"1700 - 500 eaa.","rautakautinen":"500 eaa. - 1200 jaa.","esiroomalainen aika":"500 eaa.  50 jaa.","nuorempi roomalaisaika":"150/200  375/400 jaa.","vanhempi roomalaisaika":"0/50  150/200 jaa.","merovingiaika":"550/600  800/825 jaa.","viikinkiaika":"800/825  1025/1050/1075 jaa.","ristiretkiaika":"1025/1050/1075  1150/1200 jaa.","keskiaikainen":"1200 - 1520 jaa","historiallinen":"1200 jaa. -","moderni":"1800 jaa. -"},"varkAjoitus":{"1100-luku":"1100-luku","1200-luku":"1200-luku","1300-luku":"1300-luku","1400-luku":"1400-luku","1500-luku":"1500-luku","1600-luku":"1600-luku","1700-luku":"1700-luku","1800-luku":"1800-luku","1900-luku":"1900-luku","Vaasa-aika 15231617":"Vaasa-aika 15231617","ajoittamaton":"ajoittamaton","autonomian aika 18091917":"autonomian aika 18091917","ei mritelty":"ei mritelty","esihistoriallinen":"esihistoriallinen","esiroomalainen aika":"esiroomalainen aika","historiallinen":"historiallinen","kansainvaellusaika":"kansainvaellusaika","keskiaikainen":"keskiaikainen","kivikautinen":"kivikautinen","merovingiaika":"merovingiaika","mesoliittinen":"mesoliittinen","moderni":"moderni","neoliittinen":"neoliittinen","nuorempi roomalaisaika":"nuorempi roomalaisaika","pronssikautinen":"pronssikautinen","rautakautinen":"rautakautinen","rautakautinen ja/tai keskiaikainen":"rautakautinen ja/tai keskiaikainen","ristiretkiaika":"ristiretkiaika","suurvalta-aika 16171721":"suurvalta-aika 16171721","toinen maailmansota 19391945":"toinen maailmansota 19391945","vanhempi roomalaisaika":"vanhempi roomalaisaika","vapauden aika ja kustavilainen aika 17211809":"vapauden aika ja kustavilainen aika 17211809","varhaismetallikautinen":"varhaismetallikautinen","viikinkiaika":"viikinkiaika"},"type":{"alusten hylyt":"alusten hylyt","asuinpaikat":"asuinpaikat","ei mritelty":"ei mritelty","hautapaikat":"hautapaikat","kirkkorakenteet":"kirkkorakenteet","kivirakenteet":"kivirakenteet","kulkuvylt":"kulkuvylt","kultti- ja tarinapaikat":"kultti- ja tarinapaikat","luonnonmuodostumat":"luonnonmuodostumat","lytpaikat":"lytpaikat","maarakenteet":"maarakenteet","muinaisjnnsryhmt":"muinaisjnnsryhmt","puolustusvarustukset":"puolustusvarustukset","puurakenteet":"puurakenteet","raaka-aineen hankintapaikat":"raaka-aineen hankintapaikat","tapahtumapaikat":"tapahtumapaikat","teollisuuskohteet":"teollisuuskohteet","taide, muistomerkit":"taide, muistomerkit","ty- ja valmistuspaikat":"ty- ja valmistuspaikat"},"subtype":{"aallonmurtajat":"aallonmurtajat","aidat":"aidat","ammusvarastot":"ammusvarastot","asumuspainanteet":"asumuspainanteet","ei mritelty":"ei mritelty","ersijat":"ersijat","haaksirikkopaikat":"haaksirikkopaikat","hakkaukset":"hakkaukset","hangakset":"hangakset","hautakammiot":"hautakammiot","hautakummut":"hautakummut","hautarykkit":"hautarykkit","hautasaaret":"hautasaaret","hautausmaat":"hautausmaat","hiekanottokuopat":"hiekanottokuopat","hiilimiilut":"hiilimiilut","hirsivarustukset":"hirsivarustukset","hospitaalit ja sairaalat":"hospitaalit ja sairaalat","hylyt (metalli)":"hylyt (metalli)","hylyt (puu)":"hylyt (puu)","hyrysahat":"hyrysahat","irtolytpaikat":"irtolytpaikat","jatulintarhat":"jatulintarhat","joukkohaudat":"joukkohaudat","jtinkirkot":"jtinkirkot","kaivannot":"kaivannot","kaiverrukset":"kaiverrukset","kaivokset":"kaivokset","kaivot":"kaivot","kalastuspaikat":"kalastuspaikat","kalkkiuunit":"kalkkiuunit","kalliomaalaukset":"kalliomaalaukset","kalliopiirrokset":"kalliopiirrokset","kanavat":"kanavat","kapulatiet":"kapulatiet","karsikkopaikat":"karsikkopaikat","kartanot":"kartanot","kaskirykkit":"kaskirykkit","kaupungit":"kaupungit","keittokuopat":"keittokuopat","kellarit":"kellarit","kellotapulinpaikat":"kellotapulinpaikat","kentt (gieddi)":"kentt (gieddi)","keramiikkatehtaat":"keramiikkatehtaat","kestikievarit":"kestikievarit","keshaudat":"keshaudat","kiinnitysrenkaat":"kiinnitysrenkaat","kirkkohaudat":"kirkkohaudat","kirkkomaat":"kirkkomaat","kirkonpaikat":"kirkonpaikat","kirkonrauniot":"kirkonrauniot","kiukaat":"kiukaat","kiviaidat":"kiviaidat","kivilatomukset":"kivilatomukset","kivilinnat":"kivilinnat","kivimuurit":"kivimuurit","kivipydt":"kivipydt","kivivallit":"kivivallit","kivivarustukset":"kivivarustukset","kodanpohjat":"kodanpohjat","kompassiruusut":"kompassiruusut","kullanhuuhdonnan jnnkset":"kullanhuuhdonnan jnnkset","kummelit":"kummelit","kummut":"kummut","kuninkaankartanot":"kuninkaankartanot","kuopat":"kuopat","kuparinsulattamot":"kuparinsulattamot","kuppikivet":"kuppikivet","kylnpaikat":"kylnpaikat","krjpaikat":"krjpaikat","ksittelypaikat":"ksittelypaikat","ktkt":"ktkt","laiturit":"laiturit","laivalatomukset":"laivalatomukset","laivanrakennuspaikat":"laivanrakennuspaikat","lapinpadot":"lapinpadot","lapinrauniot":"lapinrauniot","lasitehtaat":"lasitehtaat","latomukset":"latomukset","liesikiveykset":"liesikiveykset","liesilatomukset (rran)":"liesilatomukset (rran)","linnakkeet":"linnakkeet","linnamalmit":"linnamalmit","linnat":"linnat","linnavuoret":"linnavuoret","linnoitukset":"linnoitukset","linnustuspaikat":"linnustuspaikat","louhokset":"louhokset","luolat":"luolat","luostarinpaikat":"luostarinpaikat","luotsi- ja tulliasemat":"luotsi- ja tulliasemat","lhteet":"lhteet","maanmittauspisteet":"maanmittauspisteet","maavallit":"maavallit","majakat":"majakat","manufaktuurit":"manufaktuurit","markkinapaikat":"markkinapaikat","masuunit":"masuunit","merimerkit":"merimerkit","merkkikivet":"merkkikivet","merkkipuut":"merkkipuut","miekanhiontakivet":"miekanhiontakivet","muinaislinnat":"muinaislinnat","muinaispellot":"muinaispellot","muistomerkit":"muistomerkit","muistopaikat":"muistopaikat","mkituvat":"mkituvat","nauriskuopat":"nauriskuopat","optiset lenntinasemat":"optiset lenntinasemat","ortodoksikalmistot":"ortodoksikalmistot","painanteet":"painanteet","painolastipaikat":"painolastipaikat","pajat":"pajat","palokuoppahaudat":"palokuoppahaudat","panssariesteet":"panssariesteet","paperitehtaat":"paperitehtaat","pappilat":"pappilat","piilopirtit":"piilopirtit","piiskauspetjt":"piiskauspetjt","pikiruukit":"pikiruukit","pirunpellot":"pirunpellot","pitkospuut":"pitkospuut","polttokenttkalmistot":"polttokenttkalmistot","polut":"polut","poroaidat":"poroaidat","portaat":"portaat","potaskauunit":"potaskauunit","puistot":"puistot","purnut":"purnut","puutarhat":"puutarhat","pyyntikuopat":"pyyntikuopat","pyyntitukikohdat":"pyyntitukikohdat","rajamerkit":"rajamerkit","rajamerkit, puu":"rajamerkit, puu","rakkakuopat":"rakkakuopat","rangaistuspaikat":"rangaistuspaikat","rantakivikot":"rantakivikot","ratapohjat":"ratapohjat","raudanvalmistuspaikat":"raudanvalmistuspaikat","rautaruukit":"rautaruukit","ristikivet":"ristikivet","ruuhet":"ruuhet","ruumiskalmistot":"ruumiskalmistot","ruttohautausmaat":"ruttohautausmaat","ryssnuunit":"ryssnuunit","rykkit":"rykkit","salpietarikeittimt":"salpietarikeittimt","satamat":"satamat","savupiiput":"savupiiput","seidat":"seidat","sillanpaikat":"sillanpaikat","sillat":"sillat","sirpalekivikasat":"sirpalekivikasat","sotilasleirit":"sotilasleirit","sudenkuopat":"sudenkuopat","suojahuoneet":"suojahuoneet","taistelukaivannot":"taistelukaivannot","taistelupaikat":"taistelupaikat","talonpohjat":"talonpohjat","tarhakalmistot":"tarhakalmistot","tarinapaikat":"tarinapaikat","telakat":"telakat","terva- ja trpttitehtaat":"terva- ja trpttitehtaat","tervahaudat":"tervahaudat","terveyslhteet":"terveyslhteet","tienpohjat":"tienpohjat","tiilenpolttouunit":"tiilenpolttouunit","tiilitehtaat":"tiilitehtaat","tomtning-jnnkset":"tomtning-jnnkset","tornit":"tornit","torpat":"torpat","tsasounanpaikat":"tsasounanpaikat","tulipeskkeet":"tulipeskkeet","tulisijat":"tulisijat","tupasijat":"tupasijat","tuulimyllyt":"tuulimyllyt","tykkiasemat":"tykkiasemat","tykkitiet":"tykkitiet","thystysasemat":"thystysasemat","uhrikivet":"uhrikivet","uhrilehdot":"uhrilehdot","uhripuut":"uhripuut","uittolaitteet":"uittolaitteet","uunit":"uunit","valkamat":"valkamat","vallihaudat":"vallihaudat","vallit":"vallit","valonheitinasemat":"valonheitinasemat","veneenvetopaikat":"veneenvetopaikat","vesimyllyt":"vesimyllyt","vesisahat":"vesisahat","viljelmt":"viljelmt","viljelyrykkit":"viljelyrykkit","virkatalot":"virkatalot","virstanpylvt":"virstanpylvt","yhdyshaudat":"yhdyshaudat","yksinistalot":"yksinistalot"},"featureType":{"kiinte muinaisjnns":"kiinte muinaisjnns","muu kulttuuriperintkohde":"muu kulttuuriperintkohde"}},"ahvenanmaa":{"type":{"Uppgifter saknas":"Tiedot puuttuvat","Agrara lmningar":"Maanviljelyjnnkset","Bebyggelselmningar":"Asutusjnnkset","Befstningsanlggningar":"Puolustusvarustukset","Boplatser":"Asuinpaikat","Gravar":"Hautapaikat","Industriell-/produktionsplatser":"Teollisuus- ja valmistuspaikat","Jakt och fngst":"Metsstys- ja pyyntijnnkset","Kommunikations-/maritima lmningar":"Liikenne ja merellinen kulttuuriperint","Kult, offer och folktro":"Kultti-, uhri- ja tarinapaikat","Ristningar och minnesmrken":"Hakkaukset ja muistomerkit","vriga lmningar":"Muut jnnkset"},"subType":{"Uppgifter saknas":"tiedot puuttuvat","artilleristllning":"tykkiasema","avrttningsplats":"teloituspaikka","befstning":"linnoitus","begravningsplats":"hautausmaa","bevakning/signalering":"thystys/viestint","boplats":"asuinpaikka","brokista":"kiviarkku","brott/tkt":"louhos/kaivanto","brunn/kallklla":"kaivo/lhde","bytomt/grdstomt":"kylnpaikka/tilanpaikka","depofynd":"ktk","domarring":"krjkivet","flygstation":"lentoasema","fornborg":"muinaislinna","fossil ker":"muinaispelto","fltbefstning":"kenttlinnoitus","fngstgrop":"pyyntikuoppa","frtjningsanordning":"kiinnityslaite","frvaringsanlggning":"silytyskuoppa","grav":"hautapaikka","gravhg":"hautakumpu","gravrse":"hautarykki","gruvlmning":"kaivos","grnsmrke":"rajamerkki","hamnanlggning":"satamat","husgrund":"rakennusjnns","hgnad":"aita","hggravflt":"kumpukalmisto","industrilmning":"teollisuuskohde","kastalgrund":"kastelli","kyrka/kapell":"kirkko/kappeli","labyrint":"jatulintarha","minnesmrke":"muistomerkki","offerplats":"uhripaikka","ristning":"kalliohakkaus","rjningsrse":"peltorykki","rsegravflt":"rykkikalmisto","sjmrke":"merimerkki","skeppssttning":"laivalatomus","skrvstenshg":"palokivirykki","slott":"linna","stenkompass":"kompassiruusu","stenugn":"kiviuuni","tomtning":"tomtning-jnns","traditionsplats":"tarinapaikka","transport/frrd":"kuljetus/silytys","treudd":"treudd","varv":"laivanrakennuspaikka","vglmning":"tiejnns"},"dating":{"Frhistorisk tid":"esihistoriallinen aika","Historisk tid":"historiallinen aika","Stenlder":"kivikausi","Bronslder":"pronssikausi","Jrnlder":"rautakausi","Medeltid":"keskiaika","Sentid":"varhaismoderni","Uppgifter saknas":"tiedot puuttuvat"},"subDating":{"1600-tal":"1600-luku","1700-tal":"1700-luku","1800-tal":"1800-luku","1900-tal":"1900-luku","Tidigneolitikum":"varhaisneoliittinen aika","Yngre jrnlder":"myhisrautakausi","yngre bronslder":"myhispronssikausi","yngre jrnlder":"myhisrautakausi","ldre jrnlder":"varhaisrautakausi","ldre jrnlder":"varhaisrautakausi"}}}}'),vS=JSON.parse('{"common":{"Ennen ajanlaskun alkua":"f.v.t.","Jlkeen ajanlaskun alun":"e.v.t.","button":{"close":"Stng","languageSelection":"Vlj sprk","zoomOut":"Zooma ut","zoomIn":"Zooma in","settings":"Instllningar","search":"Sk objekt","info":"Hjlp och anvisningar","positioning":"Visa position","fullscreen":"Fullskrmslge","maannousuInfo":{"Edellinen vuosi":"Frra ret","Seuraava vuosi":"Nsta r"},"featureLocationLink":"Lnk direkt till detta objekt"},"features":{"Alue":"Omrde","Viiva":"Linje (t.ex. vg)","Rakennettu alue":"Bebyggd milj","Rakennus":"Byggnad","Kohde":"Objekt","3D-malli":"3D-modell","Valtakunnallisesti merkittv muinaisjnns":"Fast fornlmning av riksomfattande betydelse","aluerajaukset":"Omrdesavgrnsningar","keskipisteet":"Medelpunkter"},"organization":{"Maanmittauslaitos":"Lantmteriverket","Museovirasto":"Museiverket","Ahvenanmaan paikallishallinto":"lands landskapsregering","Geologian tutkimuskeskus":"Geologiska forskningscentralen","Helsingin kaupunki":"Helsingfors stad","Maannousu.info":"Maannousu.info","viabundus":"Viabundus-projektet"}},"linkedFeature":{"header":"Lnkad objekt","showOnMap":"Visa p kartan","showFeatureDetails":"Visa information","remove":"Ta bort lnkning"},"info":{"title":"Information om webbsidan","dataUpdates":{"title":"Datamaterialets aktualitet","description":"Uppdateringsfrekvens fr datamngder:","mml":"I realtid","museovirasto":"Nya objekt med 0-24 timmars frdrjning, mer detaljerad information visas i realtid vid klick","ahvenanmaa":"I realtid","gtk":"I realtid","helsinki":"I realtid","viabundus":"Manuellt. Den nuvarande versionen av datamngden r version 2, publicerad 25.4.2025","Maannousu.info":"I realtid"},"symbols":"Teckenfrklaring","siteInfo":{"title":"Information om webbsidan","registerInfo":"P webbsidan kan du visa fljande registeruppgifter p karta","info1":"Alla objekt r ppet data och hmtas frn respektive organisations karttjnst.","info2":"Klicka p objekt p kartan fr mera information. Information inkluderar lnk till organisationens webbsida. Frn symbolen vid objektnamn (<i className=\'bi bi-geo-alt-fill\' aria-hidden=\'true\' />) sparas lnk till objektet.","3DModelsInfo":"Vissa objekt r frsedda med 3D-modeller frn <a href=\'./3d/\' target=\'_blank\'>en databas</a>, som sammanstller modeller frn privata och offentliga aktrer (museer, Museiverket, lands landskapsregering) i <a href=\'https://sketchfab.com\' target=\'_blank\'>Sketchfab</a> -tjnsten.","positioningTitle":"Lokalisering","positioningInfo":"Kartvyn ppnar din position om du tillter tkomst till platsdata. Visa position genom att klicka p <i className=\'bi bi-crosshair\' aria-hidden=\'true\' />.","searchTitle":"Skning","searchInfo":"Objekt i Museiverkets register gr att ska enligt namn i skrutan (<i className=\'bi bi-search\' aria-hidden=\'true\' />). Genom att klicka p skresultat visar kartvyn objektet med platsnotering <img src=\'images/map-pin-small.png\' />.","settingsTitle":"Instllningar","settingsInfo":"Byt kartlager mellan bakgrunskarta och terrngkarta p instllningar (<i className=\'bi bi-gear\' aria-hidden=\'true\' />). Objekt kan frn Museiverkets register kan dljas enligt typ och datering. Detta mjliggr skningar till exempel p fornlmningar frn jrnlder.","feedbackTitle":"Respons","feedbackInfo":"Lmna respons om webbplatsen till adressen <a href=\'mailto:antti.kekki@gmail.com\'>antti.kekki@gmail.com</a>","developersTitle":"Utvecklare","developersInfo":"Kodning: Antti Kekki<br/>versttningar: Jenni Lucenius och Mikko Helminen"},"licences":{"title":"ppet data, licenser och kllkod","museovirasto":"Museiverkets registerdata hmtas frn <a href=\'https://www.museovirasto.fi/fi/palvelut-ja-ohjeet/tietojarjestelmat/kulttuuriympariston-tietojarjestelmat/kulttuuriympaeristoen-paikkatietoaineistot\' target=\'_blank\'>ppet WMS-grnsnitt</a> (platsdata har publicerats med licensen <a href=\'https://creativecommons.org/licenses/by/4.0/deed.sv\' target=\'_blank\'>Creative Commons CC By 4.0</a>).","ahvenanmaa":"lands landskapsregerings register hmtas frn <a href=\'https://www.kartor.ax/datasets\' target=\'_blank\'>ppet WMS-grnsnitt</a> (platsdata har publicerats med licensen <a href=\'https://creativecommons.org/licenses/by/4.0/deed.sv\' target=\'_blank\'>Creative Commons CC By 4.0</a>).","maanmittauslaitos":"Bakgrundskarta, flygfoto och terrngskarta hmtas frn Lantmteriverkets <a href=\'https://www.maanmittauslaitos.fi/kartat-ja-paikkatieto/asiantuntevalle-kayttajalle/kartta-ja-paikkatietojen-rajapintapalvelut-17\' target=\'_blank\'>ppet WMTS-grnsnitt</a> (platsdata har publicerats med licensen <a href=\'https://creativecommons.org/licenses/by/4.0/deed.sv\' target=\'_blank\'>Creative Commons CC By 4.0</a>).","maanmittauslaitosPaituli":"<a href=\'https://www.maanmittauslaitos.fi/sites/maanmittauslaitos.fi/files/attachments/2024/04/Vanhatkartat2024_verkkoon.pdf\' target=\'_blank\'>Gamla kartor</a> och Lantmteriverkets hjdmodell hmtas frn CSC (IT-centret fr vetenskap) <a href=\'https://paituli.csc.fi/webservices.html\' target=\'_blank\'>ppet WMS- och WMTS-grnsnitt</a>  (platsdata har publicerats med licensen <a href=\'https://creativecommons.org/licenses/by/4.0/deed.sv\' target=\'_blank\'>Creative Commons CC By 4.0</a>).","gtk":"Materialet ver fornstrnder och jordarter hmtas frn Geologiska forskningscentralens <a href=\'https://www.gtk.fi/palvelut/aineistot-ja-verkkopalvelut/rajapintapalvelut/maapera-karttatasot-wms-rajapinnassa/\' target=\'_blank\'>ppet WMS-grnssnitt</a>. Platsdata ver fornstrnder har publicerats med <a href=\'https://www.gtk.fi/sv/grundlicens/\' target=\'_blank\'>grundlicens</a> (tillstnd fr anvndning av materialet beviljades 15.1.2021). Jordartsdata har publicerats med <a href=\'https://www.gtk.fi/sv/oppen-licens/\' target=\'_blank\'>ppen licens</a> (<a href=\'https://creativecommons.org/licenses/by/4.0/deed.sv\' target=\'_blank\'>Creative Commons CC BY 4.0</a>).","helsinki":"Materialet rrande landfstningar runt Helsingfors under frsta vrldskriget hmtas frn Helsingfors stads <a href=\'https://hri.fi/data/fi/dataset/helsingin-ensimmaisen-maailmansodan-aikaiset-maalinnoitukset\' target=\'_blank\'>ppna WMS-grnssnitt</a> (platsdata har publicerats med licensen <a href=\'https://creativecommons.org/licenses/by/4.0/deed.sv\' target=\'_blank\'>Creative Commons CC By 4.0</a>).","maannousuInfo":"Kartan som beskriver landhjningen p webbplatsen Maannousu.info via <a href=\'https://maannousu.info/integration\' target=\'_blank\'>ett ppet GeoTIFF-grnssnitt</a> (platsdata har publicerats med licensen <a href=\'https://creativecommons.org/licenses/by/4.0/deed.sv\' target=\'_blank\'>Creative Commons CC By 4.0</a>).","maisemanmuisti":"Platsdata frn boken Maiseman muisti - Valtakunnallisesti merkittvt muinaisjnnkset hmtas frn <a href=\'./maisemanmuisti/\' target=\'_blank\'>en databas</a> som sammanstller samtliga 205 objekt i boken. Upphovsrtten till boken tillhr Museiverket, som har godknt att informationen anvnds.","3DModels":"3D-modeller hmtas frn ppen <a href=\'./3d/\' target=\'_blank\'>databas</a>, som sammanstller modeller frn privata och offentliga aktrer (museer, Museiverket, lands landskapsregering). Licensuppgifter ver modellerna har sammanstllts enligt respektive modell i databasen.","sourceCode":"Denna webbplats anvnder <a href=\'https://github.com/anttikekki/muinaismuistot\' target=\'_blank\'>ppen kllkod</a> av licensen <a href=\'https://github.com/anttikekki/muinaismuistot/blob/master/LICENSE\' target=\'_blank\'>MIT</a>.","viabundus":"Materialet frn Viabundus-projektet om det medeltida vgntet och bosttningen har hmtats frn <a href=\'https://www.landesgeschichte.uni-goettingen.de/handelsstrassen/info.php?lang=eng\' target=\'_blank\'>projektets webbplats</a>, har bearbetats och r version 2 av materialet. Det ursprungliga och det bearbetade geodata-materialet r publicerat under licensen <a href=\'https://creativecommons.org/licenses/by-sa/4.0/deed.sv\' target=\'_blank\'>CC BY-SA 4.0</a>. Det bearbetade materialet kan laddas ner i GeoJSON-format frn <a href=\'./viabundus/Viabundus-finland.geojson\' target=\'_blank\'>muinaismuistot.info/viabundus/Viabundus-finland.geojson</a>."},"versionHistory":{"title":"Versionshistorik","2025-10":"<p>Material frn <a href=\'https://www.landesgeschichte.uni-goettingen.de/handelsstrassen/info.php?lang=fin\' target=\'_blank\'>Viabundus-projektet</a> har lagts till.</p><p>Tillagt fyndplatser, observationsplatser, mjliga fornlmningar, naturformationer, borttagna lmningar, vriga objekt och delobjekt frn Museiverkets fornminnesregister.</p><p>Det lnkade objektet p kartan markeras nu i objektlistan. En separat kontrollknapp har ocks lagts till p kartans vnstra sida.</p><p>En engelsksprkig versttning av webbplatsen har lagts till.</p>","2025-09":"<p>Mjlighet att ladda ner objektets geografiska data i GeoJSON-format har lagts till.</p><p>Visning av identifierare i Museiverkets material (t.ex. fornlmningsnummer) har lagts till.</p><p>tgrdat problem med 3D-modeller fr lands marina objekt.</p><p>Den nationella lantmteriverkets <a href=\'https://www.maanmittauslaitos.fi/tutkimus/teematietoa/korkeusmallit\' target=\'_blank\'>hjdmodell</a> har lagts till i bakgrundskartorna.</p><p>Tillagt Museiverkets <a href=\'https://www.kyppi.fi/palveluikkuna/VARKL/asp/v_default.aspx\' target=\'_blank\'>Nationellt betydelsefulla arkeologiska objekt (VARK)</a>.</p><p>Tillagt GTK:s jordartskarta.</p>","2025-05":"<p>Tillagt landhjningskartan frn <a href=\'https://maannousu.info/\' target=\'_blank\'>Maannousu.info</a>.</p>","2025-04":"<p>Tillagt historiska kartor frn Lantmteriverkets <a href=\'https://www.maanmittauslaitos.fi/ajankohtaista/yli-30-000-vanhaa-karttaa-jopa-150-vuoden-takaa-nyt-paikkatietona\' target=\'_blank\'>samling av ver 30 000 gamla kartor</a>.</p>","2024-01":"<p>Tillagt kartlager fr Museiverkets vriga kulturarvsobjekt fr punkter och omrden. Tidigare ingick de i lagret Fasta fornlmningar, men p den nya servern r de ett separat lager.</p>","2023-12":"<p>Bytt Museiverkets karttjnst frn den stngda ArcGIS-servern <a href=\'https://kartta.nba.fi\' target=\'_blank\'>kartta.nba.fi</a> till den nya servern <a href=\'https://geoserver.museovirasto.fi/geoserver\' target=\'_blank\'>geoserver.museovirasto.fi</a>. Filtrering av fasta fornlmningar p kartan fungerar fortfarande inte.</p>","2022-04":"<p>Tillagt std fr <a href=\'https://en.wikipedia.org/wiki/Progressive_web_application\' target=\'_blank\'>Progressive Web Application</a>. Webbplatsen kan nu lggas till som en genvg p en mobil enhets startskrm, och ppnas d utan webblsarens adressflt.</p>","2021-03":"<p>Tillagt stadens Helsingfors dataset ver <a href=\'https://hri.fi/data/fi/dataset/helsingin-ensimmaisen-maailmansodan-aikaiset-maalinnoitukset\' target=\'_blank\'>frsta vrldskrigets fltbefstningar</a> som kartlager.</p>","2021-02":"<p>Tillagt Geologiska forskningscentralens dataset <a href=\'https://tupa.gtk.fi/paikkatieto/meta/ancient_shorelines.html\' target=\'_blank\'>Fornstrnder</a> som kartlager.</p>","2021-01":"<p>Lagt till versttning till svenska (tack till Jenni Lucenius och Mikko Helminen!).</p><p>Typ och undertyp fr fasta fornlmningar r nu lnkar till webbplatsen <a href=\'http://akp.nba.fi\' target=\'_blank\'>Arkeologiskt kulturarvsguide</a>.</p><p>Helbildslge tillagt.</p>","2020-11":"<p>Tillagt geografiskt material frn boken <a href=\'./maisemanmuisti/\' target=\'_blank\'>Landskapets minne  Nationellt betydelsefulla fornlmningar</a> till kartan, markerat med <img src=\'images/maiseman-muisti.png\' />.</p><p>Kartlagrens synlighetsinstllningar uppdateras nu i webblsarens adressflt, vilket gr att sidan kan laddas om med samma instllningar.</p>","2020-04":"<p>Tillagt <a href=\'./3d/\' target=\'_blank\'>databas fr 3D-modeller</a> och markeringar (<img src=\'images/3d_malli_circle.png\' /><img src=\'images/3d_malli_square.png\' />) fr objekt med tillgngliga 3D-modeller.</p>","2020-02":"<p>Positionsuppdatering sker nu automatiskt p kartan.</p>","2019-08":"<p>Bytt till lands landskapsregerings nya <a href=\'https://www.kartor.ax/datasets/fornminnen\'>kartor.ax</a>-karttjnst. Skning fungerar nu ven fr objekt p land.</p>","2018-12":"<p>Bytt till Lantmteriverkets nya <a href=\'https://www.maanmittauslaitos.fi/kartat-ja-paikkatieto/asiantuntevalle-kayttajalle/kartta-ja-paikkatietojen-rajapintapalvelut-17\'>karttjnst</a>, vilket frbttrade bakgrundskartans tydlighet, aktiverade lagret <a href=\'https://www.maanmittauslaitos.fi/kartat-ja-paikkatieto/asiantuntevalle-kayttajalle/tuotekuvaukset/ortokuva\'>Ortofoto</a> och lade till bruna punkter fr vriga kulturarvsobjekt.</p>","2017-11":"<p>Lagt till lands landskapsregerings <a href=\'http://www.regeringen.ax/kulturarv/arkeologi-fornlamningar/fornlamningsregistret\' target=\'_blank\'>fornlmningsregister</a> p kartan.</p>","2015-10":"<p>Frsta versionen publicerad.</p>"}},"settings":{"title":"Instllningar","common":{"transparency":"Transparens ({{transparency}} %)"},"mml":{"title":"Lantmteriverkets material","basemap":{"title":"Baskarta","layer":{"maastokartta":"Terrngkarta","taustakartta":"Bakgrundskarta","ortokuva":"Flygfoto","mml_korkeusmalli_25m_2000":"Hjdmodell 25m"}},"vanhatKartat":{"title":"Gamla kartor","section":{"topografisetKartat":"Topografiska kartor (<a href=\'https://www.maanmittauslaitos.fi/sites/maanmittauslaitos.fi/files/attachments/2024/04/Vanhatkartat2024_verkkoon.pdf\' target=\'_blank\'>information</a>)","yleiskartta":"Generalkartan ver Finland (<a href=\'https://www.maanmittauslaitos.fi/sites/maanmittauslaitos.fi/files/attachments/2024/04/Vanhatkartat2024_verkkoon.pdf\' target=\'_blank\'>information</a>)","pitjnkartasto":"Sockenkartorna (<a href=\'https://www.maanmittauslaitos.fi/sites/maanmittauslaitos.fi/files/attachments/2024/04/Vanhatkartat2024_verkkoon.pdf\' target=\'_blank\'>information</a>)","taloudellinenKartta":"Taloudellinen kartta (<a href=\'https://www.maanmittauslaitos.fi/sites/maanmittauslaitos.fi/files/attachments/2024/04/Vanhatkartat2024_verkkoon.pdf\' target=\'_blank\'>information</a>)","maastokartat":"Grundkartan 1:20 000/1:25 000 och Topografisk karta 1:50 000 (<a href=\'https://www.maanmittauslaitos.fi/sites/maanmittauslaitos.fi/files/attachments/2024/04/Vanhatkartat2024_verkkoon.pdf\' target=\'_blank\'>information</a>)"},"layer":{"mml_ven_topo_21k_1871_1919":"Ryska topografiska kartor, 1:21 000, 1871-1919","mml_ven_topo_42k_1870_1944":"Ryska topografiska kartor, 1:42 000, 1870-1944","mml_ven_topo_42k_192x":"Ryska topografiska kartor, 1:42 000, 192x","mml_ven_topo_84k_1916-1917":"Ryska topografiska kartor, 1:84 000, 1916-1917","mml_yleiskartta_400k_1863-1879":"Generalkartan (rutnt), 1:400 000, 1863-1879","mml_yleiskartta_400k_1880-1899":"Generalkartan (rutnt), 1:400 000, 1880-1899","mml_yleiskartta_400k_1900-1919":"Generalkartan (rutnt), 1:400 000, 1900-1919","mml_yleiskartta_400k_1920-1939":"Generalkartan (rutnt), 1:400 000, 1920-1939","mml_yleiskartta_400k_1940-1972":"Generalkartan (rutnt), 1:400 000, 1940-1972","mml_yleiskartta_400k_1954-1975":"Generalkartan (rutnt), 1:400 000, 1954-1975","mml_yleiskartta_400k_1983-1992":"Generalkartan (rutnt), 1:400 000, 1983-1992","mml_yleiskartta_500k_1996":"Generalkartan (rutnt), 1:500 000, 1996","mml_yleiskartta_500k_2000":"Generalkartan (rutnt), 1:500 000, 2000","mml_pitajakartta_20k_1912-1968":"Sockenkartorna, 1:20 000, 1912-1968","mml_taloudellinen_100k_1911-1970":"Ekonomisk karta, 1:100 000, 1911-1970","mml_topo_100k_1928_1947":"Grundkartan eller Topografisk karta, 1:100 000, 1928-1947","mml_topo_100k_1948_1989":"Grundkartan eller Topografisk karta, 1:100 000, 1948-1989","mml_topo_20k_1924-1948":"Grundkartan eller Topografisk karta, 1:20 000, 1924-1948","mml_topo_20k_1947-1959":"Grundkartan eller Topografisk karta, 1:20 000, 1947-1959","mml_topo_20k_1960-1969":"Grundkartan eller Topografisk karta, 1:20 000, 1960-1969","mml_topo_20k_1970-1979":"Grundkartan eller Topografisk karta, 1:20 000, 1970-1979","mml_topo_20k_1980-1997":"Grundkartan eller Topografisk karta, 1:20 000, 1980-1997","mml_topo_50k_1922-1946":"Grundkartan eller Topografisk karta, 1:50 000, 1922-1946","mml_topo_50k_1964-2006":"Grundkartan eller Topografisk karta, 1:50 000, 1964-2006","mml_topo_50k_2005-2020":"Grundkartan eller Topografisk karta, 1:50 000, 2005-2020"}},"licence":" Lantmteriverket (<a href=\'https://creativecommons.org/licenses/by/4.0/deed.sv\'>CC BY 4.0</a>)"},"gtk":{"title":"Geologiska forskningscentralens material","licence":" Geologiska forskningscentralen"},"maannousuInfo":{"title":"Maannousu.info landhjningskarta","info":"Berkningsmodell fr landhjningen: <a href=\'https://maannousu.info/model-v2\' target=\'_blank\'>Glacial Land Adjustment Regenerator (Glare)</a>","info2":"Landhjningen kan fljas under tidsperioden 10 000 f.v.t - 1900 e.v.t ret vljs lngst ned p kartan. Fr ren 10 000 f.v.t - 8500 e.v.t visas ven inlandsisen frn istiden i Norden.","licence":"<a href=\'https://creativecommons.org/licenses/by/4.0/deed.sv\'>CC BY 4.0</a>","webGLError":"Din webblsare stder inte WebGL-tekniken som krvs fr att visa Maannousu.info-kartor. Tyvrr kan Maannousu.info-kartor inte anvndas p din enhet.","placementSwitch":"Dlj objekt som hamnar under havsytan"},"museovirasto":{"title":"Museiverkets registerdata","licence":" Museiverket (<a href=\'https://creativecommons.org/licenses/by/4.0/deed.sv\'>CC BY 4.0</a>)","filters":{"title":"Objekt frn Fornlmningsregistret som visas p kartan","info":"Begrnsningen gller endast punkter i Fornlmningsregistret, inte omrden.","type":"Typ","dating":"Datering"}},"ahvenanmaa":{"title":"lands landskapsregerings registerdata","licence":" lands landskapsregering (<a href=\'https://creativecommons.org/licenses/by/4.0/deed.sv\'>CC BY 4.0</a>)"},"helsinki":{"title":"Helsingfors stads material","licence":" Helsingfors stad (<a href=\'https://creativecommons.org/licenses/by/4.0/deed.sv\'>CC BY 4.0</a>)"},"3Dmodels":{"title":"3D-modeller"},"maisemanMuisti":{"title":"Boken Maiseman muisti - Valtakunnallisesti merkittvt muinaisjnnkset"},"viabundus":{"title":"Viabundus-projektets material","year":"r ({{selectedYear}})","licence":" Viabundus-projektet (<a href=\'https://creativecommons.org/licenses/by-sa/4.0/deed.sv\'>CC BY-SA 4.0</a>)"}},"search":{"title":"Sk objekt","info":"Du kan ska med objektnamn (t.ex. Turun linna) eller objektets register-id (t.ex. 200284 eller Sa 14.1)","placeholder":"Sk med namn eller beskrivning","searchButton":"Sk","error":"Skord behver innehlla minst tre tecken","searchResultTitle":"Skresultat","resultCount":"st"},"details":{"title":"Valda objekt","finnishHeritageAgencyMoreInfoLink":"Mera information om objektet hittar du p Museiverkets <a href=\'{{url}}\' target=\'_blank\'>{{ registerName }}</a>.","registerLink":{"fromMuinaisjaannos":"Fornlmningsregister","fromRKY":"Register ver byggda kulturmiljer av riksintresse (RKY) p rky.fi","fromMaailmanperinto":"Museiverkets hemsida","fromRakennusperint":"Register ver byggnadsarv","fromVark":"Register ver VARK-omrden"},"field":{"id":"Objekt-id","alakohdetunnus":"Delobjekt-id","varkId":"VARK objekt-id","feature":"Objekt","name":"Namn","featureName":"Objektnamn","buildingName":"Byggnadens namn","municipality":"Kommun","region":"Landskap","village":"By","description":"Beskrivning","location":"Lgesinformation","type":"Typ","subType":"Undertyp","dating":"Datering","typeAndDating":"Typ och datering","mainCategory":"Huvudkategori","subCategory":"Undertyp","mainEra":"Tidslder","period":"Period","featureCount":"Antal","precision":"Precision","legislation":"Lagstiftning","featureType":"Skyddsstatus","protectionGroup":"Skyddskategori","maalinnoitus":{"tukikohta":"Anlggning","puolustusasema":"Frsvarslinje","olotila":"Status","mittaustieto":"Mtuppgift","yksikk":"Enhet","yksiknTyyppi":"Enhetstyp","yksikknumero":"Enhetsnummer","rakennustapa":"Byggnadsstt","rakennushistoria":"Byggnadshistoria","kohteenTyyppi":"Objekttyp","rajauksenTyyppi":"Avgrnsning"},"downloadGeometry":"Ladda ner GeoJSON-geodata","muinaisjnnkset":"Muinaisjnnkset","lhteet":"Kllor","yleisetLhteet":"Allmnna kllor","markkinapivt":"Marknadsdagar","rekonstruktiotarkkuus":"Rekonstruktionens noggrannhet","asukasluku":"Uppskattad befolkning"},"3d":{"title":"3D-modeller ver objektet","infoHeading":"Information om 3D-modeller","infoText1":"Dessa 3D-modeller hmtas frn <a href=\'./3d/\' target=\'_blank\'>en databas</a>, som sammanstller modeller frn privata och offentliga aktrer (museer, Museiverket, lands landskapsregering) i <a href=\'https://sketchfab.com\' target=\'_blank\'>Sketchfab</a>-tjnsten.","infoText2":"Modellen ppnas genom att klicka pilen. Modellen ppnats som helsida genom att trycka bokstaven <kbd>f</kbd> p tangentbordet eller genom att klicka p symbolen nere till hger","controls":{"title":"Rotera modellen","rotateTitle":"Rotera","rotate":"hll ned vnster knapp och flytta p musen. P pekskrm svep fingret samtidigt som du trycker p skrmen.","zoomTitle":"Zooma in och ut","zoom":"rulla blddringshjulet p musen. P pekskrm placera tummen och pekfingret p skrmen och dra sedan isr fingrarna fr att zooma ut skrmen.","focusTitle":"ndra position","focus":"hll ned hger knapp och flytta p musen. P pekskrm placera tv fingrar p skrmen och dra sedan fingrarna i samma riktning."}}},"data":{"register":{"name":{"Muinaisjnnsrekisteri":"Fornlmningsregister","Valtakunnallisesti merkittvt rakennetut kulttuuriympristt":"Byggda kulturmiljer av riksintresse (RKY)","Maailmanperintkohteet":"Vrldsarv","Rakennusperintrekisteri":"Register ver byggnadsarv","vark":"Arkeologiska omrden av riksintresse (VARK)","Ahvenanmaan muinaisjnnsrekisteri":"Fornminnesregister fr land","Ahvenanmaan merellinen kulttuuriperintrekisteri":"Register ver maritimt kulturarv p land","3Dmodels":"3D-modeller","maisemanMuisti":"Boken Maiseman muisti - Valtakunnallisesti merkittvt muinaisjnnkset","maalinnoitus":"Landfstningar runt Helsingfors under frsta vrldskriget","muinaisrannat":"Fornstrnder","MaannousuInfo":"Maannousu.info landhjningskarta","viabundus":"Viabundus-projektet"},"nameWithLink":{"Muinaisjnnsrekisteri":"Fornlmningsregister (<a href=\'https://www.kyppi.fi/palveluikkuna/mjreki/read/asp/r_default.aspx\' target=\'_blank\'>information</a>)","Valtakunnallisesti merkittvt rakennetut kulttuuriympristt":"Byggda kulturmiljer av riksintresse (RKY) (<a href=\'http://www.rky.fi/\' target=\'_blank\'>information</a>)","Maailmanperintkohteet":"Vrldsarv (<a href=\'https://www.museovirasto.fi/fi/tietoa-meista/kansainvalinen-toiminta/maailmanperintokohteet-suomessa\' target=\'_blank\'>information</a>)","Rakennusperintrekisteri":"Register ver byggnadsarv (<a href=\'https://www.kyppi.fi/palveluikkuna/rapea/read/asp/r_default.aspx\' target=\'_blank\'>information</a>)","vark":"Arkeologiska omrden av riksintresse (VARK) (<a href=\'https://www.kyppi.fi/palveluikkuna/VARKL/asp/sv_default.aspx\' target=\'_blank\'>information</a>)","Ahvenanmaan muinaisjnnsrekisteri":"Fornminnesregister fr land (<a href=\'https://hub.arcgis.com/datasets/aland::fornminnen-1/\' target=\'_blank\'>information</a>)","Ahvenanmaan merellinen kulttuuriperintrekisteri":"Register ver maritimt kulturarv p land (<a href=\'https://hub.arcgis.com/datasets/aland::maritimt-kulturarv-vrak-1/\' target=\'_blank\'>information</a>)","3Dmodels":"3D-modeller (<a href=\'./3d/\' target=\'_blank\'>information</a>)","maisemanMuisti":"Boken Maiseman muisti - Valtakunnallisesti merkittvt muinaisjnnkset (<a href=\'./maisemanmuisti/\' target=\'_blank\'>information</a>)","maalinnoitus":"Landfstningar runt Helsingfors under frsta vrldskriget (<a href=\'https://hri.fi/data/fi/dataset/helsingin-ensimmaisen-maailmansodan-aikaiset-maalinnoitukset\' target=\'_blank\'>information</a>)","MaannousuInfo":"Landhjningskarta (<a href=\'https://maannousu.info\' target=\'_blank\'>information</a>)","viabundus":"Viabundus-projektet (<a href=\'https://www.landesgeschichte.uni-goettingen.de/handelsstrassen/info.php?lang=fin\' target=\'_blank\'>mer information</a>)"}},"featureType":{"Kiinte muinaisjnns":"Fast fornlmning","Muu kulttuuriperintkohde":"vrigt kulturarvsobjekt","Kiinte muinaisjnns (alue)":"Fast fornlmning (omrde)","Muu kulttuuriperintkohde (alue)":"vrigt kulturarvsobjekt (omrde)","Valtakunnallisesti merkittv muinaisjnns":"Fast fornlmning av riksomfattande betydelse","Rakennettu kulttuuriymprist":"Bebyggd kulturmilj","Maailmanperintkohde":"Vrldsarvs","Rakennusperintkohde":"Byggandsarv","varkPiste":"Arkeologiska omrden av riksintresse (VARK), medelpunkter","varkAlue":"Arkeologiska omrden av riksintresse (VARK), omrdesavgrnsningar","lytpaikkaPiste":"Fyndplats","lytpaikkaAlue":"Fyndplatsomrde","muuKohdePiste":"vrigt objekt","muuKohdeAlue":"vrigt objekt (omrde)","luonnonmuodostumaPiste":"Naturformation","luonnonmuodostumaAlue":"Naturformation (omrde)","havaintokohdePiste":"Observationsobjekt","havaintokohdeAlue":"Observationsobjekt (omrde)","mahdollinenMuinaisjnnsPiste":"Mjlig fornlmning","mahdollinenMuinaisjnnsAlue":"Mjlig fornlmning (omrde)","poistettuKiinteMuijaisjnnsPiste":"Borttagen fast fornlmning","poistettuKiinteMuijaisjnnsAlue":"Borttagen fast fornlmning (omrde)","alakohdePiste":"Delobjekt","Ahvenanmaan muinaisjnnsrekisterin kohde":"Fast fornlmning i fornminnesregister fr land","Ahvenanmaan merellisen kulttuuriperintrekisterin kohde":"Objekt i register ver maritimt kulturarv p land","maalinnoitus":"Landfstningar runt Helsingfors under frsta vrldskriget","viabundus":"Viabundus-material","viabundus-tieverkko":"Vgnt, Viabundus-material","viabundus-kaupungin-rajat":"Stadsgrnser, Viabundus-material"},"gtk":{"layer":{"muinaisrannat":"Fornstrnder (<a href=\'https://tupa.gtk.fi/paikkatieto/meta/ancient_shorelines.html\' target=\'_blank\'>information</a>)","maapera_200k_maalaji":"Jordarter 1:200 000"},"feature":{"supra-akvaattinen":"Supraakvatiskt, dvs. yta som efter istiden blivit ovan havsytan","yoldia":"Yta som tckts av Yoldiahavet eller Ancylussjn (11 600 - 7 200 f.v.t.)","litorina":"Yta som tckts av Litorinahavet (8 500 - 4 000 f.v.t.)","maalajit_ohut_turvekerros":"Tunt torvlager (Tvo, 0,3-0,6 m)","maalajit_soistuma":"Myrbildning (Tvs, <0,3 m)","maalajit_vesi":"Vatten","maalajit_kartoittamaton":"Ej kartlagt","maalajit_taytemaa":"Fyllnadsmassor","maalajit_paksu_turvekerros":"Tjockt torvlager, vanligen ver 0,6 m","maalajit_lieju":"Dy, humushalt ver 6 %","maalajit_savi":"Lera","maalajit_liejuinen_hienorakenteinen_maalaji":"Dyig finkornig jordart, humushalt 2-6 %","maalajit_hienorakenteinen_maalaji":"Finkornig jordart, huvudfraktion ej faststlld","maalajit_karkearakenteinen_maalaaji":"Grovkornig jordart, huvudfraktion ej faststlld","maalajit_sekalajitteinen_maalaji":"Osorterad jordart, huvudfraktion ej faststlld","maalajit_kivia":"Stenar","maalajit_rakka":"Blockflt","maalajit_kalliomaa":"Berggrund, jordtcke hgst 1m (vanligen morn)","maalajit_kalliopaljastuma":"Berg i dagen"}},"helsinki":{"layer":{"Maalinnoitus_karttatekstit":"Enheternas namn","Maalinnoitus_yksikot":"Enheterna och deras numrering","Maalinnoitus_kohteet":"Objekt","Maalinnoitus_rajaukset":"Grnser"},"feature":{"asema":"Skyttegrav, skyddsrum, eldstllning","luola":"Bergrum","tykkipatteri":"Artilleribatteri","tykkitie":"Kanonvg","puolustusasemanRaja":"Grnsen fr frsvarslinje","tukikohdanRaja":"Grnsen fr militr anlggning"},"featureType":{"kohde":"objetk","yksikk":"enhet","rajaus":"avgrnsning"},"yksikkoLaji":{"asema":"Stllning","tykkipatteri":"Artilleribatteri","tykkitie":"Kanonvg","muu":"vrig"},"yksikko":{"tulipeske":"Eldstllning","suojahuone":"Skyddsrum","kuoppa":"Skyttevrn","tykkiasema":"Eldstllning","rakenne":"Anlggning","hauta":"Skyttegrav","luola":"Bergrum","jalusta":"Kanonstllning","suojavalli":"Blverk"},"kohdetyyppi":{"asema (hauta,suojahuone, tulipeske)":"Stllning (skyttegrav, skyddsrum, eldstllning)","luola":"Bergrum","tykkitie":"Kanonvg","tykkipatteri":"Artilleribatteri"},"rajaustyyppi":{"tukikohta":"Militr anlggning","laji":"Frsvarslinje"}},"viabundus":{"place":{"settlement":"Bebyggelse","town":"Stad","fair":"Marknad","toll":"Tull","bridge":"Bro","ferry":"Frja","harbour":"Hamn","lock":"Sluss"},"road":{"canal":"Kanal","coast":"Farled","coastUncertain":"Osker strckning av farled","ferry":"Frjeled","land":"Landsvg","landUncertain":"Osker strckning av landsvg","river":"Flod","winter":"Vintervg"},"roadCertainty":{"1":"Sker","2":"Delvis osker","3":"Osker"},"townOutline":"Stadsgrnser","population":{"year":"r","inhabitants":"Invnare"}},"museovirasto":{"muinaisjnnsAjoitusTimespan":{"esihistoriallinen":"8600 f.v.t. - 1200 e.v.t.","kivikautinen":"8850 - 1700 f.v.t.","varhaismetallikautinen":"1800 f.v.t. - 300 e.v.t.","pronssikautinen":"1700 - 500 f.v.t.","rautakautinen":"500 f.v.t. - 1200 e.v.t.","keskiaikainen":"1200 - 1520 e.v.t.","historiallinen":"1200 e.v.t. -","moderni":"1800 e.v.t. -"},"muinaisjnnsAjoitus":{"ajoittamaton":"odaterad","ei mritelty":"ej definierad","esihistoriallinen":"frhistorisk","historiallinen":"historisk","keskiaikainen":"medeltida","kivikautinen":"stenlder","moderni":"modern","moniperiodinen":"mngperiodisk","pronssikautinen":"bronslder","rautakautinen ja/tai keskiaikainen":"jrnlder och/eller medeltida","rautakautinen":"jrnlder","varhaismetallikautinen":"tidig metalllder"},"varkAjoitusTimespan":{"esihistoriallinen":"8600 f.v.t. - 1200 e.v.t.","kivikautinen":"8850 - 1700 f.v.t.","mesoliittinen":"8850 - 5200 f.v.t.","neoliittinen":"5200 - 1700 f.v.t.","varhaismetallikautinen":"1800 f.v.t. - 300 e.v.t.","pronssikautinen":"1700 - 500 f.v.t.","rautakautinen":"500 f.v.t. - 1200 e.v.t.","esiroomalainen aika":"500 f.v.t.  50 e.v.t.","nuorempi roomalaisaika":"150/200  375/400 e.v.t.","vanhempi roomalaisaika":"0/50  150/200 e.v.t.","merovingiaika":"550/600  800/825 e.v.t.","viikinkiaika":"800/825  1025/1050/1075 e.v.t.","ristiretkiaika":"1025/1050/1075  1150/1200 e.v.t.","keskiaikainen":"1200 - 1520 e.v.t.","historiallinen":"1200 e.v.t. -","moderni":"1800 e.v.t. -"},"varkAjoitus":{"1100-luku":"1100-talet","1200-luku":"1200-talet","1300-luku":"1300-talet","1400-luku":"1400-talet","1500-luku":"1500-talet","1600-luku":"1600-talet","1700-luku":"1700-talet","1800-luku":"1800-talet","1900-luku":"1900-talet","Vaasa-aika 15231617":"Vasatiden 15231617","ajoittamaton":"odaterad","autonomian aika 18091917":"autonomitiden 18091917","ei mritelty":"ej definierad","esihistoriallinen":"frhistorisk","esiroomalainen aika":"frromersk tid","historiallinen":"historisk","kansainvaellusaika":"folkvandringstid","keskiaikainen":"medeltida","kivikautinen":"stenldern","merovingiaika":"merovingertiden","mesoliittinen":"mesolitisk","moderni":"modern","neoliittinen":"neolitisk","nuorempi roomalaisaika":"senare romersk tid","pronssikautinen":"bronsldern","rautakautinen":"jrnldern","rautakautinen ja/tai keskiaikainen":"jrnldern och/eller medeltiden","ristiretkiaika":"korstgstiden","suurvalta-aika 16171721":"stormaktstiden 16171721","toinen maailmansota 19391945":"andra vrldskriget 19391945","vanhempi roomalaisaika":"ldre romersk tid","vapauden aika ja kustavilainen aika 17211809":"frihetstiden och gustavianska tiden 17211809","varhaismetallikautinen":"tidig metalllder","viikinkiaika":"vikingatiden"},"type":{"alusten hylyt":"fartygsvrak","asuinpaikat":"boplatser","ei mritelty":"ej definierad","hautapaikat":"gravplatser","kirkkorakenteet":"kyrkobyggnader","kivirakenteet":"stenkonstruktioner","kulkuvylt":"frdvgar","kultti- ja tarinapaikat":"kult- och berttelseplatser","luonnonmuodostumat":"naturformationer","lytpaikat":"fyndplatser","maarakenteet":"markkonstruktioner","muinaisjnnsryhmt":"fornlmningsgrupper","puolustusvarustukset":"frsvarsverk","puurakenteet":"trkonstruktioner","raaka-aineen hankintapaikat":"frvrvsplatser fr rmaterial","tapahtumapaikat":"hndelseplatser","teollisuuskohteet":"industriobjekt","taide, muistomerkit":"konst, minnesmrken","ty- ja valmistuspaikat":"arbets- och tillverkningsplatser"},"subtype":{"aallonmurtajat":"vgbrytare","aidat":"grden","ammusvarastot":"ammunitionslager","asumuspainanteet":"bostadsgropar","ei mritelty":"ej definierad","ersijat":"vildmarksvisten","haaksirikkopaikat":"skeppsbrottsplatser","hakkaukset":"inhuggningar","hangakset":"stngslen","hautakammiot":"gravkamrar","hautakummut":"gravhgar","hautarykkit":"gravrsen","hautasaaret":"gravar","hautausmaat":"gravgrdar","hiekanottokuopat":"sandtktsgropar","hiilimiilut":"kolmilor","hirsivarustukset":"stockbefstningar","hospitaalit ja sairaalat":"hospital och sjukhus","hylyt (metalli)":"vrak (metall)","hylyt (puu)":"vrak (tr)","hyrysahat":"ngsgar","irtolytpaikat":"lsfyndsplatser","jatulintarhat":"stenlabyrinter","joukkohaudat":"massgravar","jtinkirkot":"jttekyrkor","kaivannot":"nedgrvningar","kaiverrukset":"inristningar","kaivokset":"gruvor","kaivot":"brunnar","kalastuspaikat":"fiskeplatser","kalkkiuunit":"kalkugnar","kalliomaalaukset":"hllmlningar","kalliopiirrokset":"hllristningar","kanavat":"kanaler","kapulatiet":"kavelvgar","karsikkopaikat":"minnestrd (fi. karsikkopaikat)","kartanot":"herrgrdar","kaskirykkit":"svedjersen","kaupungit":"stder","keittokuopat":"kokgropar","kellarit":"kllare","kellotapulinpaikat":"klockstapelplaser","kentt (gieddi)":"samiska boplatser (gieddi)","keramiikkatehtaat":"keramikfabrik","kestikievarit":"gstgiverier","keshaudat":"sommargravar","kiinnitysrenkaat":"frtjningsringar","kirkkohaudat":"kyrkogravar","kirkkomaat":"gravgrdsgrden","kirkonpaikat":"kyrkoplatser","kirkonrauniot":"kyrkoruiner","kiukaat":"spisar","kiviaidat":"stengrden","kivilatomukset":"stensttningar","kivilinnat":"stenborgar","kivimuurit":"stenmurar","kivipydt":"uppallade block","kivivallit":"stenvallar","kivivarustukset":"stenbefstningar","kodanpohjat":"ktabottnar","kompassiruusut":"kompassrosor","kullanhuuhdonnan jnnkset":"lmningar av guldvaskning","kummelit":"kummel","kummut":"hgar","kuninkaankartanot":"kungsgrdar","kuopat":"gropar","kuparinsulattamot":"kopparsmltverk","kuppikivet":"sklgropsstenar","kylnpaikat":"byplatser","krjpaikat":"tingsstllen","ksittelypaikat":"hanteringsplatser","ktkt":"deper","laiturit":"bryggor","laivalatomukset":"skeppssttningar","laivanrakennuspaikat":"skeppsvarv","lapinpadot":"fiskpator (Lappland)","lapinrauniot":"lapprsen","lasitehtaat":"glasbruk","latomukset":"lggningar","liesikiveykset":"stensatta hrdar","liesilatomukset (rran)":"rektangulra hrdar (rran)","linnakkeet":"fort","linnamalmit":"slottsmalmar","linnat":"borgar","linnavuoret":"borgberg","linnoitukset":"befstningar","linnustuspaikat":"fgeljaktsplaser","louhokset":"brott","luolat":"grottor","luostarinpaikat":"klosterplatser","luotsi- ja tulliasemat":"lots- och tullstationer","lhteet":"kllor","maanmittauspisteet":"lantmtningspunkter","maavallit":"jordvallar","majakat":"fyrar","manufaktuurit":"manufakturer","markkinapaikat":"markandsplatser","masuunit":"masugnar","merimerkit":"sjmrken","merkkikivet":"mrkesstenar","merkkipuut":"mrkestrd","miekanhiontakivet":"svrdslipningsstenar","muinaislinnat":"fornborgar","muinaispellot":"fossila krar","muistomerkit":"minnesmrken","muistopaikat":"minnesplatser","mkituvat":"backstugor","nauriskuopat":"rovgropar","optiset lenntinasemat":"optiska telegrafstationer","ortodoksikalmistot":"ortodoxa begravningsplatser","painanteet":"snkor","painolastipaikat":"barlastplatser","pajat":"smedjor","palokuoppahaudat":"brandgropsgravar","panssariesteet":"stridsvagnshinder","paperitehtaat":"pappersbruk","pappilat":"prstgrdar","piilopirtit":"lnnprten","piiskauspetjt":"trd fr piskning (fi. piiskauspetjt)","pikiruukit":"beckbruk","pirunpellot":"klapperstensflt","pitkospuut":"spnger","polttokenttkalmistot":"brandgravflt","polut":"stigar","poroaidat":"rengrden","portaat":"trappor","potaskauunit":"potaskaugnar","puistot":"parker","purnut":"frvaringsgropar (fi. purnut)","puutarhat":"trdgrdar","pyyntikuopat":"fngstgropar","pyyntitukikohdat":"basstationer fr fngst","rajamerkit":"grnsmrken","rajamerkit, puu":"grnsmrken, tr","rakkakuopat":"klapperstensgropar","rangaistuspaikat":"avrttningsplatser","rantakivikot":"strandstenjordar","ratapohjat":"banvallar","raudanvalmistuspaikat":"jrnframstllningsplatser","rautaruukit":"jrnbruk","ristikivet":"korsstenar","ruuhet":"ekor","ruumiskalmistot":"skelettgravflt","ruttohautausmaat":"pestgravgrdar","ryssnuunit":"ryssugnar","rykkit":"rsen","salpietarikeittimt":"salpeterkokerier","satamat":"hamnar","savupiiput":"skorstenar","seidat":"sejtar (sieidi)","sillanpaikat":"broplatser","sillat":"broar","sirpalekivikasat":"skrvstenshgar","sotilasleirit":"soldatlger","sudenkuopat":"varggropar","suojahuoneet":"skyddsrum","taistelukaivannot":"skyttegravar","taistelupaikat":"stridsplatser","talonpohjat":"husgrunder","tarhakalmistot":"tarandgravflt","tarinapaikat":"sgenplatser","telakat":"varv","terva- ja trpttitehtaat":"tjr- och terpentinfabriker","tervahaudat":"tjrdalar","terveyslhteet":"hlsokllor","tienpohjat":"vgbottnar","tiilenpolttouunit":"tegelbrnnugnar","tiilitehtaat":"tegelbruk","tomtning-jnnkset":"tomtningar","tornit":"torn","torpat":"torp","tsasounanpaikat":"ortodoxa bnehusplatser","tulipeskkeet":"eldvrn","tulisijat":"eldstder","tupasijat":"stuglgen","tuulimyllyt":"vderkvarnar","tykkiasemat":"artilleristllningar","tykkitiet":"kanonvgar","thystysasemat":"observationsstllningar","uhrikivet":"offerstenar","uhrilehdot":"offerlundar","uhripuut":"offertrd","uittolaitteet":"flottningsanordningar","uunit":"ugnar","valkamat":"naturhamnar","vallihaudat":"vallgravar","vallit":"vallar","valonheitinasemat":"strlkastarstllningar","veneenvetopaikat":"dragplaser fr btar","vesimyllyt":"vattenkvarnar","vesisahat":"vattensgar","viljelmt":"odlingar","viljelyrykkit":"odlingsrsen","virkatalot":"tjnstegrdar","virstanpylvt":"milstolpar","yhdyshaudat":"lpgravar","yksinistalot":"enskilda grdar"},"featureType":{"kiinte muinaisjnns":"fast fornlmning","muu kulttuuriperintkohde":"vrigt kulturarvsobjekt"}},"ahvenanmaa":{"type":{"Uppgifter saknas":"Uppgifter saknas","Agrara lmningar":"Agrara lmningar","Bebyggelselmningar":"Bebyggelselmningar","Befstningsanlggningar":"Befstningsanlggningar","Boplatser":"Boplatser","Gravar":"Gravar","Industriell-/produktionsplatser":"Industriell-/produktionsplatser","Jakt och fngst":"Jakt och fngst","Kommunikations-/maritima lmningar":"Kommunikations-/maritima lmningar","Kult, offer och folktro":"Kult, offer och folktro","Ristningar och minnesmrken":"Ristningar och minnesmrken","vriga lmningar":"vriga lmningar"},"subType":{"Uppgifter saknas":"Uppgifter saknas","artilleristllning":"artilleristllning","avrttningsplats":"avrttningsplats","befstning":"befstning","begravningsplats":"begravningsplats","bevakning/signalering":"bevakning/signalering","boplats":"boplats","brokista":"brokista","brott/tkt":"brott/tkt","brunn/kallklla":"brunn/kallklla","bytomt/grdstomt":"bytomt/grdstomt","depofynd":"depofynd","domarring":"domarring","flygstation":"flygstation","fornborg":"fornborg","fossil ker":"fossil ker","fltbefstning":"fltbefstning","fngstgrop":"fngstgrop","frtjningsanordning":"frtjningsanordning","frvaringsanlggning":"frvaringsanlggning","grav":"grav","gravhg":"gravhg","gravrse":"gravrse","gruvlmning":"gruvlmning","grnsmrke":"grnsmrke","hamnanlggning":"hamnanlggning","husgrund":"husgrund","hgnad":"hgnad","hggravflt":"hggravflt","industrilmning":"industrilmning","kastalgrund":"kastalgrund","kyrka/kapell":"kyrka/kapell","labyrint":"labyrint","minnesmrke":"minnesmrke","offerplats":"offerplats","ristning":"ristning","rjningsrse":"rjningsrse","rsegravflt":"rsegravflt","sjmrke":"sjmrke","skeppssttning":"skeppssttning","skrvstenshg":"skrvstenshg","slott":"slott","stenkompass":"stenkompass","stenugn":"stenugn","tomtning":"tomtning","traditionsplats":"traditionsplats","transport/frrd":"transport/frrd","treudd":"treudd","varv":"varv","vglmning":"vglmning"},"dating":{"Frhistorisk tid":"Frhistorisk tid","Historisk tid":"Historisk tid","Stenlder":"Stenlder","Bronslder":"Bronslder","Jrnlder":"Jrnlder","Medeltid":"Medeltid","Sentid":"Sentid","Uppgifter saknas":"Uppgifter saknas"},"subDating":{"1600-tal":"1600-tal","1700-tal":"1700-tal","1800-tal":"1800-tal","1900-tal":"1900-tal","Tidigneolitikum":"tidigneolitikum","Yngre jrnlder":"yngre jrnlder","yngre bronslder":"yngre bronslder","yngre jrnlder":"yngre jrnlder","ldre jrnlder":"ldre jrnlder","ldre jrnlder":"ldre jrnlder"}}}}');var xS=i(6244),wS={};wS.styleTagTransform=ch(),wS.setAttributes=oh(),wS.insert=sh().bind(null,"head"),wS.domAPI=nh(),wS.insertStyleElement=uh(),eh()(xS.A,wS),xS.A&&xS.A.locals&&xS.A.locals;var bS=i(6942),ES=i.n(bS),MS=i(4848);const TS=["xxl","xl","lg","md","sm","xs"],SS=cT.createContext({prefixes:{},breakpoints:TS,minBreakpoint:"xs"}),{Consumer:CS,Provider:LS}=SS;function RS(t,e){const{prefixes:i}=(0,cT.useContext)(SS);return t||i[e]||e}function IS(){const{breakpoints:t}=(0,cT.useContext)(SS);return t}function PS(){const{minBreakpoint:t}=(0,cT.useContext)(SS);return t}function AS(){const{dir:t}=(0,cT.useContext)(SS);return"rtl"===t}const jS=cT.forwardRef(({bsPrefix:t,variant:e,animation:i="border",size:n,as:a="div",className:s,...r},o)=>{const l=`${t=RS(t,"spinner")}-${i}`;return(0,MS.jsx)(a,{ref:o,...r,className:ES()(s,l,n&&`${l}-${n}`,e&&`text-${e}`)})});jS.displayName="Spinner";const OS=jS,FS=()=>{const[t,e]=(0,cT.useState)(),i=(0,cT.useRef)(t);i.current=t;const[n,a]=(0,cT.useState)(!1),s=_S(t=>t.showLoadingAnimation),r=_S(t=>void 0!==t.visiblePage);return(0,cT.useEffect)(()=>{if(s){const t=window.setTimeout(()=>{i.current&&a(!0)},300);e(t)}else window.clearTimeout(i.current),e(void 0),a(!1)},[s]),n?cT.createElement(OS,{id:"loading-animation",animation:"border",role:"status",style:r?{right:"50px"}:void 0},cT.createElement("span",{className:"visually-hidden"},"Loading...")):cT.createElement(cT.Fragment,null)},NS=["as","disabled"];function GS({tagName:t,disabled:e,href:i,target:n,rel:a,role:s,onClick:r,tabIndex:o=0,type:l}){t||(t=null!=i||null!=n||null!=a?"a":"button");const u={tagName:t};if("button"===t)return[{type:l||"button",disabled:e},u];const h=n=>{(e||"a"===t&&function(t){return!t||"#"===t.trim()}(i))&&n.preventDefault(),e?n.stopPropagation():null==r||r(n)};return"a"===t&&(i||(i="#"),e&&(i=void 0)),[{role:null!=s?s:"button",disabled:void 0,tabIndex:e?void 0:o,href:i,target:"a"===t?n:void 0,"aria-disabled":e||void 0,rel:"a"===t?a:void 0,onClick:h,onKeyDown:t=>{" "===t.key&&(t.preventDefault(),h(t))}},u]}const DS=cT.forwardRef((t,e)=>{let{as:i,disabled:n}=t,a=function(t,e){if(null==t)return{};var i={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;i[n]=t[n]}return i}(t,NS);const[s,{tagName:r}]=GS(Object.assign({tagName:i,disabled:n},a));return(0,MS.jsx)(r,Object.assign({},a,s,{ref:e}))});DS.displayName="Button";const WS=DS,HS=cT.forwardRef(({as:t,bsPrefix:e,variant:i="primary",size:n,active:a=!1,disabled:s=!1,className:r,...o},l)=>{const u=RS(e,"btn"),[h,{tagName:c}]=GS({tagName:t,disabled:s,...o}),d=c;return(0,MS.jsx)(d,{...h,...o,ref:l,disabled:s,className:ES()(r,u,a&&"active",i&&`${u}-${i}`,n&&`${u}-${n}`,o.href&&s&&"disabled")})});HS.displayName="Button";const US=HS,BS=()=>{const{t}=JT(),e=mS(),i=(0,cT.useCallback)(()=>e({type:Dm.CENTER_MAP_TO_CURRENT_POSITION}),[e]);return cT.createElement("div",{id:"map-button-position",className:"map-button"},cT.createElement(US,{variant:"primary",size:"sm",title:t("common.button.positioning")??void 0,onClick:i},cT.createElement("i",{className:"bi bi-crosshair","aria-hidden":"true"})))},VS=({onClick:t,fullscreenPossible:e})=>{const{t:i}=JT();return e?cT.createElement("div",{id:"map-button-fullscreen",className:"map-button"},cT.createElement(US,{variant:"primary",size:"sm",title:i("common.button.fullscreen")??void 0,onClick:t},cT.createElement("i",{className:"bi bi-arrows-fullscreen","aria-hidden":"true"}))):null},KS=cT.forwardRef(({className:t,bsPrefix:e,as:i="div",...n},a)=>(e=RS(e,"popover-header"),(0,MS.jsx)(i,{ref:a,className:ES()(t,e),...n})));KS.displayName="PopoverHeader";const zS=KS,$S=cT.forwardRef(({className:t,bsPrefix:e,as:i="div",...n},a)=>(e=RS(e,"popover-body"),(0,MS.jsx)(i,{ref:a,className:ES()(t,e),...n})));$S.displayName="PopoverBody";const YS=$S;function XS(t,e){let i=t;return"left"===t?i=e?"end":"start":"right"===t&&(i=e?"start":"end"),i}function qS(t="absolute"){return{position:t,top:"0",left:"0",opacity:"0",pointerEvents:"none"}}cT.Component;const ZS=cT.forwardRef(({bsPrefix:t,placement:e="right",className:i,style:n,children:a,body:s,arrowProps:r,hasDoneInitialMeasure:o,popper:l,show:u,...h},c)=>{const d=RS(t,"popover"),p=AS(),[m]=(null==e?void 0:e.split("-"))||[],f=XS(m,p);let g=n;return u&&!o&&(g={...n,...qS(null==l?void 0:l.strategy)}),(0,MS.jsxs)("div",{ref:c,role:"tooltip",style:g,"x-placement":m,className:ES()(i,d,m&&`bs-popover-${f}`),...h,children:[(0,MS.jsx)("div",{className:"popover-arrow",...r}),s?(0,MS.jsx)(YS,{children:a}):a]})});ZS.displayName="Popover";const JS=Object.assign(ZS,{Header:zS,Body:YS,POPPER_OFFSET:[0,8]});function QS(t,e=TS,i="xs"){const n=[];return Object.entries(t).forEach(([t,a])=>{null!=a&&("object"==typeof a?e.forEach(e=>{const s=a[e];if(null!=s){const a=e!==i?`-${e}`:"";n.push(`${t}${a}-${s}`)}}):n.push(`${t}-${a}`))}),n}const tC=cT.forwardRef(({as:t="div",bsPrefix:e,className:i,direction:n,gap:a,...s},r)=>{e=RS(e,"horizontal"===n?"hstack":"vstack");const o=IS(),l=PS();return(0,MS.jsx)(t,{...s,ref:r,className:ES()(i,e,...QS({gap:a},o,l))})});tC.displayName="Stack";const eC=tC;function iC(t,e){return t.contains?t.contains(e):t.compareDocumentPosition?t===e||!!(16&t.compareDocumentPosition(e)):void 0}var nC=i(5556),aC=i.n(nC);const sC=2**31-1;function rC(t,e,i){const n=i-Date.now();t.current=n<=sC?setTimeout(e,n):setTimeout(()=>rC(t,e,i),sC)}function oC(){const t=function(){const t=(0,cT.useRef)(!0),e=(0,cT.useRef)(()=>t.current);return(0,cT.useEffect)(()=>(t.current=!0,()=>{t.current=!1}),[]),e.current}(),e=(0,cT.useRef)();return function(t){const e=function(t){const e=(0,cT.useRef)(t);return e.current=t,e}(t);(0,cT.useEffect)(()=>()=>e.current(),[])}(()=>clearTimeout(e.current)),(0,cT.useMemo)(()=>{const i=()=>clearTimeout(e.current);return{set:function(n,a=0){t()&&(i(),a<=sC?e.current=setTimeout(n,a):rC(e,n,Date.now()+a))},clear:i,handleRef:e}},[])}var lC=i(9771),uC=i.n(lC);function hC(){return hC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)({}).hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},hC.apply(null,arguments)}function cC(t,e){if(null==t)return{};var i={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(-1!==e.indexOf(n))continue;i[n]=t[n]}return i}function dC(t){return"default"+t.charAt(0).toUpperCase()+t.substr(1)}function pC(t){var e=function(t){if("object"!=typeof t||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}function mC(t,e,i){var n=(0,cT.useRef)(void 0!==t),a=(0,cT.useState)(e),s=a[0],r=a[1],o=void 0!==t,l=n.current;return n.current=o,!o&&l&&s!==e&&r(e),[o?t:s,(0,cT.useCallback)(function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),a=1;a<e;a++)n[a-1]=arguments[a];i&&i.apply(void 0,[t].concat(n)),r(t)},[i])]}function fC(t,e){return Object.keys(e).reduce(function(i,n){var a,s=i,r=s[dC(n)],o=s[n],l=cC(s,[dC(n),n].map(pC)),u=e[n],h=mC(o,r,t[u]),c=h[0],d=h[1];return hC({},l,((a={})[n]=c,a[u]=d,a))},t)}i(2692);const gC=t=>t&&"function"!=typeof t?e=>{t.current=e}:t,_C=function(t,e){return(0,cT.useMemo)(()=>function(t,e){const i=gC(t),n=gC(e);return t=>{i&&i(t),n&&n(t)}}(t,e),[t,e])};function yC(t){return"Escape"===t.code||27===t.keyCode}function kC(t){if(!t||"function"==typeof t)return null;const{major:e}=function(){const t=cT.version.split(".");return{major:+t[0],minor:+t[1],patch:+t[2]}}();return e>=19?t.props.ref:t.ref}var vC=i(961);function xC(){return(0,cT.useState)(null)}const wC=t=>t&&"function"!=typeof t?e=>{t.current=e}:t,bC=function(t,e){return(0,cT.useMemo)(()=>function(t,e){const i=wC(t),n=wC(e);return t=>{i&&i(t),n&&n(t)}}(t,e),[t,e])};var EC=Object.prototype.hasOwnProperty;function MC(t,e,i){for(i of t.keys())if(TC(i,e))return i}function TC(t,e){var i,n,a;if(t===e)return!0;if(t&&e&&(i=t.constructor)===e.constructor){if(i===Date)return t.getTime()===e.getTime();if(i===RegExp)return t.toString()===e.toString();if(i===Array){if((n=t.length)===e.length)for(;n--&&TC(t[n],e[n]););return-1===n}if(i===Set){if(t.size!==e.size)return!1;for(n of t){if((a=n)&&"object"==typeof a&&!(a=MC(e,a)))return!1;if(!e.has(a))return!1}return!0}if(i===Map){if(t.size!==e.size)return!1;for(n of t){if((a=n[0])&&"object"==typeof a&&!(a=MC(e,a)))return!1;if(!TC(n[1],e.get(a)))return!1}return!0}if(i===ArrayBuffer)t=new Uint8Array(t),e=new Uint8Array(e);else if(i===DataView){if((n=t.byteLength)===e.byteLength)for(;n--&&t.getInt8(n)===e.getInt8(n););return-1===n}if(ArrayBuffer.isView(t)){if((n=t.byteLength)===e.byteLength)for(;n--&&t[n]===e[n];);return-1===n}if(!i||"object"==typeof t){for(i in n=0,t){if(EC.call(t,i)&&++n&&!EC.call(e,i))return!1;if(!(i in e)||!TC(t[i],e[i]))return!1}return Object.keys(e).length===n}}return t!=t&&e!=e}function SC(){const t=(0,cT.useRef)(!0),e=(0,cT.useRef)(()=>t.current);return(0,cT.useEffect)(()=>(t.current=!0,()=>{t.current=!1}),[]),e.current}function CC(t){return t.split("-")[0]}function LC(t){if(null==t)return window;if("[object Window]"!==t.toString()){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function RC(t){return t instanceof LC(t).Element||t instanceof Element}function IC(t){return t instanceof LC(t).HTMLElement||t instanceof HTMLElement}function PC(t){return"undefined"!=typeof ShadowRoot&&(t instanceof LC(t).ShadowRoot||t instanceof ShadowRoot)}var AC=Math.max,jC=Math.min,OC=Math.round;function FC(){var t=navigator.userAgentData;return null!=t&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function NC(){return!/^((?!chrome|android).)*safari/i.test(FC())}function GC(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var n=t.getBoundingClientRect(),a=1,s=1;e&&IC(t)&&(a=t.offsetWidth>0&&OC(n.width)/t.offsetWidth||1,s=t.offsetHeight>0&&OC(n.height)/t.offsetHeight||1);var r=(RC(t)?LC(t):window).visualViewport,o=!NC()&&i,l=(n.left+(o&&r?r.offsetLeft:0))/a,u=(n.top+(o&&r?r.offsetTop:0))/s,h=n.width/a,c=n.height/s;return{width:h,height:c,top:u,right:l+h,bottom:u+c,left:l,x:l,y:u}}function DC(t){var e=GC(t),i=t.offsetWidth,n=t.offsetHeight;return Math.abs(e.width-i)<=1&&(i=e.width),Math.abs(e.height-n)<=1&&(n=e.height),{x:t.offsetLeft,y:t.offsetTop,width:i,height:n}}function WC(t,e){var i=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(i&&PC(i)){var n=e;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function HC(t){return t?(t.nodeName||"").toLowerCase():null}function UC(t){return LC(t).getComputedStyle(t)}function BC(t){return["table","td","th"].indexOf(HC(t))>=0}function VC(t){return((RC(t)?t.ownerDocument:t.document)||window.document).documentElement}function KC(t){return"html"===HC(t)?t:t.assignedSlot||t.parentNode||(PC(t)?t.host:null)||VC(t)}function zC(t){return IC(t)&&"fixed"!==UC(t).position?t.offsetParent:null}function $C(t){for(var e=LC(t),i=zC(t);i&&BC(i)&&"static"===UC(i).position;)i=zC(i);return i&&("html"===HC(i)||"body"===HC(i)&&"static"===UC(i).position)?e:i||function(t){var e=/firefox/i.test(FC());if(/Trident/i.test(FC())&&IC(t)&&"fixed"===UC(t).position)return null;var i=KC(t);for(PC(i)&&(i=i.host);IC(i)&&["html","body"].indexOf(HC(i))<0;){var n=UC(i);if("none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||-1!==["transform","perspective"].indexOf(n.willChange)||e&&"filter"===n.willChange||e&&n.filter&&"none"!==n.filter)return i;i=i.parentNode}return null}(t)||e}function YC(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function XC(t,e,i){return AC(t,jC(e,i))}function qC(t){return Object.assign({},{top:0,right:0,bottom:0,left:0},t)}function ZC(t,e){return e.reduce(function(e,i){return e[i]=t,e},{})}var JC="top",QC="bottom",tL="right",eL="left",iL="auto",nL=[JC,QC,tL,eL],aL="start",sL="end",rL="viewport",oL="popper",lL=nL.reduce(function(t,e){return t.concat([e+"-"+aL,e+"-"+sL])},[]),uL=[].concat(nL,[iL]).reduce(function(t,e){return t.concat([e,e+"-"+aL,e+"-"+sL])},[]),hL=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];const cL={name:"arrow",enabled:!0,phase:"main",fn:function(t){var e,i=t.state,n=t.name,a=t.options,s=i.elements.arrow,r=i.modifiersData.popperOffsets,o=CC(i.placement),l=YC(o),u=[eL,tL].indexOf(o)>=0?"height":"width";if(s&&r){var h=function(t,e){return qC("number"!=typeof(t="function"==typeof t?t(Object.assign({},e.rects,{placement:e.placement})):t)?t:ZC(t,nL))}(a.padding,i),c=DC(s),d="y"===l?JC:eL,p="y"===l?QC:tL,m=i.rects.reference[u]+i.rects.reference[l]-r[l]-i.rects.popper[u],f=r[l]-i.rects.reference[l],g=$C(s),_=g?"y"===l?g.clientHeight||0:g.clientWidth||0:0,y=m/2-f/2,k=h[d],v=_-c[u]-h[p],x=_/2-c[u]/2+y,w=XC(k,x,v),b=l;i.modifiersData[n]=((e={})[b]=w,e.centerOffset=w-x,e)}},effect:function(t){var e=t.state,i=t.options.element,n=void 0===i?"[data-popper-arrow]":i;null!=n&&("string"!=typeof n||(n=e.elements.popper.querySelector(n)))&&WC(e.elements.popper,n)&&(e.elements.arrow=n)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function dL(t){return t.split("-")[1]}var pL={top:"auto",right:"auto",bottom:"auto",left:"auto"};function mL(t){var e,i=t.popper,n=t.popperRect,a=t.placement,s=t.variation,r=t.offsets,o=t.position,l=t.gpuAcceleration,u=t.adaptive,h=t.roundOffsets,c=t.isFixed,d=r.x,p=void 0===d?0:d,m=r.y,f=void 0===m?0:m,g="function"==typeof h?h({x:p,y:f}):{x:p,y:f};p=g.x,f=g.y;var _=r.hasOwnProperty("x"),y=r.hasOwnProperty("y"),k=eL,v=JC,x=window;if(u){var w=$C(i),b="clientHeight",E="clientWidth";w===LC(i)&&"static"!==UC(w=VC(i)).position&&"absolute"===o&&(b="scrollHeight",E="scrollWidth"),(a===JC||(a===eL||a===tL)&&s===sL)&&(v=QC,f-=(c&&w===x&&x.visualViewport?x.visualViewport.height:w[b])-n.height,f*=l?1:-1),a!==eL&&(a!==JC&&a!==QC||s!==sL)||(k=tL,p-=(c&&w===x&&x.visualViewport?x.visualViewport.width:w[E])-n.width,p*=l?1:-1)}var M,T=Object.assign({position:o},u&&pL),S=!0===h?function(t,e){var i=t.x,n=t.y,a=e.devicePixelRatio||1;return{x:OC(i*a)/a||0,y:OC(n*a)/a||0}}({x:p,y:f},LC(i)):{x:p,y:f};return p=S.x,f=S.y,l?Object.assign({},T,((M={})[v]=y?"0":"",M[k]=_?"0":"",M.transform=(x.devicePixelRatio||1)<=1?"translate("+p+"px, "+f+"px)":"translate3d("+p+"px, "+f+"px, 0)",M)):Object.assign({},T,((e={})[v]=y?f+"px":"",e[k]=_?p+"px":"",e.transform="",e))}const fL={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(t){var e=t.state,i=t.options,n=i.gpuAcceleration,a=void 0===n||n,s=i.adaptive,r=void 0===s||s,o=i.roundOffsets,l=void 0===o||o,u={placement:CC(e.placement),variation:dL(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:a,isFixed:"fixed"===e.options.strategy};null!=e.modifiersData.popperOffsets&&(e.styles.popper=Object.assign({},e.styles.popper,mL(Object.assign({},u,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:r,roundOffsets:l})))),null!=e.modifiersData.arrow&&(e.styles.arrow=Object.assign({},e.styles.arrow,mL(Object.assign({},u,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})},data:{}};var gL={passive:!0};const _L={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(t){var e=t.state,i=t.instance,n=t.options,a=n.scroll,s=void 0===a||a,r=n.resize,o=void 0===r||r,l=LC(e.elements.popper),u=[].concat(e.scrollParents.reference,e.scrollParents.popper);return s&&u.forEach(function(t){t.addEventListener("scroll",i.update,gL)}),o&&l.addEventListener("resize",i.update,gL),function(){s&&u.forEach(function(t){t.removeEventListener("scroll",i.update,gL)}),o&&l.removeEventListener("resize",i.update,gL)}},data:{}};var yL={left:"right",right:"left",bottom:"top",top:"bottom"};function kL(t){return t.replace(/left|right|bottom|top/g,function(t){return yL[t]})}var vL={start:"end",end:"start"};function xL(t){return t.replace(/start|end/g,function(t){return vL[t]})}function wL(t){var e=LC(t);return{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function bL(t){return GC(VC(t)).left+wL(t).scrollLeft}function EL(t){var e=UC(t),i=e.overflow,n=e.overflowX,a=e.overflowY;return/auto|scroll|overlay|hidden/.test(i+a+n)}function ML(t){return["html","body","#document"].indexOf(HC(t))>=0?t.ownerDocument.body:IC(t)&&EL(t)?t:ML(KC(t))}function TL(t,e){var i;void 0===e&&(e=[]);var n=ML(t),a=n===(null==(i=t.ownerDocument)?void 0:i.body),s=LC(n),r=a?[s].concat(s.visualViewport||[],EL(n)?n:[]):n,o=e.concat(r);return a?o:o.concat(TL(KC(r)))}function SL(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function CL(t,e,i){return e===rL?SL(function(t,e){var i=LC(t),n=VC(t),a=i.visualViewport,s=n.clientWidth,r=n.clientHeight,o=0,l=0;if(a){s=a.width,r=a.height;var u=NC();(u||!u&&"fixed"===e)&&(o=a.offsetLeft,l=a.offsetTop)}return{width:s,height:r,x:o+bL(t),y:l}}(t,i)):RC(e)?function(t,e){var i=GC(t,!1,"fixed"===e);return i.top=i.top+t.clientTop,i.left=i.left+t.clientLeft,i.bottom=i.top+t.clientHeight,i.right=i.left+t.clientWidth,i.width=t.clientWidth,i.height=t.clientHeight,i.x=i.left,i.y=i.top,i}(e,i):SL(function(t){var e,i=VC(t),n=wL(t),a=null==(e=t.ownerDocument)?void 0:e.body,s=AC(i.scrollWidth,i.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),r=AC(i.scrollHeight,i.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),o=-n.scrollLeft+bL(t),l=-n.scrollTop;return"rtl"===UC(a||i).direction&&(o+=AC(i.clientWidth,a?a.clientWidth:0)-s),{width:s,height:r,x:o,y:l}}(VC(t)))}function LL(t){var e,i=t.reference,n=t.element,a=t.placement,s=a?CC(a):null,r=a?dL(a):null,o=i.x+i.width/2-n.width/2,l=i.y+i.height/2-n.height/2;switch(s){case JC:e={x:o,y:i.y-n.height};break;case QC:e={x:o,y:i.y+i.height};break;case tL:e={x:i.x+i.width,y:l};break;case eL:e={x:i.x-n.width,y:l};break;default:e={x:i.x,y:i.y}}var u=s?YC(s):null;if(null!=u){var h="y"===u?"height":"width";switch(r){case aL:e[u]=e[u]-(i[h]/2-n[h]/2);break;case sL:e[u]=e[u]+(i[h]/2-n[h]/2)}}return e}function RL(t,e){void 0===e&&(e={});var i=e,n=i.placement,a=void 0===n?t.placement:n,s=i.strategy,r=void 0===s?t.strategy:s,o=i.boundary,l=void 0===o?"clippingParents":o,u=i.rootBoundary,h=void 0===u?rL:u,c=i.elementContext,d=void 0===c?oL:c,p=i.altBoundary,m=void 0!==p&&p,f=i.padding,g=void 0===f?0:f,_=qC("number"!=typeof g?g:ZC(g,nL)),y=d===oL?"reference":oL,k=t.rects.popper,v=t.elements[m?y:d],x=function(t,e,i,n){var a="clippingParents"===e?function(t){var e=TL(KC(t)),i=["absolute","fixed"].indexOf(UC(t).position)>=0&&IC(t)?$C(t):t;return RC(i)?e.filter(function(t){return RC(t)&&WC(t,i)&&"body"!==HC(t)}):[]}(t):[].concat(e),s=[].concat(a,[i]),r=s[0],o=s.reduce(function(e,i){var a=CL(t,i,n);return e.top=AC(a.top,e.top),e.right=jC(a.right,e.right),e.bottom=jC(a.bottom,e.bottom),e.left=AC(a.left,e.left),e},CL(t,r,n));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}(RC(v)?v:v.contextElement||VC(t.elements.popper),l,h,r),w=GC(t.elements.reference),b=LL({reference:w,element:k,strategy:"absolute",placement:a}),E=SL(Object.assign({},k,b)),M=d===oL?E:w,T={top:x.top-M.top+_.top,bottom:M.bottom-x.bottom+_.bottom,left:x.left-M.left+_.left,right:M.right-x.right+_.right},S=t.modifiersData.offset;if(d===oL&&S){var C=S[a];Object.keys(T).forEach(function(t){var e=[tL,QC].indexOf(t)>=0?1:-1,i=[JC,QC].indexOf(t)>=0?"y":"x";T[t]+=C[i]*e})}return T}const IL={name:"flip",enabled:!0,phase:"main",fn:function(t){var e=t.state,i=t.options,n=t.name;if(!e.modifiersData[n]._skip){for(var a=i.mainAxis,s=void 0===a||a,r=i.altAxis,o=void 0===r||r,l=i.fallbackPlacements,u=i.padding,h=i.boundary,c=i.rootBoundary,d=i.altBoundary,p=i.flipVariations,m=void 0===p||p,f=i.allowedAutoPlacements,g=e.options.placement,_=CC(g),y=l||(_!==g&&m?function(t){if(CC(t)===iL)return[];var e=kL(t);return[xL(t),e,xL(e)]}(g):[kL(g)]),k=[g].concat(y).reduce(function(t,i){return t.concat(CC(i)===iL?function(t,e){void 0===e&&(e={});var i=e,n=i.placement,a=i.boundary,s=i.rootBoundary,r=i.padding,o=i.flipVariations,l=i.allowedAutoPlacements,u=void 0===l?uL:l,h=dL(n),c=h?o?lL:lL.filter(function(t){return dL(t)===h}):nL,d=c.filter(function(t){return u.indexOf(t)>=0});0===d.length&&(d=c);var p=d.reduce(function(e,i){return e[i]=RL(t,{placement:i,boundary:a,rootBoundary:s,padding:r})[CC(i)],e},{});return Object.keys(p).sort(function(t,e){return p[t]-p[e]})}(e,{placement:i,boundary:h,rootBoundary:c,padding:u,flipVariations:m,allowedAutoPlacements:f}):i)},[]),v=e.rects.reference,x=e.rects.popper,w=new Map,b=!0,E=k[0],M=0;M<k.length;M++){var T=k[M],S=CC(T),C=dL(T)===aL,L=[JC,QC].indexOf(S)>=0,R=L?"width":"height",I=RL(e,{placement:T,boundary:h,rootBoundary:c,altBoundary:d,padding:u}),P=L?C?tL:eL:C?QC:JC;v[R]>x[R]&&(P=kL(P));var A=kL(P),j=[];if(s&&j.push(I[S]<=0),o&&j.push(I[P]<=0,I[A]<=0),j.every(function(t){return t})){E=T,b=!1;break}w.set(T,j)}if(b)for(var O=function(t){var e=k.find(function(e){var i=w.get(e);if(i)return i.slice(0,t).every(function(t){return t})});if(e)return E=e,"break"},F=m?3:1;F>0&&"break"!==O(F);F--);e.placement!==E&&(e.modifiersData[n]._skip=!0,e.placement=E,e.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function PL(t,e,i){return void 0===i&&(i={x:0,y:0}),{top:t.top-e.height-i.y,right:t.right-e.width+i.x,bottom:t.bottom-e.height+i.y,left:t.left-e.width-i.x}}function AL(t){return[JC,tL,QC,eL].some(function(e){return t[e]>=0})}const jL={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(t){var e=t.state,i=t.options,n=t.name,a=i.offset,s=void 0===a?[0,0]:a,r=uL.reduce(function(t,i){return t[i]=function(t,e,i){var n=CC(t),a=[eL,JC].indexOf(n)>=0?-1:1,s="function"==typeof i?i(Object.assign({},e,{placement:t})):i,r=s[0],o=s[1];return r=r||0,o=(o||0)*a,[eL,tL].indexOf(n)>=0?{x:o,y:r}:{x:r,y:o}}(i,e.rects,s),t},{}),o=r[e.placement],l=o.x,u=o.y;null!=e.modifiersData.popperOffsets&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=u),e.modifiersData[n]=r}},OL={name:"preventOverflow",enabled:!0,phase:"main",fn:function(t){var e=t.state,i=t.options,n=t.name,a=i.mainAxis,s=void 0===a||a,r=i.altAxis,o=void 0!==r&&r,l=i.boundary,u=i.rootBoundary,h=i.altBoundary,c=i.padding,d=i.tether,p=void 0===d||d,m=i.tetherOffset,f=void 0===m?0:m,g=RL(e,{boundary:l,rootBoundary:u,padding:c,altBoundary:h}),_=CC(e.placement),y=dL(e.placement),k=!y,v=YC(_),x="x"===v?"y":"x",w=e.modifiersData.popperOffsets,b=e.rects.reference,E=e.rects.popper,M="function"==typeof f?f(Object.assign({},e.rects,{placement:e.placement})):f,T="number"==typeof M?{mainAxis:M,altAxis:M}:Object.assign({mainAxis:0,altAxis:0},M),S=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,C={x:0,y:0};if(w){if(s){var L,R="y"===v?JC:eL,I="y"===v?QC:tL,P="y"===v?"height":"width",A=w[v],j=A+g[R],O=A-g[I],F=p?-E[P]/2:0,N=y===aL?b[P]:E[P],G=y===aL?-E[P]:-b[P],D=e.elements.arrow,W=p&&D?DC(D):{width:0,height:0},H=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},U=H[R],B=H[I],V=XC(0,b[P],W[P]),K=k?b[P]/2-F-V-U-T.mainAxis:N-V-U-T.mainAxis,z=k?-b[P]/2+F+V+B+T.mainAxis:G+V+B+T.mainAxis,$=e.elements.arrow&&$C(e.elements.arrow),Y=$?"y"===v?$.clientTop||0:$.clientLeft||0:0,X=null!=(L=null==S?void 0:S[v])?L:0,q=A+z-X,Z=XC(p?jC(j,A+K-X-Y):j,A,p?AC(O,q):O);w[v]=Z,C[v]=Z-A}if(o){var J,Q="x"===v?JC:eL,tt="x"===v?QC:tL,et=w[x],it="y"===x?"height":"width",nt=et+g[Q],at=et-g[tt],st=-1!==[JC,eL].indexOf(_),rt=null!=(J=null==S?void 0:S[x])?J:0,ot=st?nt:et-b[it]-E[it]-rt+T.altAxis,lt=st?et+b[it]+E[it]-rt-T.altAxis:at,ut=p&&st?function(t,e,i){var n=XC(t,e,i);return n>i?i:n}(ot,et,lt):XC(p?ot:nt,et,p?lt:at);w[x]=ut,C[x]=ut-et}e.modifiersData[n]=C}},requiresIfExists:["offset"]};function FL(t,e,i){void 0===i&&(i=!1);var n,a,s=IC(e),r=IC(e)&&function(t){var e=t.getBoundingClientRect(),i=OC(e.width)/t.offsetWidth||1,n=OC(e.height)/t.offsetHeight||1;return 1!==i||1!==n}(e),o=VC(e),l=GC(t,r,i),u={scrollLeft:0,scrollTop:0},h={x:0,y:0};return(s||!s&&!i)&&(("body"!==HC(e)||EL(o))&&(u=(n=e)!==LC(n)&&IC(n)?{scrollLeft:(a=n).scrollLeft,scrollTop:a.scrollTop}:wL(n)),IC(e)?((h=GC(e,!0)).x+=e.clientLeft,h.y+=e.clientTop):o&&(h.x=bL(o))),{x:l.left+u.scrollLeft-h.x,y:l.top+u.scrollTop-h.y,width:l.width,height:l.height}}function NL(t){var e=new Map,i=new Set,n=[];function a(t){i.add(t.name),[].concat(t.requires||[],t.requiresIfExists||[]).forEach(function(t){if(!i.has(t)){var n=e.get(t);n&&a(n)}}),n.push(t)}return t.forEach(function(t){e.set(t.name,t)}),t.forEach(function(t){i.has(t.name)||a(t)}),n}var GL={placement:"bottom",modifiers:[],strategy:"absolute"};function DL(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return!e.some(function(t){return!(t&&"function"==typeof t.getBoundingClientRect)})}const WL=function(t){void 0===t&&(t={});var e=t,i=e.defaultModifiers,n=void 0===i?[]:i,a=e.defaultOptions,s=void 0===a?GL:a;return function(t,e,i){void 0===i&&(i=s);var a,r,o={placement:"bottom",orderedModifiers:[],options:Object.assign({},GL,s),modifiersData:{},elements:{reference:t,popper:e},attributes:{},styles:{}},l=[],u=!1,h={state:o,setOptions:function(i){var a="function"==typeof i?i(o.options):i;c(),o.options=Object.assign({},s,o.options,a),o.scrollParents={reference:RC(t)?TL(t):t.contextElement?TL(t.contextElement):[],popper:TL(e)};var r,u,d=function(t){var e=NL(t);return hL.reduce(function(t,i){return t.concat(e.filter(function(t){return t.phase===i}))},[])}((r=[].concat(n,o.options.modifiers),u=r.reduce(function(t,e){var i=t[e.name];return t[e.name]=i?Object.assign({},i,e,{options:Object.assign({},i.options,e.options),data:Object.assign({},i.data,e.data)}):e,t},{}),Object.keys(u).map(function(t){return u[t]})));return o.orderedModifiers=d.filter(function(t){return t.enabled}),o.orderedModifiers.forEach(function(t){var e=t.name,i=t.options,n=void 0===i?{}:i,a=t.effect;if("function"==typeof a){var s=a({state:o,name:e,instance:h,options:n});l.push(s||function(){})}}),h.update()},forceUpdate:function(){if(!u){var t=o.elements,e=t.reference,i=t.popper;if(DL(e,i)){o.rects={reference:FL(e,$C(i),"fixed"===o.options.strategy),popper:DC(i)},o.reset=!1,o.placement=o.options.placement,o.orderedModifiers.forEach(function(t){return o.modifiersData[t.name]=Object.assign({},t.data)});for(var n=0;n<o.orderedModifiers.length;n++)if(!0!==o.reset){var a=o.orderedModifiers[n],s=a.fn,r=a.options,l=void 0===r?{}:r,c=a.name;"function"==typeof s&&(o=s({state:o,options:l,name:c,instance:h})||o)}else o.reset=!1,n=-1}}},update:(a=function(){return new Promise(function(t){h.forceUpdate(),t(o)})},function(){return r||(r=new Promise(function(t){Promise.resolve().then(function(){r=void 0,t(a())})})),r}),destroy:function(){c(),u=!0}};if(!DL(t,e))return h;function c(){l.forEach(function(t){return t()}),l=[]}return h.setOptions(i).then(function(t){!u&&i.onFirstUpdate&&i.onFirstUpdate(t)}),h}}({defaultModifiers:[{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(t){var e=t.state,i=t.name,n=e.rects.reference,a=e.rects.popper,s=e.modifiersData.preventOverflow,r=RL(e,{elementContext:"reference"}),o=RL(e,{altBoundary:!0}),l=PL(r,n),u=PL(o,a,s),h=AL(l),c=AL(u);e.modifiersData[i]={referenceClippingOffsets:l,popperEscapeOffsets:u,isReferenceHidden:h,hasPopperEscaped:c},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":h,"data-popper-escaped":c})}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(t){var e=t.state,i=t.name;e.modifiersData[i]=LL({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})},data:{}},fL,_L,jL,IL,OL,cL]}),HL=["enabled","placement","strategy","modifiers"],UL={name:"applyStyles",enabled:!1,phase:"afterWrite",fn:()=>{}},BL={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:({state:t})=>()=>{const{reference:e,popper:i}=t.elements;if("removeAttribute"in e){const t=(e.getAttribute("aria-describedby")||"").split(",").filter(t=>t.trim()!==i.id);t.length?e.setAttribute("aria-describedby",t.join(",")):e.removeAttribute("aria-describedby")}},fn:({state:t})=>{var e;const{popper:i,reference:n}=t.elements,a=null==(e=i.getAttribute("role"))?void 0:e.toLowerCase();if(i.id&&"tooltip"===a&&"setAttribute"in n){const t=n.getAttribute("aria-describedby");if(t&&-1!==t.split(",").indexOf(i.id))return;n.setAttribute("aria-describedby",t?`${t},${i.id}`:i.id)}}},VL=[],KL=function(t,e,i={}){let{enabled:n=!0,placement:a="bottom",strategy:s="absolute",modifiers:r=VL}=i,o=function(t,e){if(null==t)return{};var i={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;i[n]=t[n]}return i}(i,HL);const l=(0,cT.useRef)(r),u=(0,cT.useRef)(),h=(0,cT.useCallback)(()=>{var t;null==(t=u.current)||t.update()},[]),c=(0,cT.useCallback)(()=>{var t;null==(t=u.current)||t.forceUpdate()},[]),[d,p]=function(t){const e=SC();return[t[0],(0,cT.useCallback)(i=>{if(e())return t[1](i)},[e,t[1]])]}((0,cT.useState)({placement:a,update:h,forceUpdate:c,attributes:{},styles:{popper:{},arrow:{}}})),m=(0,cT.useMemo)(()=>({name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:({state:t})=>{const e={},i={};Object.keys(t.elements).forEach(n=>{e[n]=t.styles[n],i[n]=t.attributes[n]}),p({state:t,styles:e,attributes:i,update:h,forceUpdate:c,placement:t.placement})}}),[h,c,p]),f=(0,cT.useMemo)(()=>(TC(l.current,r)||(l.current=r),l.current),[r]);return(0,cT.useEffect)(()=>{u.current&&n&&u.current.setOptions({placement:a,strategy:s,modifiers:[...f,m,UL]})},[s,a,m,n,f]),(0,cT.useEffect)(()=>{if(n&&null!=t&&null!=e)return u.current=WL(t,e,Object.assign({},o,{placement:a,strategy:s,modifiers:[...f,BL,m]})),()=>{null!=u.current&&(u.current.destroy(),u.current=void 0,p(t=>Object.assign({},t,{attributes:{},styles:{popper:{}}})))}},[n,t,e]),d},zL=!("undefined"==typeof window||!window.document||!window.document.createElement);var $L=!1,YL=!1;try{var XL={get passive(){return $L=!0},get once(){return YL=$L=!0}};zL&&(window.addEventListener("test",XL,XL),window.removeEventListener("test",XL,!0))}catch(t){}const qL=function(t,e,i,n){if(n&&"boolean"!=typeof n&&!YL){var a=n.once,s=n.capture,r=i;!YL&&a&&(r=i.__once||function t(n){this.removeEventListener(e,t,s),i.call(this,n)},i.__once=r),t.addEventListener(e,r,$L?n:s)}t.addEventListener(e,i,n)},ZL=function(t,e,i,n){return qL(t,e,i,n),function(){!function(t,e,i,n){var a=n&&"boolean"!=typeof n?n.capture:n;t.removeEventListener(e,i,a),i.__once&&t.removeEventListener(e,i.__once,a)}(t,e,i,n)}};function JL(t){return t&&t.ownerDocument||document}function QL(t){const e=function(t){const e=(0,cT.useRef)(t);return(0,cT.useEffect)(()=>{e.current=t},[t]),e}(t);return(0,cT.useCallback)(function(...t){return e.current&&e.current(...t)},[e])}const tR=()=>{},eR=t=>t&&("current"in t?t.current:t),iR={click:"mousedown",mouseup:"mousedown",pointerup:"pointerdown"},nR=function(t,e=tR,{disabled:i,clickTrigger:n="click"}={}){const a=(0,cT.useRef)(!1),s=(0,cT.useRef)(!1),r=(0,cT.useCallback)(e=>{const i=eR(t);var n;uC()(!!i,"ClickOutside captured a close event but does not have a ref to compare it to. useClickOutside(), should be passed a ref that resolves to a DOM node"),a.current=!i||!!((n=e).metaKey||n.altKey||n.ctrlKey||n.shiftKey)||!function(t){return 0===t.button}(e)||!!iC(i,e.target)||s.current,s.current=!1},[t]),o=QL(e=>{const i=eR(t);i&&iC(i,e.target)?s.current=!0:s.current=!1}),l=QL(t=>{a.current||e(t)});(0,cT.useEffect)(()=>{var e,a;if(i||null==t)return;const s=JL(eR(t)),u=s.defaultView||window;let h=null!=(e=u.event)?e:null==(a=u.parent)?void 0:a.event,c=null;iR[n]&&(c=ZL(s,iR[n],o,!0));const d=ZL(s,n,r,!0),p=ZL(s,n,t=>{t!==h?l(t):h=void 0});let m=[];return"ontouchstart"in s.documentElement&&(m=[].slice.call(s.body.children).map(t=>ZL(t,"mousemove",tR))),()=>{null==c||c(),d(),p(),m.forEach(t=>t())}},[t,i,n,r,o,l])},aR=()=>{},sR=(0,cT.createContext)(zL?window:void 0);function rR(){return(0,cT.useContext)(sR)}sR.Provider;const oR=(t,e)=>zL?null==t?(e||JL()).body:("function"==typeof t&&(t=t()),t&&"current"in t&&(t=t.current),t&&("nodeType"in t||t.getBoundingClientRect)?t:null):null;function lR(t,e){const i=rR(),[n,a]=(0,cT.useState)(()=>oR(t,null==i?void 0:i.document));if(!n){const e=oR(t);e&&a(e)}return(0,cT.useEffect)(()=>{e&&n&&e(n)},[e,n]),(0,cT.useEffect)(()=>{const e=oR(t);e!==n&&a(e)},[t,n]),n}function uR(t={}){return Array.isArray(t)?t:Object.keys(t).map(e=>(t[e].name=e,t[e]))}function hR({enabled:t,enableEvents:e,placement:i,flip:n,offset:a,fixed:s,containerPadding:r,arrowElement:o,popperConfig:l={}}){var u,h,c,d,p;const m=function(t){const e={};return Array.isArray(t)?(null==t||t.forEach(t=>{e[t.name]=t}),e):t||e}(l.modifiers);return Object.assign({},l,{placement:i,enabled:t,strategy:s?"fixed":l.strategy,modifiers:uR(Object.assign({},m,{eventListeners:{enabled:e,options:null==(u=m.eventListeners)?void 0:u.options},preventOverflow:Object.assign({},m.preventOverflow,{options:r?Object.assign({padding:r},null==(h=m.preventOverflow)?void 0:h.options):null==(c=m.preventOverflow)?void 0:c.options}),offset:{options:Object.assign({offset:a},null==(d=m.offset)?void 0:d.options)},arrow:Object.assign({},m.arrow,{enabled:!!o,options:Object.assign({},null==(p=m.arrow)?void 0:p.options,{element:o})}),flip:Object.assign({enabled:!!n},m.flip)}))})}const cR=void 0!==i.g&&i.g.navigator&&"ReactNative"===i.g.navigator.product,dR="undefined"!=typeof document||cR?cT.useLayoutEffect:cT.useEffect,pR=function({children:t,in:e,onExited:i,mountOnEnter:n,unmountOnExit:a}){const s=(0,cT.useRef)(null),r=(0,cT.useRef)(e),o=QL(i);(0,cT.useEffect)(()=>{e?r.current=!0:o(s.current)},[e,o]);const l=bC(s,kC(t)),u=(0,cT.cloneElement)(t,{ref:l});return e?u:a||!r.current&&n?null:u},mR=["onEnter","onEntering","onEntered","onExit","onExiting","onExited","addEndListener","children"],fR=["component"],gR=cT.forwardRef((t,e)=>{let{component:i}=t,n=function(t,e){if(null==t)return{};var i={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;i[n]=t[n]}return i}(t,fR);const a=function(t){let{onEnter:e,onEntering:i,onEntered:n,onExit:a,onExiting:s,onExited:r,addEndListener:o,children:l}=t,u=function(t,e){if(null==t)return{};var i={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;i[n]=t[n]}return i}(t,mR);const h=(0,cT.useRef)(null),c=bC(h,kC(l)),d=t=>e=>{t&&h.current&&t(h.current,e)},p=(0,cT.useCallback)(d(e),[e]),m=(0,cT.useCallback)(d(i),[i]),f=(0,cT.useCallback)(d(n),[n]),g=(0,cT.useCallback)(d(a),[a]),_=(0,cT.useCallback)(d(s),[s]),y=(0,cT.useCallback)(d(r),[r]),k=(0,cT.useCallback)(d(o),[o]);return Object.assign({},u,{nodeRef:h},e&&{onEnter:p},i&&{onEntering:m},n&&{onEntered:f},a&&{onExit:g},s&&{onExiting:_},r&&{onExited:y},o&&{addEndListener:k},{children:"function"==typeof l?(t,e)=>l(t,Object.assign({},e,{ref:c})):(0,cT.cloneElement)(l,{ref:c})})}(n);return(0,MS.jsx)(i,Object.assign({ref:e},a))}),_R=gR;function yR({children:t,in:e,onExited:i,onEntered:n,transition:a}){const[s,r]=(0,cT.useState)(!e);e&&s&&r(!1);const o=function({in:t,onTransition:e}){const i=(0,cT.useRef)(null),n=(0,cT.useRef)(!0),a=QL(e);return dR(()=>{if(!i.current)return;let e=!1;return a({in:t,element:i.current,initial:n.current,isStale:()=>e}),()=>{e=!0}},[t,a]),dR(()=>(n.current=!1,()=>{n.current=!0}),[]),i}({in:!!e,onTransition:t=>{Promise.resolve(a(t)).then(()=>{t.isStale()||(t.in?null==n||n(t.element,t.initial):(r(!0),null==i||i(t.element)))},e=>{throw t.in||r(!0),e})}}),l=bC(o,kC(t));return s&&!e?null:(0,cT.cloneElement)(t,{ref:l})}function kR(t,e,i){return t?(0,MS.jsx)(_R,Object.assign({},i,{component:t})):e?(0,MS.jsx)(yR,Object.assign({},i,{transition:e})):(0,MS.jsx)(pR,Object.assign({},i))}const vR=cT.forwardRef((t,e)=>{const{flip:i,offset:n,placement:a,containerPadding:s,popperConfig:r={},transition:o,runTransition:l}=t,[u,h]=xC(),[c,d]=xC(),p=bC(h,e),m=lR(t.container),f=lR(t.target),[g,_]=(0,cT.useState)(!t.show),y=KL(f,u,hR({placement:a,enableEvents:!!t.show,containerPadding:s||5,flip:i,offset:n,arrowElement:c,popperConfig:r}));t.show&&g&&_(!1);const k=t.show||!g;if(function(t,e,{disabled:i,clickTrigger:n}={}){const a=e||aR;nR(t,a,{disabled:i,clickTrigger:n});const s=QL(t=>{yC(t)&&a(t)});(0,cT.useEffect)(()=>{if(i||null==t)return;const e=JL(eR(t));let n=(e.defaultView||window).event;const a=ZL(e,"keyup",t=>{t!==n?s(t):n=void 0});return()=>{a()}},[t,i,s])}(u,t.onHide,{disabled:!t.rootClose||t.rootCloseDisabled,clickTrigger:t.rootCloseEvent}),!k)return null;const{onExit:v,onExiting:x,onEnter:w,onEntering:b,onEntered:E}=t;let M=t.children(Object.assign({},y.attributes.popper,{style:y.styles.popper,ref:p}),{popper:y,placement:a,show:!!t.show,arrowProps:Object.assign({},y.attributes.arrow,{style:y.styles.arrow,ref:d})});return M=kR(o,l,{in:!!t.show,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:M,onExit:v,onExiting:x,onExited:(...e)=>{_(!0),t.onExited&&t.onExited(...e)},onEnter:w,onEntering:b,onEntered:E}),m?vC.createPortal(M,m):null});vR.displayName="Overlay";const xR=vR;function wR(t){const e=function(t){const e=(0,cT.useRef)(t);return(0,cT.useEffect)(()=>{e.current=t},[t]),e}(t);return(0,cT.useCallback)(function(...t){return e.current&&e.current(...t)},[e])}const bR=void 0!==i.g&&i.g.navigator&&"ReactNative"===i.g.navigator.product,ER="undefined"!=typeof document||bR?cT.useLayoutEffect:cT.useEffect;function MR(t,e){return t.classList?!!e&&t.classList.contains(e):-1!==(" "+(t.className.baseVal||t.className)+" ").indexOf(" "+e+" ")}const TR=cT.forwardRef(({bsPrefix:t,placement:e="right",className:i,style:n,children:a,arrowProps:s,hasDoneInitialMeasure:r,popper:o,show:l,...u},h)=>{t=RS(t,"tooltip");const c=AS(),[d]=(null==e?void 0:e.split("-"))||[],p=XS(d,c);let m=n;return l&&!r&&(m={...n,...qS(null==o?void 0:o.strategy)}),(0,MS.jsxs)("div",{ref:h,style:m,role:"tooltip","x-placement":d,className:ES()(i,t,`bs-tooltip-${p}`),...u,children:[(0,MS.jsx)("div",{className:"tooltip-arrow",...s}),(0,MS.jsx)("div",{className:`${t}-inner`,children:a})]})});TR.displayName="Tooltip";const SR=Object.assign(TR,{TOOLTIP_OFFSET:[0,6]});function CR(t,e){return CR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},CR(t,e)}const LR=cT.createContext(null);var RR="unmounted",IR="exited",PR="entering",AR="entered",jR="exiting",OR=function(t){function e(e,i){var n;n=t.call(this,e,i)||this;var a,s=i&&!i.isMounting?e.enter:e.appear;return n.appearStatus=null,e.in?s?(a=IR,n.appearStatus=PR):a=AR:a=e.unmountOnExit||e.mountOnEnter?RR:IR,n.state={status:a},n.nextCallback=null,n}var i,n;n=t,(i=e).prototype=Object.create(n.prototype),i.prototype.constructor=i,CR(i,n),e.getDerivedStateFromProps=function(t,e){return t.in&&e.status===RR?{status:IR}:null};var a=e.prototype;return a.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},a.componentDidUpdate=function(t){var e=null;if(t!==this.props){var i=this.state.status;this.props.in?i!==PR&&i!==AR&&(e=PR):i!==PR&&i!==AR||(e=jR)}this.updateStatus(!1,e)},a.componentWillUnmount=function(){this.cancelNextCallback()},a.getTimeouts=function(){var t,e,i,n=this.props.timeout;return t=e=i=n,null!=n&&"number"!=typeof n&&(t=n.exit,e=n.enter,i=void 0!==n.appear?n.appear:e),{exit:t,enter:e,appear:i}},a.updateStatus=function(t,e){if(void 0===t&&(t=!1),null!==e)if(this.cancelNextCallback(),e===PR){if(this.props.unmountOnExit||this.props.mountOnEnter){var i=this.props.nodeRef?this.props.nodeRef.current:vC.findDOMNode(this);i&&function(t){t.scrollTop}(i)}this.performEnter(t)}else this.performExit();else this.props.unmountOnExit&&this.state.status===IR&&this.setState({status:RR})},a.performEnter=function(t){var e=this,i=this.props.enter,n=this.context?this.context.isMounting:t,a=this.props.nodeRef?[n]:[vC.findDOMNode(this),n],s=a[0],r=a[1],o=this.getTimeouts(),l=n?o.appear:o.enter;t||i?(this.props.onEnter(s,r),this.safeSetState({status:PR},function(){e.props.onEntering(s,r),e.onTransitionEnd(l,function(){e.safeSetState({status:AR},function(){e.props.onEntered(s,r)})})})):this.safeSetState({status:AR},function(){e.props.onEntered(s)})},a.performExit=function(){var t=this,e=this.props.exit,i=this.getTimeouts(),n=this.props.nodeRef?void 0:vC.findDOMNode(this);e?(this.props.onExit(n),this.safeSetState({status:jR},function(){t.props.onExiting(n),t.onTransitionEnd(i.exit,function(){t.safeSetState({status:IR},function(){t.props.onExited(n)})})})):this.safeSetState({status:IR},function(){t.props.onExited(n)})},a.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},a.safeSetState=function(t,e){e=this.setNextCallback(e),this.setState(t,e)},a.setNextCallback=function(t){var e=this,i=!0;return this.nextCallback=function(n){i&&(i=!1,e.nextCallback=null,t(n))},this.nextCallback.cancel=function(){i=!1},this.nextCallback},a.onTransitionEnd=function(t,e){this.setNextCallback(e);var i=this.props.nodeRef?this.props.nodeRef.current:vC.findDOMNode(this),n=null==t&&!this.props.addEndListener;if(i&&!n){if(this.props.addEndListener){var a=this.props.nodeRef?[this.nextCallback]:[i,this.nextCallback],s=a[0],r=a[1];this.props.addEndListener(s,r)}null!=t&&setTimeout(this.nextCallback,t)}else setTimeout(this.nextCallback,0)},a.render=function(){var t=this.state.status;if(t===RR)return null;var e=this.props,i=e.children,n=(e.in,e.mountOnEnter,e.unmountOnExit,e.appear,e.enter,e.exit,e.timeout,e.addEndListener,e.onEnter,e.onEntering,e.onEntered,e.onExit,e.onExiting,e.onExited,e.nodeRef,cC(e,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return cT.createElement(LR.Provider,{value:null},"function"==typeof i?i(t,n):cT.cloneElement(cT.Children.only(i),n))},e}(cT.Component);function FR(){}OR.contextType=LR,OR.propTypes={},OR.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:FR,onEntering:FR,onEntered:FR,onExit:FR,onExiting:FR,onExited:FR},OR.UNMOUNTED=RR,OR.EXITED=IR,OR.ENTERING=PR,OR.ENTERED=AR,OR.EXITING=jR;const NR=OR;var GR=/([A-Z])/g,DR=/^ms-/;function WR(t){return function(t){return t.replace(GR,"-$1").toLowerCase()}(t).replace(DR,"-ms-")}var HR=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;const UR=function(t,e){var i="",n="";if("string"==typeof e)return t.style.getPropertyValue(WR(e))||function(t,e){return function(t){var e=JL(t);return e&&e.defaultView||window}(t).getComputedStyle(t,e)}(t).getPropertyValue(WR(e));Object.keys(e).forEach(function(a){var s=e[a];s||0===s?function(t){return!(!t||!HR.test(t))}(a)?n+=a+"("+s+") ":i+=WR(a)+": "+s+";":t.style.removeProperty(WR(a))}),n&&(i+="transform: "+n+";"),t.style.cssText+=";"+i};function BR(t,e,i,n){var a,s;null==i&&(s=-1===(a=UR(t,"transitionDuration")||"").indexOf("ms")?1e3:1,i=parseFloat(a)*s||0);var r=function(t,e,i){void 0===i&&(i=5);var n=!1,a=setTimeout(function(){n||function(t,e,i,n){if(void 0===i&&(i=!1),void 0===n&&(n=!0),t){var a=document.createEvent("HTMLEvents");a.initEvent("transitionend",i,n),t.dispatchEvent(a)}}(t,0,!0)},e+i),s=ZL(t,"transitionend",function(){n=!0},{once:!0});return function(){clearTimeout(a),s()}}(t,i,n),o=ZL(t,"transitionend",e);return function(){r(),o()}}function VR(t,e){const i=UR(t,e)||"",n=-1===i.indexOf("ms")?1e3:1;return parseFloat(i)*n}function KR(t,e){const i=VR(t,"transitionDuration"),n=VR(t,"transitionDelay"),a=BR(t,i=>{i.target===t&&(a(),e(i))},i+n)}function zR(t){t.offsetHeight}function $R(t){return t&&"setState"in t?vC.findDOMNode(t):null!=t?t:null}const YR=cT.forwardRef(({onEnter:t,onEntering:e,onEntered:i,onExit:n,onExiting:a,onExited:s,addEndListener:r,children:o,childRef:l,...u},h)=>{const c=(0,cT.useRef)(null),d=_C(c,l),p=t=>{d($R(t))},m=t=>e=>{t&&c.current&&t(c.current,e)},f=(0,cT.useCallback)(m(t),[t]),g=(0,cT.useCallback)(m(e),[e]),_=(0,cT.useCallback)(m(i),[i]),y=(0,cT.useCallback)(m(n),[n]),k=(0,cT.useCallback)(m(a),[a]),v=(0,cT.useCallback)(m(s),[s]),x=(0,cT.useCallback)(m(r),[r]);return(0,MS.jsx)(NR,{ref:h,...u,onEnter:f,onEntered:_,onEntering:g,onExit:y,onExited:v,onExiting:k,addEndListener:x,nodeRef:c,children:"function"==typeof o?(t,e)=>o(t,{...e,ref:p}):cT.cloneElement(o,{ref:p})})});YR.displayName="TransitionWrapper";const XR=YR,qR={[PR]:"show",[AR]:"show"},ZR=cT.forwardRef(({className:t,children:e,transitionClasses:i={},onEnter:n,...a},s)=>{const r={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1,...a},o=(0,cT.useCallback)((t,e)=>{zR(t),null==n||n(t,e)},[n]);return(0,MS.jsx)(XR,{ref:s,addEndListener:KR,...r,onEnter:o,childRef:kC(e),children:(n,a)=>cT.cloneElement(e,{...a,className:ES()("fade",t,e.props.className,qR[n],i[n])})})});ZR.displayName="Fade";const JR=ZR,QR=cT.forwardRef(({children:t,transition:e=JR,popperConfig:i={},rootClose:n=!1,placement:a="top",show:s=!1,...r},o)=>{const l=(0,cT.useRef)({}),[u,h]=(0,cT.useState)(null),[c,d]=function(t){const e=(0,cT.useRef)(null),i=RS(void 0,"popover"),n=RS(void 0,"tooltip"),a=(0,cT.useMemo)(()=>({name:"offset",options:{offset:()=>{if(t)return t;if(e.current){if(MR(e.current,i))return JS.POPPER_OFFSET;if(MR(e.current,n))return SR.TOOLTIP_OFFSET}return[0,0]}}}),[t,i,n]);return[e,[a]]}(r.offset),p=_C(o,c),m=!0===e?JR:e||void 0,f=wR(t=>{h(t),null==i||null==i.onFirstUpdate||i.onFirstUpdate(t)});return ER(()=>{u&&r.target&&(null==l.current.scheduleUpdate||l.current.scheduleUpdate())},[u,r.target]),(0,cT.useEffect)(()=>{s||h(null)},[s]),(0,MS.jsx)(xR,{...r,ref:p,popperConfig:{...i,modifiers:d.concat(i.modifiers||[]),onFirstUpdate:f},transition:m,rootClose:n,placement:a,show:s,children:(n,{arrowProps:a,popper:s,show:r})=>{var o;!function(t,e){const{ref:i}=t,{ref:n}=e;t.ref=i.__wrapped||(i.__wrapped=t=>i($R(t))),e.ref=n.__wrapped||(n.__wrapped=t=>n($R(t)))}(n,a);const h=null==s?void 0:s.placement,c=Object.assign(l.current,{state:null==s?void 0:s.state,scheduleUpdate:null==s?void 0:s.update,placement:h,outOfBoundaries:(null==s||null==(o=s.state)||null==(o=o.modifiersData.hide)?void 0:o.isReferenceHidden)||!1,strategy:i.strategy}),d=!!u;return"function"==typeof t?t({...n,placement:h,show:r,...!e&&r&&{className:"show"},popper:c,arrowProps:a,hasDoneInitialMeasure:d}):cT.cloneElement(t,{...n,placement:h,arrowProps:a,popper:c,hasDoneInitialMeasure:d,className:ES()(t.props.className,!e&&r&&"show"),style:{...t.props.style,...n.style}})}})});QR.displayName="Overlay";const tI=QR;function eI(t,e,i){const[n]=e,a=n.currentTarget,s=n.relatedTarget||n.nativeEvent[i];s&&s===a||iC(a,s)||t(...e)}aC().oneOf(["click","hover","focus"]);const iI=({trigger:t=["hover","focus"],overlay:e,children:i,popperConfig:n={},show:a,defaultShow:s=!1,onToggle:r,delay:o,placement:l,flip:u=l&&-1!==l.indexOf("auto"),...h})=>{const c=(0,cT.useRef)(null),d=_C(c,kC(i)),p=oC(),m=(0,cT.useRef)(""),[f,g]=mC(a,s,r),_=function(t){return t&&"object"==typeof t?t:{show:t,hide:t}}(o),{onFocus:y,onBlur:k,onClick:v}="function"!=typeof i?cT.Children.only(i).props:{},x=(0,cT.useCallback)(()=>{p.clear(),m.current="show",_.show?p.set(()=>{"show"===m.current&&g(!0)},_.show):g(!0)},[_.show,g,p]),w=(0,cT.useCallback)(()=>{p.clear(),m.current="hide",_.hide?p.set(()=>{"hide"===m.current&&g(!1)},_.hide):g(!1)},[_.hide,g,p]),b=(0,cT.useCallback)((...t)=>{x(),null==y||y(...t)},[x,y]),E=(0,cT.useCallback)((...t)=>{w(),null==k||k(...t)},[w,k]),M=(0,cT.useCallback)((...t)=>{g(!f),null==v||v(...t)},[v,g,f]),T=(0,cT.useCallback)((...t)=>{eI(x,t,"fromElement")},[x]),S=(0,cT.useCallback)((...t)=>{eI(w,t,"toElement")},[w]),C=null==t?[]:[].concat(t),L={ref:t=>{d($R(t))}};return-1!==C.indexOf("click")&&(L.onClick=M),-1!==C.indexOf("focus")&&(L.onFocus=b,L.onBlur=E),-1!==C.indexOf("hover")&&(L.onMouseOver=T,L.onMouseOut=S),(0,MS.jsxs)(MS.Fragment,{children:["function"==typeof i?i(L):(0,cT.cloneElement)(i,L),(0,MS.jsx)(tI,{...h,show:f,onHide:w,flip:u,placement:l,popperConfig:n,target:c.current,children:e})]})},nI=()=>{const{t}=JT(),e=mS(),i=_S(t=>t.linkedFeature),[n,a]=(0,cT.useState)(!1);if(!i)return;const{layer:s,name:r,coordinates:o}=i,l=cT.createElement(JS,{id:"linked-feature-popover"},cT.createElement(JS.Header,{as:"h3"},t("linkedFeature.header")),cT.createElement(JS.Body,null,s&&r&&cT.createElement(eC,{gap:1,className:"mb-2"},cT.createElement("div",null,r),cT.createElement("div",null,cT.createElement("img",{className:"feature-icon",src:vw(s)[0]}),cT.createElement("span",null,((t,e)=>{switch(e){case Up.Muinaisjaannokset_piste:case Up.Muinaisjaannokset_alue:case Up.Muu_kulttuuriperintokohde_piste:case Up.Muu_kulttuuriperintokohde_alue:case Up.Lytpaikka_piste:case Up.Lytpaikka_alue:case Up.Havaintokohde_piste:case Up.Havaintokohde_alue:case Up.Luonnonmuodostuma_piste:case Up.Luonnonmuodostuma_alue:case Up.Mahdollinen_muinaisjnns_piste:case Up.Mahdollinen_muinaisjnns_alue:case Up.Muu_kohde_piste:case Up.Muu_kohde_alue:case Up.PoistettuKiinteMuijaisjnnsPiste:case Up.PoistettuKiinteMuijaisjnnsAlue:case Up.Alakohde_piste:return t("data.register.name.Muinaisjnnsrekisteri");case Up.RKY_alue:case Up.RKY_viiva:case Up.RKY_piste:return t("data.register.name.Valtakunnallisesti merkittvt rakennetut kulttuuriympristt");case Up.Maailmanperinto_alue:case Up.Maailmanperinto_piste:return t("data.register.name.Maailmanperintkohteet");case Up.Suojellut_rakennukset_alue:case Up.Suojellut_rakennukset_piste:return t("data.register.name.Rakennusperintrekisteri");case Up.VARK_pisteet:case Up.VARK_alueet:return t("data.register.name.vark");case Bp.Fornminnen:return t("data.register.name.Ahvenanmaan muinaisjnnsrekisteri");case Bp.MaritimaFornminnen:return t("data.register.name.Ahvenanmaan merellinen kulttuuriperintrekisteri");case Vp.ModelLayer:return t("data.register.name.3Dmodels");case Kp.MaisemanMuisti:return t("data.register.name.maisemanMuisti");case $p.Maalinnoitus_kohteet:case $p.Maalinnoitus_rajaukset:case $p.Maalinnoitus_karttatekstit:case $p.Maalinnoitus_yksikot:return t("data.register.name.maalinnoitus");case Yp.Viabundus:return t("data.register.name.viabundus")}})(t,s)))),cT.createElement("div",{className:"d-grid gap-2"},cT.createElement(US,{variant:"primary",size:"sm",onClick:()=>e({type:Dm.CENTER_MAP_TO_LINKED_FEATURE})},t("linkedFeature.showOnMap")),cT.createElement(US,{variant:"primary",size:"sm",onClick:()=>{e({type:Dm.IDENTIFY_MAP_FEATURES_ON_COORDINATE,requestTimestamp:Date.now(),coordinates:o}),a(!1)}},t("linkedFeature.showFeatureDetails")),cT.createElement(US,{variant:"danger",size:"sm",onClick:()=>e({type:Dm.SET_LINKED_FEATURE,linkedFeature:void 0})},t("linkedFeature.remove")))));return cT.createElement("div",{id:"map-button-linked-feature",className:"map-button"},cT.createElement(iI,{trigger:"click",placement:"right",overlay:l,show:n,onToggle:t=>a(t)},cT.createElement(US,{variant:"warning",size:"sm",title:t("linkedFeature.header")??void 0},cT.createElement("i",{className:"bi bi-geo-alt-fill","aria-hidden":"true"}))))},aI={type:aC().string,tooltip:aC().bool,as:aC().elementType},sI=cT.forwardRef(({as:t="div",className:e,type:i="valid",tooltip:n=!1,...a},s)=>(0,MS.jsx)(t,{...a,ref:s,className:ES()(e,`${i}-${n?"tooltip":"feedback"}`)}));sI.displayName="Feedback",sI.propTypes=aI;const rI=sI,oI=cT.createContext({}),lI=cT.forwardRef(({id:t,bsPrefix:e,className:i,type:n="checkbox",isValid:a=!1,isInvalid:s=!1,as:r="input",...o},l)=>{const{controlId:u}=(0,cT.useContext)(oI);return e=RS(e,"form-check-input"),(0,MS.jsx)(r,{...o,ref:l,type:n,id:t||u,className:ES()(i,e,a&&"is-valid",s&&"is-invalid")})});lI.displayName="FormCheckInput";const uI=lI,hI=cT.forwardRef(({bsPrefix:t,className:e,htmlFor:i,...n},a)=>{const{controlId:s}=(0,cT.useContext)(oI);return t=RS(t,"form-check-label"),(0,MS.jsx)("label",{...n,ref:a,htmlFor:i||s,className:ES()(e,t)})});hI.displayName="FormCheckLabel";const cI=hI,dI=cT.forwardRef(({id:t,bsPrefix:e,bsSwitchPrefix:i,inline:n=!1,reverse:a=!1,disabled:s=!1,isValid:r=!1,isInvalid:o=!1,feedbackTooltip:l=!1,feedback:u,feedbackType:h,className:c,style:d,title:p="",type:m="checkbox",label:f,children:g,as:_="input",...y},k)=>{e=RS(e,"form-check"),i=RS(i,"form-switch");const{controlId:v}=(0,cT.useContext)(oI),x=(0,cT.useMemo)(()=>({controlId:t||v}),[v,t]),w=!g&&null!=f&&!1!==f||function(t,e){return cT.Children.toArray(t).some(t=>cT.isValidElement(t)&&t.type===e)}(g,cI),b=(0,MS.jsx)(uI,{...y,type:"switch"===m?"checkbox":m,ref:k,isValid:r,isInvalid:o,disabled:s,as:_});return(0,MS.jsx)(oI.Provider,{value:x,children:(0,MS.jsx)("div",{style:d,className:ES()(c,w&&e,n&&`${e}-inline`,a&&`${e}-reverse`,"switch"===m&&i),children:g||(0,MS.jsxs)(MS.Fragment,{children:[b,w&&(0,MS.jsx)(cI,{title:p,children:f}),u&&(0,MS.jsx)(rI,{type:h,tooltip:l,children:u})]})})})});dI.displayName="FormCheck";const pI=Object.assign(dI,{Input:uI,Label:cI}),mI=cT.forwardRef(({bsPrefix:t,type:e,size:i,htmlSize:n,id:a,className:s,isValid:r=!1,isInvalid:o=!1,plaintext:l,readOnly:u,as:h="input",...c},d)=>{const{controlId:p}=(0,cT.useContext)(oI);return t=RS(t,"form-control"),(0,MS.jsx)(h,{...c,type:e,size:n,ref:d,readOnly:u,id:a||p,className:ES()(s,l?`${t}-plaintext`:t,i&&`${t}-${i}`,"color"===e&&`${t}-color`,r&&"is-valid",o&&"is-invalid")})});mI.displayName="FormControl";const fI=Object.assign(mI,{Feedback:rI}),gI=cT.forwardRef(({className:t,bsPrefix:e,as:i="div",...n},a)=>(e=RS(e,"form-floating"),(0,MS.jsx)(i,{ref:a,className:ES()(t,e),...n})));gI.displayName="FormFloating";const _I=gI,yI=cT.forwardRef(({controlId:t,as:e="div",...i},n)=>{const a=(0,cT.useMemo)(()=>({controlId:t}),[t]);return(0,MS.jsx)(oI.Provider,{value:a,children:(0,MS.jsx)(e,{...i,ref:n})})});yI.displayName="FormGroup";const kI=yI,vI=cT.forwardRef((t,e)=>{const[{className:i,...n},{as:a="div",bsPrefix:s,spans:r}]=function({as:t,bsPrefix:e,className:i,...n}){e=RS(e,"col");const a=IS(),s=PS(),r=[],o=[];return a.forEach(t=>{const i=n[t];let a,l,u;delete n[t],"object"==typeof i&&null!=i?({span:a,offset:l,order:u}=i):a=i;const h=t!==s?`-${t}`:"";a&&r.push(!0===a?`${e}${h}`:`${e}${h}-${a}`),null!=u&&o.push(`order${h}-${u}`),null!=l&&o.push(`offset${h}-${l}`)}),[{...n,className:ES()(i,...r,...o)},{as:t,bsPrefix:e,spans:r}]}(t);return(0,MS.jsx)(a,{...n,ref:e,className:ES()(i,!r.length&&s)})});vI.displayName="Col";const xI=vI,wI=cT.forwardRef(({as:t="label",bsPrefix:e,column:i=!1,visuallyHidden:n=!1,className:a,htmlFor:s,...r},o)=>{const{controlId:l}=(0,cT.useContext)(oI);e=RS(e,"form-label");let u="col-form-label";"string"==typeof i&&(u=`${u} ${u}-${i}`);const h=ES()(a,e,n&&"visually-hidden",i&&u);return s=s||l,i?(0,MS.jsx)(xI,{ref:o,as:"label",className:h,htmlFor:s,...r}):(0,MS.jsx)(t,{ref:o,className:h,htmlFor:s,...r})});wI.displayName="FormLabel";const bI=wI,EI=cT.forwardRef(({bsPrefix:t,className:e,id:i,...n},a)=>{const{controlId:s}=(0,cT.useContext)(oI);return t=RS(t,"form-range"),(0,MS.jsx)("input",{...n,type:"range",ref:a,className:ES()(e,t),id:i||s})});EI.displayName="FormRange";const MI=EI,TI=cT.forwardRef(({bsPrefix:t,size:e,htmlSize:i,className:n,isValid:a=!1,isInvalid:s=!1,id:r,...o},l)=>{const{controlId:u}=(0,cT.useContext)(oI);return t=RS(t,"form-select"),(0,MS.jsx)("select",{...o,size:i,ref:l,className:ES()(n,t,e&&`${t}-${e}`,a&&"is-valid",s&&"is-invalid"),id:r||u})});TI.displayName="FormSelect";const SI=TI,CI=cT.forwardRef(({bsPrefix:t,className:e,as:i="small",muted:n,...a},s)=>(t=RS(t,"form-text"),(0,MS.jsx)(i,{...a,ref:s,className:ES()(e,t,n&&"text-muted")})));CI.displayName="FormText";const LI=CI,RI=cT.forwardRef((t,e)=>(0,MS.jsx)(pI,{...t,ref:e,type:"switch"}));RI.displayName="Switch";const II=Object.assign(RI,{Input:pI.Input,Label:pI.Label}),PI=cT.forwardRef(({bsPrefix:t,className:e,children:i,controlId:n,label:a,...s},r)=>(t=RS(t,"form-floating"),(0,MS.jsxs)(kI,{ref:r,className:ES()(e,t),controlId:n,...s,children:[i,(0,MS.jsx)("label",{htmlFor:n,children:a})]})));PI.displayName="FloatingLabel";const AI=PI,jI={_ref:aC().any,validated:aC().bool,as:aC().elementType},OI=cT.forwardRef(({className:t,validated:e,as:i="form",...n},a)=>(0,MS.jsx)(i,{...n,ref:a,className:ES()(t,e&&"was-validated")}));OI.displayName="Form",OI.propTypes=jI;const FI=Object.assign(OI,{Group:kI,Control:fI,Floating:_I,Check:pI,Switch:II,Label:bI,Text:LI,Range:MI,Select:SI,FloatingLabel:AI}),NI=Object.values(Dp),GI=()=>{const{t,i18n:e}=JT(),i=mS(),{selectedLayer:n,enabled:a}=_S(t=>t.maannousuInfo),s=(0,cT.useMemo)(()=>NI.map(e=>{const i=parseInt(e),n=i>=0?`${i} ${t("common.Jlkeen ajanlaskun alun")}`:`${-i} ${t("common.Ennen ajanlaskun alkua")}`;return cT.createElement("option",{key:e,value:e},n)}),[e.language]),r=(0,cT.useCallback)(()=>NI.indexOf(n)-1>=0,[n]),o=(0,cT.useCallback)(()=>NI.indexOf(n)+1<NI.length,[n]),l=(0,cT.useCallback)(()=>{if(r()){const t=NI.indexOf(n)-1;i({type:Dm.SELECT_VISIBLE_LAYERS,layerGroup:Fp.MaannousuInfo,layer:NI[t]})}},[i,n]),u=(0,cT.useCallback)(t=>{const e=t.target.value;NI.includes(e)&&i({type:Dm.SELECT_VISIBLE_LAYERS,layerGroup:Fp.MaannousuInfo,layer:e})},[i,n]),h=(0,cT.useCallback)(()=>{if(o()){const t=NI.indexOf(n)+1;i({type:Dm.SELECT_VISIBLE_LAYERS,layerGroup:Fp.MaannousuInfo,layer:NI[t]})}},[i,n]);return a?cT.createElement("div",{id:"maannnousu-info-year-buttons",className:"map-button"},cT.createElement(US,{variant:"primary",size:"sm",title:t("common.button.maannousuInfo.Edellinen vuosi"),onClick:l,disabled:!r()},cT.createElement("i",{className:"bi bi-caret-left-fill","aria-hidden":"true"})),cT.createElement(FI.Select,{size:"sm",value:n,onChange:u},s),cT.createElement(US,{variant:"primary",size:"sm",title:t("common.button.maannousuInfo.Seuraava vuosi"),onClick:h,disabled:!o()},cT.createElement("i",{className:"bi bi-caret-right-fill","aria-hidden":"true"}))):cT.createElement(cT.Fragment,null)},DI=()=>{const{t}=JT(),e=mS(),i=(0,cT.useCallback)(()=>{e({type:Dm.SHOW_PAGE,pageId:fM.Info})},[e]);return cT.createElement("div",{id:"map-button-info",className:"map-button"},cT.createElement(US,{variant:"primary",size:"sm",title:t("common.button.info")??void 0,onClick:i},cT.createElement("i",{className:"bi bi-info-circle","aria-hidden":"true"})))},WI=()=>{const{t}=JT(),e=mS(),i=(0,cT.useCallback)(()=>{e({type:Dm.SHOW_PAGE,pageId:fM.Search})},[e]);return cT.createElement("div",{id:"map-button-search",className:"map-button"},cT.createElement(US,{variant:"primary",size:"sm",title:t("common.button.search")??void 0,onClick:i},cT.createElement("i",{className:"bi bi-search","aria-hidden":"true"})))},HI=()=>{const{t}=JT(),e=mS(),i=(0,cT.useCallback)(()=>{e({type:Dm.SHOW_PAGE,pageId:fM.Settings})},[e]);return cT.createElement("div",{id:"map-button-settings",className:"map-button"},cT.createElement(US,{variant:"primary",size:"sm",title:t("common.button.settings")??void 0,onClick:i},cT.createElement("i",{className:"bi bi-gear","aria-hidden":"true"})))},UI=t=>cT.forwardRef((e,i)=>(0,MS.jsx)("div",{...e,ref:i,className:ES()(e.className,t)})),BI=UI("h4");BI.displayName="DivStyledAsH4";const VI=cT.forwardRef(({className:t,bsPrefix:e,as:i=BI,...n},a)=>(e=RS(e,"alert-heading"),(0,MS.jsx)(i,{ref:a,className:ES()(t,e),...n})));VI.displayName="AlertHeading";const KI=VI;function zI(t){const e=(0,cT.useRef)(null);return(0,cT.useEffect)(()=>{e.current=t}),e.current}new WeakMap;const $I=["onKeyDown"],YI=cT.forwardRef((t,e)=>{let{onKeyDown:i}=t,n=function(t,e){if(null==t)return{};var i={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;i[n]=t[n]}return i}(t,$I);const[a]=GS(Object.assign({tagName:"a"},n)),s=QL(t=>{a.onKeyDown(t),null==i||i(t)});return(r=n.href)&&"#"!==r.trim()&&"button"!==n.role?(0,MS.jsx)("a",Object.assign({ref:e},n,{onKeyDown:i})):(0,MS.jsx)("a",Object.assign({ref:e},n,a,{onKeyDown:s}));var r});YI.displayName="Anchor";const XI=YI,qI=cT.forwardRef(({className:t,bsPrefix:e,as:i=XI,...n},a)=>(e=RS(e,"alert-link"),(0,MS.jsx)(i,{ref:a,className:ES()(t,e),...n})));qI.displayName="AlertLink";const ZI=qI,JI={"aria-label":aC().string,onClick:aC().func,variant:aC().oneOf(["white"])},QI=cT.forwardRef(({className:t,variant:e,"aria-label":i="Close",...n},a)=>(0,MS.jsx)("button",{ref:a,type:"button",className:ES()("btn-close",e&&`btn-close-${e}`,t),"aria-label":i,...n}));QI.displayName="CloseButton",QI.propTypes=JI;const tP=QI,eP=cT.forwardRef((t,e)=>{const{bsPrefix:i,show:n=!0,closeLabel:a="Close alert",closeVariant:s,className:r,children:o,variant:l="primary",onClose:u,dismissible:h,transition:c=JR,...d}=fC(t,{show:"onClose"}),p=RS(i,"alert"),m=wR(t=>{u&&u(!1,t)}),f=!0===c?JR:c,g=(0,MS.jsxs)("div",{role:"alert",...f?void 0:d,ref:e,className:ES()(r,p,l&&`${p}-${l}`,h&&`${p}-dismissible`),children:[h&&(0,MS.jsx)(tP,{onClick:m,"aria-label":a,variant:s}),o]});return f?(0,MS.jsx)(f,{unmountOnExit:!0,...d,ref:void 0,in:n,children:g}):n?g:null});eP.displayName="Alert";const iP=Object.assign(eP,{Link:ZI,Heading:KI}),nP=()=>{const{enabled:t}=_S(t=>t.maannousuInfo);return t&&!fy()?cT.createElement(iP,{variant:"danger",id:"webgl-global-error-message"},cT.createElement($T,{i18nKey:"settings.maannousuInfo.webGLError"})):cT.createElement(cT.Fragment,null)},aP=()=>{const{t}=JT(),e=mS(),i=(0,cT.useCallback)(()=>e({type:Dm.ZOOM,zoomDirection:"in"}),[e]);return cT.createElement("div",{id:"map-button-zoom-in",className:"map-button"},cT.createElement(US,{variant:"primary",size:"sm",title:t("common.button.zoomIn")??void 0,onClick:i},cT.createElement("i",{className:"bi bi-zoom-in","aria-hidden":"true"})))},sP=()=>{const{t}=JT(),e=mS(),i=(0,cT.useCallback)(()=>e({type:Dm.ZOOM,zoomDirection:"out"}),[e]);return cT.createElement("div",{id:"map-button-zoom-out",className:"map-button"},cT.createElement(US,{variant:"primary",size:"sm",title:t("common.button.zoomOut")??void 0,onClick:i},cT.createElement("i",{className:"bi bi-zoom-out","aria-hidden":"true"})))},rP=function(...t){return t.filter(t=>null!=t).reduce((t,e)=>{if("function"!=typeof e)throw new Error("Invalid Argument Type, must only provide functions, undefined, or null.");return null===t?e:function(...i){t.apply(this,i),e.apply(this,i)}},null)},oP={height:["marginTop","marginBottom"],width:["marginLeft","marginRight"]};function lP(t,e){const i=e[`offset${t[0].toUpperCase()}${t.slice(1)}`],n=oP[t];return i+parseInt(UR(e,n[0]),10)+parseInt(UR(e,n[1]),10)}const uP={[IR]:"collapse",[jR]:"collapsing",[PR]:"collapsing",[AR]:"collapse show"},hP=cT.forwardRef(({onEnter:t,onEntering:e,onEntered:i,onExit:n,onExiting:a,className:s,children:r,dimension:o="height",in:l=!1,timeout:u=300,mountOnEnter:h=!1,unmountOnExit:c=!1,appear:d=!1,getDimensionValue:p=lP,...m},f)=>{const g="function"==typeof o?o():o,_=(0,cT.useMemo)(()=>rP(t=>{t.style[g]="0"},t),[g,t]),y=(0,cT.useMemo)(()=>rP(t=>{const e=`scroll${g[0].toUpperCase()}${g.slice(1)}`;t.style[g]=`${t[e]}px`},e),[g,e]),k=(0,cT.useMemo)(()=>rP(t=>{t.style[g]=null},i),[g,i]),v=(0,cT.useMemo)(()=>rP(t=>{t.style[g]=`${p(g,t)}px`,zR(t)},n),[n,p,g]),x=(0,cT.useMemo)(()=>rP(t=>{t.style[g]=null},a),[g,a]);return(0,MS.jsx)(XR,{ref:f,addEndListener:KR,...m,"aria-expanded":m.role?l:null,onEnter:_,onEntering:y,onEntered:k,onExit:v,onExiting:x,childRef:kC(r),in:l,timeout:u,mountOnEnter:h,unmountOnExit:c,appear:d,children:(t,e)=>cT.cloneElement(r,{...e,className:ES()(s,r.props.className,uP[t],"width"===g&&"collapse-horizontal")})})});hP.displayName="Collapse";const cP=hP;function dP(t,e){return Array.isArray(t)?t.includes(e):t===e}const pP=cT.createContext({});pP.displayName="AccordionContext";const mP=pP,fP=cT.forwardRef(({as:t="div",bsPrefix:e,className:i,children:n,eventKey:a,...s},r)=>{const{activeEventKey:o}=(0,cT.useContext)(mP);return e=RS(e,"accordion-collapse"),(0,MS.jsx)(cP,{ref:r,in:dP(o,a),...s,className:ES()(i,e),children:(0,MS.jsx)(t,{children:cT.Children.only(n)})})});fP.displayName="AccordionCollapse";const gP=fP,_P=cT.createContext({eventKey:""});_P.displayName="AccordionItemContext";const yP=_P,kP=cT.forwardRef(({as:t="div",bsPrefix:e,className:i,onEnter:n,onEntering:a,onEntered:s,onExit:r,onExiting:o,onExited:l,...u},h)=>{e=RS(e,"accordion-body");const{eventKey:c}=(0,cT.useContext)(yP);return(0,MS.jsx)(gP,{eventKey:c,onEnter:n,onEntering:a,onEntered:s,onExit:r,onExiting:o,onExited:l,children:(0,MS.jsx)(t,{ref:h,...u,className:ES()(i,e)})})});kP.displayName="AccordionBody";const vP=kP,xP=cT.forwardRef(({as:t="button",bsPrefix:e,className:i,onClick:n,...a},s)=>{e=RS(e,"accordion-button");const{eventKey:r}=(0,cT.useContext)(yP),o=function(t,e){const{activeEventKey:i,onSelect:n,alwaysOpen:a}=(0,cT.useContext)(mP);return s=>{let r=t===i?null:t;a&&(r=Array.isArray(i)?i.includes(t)?i.filter(e=>e!==t):[...i,t]:[t]),null==n||n(r,s),null==e||e(s)}}(r,n),{activeEventKey:l}=(0,cT.useContext)(mP);return"button"===t&&(a.type="button"),(0,MS.jsx)(t,{ref:s,onClick:o,...a,"aria-expanded":Array.isArray(l)?l.includes(r):r===l,className:ES()(i,e,!dP(l,r)&&"collapsed")})});xP.displayName="AccordionButton";const wP=xP,bP=cT.forwardRef(({as:t="h2","aria-controls":e,bsPrefix:i,className:n,children:a,onClick:s,...r},o)=>(i=RS(i,"accordion-header"),(0,MS.jsx)(t,{ref:o,...r,className:ES()(n,i),children:(0,MS.jsx)(wP,{onClick:s,"aria-controls":e,children:a})})));bP.displayName="AccordionHeader";const EP=bP,MP=cT.forwardRef(({as:t="div",bsPrefix:e,className:i,eventKey:n,...a},s)=>{e=RS(e,"accordion-item");const r=(0,cT.useMemo)(()=>({eventKey:n}),[n]);return(0,MS.jsx)(yP.Provider,{value:r,children:(0,MS.jsx)(t,{ref:s,...a,className:ES()(i,e)})})});MP.displayName="AccordionItem";const TP=MP,SP=cT.forwardRef((t,e)=>{const{as:i="div",activeKey:n,bsPrefix:a,className:s,onSelect:r,flush:o,alwaysOpen:l,...u}=fC(t,{activeKey:"onSelect"}),h=RS(a,"accordion"),c=(0,cT.useMemo)(()=>({activeEventKey:n,onSelect:r,alwaysOpen:l}),[n,r,l]);return(0,MS.jsx)(mP.Provider,{value:c,children:(0,MS.jsx)(i,{ref:e,...u,className:ES()(s,h,o&&`${h}-flush`)})})});SP.displayName="Accordion";const CP=Object.assign(SP,{Button:wP,Collapse:gP,Item:TP,Header:EP,Body:vP}),LP=t=>{switch(t){case Qp.alustenHylyt:case Qp.kulkuvylt:return"https://akp.nba.fi/wiki;luokka;liikenne_ja_tiedonkulku";case Qp.asuinpaikat:return"https://akp.nba.fi/wiki;luokka;asuminen_ja_oleskelu";case Qp.hautapaikat:return"https://akp.nba.fi/wiki;luokka;hautaaminen";case Qp.kirkkorakenteet:case Qp.kulttiJaTarinapaikat:return"https://akp.nba.fi/wiki;luokka;uskonnon_harjoittaminen";case Qp.puolustusvarustukset:return"https://akp.nba.fi/wiki;luokka;puolustus_ja_sodank%C3%A4ynti";case Qp.raakaAineenHankintapaikat:case Qp.tyJaValmistuspaikat:return"https://akp.nba.fi/wiki;luokka;elinkeinot";case Qp.tapahtumapaikat:case Qp.taideMuistomerkit:return"https://akp.nba.fi/muut";case Qp.teollisuuskohteet:return"https://akp.nba.fi/wiki;luokka;teollisuus";case Qp.kivirakenteet:case Qp.luonnonmuodostumat:case Qp.lytpaikat:case Qp.puurakenteet:case Qp.maarakenteet:case Qp.muinaisjnnsryhmt:case Qp.eiMritelty:default:return}},RP=t=>{switch(t){case"aallonmurtajat":case"kiinnitysrenkaat":case"laiturit":case"painolastipaikat":case"satamat":case"valkamat":return"https://akp.nba.fi/wiki;satama";case"aidat":case"ammusvarastot":case"ei mritelty":case"hautakammiot":case"hiekanottokuopat":case"hirsivarustukset":case"hospitaalit ja sairaalat":case"irtolytpaikat":case"joukkohaudat":case"kaivannot":case"keittokuopat":case"keramiikkatehtaat":case"kivimuurit":case"kivipydt":case"kivivallit":case"kivivarustukset":case"kummut":case"kuopat":case"kuparinsulattamot":case"ksittelypaikat":case"ktkt":case"latomukset":case"linnustuspaikat":case"luotsi- ja tulliasemat":case"maavallit":case"painanteet":case"pirunpellot":case"portaat":case"potaskauunit":case"rajamerkit, puu":case"rantakivikot":case"savenottokuopat":case"savupiiput":case"sirpalekivikasat":case"sudenkuopat":case"terva- ja trpttitehtaat":case"terveyslhteet":case"tornit":case"tulipeskkeet":case"uittolaitteet":case"vallit":case"viljelmt":case"virkatalot":case"yksinistalot":default:return;case"asumuspainanteet":return"https://akp.nba.fi/wiki;asumuspainanne";case"ersijat":return"https://akp.nba.fi/wiki;er%C3%A4sija";case"haaksirikkopaikat":case"hylyt (metalli)":case"hylyt (puu)":case"ruuhet":return"https://akp.nba.fi/wiki;hylky";case"hakkaukset":case"kaiverrukset":case"kalliopiirrokset":case"maanmittauspisteet":return"https://akp.nba.fi/wiki;kalliohakkaus";case"hangakset":case"pyyntikuopat":return"https://akp.nba.fi/wiki;pyyntikuoppa";case"hautakummut":return"https://akp.nba.fi/wiki;hautakumpu";case"hautarykkit":case"rykkit":return"https://akp.nba.fi/wiki;hautar%C3%B6ykki%C3%B6";case"hautasaaret":case"keshaudat":return"https://akp.nba.fi/wiki;hautasaari";case"hautausmaat":return"https://akp.nba.fi/wiki;hautausmaa";case"hiilimiilut":return"https://akp.nba.fi/wiki;hiilimiilu";case"hyrysahat":return"https://akp.nba.fi/wiki;h%C3%B6yrysaha";case"jatulintarhat":return"https://akp.nba.fi/wiki;jatulintarha";case"jtinkirkot":return"https://akp.nba.fi/wiki;j%C3%A4tinkirkko";case"kaivokset":return"https://akp.nba.fi/wiki;kaivos";case"kaivot":return"https://akp.nba.fi/wiki;kaivo";case"kalastuspaikat":return"https://akp.nba.fi/wiki;kalastuspaikka";case"kalkkiuunit":return"https://akp.nba.fi/wiki;kalkkiuuni";case"kalliomaalaukset":return"https://akp.nba.fi/wiki;kalliomaalaus";case"kanavat":case"veneenvetopaikat":return"https://akp.nba.fi/wiki;kanava";case"kapulatiet":case"kestikievarit":case"pitkospuut":case"tienpohjat":case"tykkitiet":case"virstanpylvt":return"https://akp.nba.fi/wiki;tie";case"karsikkopaikat":case"merkkikivet":case"merkkipuut":case"muistopaikat":case"ristikivet":return"https://akp.nba.fi/wiki;karsikko";case"kartanot":return"https://akp.nba.fi/wiki;kartano";case"kaskirykkit":case"viljelyrykkit":return"https://akp.nba.fi/wiki;viljelyr%C3%B6ykki%C3%B6";case"kaupungit":return"https://akp.nba.fi/wiki;kaupunki";case"kellarit":return"https://akp.nba.fi/wiki;kellari";case"kellotapulinpaikat":case"kirkonpaikat":case"kirkonrauniot":case"tsasounanpaikat":return"https://akp.nba.fi/wiki;kirkko";case"kentt (gieddi)":return"https://akp.nba.fi/wiki;kentt%C3%A4";case"kirkkohaudat":return"https://akp.nba.fi/wiki;kirkkohauta";case"kirkkomaat":return"https://akp.nba.fi/wiki;kirkkomaa";case"kiukaat":return"https://akp.nba.fi/wiki;kiuas";case"kiviaidat":return"https://akp.nba.fi/wiki;kiviaita";case"kivilatomukset":return"https://akp.nba.fi/wiki;hautalatomus";case"kivilinnat":case"linnamalmit":case"linnat":return"https://akp.nba.fi/wiki;keskiaikainen-linna";case"kodanpohjat":return"https://akp.nba.fi/wiki;kotasija";case"kompassiruusut":return"https://akp.nba.fi/wiki;kivikompassi";case"kullanhuuhdonnan jnnkset":return"https://akp.nba.fi/wiki;kullanhuuhdontapaikka";case"kummelit":case"majakat":case"merimerkit":return"https://akp.nba.fi/wiki;merimerkki";case"kuninkaankartanot":return"https://akp.nba.fi/wiki;kuninkaankartano";case"kuppikivet":return"https://akp.nba.fi/wiki;kuppikivi";case"kylnpaikat":return"https://akp.nba.fi/wiki;kyl%C3%A4npaikka";case"krjpaikat":return"https://akp.nba.fi/wiki;k%C3%A4r%C3%A4j%C3%A4ympyr%C3%A4";case"laivalatomukset":return"https://akp.nba.fi/wiki;laivalatomus";case"laivanrakennuspaikat":case"telakat":return"https://akp.nba.fi/wiki;laivanrakennuspaikka";case"lapinpadot":return"https://akp.nba.fi/wiki;kalastusrakenne";case"lapinrauniot":return"https://akp.nba.fi/wiki;lapinraunio";case"lasitehtaat":return"https://akp.nba.fi/wiki;lasitehdas";case"liesikiveykset":case"tulisijat":return"https://akp.nba.fi/wiki;tulisija";case"liesilatomukset (rran)":return"https://akp.nba.fi/wiki;liesilatomus";case"linnakkeet":return"https://akp.nba.fi/wiki;linnake-1500-ja-1600-luku";case"linnavuoret":case"muinaislinnat":return"https://akp.nba.fi/wiki;muinaislinna";case"linnoitukset":return"https://akp.nba.fi/wiki;bastionilinnoitus";case"louhokset":return"https://akp.nba.fi/wiki;louhos";case"luolat":return"https://akp.nba.fi/wiki;louhittu-luola";case"luostarinpaikat":return"https://akp.nba.fi/wiki;luostari";case"lhteet":return"https://akp.nba.fi/wiki;uhril%C3%A4hde";case"manufaktuurit":case"rautaruukit":return"https://akp.nba.fi/wiki;rautaruukki";case"markkinapaikat":return"https://akp.nba.fi/wiki;markkinapaikka";case"masuunit":return"https://akp.nba.fi/wiki;masuuni";case"miekanhiontakivet":return"https://akp.nba.fi/wiki;miekanhiontakivi";case"muinaispellot":return"https://akp.nba.fi/wiki;muinaispelto";case"muistomerkit":return"https://akp.nba.fi/wiki;muistomerkki";case"mkituvat":return"https://akp.nba.fi/wiki;m%C3%A4kitupa";case"nauriskuopat":return"https://akp.nba.fi/wiki;nauriskuoppa";case"optiset lenntinasemat":return"https://akp.nba.fi/wiki;optinen-lenn%C3%A4tinasema";case"ortodoksikalmistot":return"https://akp.nba.fi/wiki;kyl%C3%A4kalmisto";case"pajat":case"raudanvalmistuspaikat":return"https://akp.nba.fi/wiki;paja";case"palokuoppahaudat":return"https://akp.nba.fi/wiki;palokuoppahauta";case"panssariesteet":return"https://akp.nba.fi/wiki;panssarieste";case"paperitehtaat":return"https://akp.nba.fi/wiki;paperitehdas";case"pappilat":return"https://akp.nba.fi/wiki;pappila";case"piilopirtit":return"https://akp.nba.fi/wiki;piilopirtti";case"piiskauspetjt":case"rangaistuspaikat":return"https://akp.nba.fi/wiki;rangaistuspaikka";case"pikiruukit":return"https://akp.nba.fi/wiki;pikiruukki";case"polttokenttkalmistot":return"https://akp.nba.fi/wiki;polttokentt%C3%A4kalmisto";case"polut":return"https://akp.nba.fi/wiki;polku";case"poroaidat":return"https://akp.nba.fi/wiki;poroerotuspaikka";case"puistot":case"puutarhat":return"https://akp.nba.fi/wiki;puutarha";case"purnut":return"https://akp.nba.fi/wiki;purnu";case"pyyntitukikohdat":case"tomtning-jnnkset":return"https://akp.nba.fi/wiki;tomtning";case"rajamerkit":return"https://akp.nba.fi/wiki;rajamerkki";case"rakkakuopat":return"https://akp.nba.fi/wiki;rakkakuoppa";case"ratapohjat":return"https://akp.nba.fi/wiki;rautatie";case"ruumiskalmistot":case"ruttohautausmaat":return"https://akp.nba.fi/wiki;ruumishauta";case"ryssnuunit":return"https://akp.nba.fi/wiki;kiviuuni";case"salpietarikeittimt":return"https://akp.nba.fi/wiki;salpietarikeittim%C3%B6";case"seidat":return"https://akp.nba.fi/wiki;seita";case"sillanpaikat":case"sillat":return"https://akp.nba.fi/wiki;silta";case"sotilasleirit":return"https://akp.nba.fi/wiki;sotilasleiri";case"suojahuoneet":return"https://akp.nba.fi/wiki;suojahuone";case"taistelukaivannot":return"https://akp.nba.fi/wiki;taisteluhauta";case"taistelupaikat":return"https://akp.nba.fi/wiki;taistelupaikka";case"talonpohjat":return"https://akp.nba.fi/wiki;talonpohja";case"tarhakalmistot":return"https://akp.nba.fi/wiki;tarha";case"tarinapaikat":case"uhrilehdot":return"https://akp.nba.fi/wiki;tarinapaikka";case"tervahaudat":return"https://akp.nba.fi/wiki;tervahauta";case"tiilenpolttouunit":return"https://akp.nba.fi/wiki;tiilenpolttouuni";case"tiilitehtaat":return"https://akp.nba.fi/wiki;tiilitehdas";case"torpat":return"https://akp.nba.fi/wiki;torppa";case"tupasijat":return"https://akp.nba.fi/wiki;tupasija";case"tuulimyllyt":return"https://akp.nba.fi/wiki;tuulimylly";case"tykkiasemat":return"https://akp.nba.fi/wiki;tykkiasema";case"thystysasemat":return"https://akp.nba.fi/wiki;t%C3%A4hystysasema";case"uhrikivet":return"https://akp.nba.fi/wiki;uhrikivi";case"uhripuut":return"https://akp.nba.fi/wiki;uhripuu";case"uunit":return"https://akp.nba.fi/wiki;uuni";case"vallihaudat":return"https://akp.nba.fi/wiki;vallihauta";case"valonheitinasemat":return"https://akp.nba.fi/wiki;valonheitinasema";case"vesimyllyt":return"https://akp.nba.fi/wiki;vesimylly";case"vesisahat":return"https://akp.nba.fi/wiki;vesisaha";case"yhdyshaudat":return"https://akp.nba.fi/wiki;yhdyshauta"}},IP=cT.forwardRef(({bsPrefix:t,className:e,as:i="div",...n},a)=>{const s=RS(t,"row"),r=IS(),o=PS(),l=`${s}-cols`,u=[];return r.forEach(t=>{const e=n[t];let i;delete n[t],null!=e&&"object"==typeof e?({cols:i}=e):i=e;const a=t!==o?`-${t}`:"";null!=i&&u.push(`${l}${a}-${i}`)}),(0,MS.jsx)(i,{ref:a,...n,className:ES()(e,s,...u)})});IP.displayName="Row";const PP=IP,AP=({label:t,value:e,children:i,suffixColum:n})=>{const a=(0,cT.useMemo)(()=>Rw(e),[e]);return i||a?cT.createElement(FI.Group,{as:PP,controlId:t},cT.createElement(FI.Label,{column:!0,xs:{span:n?11:12,order:1},sm:{span:3,order:1},className:"fw-bold"},t),cT.createElement(xI,{xs:{span:12,order:3},sm:{span:n?8:9,order:2}},cT.createElement("div",{className:"form-control-plaintext"},i??a)),n&&cT.createElement(xI,{xs:{span:1,order:2},sm:{span:1,order:3}},n)):null},jP=({feature:t})=>{const{t:e,i18n:i}=JT(),n=t.attributes.typeAndDating?.map(({Typ:t,Und_typ:i,Typ_1:n,Undertyp:a,Antal:s})=>{const r=((t,e)=>{switch(e){case 0:return t("data.ahvenanmaa.type.Uppgifter saknas")??void 0;case 1:return t("data.ahvenanmaa.type.Agrara lmningar")??void 0;case 2:return t("data.ahvenanmaa.type.Bebyggelselmningar")??void 0;case 3:return t("data.ahvenanmaa.type.Befstningsanlggningar")??void 0;case 4:return t("data.ahvenanmaa.type.Boplatser")??void 0;case 5:return t("data.ahvenanmaa.type.Gravar")??void 0;case 6:return t("data.ahvenanmaa.type.Industriell-/produktionsplatser")??void 0;case 7:return t("data.ahvenanmaa.type.Jakt och fngst")??void 0;case 8:return t("data.ahvenanmaa.type.Kommunikations-/maritima lmningar")??void 0;case 9:return t("data.ahvenanmaa.type.Kult, offer och folktro")??void 0;case 10:return t("data.ahvenanmaa.type.Ristningar och minnesmrken")??void 0;case 11:return t("data.ahvenanmaa.type.vriga lmningar")??void 0;default:return}})(e,t),o=(t=>{switch(t){case"Uppgifter saknas":case"Tiedot puuttuvat":case"vriga lmningar":case"Muut jnnkset":default:return;case"Agrara lmningar":case"Maanviljelyjnnkset":case"Jakt och fngst":case"Metsstys- ja pyyntijnnkset":return"https://akp.nba.fi/wiki;luokka;elinkeinot";case"Bebyggelselmningar":case"Asutusjnnkset":case"Boplatser":case"Asuinpaikat":return"https://akp.nba.fi/wiki;luokka;asuminen_ja_oleskelu";case"Befstningsanlggningar":case"Puolustusvarustukset":return"https://akp.nba.fi/wiki;luokka;puolustus_ja_sodank%C3%A4ynti";case"Gravar":case"Hautapaikat":return"https://akp.nba.fi/wiki;luokka;hautaaminen";case"Industriell-/produktionsplatser":case"Teollisuus- ja valmistuspaikat":return"https://akp.nba.fi/wiki;luokka;teollisuus";case"Kommunikations-/maritima lmningar":case"Liikenne ja merellinen kulttuuriperint":return"https://akp.nba.fi/wiki;luokka;liikenne_ja_tiedonkulku";case"Kult, offer och folktro":case"Kultti-, uhri- ja tarinapaikat":return"https://akp.nba.fi/wiki;luokka;uskonnon_harjoittaminen";case"Ristningar och minnesmrken":case"Hakkaukset ja muistomerkit":return"https://akp.nba.fi/muut"}})(r),l=e(`data.ahvenanmaa.subType.${i}`,i??""),u=(t=>{switch(t){case"Uppgifter saknas":case"depofynd":case"treudd":default:return;case"artilleristllning":return"https://akp.nba.fi/wiki;tykkiasema";case"avrttningsplats":return"https://akp.nba.fi/wiki;rangaistuspaikka";case"befstning":case"transport/frrd":return"https://akp.nba.fi/wiki;kestolinnoite";case"begravningsplats":return"https://akp.nba.fi/wiki;hautausmaa";case"bevakning/signalering":return"https://akp.nba.fi/wiki;t%C3%A4hystysasema";case"boplats":return"https://akp.nba.fi/wiki;kivikautinen-asuinpaikka";case"brokista":return"https://akp.nba.fi/wiki;hirsiarkku";case"brott/tkt":return"https://akp.nba.fi/wiki;louhos";case"brunn/kallklla":return"https://akp.nba.fi/wiki;kaivo";case"bytomt/grdstomt":return"https://akp.nba.fi/wiki;kyl%C3%A4npaikka";case"domarring":return"https://akp.nba.fi/wiki;k%C3%A4r%C3%A4j%C3%A4ympyr%C3%A4";case"flygstation":return"https://akp.nba.fi/wiki;lentokentt%C3%A4";case"fornborg":return"https://akp.nba.fi/wiki;muinaislinna";case"fossil ker":return"https://akp.nba.fi/wiki;muinaispelto";case"fltbefstning":return"https://akp.nba.fi/wiki;kentt%C3%A4linnoitteet";case"fngstgrop":return"https://akp.nba.fi/wiki;pyyntikuoppa";case"frtjningsanordning":case"hamnanlggning":return"https://akp.nba.fi/wiki;satama";case"frvaringsanlggning":return"https://akp.nba.fi/wiki;rakkakuoppa";case"grav":return"https://akp.nba.fi/wiki;ruumishauta";case"gravhg":case"hggravflt":return"https://akp.nba.fi/wiki;hautakumpu";case"gravrse":case"rsegravflt":return"https://akp.nba.fi/wiki;hautar%C3%B6ykki%C3%B6";case"gruvlmning":return"https://akp.nba.fi/wiki;kaivos";case"grnsmrke":return"https://akp.nba.fi/wiki;rajamerkki";case"husgrund":return"https://akp.nba.fi/wiki;talonpohja";case"hgnad":return"https://akp.nba.fi/wiki;kiviaita";case"industrilmning":return"https://akp.nba.fi/wiki;luokka;teollisuus";case"kastalgrund":case"slott":return"https://akp.nba.fi/wiki;keskiaikainen-linna";case"kyrka/kapell":return"https://akp.nba.fi/wiki;kirkko";case"labyrint":return"https://akp.nba.fi/wiki;jatulintarha";case"minnesmrke":return"https://akp.nba.fi/wiki;muistomerkki";case"offerplats":return"https://akp.nba.fi/wiki;uhrikivi";case"ristning":return"https://akp.nba.fi/wiki;kalliohakkaus";case"rjningsrse":return"https://akp.nba.fi/wiki;viljelyr%C3%B6ykki%C3%B6";case"sjmrke":return"https://akp.nba.fi/wiki;merimerkki";case"skeppssttning":return"https://akp.nba.fi/wiki;laivalatomus";case"skrvstenshg":return"https://akp.nba.fi/wiki;pronssikautinen-asuinpaikka";case"stenkompass":return"https://akp.nba.fi/wiki;kivikompassi";case"stenugn":return"https://akp.nba.fi/wiki;kiviuuni";case"tomtning":return"https://akp.nba.fi/wiki;tomtning";case"traditionsplats":return"https://akp.nba.fi/wiki;tarinapaikka";case"varv":return"https://akp.nba.fi/wiki;laivanrakennuspaikka";case"vglmning":return"https://akp.nba.fi/wiki;tie"}})(i),h=((t,e)=>{switch(e){case 0:return t("data.ahvenanmaa.dating.Frhistorisk tid")??void 0;case 1:return t("data.ahvenanmaa.dating.Historisk tid")??void 0;case 2:return t("data.ahvenanmaa.dating.Stenlder")??void 0;case 3:return t("data.ahvenanmaa.dating.Bronslder")??void 0;case 4:return t("data.ahvenanmaa.dating.Jrnlder")??void 0;case 5:return t("data.ahvenanmaa.dating.Medeltid")??void 0;case 6:return t("data.ahvenanmaa.dating.Sentid")??void 0;case 99:return t("data.ahvenanmaa.dating.Uppgifter saknas")??void 0;default:return}})(e,n);return[[e("details.field.mainCategory"),o?cT.createElement("a",{href:o,target:"_blank"},r):r],[e("details.field.subCategory"),u?cT.createElement("a",{href:u,target:"_blank"},l):l],[e("details.field.mainEra"),h],[e("details.field.period"),e(`data.ahvenanmaa.subDating.${a}`,a??"")],[e("details.field.featureCount"),s]].filter(t=>!!t[1]).map((t,e)=>cT.createElement("li",{key:e},cT.createElement("b",{style:{fontWeight:500}},t[0],":")," ",t[1]))})||[];return cT.createElement(AP,{label:e("details.field.typeAndDating")},n.map((t,i,n)=>{const a=cT.createElement("ul",{key:i},t);return n.length>1?cT.createElement(cT.Fragment,{key:i},cT.createElement("label",{style:{marginLeft:"15px",display:"block",fontWeight:500}},`${e("details.field.feature")} ${i+1}`),a):a}))},OP=()=>{const{t}=JT();return cT.createElement(CP,null,cT.createElement(CP.Item,{eventKey:"1"},cT.createElement(CP.Header,null,cT.createElement("i",{className:"bi bi-info-circle pe-1","aria-hidden":"true"}),t("details.3d.infoHeading")),cT.createElement(CP.Body,null,cT.createElement("p",null,cT.createElement($T,{i18nKey:"details.3d.infoText1",components:{a:cT.createElement("a",null)}})),cT.createElement("p",null,cT.createElement($T,{i18nKey:"details.3d.infoText2",components:{kbd:cT.createElement("kbd",null)}}),cT.createElement("i",{className:"bi bi-arrows-angle-expand ps-1","aria-hidden":"true"})),cT.createElement("p",null,t("details.3d.controls.title"),":"),cT.createElement("ul",null,cT.createElement("li",null,cT.createElement("b",null,t("details.3d.controls.rotateTitle"),":")," ",t("details.3d.controls.rotate")),cT.createElement("li",null,cT.createElement("b",null,t("details.3d.controls.zoomTitle"),":")," ",t("details.3d.controls.zoom")),cT.createElement("li",null,cT.createElement("b",null,t("details.3d.controls.zoomTitle"),":")," ",t("details.3d.controls.zoom"))))))},FP=({models:t=[]})=>{const{t:e}=JT();return 0===t.length?null:cT.createElement(PP,{className:"mt-2"},cT.createElement(xI,null,cT.createElement("h6",null,e("details.3d.title")),cT.createElement(OP,null),t.map(t=>{const{name:e,url:i}=t.properties.model;return cT.createElement(FI.Group,{className:"pt-2",key:i,controlId:e},cT.createElement(FI.Label,{className:"fw-bold"},e),cT.createElement("iframe",{title:e,width:"100%",height:"400",src:`${i}/embed`,allow:"fullscreen",allowFullScreen:!0}))})))},NP=cT.forwardRef(({bsPrefix:t,fluid:e=!1,as:i="div",className:n,...a},s)=>{const r=RS(t,"container"),o="string"==typeof e?`-${e}`:"-fluid";return(0,MS.jsx)(i,{ref:s,...a,className:ES()(n,e?`${r}${o}`:r)})});NP.displayName="Container";const GP=NP,DP="%[a-f0-9]{2}",WP=new RegExp("("+DP+")|([^%]+?)","gi"),HP=new RegExp("("+DP+")+","gi");function UP(t,e){try{return[decodeURIComponent(t.join(""))]}catch{}if(1===t.length)return t;e=e||1;const i=t.slice(0,e),n=t.slice(e);return Array.prototype.concat.call([],UP(i),UP(n))}function BP(t){try{return decodeURIComponent(t)}catch{let e=t.match(WP)||[];for(let i=1;i<e.length;i++)e=(t=UP(e,i).join("")).match(WP)||[];return t}}function VP(t,e){const i={};if(Array.isArray(e))for(const n of e){const e=Object.getOwnPropertyDescriptor(t,n);e?.enumerable&&Object.defineProperty(i,n,e)}else for(const n of Reflect.ownKeys(t)){const a=Object.getOwnPropertyDescriptor(t,n);a.enumerable&&e(n,t[n],t)&&Object.defineProperty(i,n,a)}return i}function KP(t,e){if("string"!=typeof t||"string"!=typeof e)throw new TypeError("Expected the arguments to be of type `string`");if(""===t||""===e)return[];const i=t.indexOf(e);return-1===i?[]:[t.slice(0,i),t.slice(i+e.length)]}const zP=t=>null==t,$P=t=>encodeURIComponent(t).replaceAll(/[!'()*]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`),YP=Symbol("encodeFragmentIdentifier");function XP(t){if("string"!=typeof t||1!==t.length)throw new TypeError("arrayFormatSeparator must be single character string")}function qP(t,e){return e.encode?e.strict?$P(t):encodeURIComponent(t):t}function ZP(t,e){return e.decode?function(t){if("string"!=typeof t)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return decodeURIComponent(t)}catch{return function(t){const e={"%FE%FF":"","%FF%FE":""};let i=HP.exec(t);for(;i;){try{e[i[0]]=decodeURIComponent(i[0])}catch{const t=BP(i[0]);t!==i[0]&&(e[i[0]]=t)}i=HP.exec(t)}e["%C2"]="";const n=Object.keys(e);for(const i of n)t=t.replace(new RegExp(i,"g"),e[i]);return t}(t)}}(t):t}function JP(t){return Array.isArray(t)?t.sort():"object"==typeof t?JP(Object.keys(t)).sort((t,e)=>Number(t)-Number(e)).map(e=>t[e]):t}function QP(t){const e=t.indexOf("#");return-1!==e&&(t=t.slice(0,e)),t}function tA(t,e,i){return"string"===i&&"string"==typeof t?t:"function"==typeof i&&"string"==typeof t?i(t):"boolean"===i&&null===t||("boolean"!==i||null===t||"true"!==t.toLowerCase()&&"false"!==t.toLowerCase()?"boolean"!==i||null===t||"1"!==t.toLowerCase()&&"0"!==t.toLowerCase()?"string[]"===i&&"none"!==e.arrayFormat&&"string"==typeof t?[t]:"number[]"!==i||"none"===e.arrayFormat||Number.isNaN(Number(t))||"string"!=typeof t||""===t.trim()?"number"!==i||Number.isNaN(Number(t))||"string"!=typeof t||""===t.trim()?!e.parseBooleans||null===t||"true"!==t.toLowerCase()&&"false"!==t.toLowerCase()?e.parseNumbers&&!Number.isNaN(Number(t))&&"string"==typeof t&&""!==t.trim()?Number(t):t:"true"===t.toLowerCase():Number(t):[Number(t)]:"1"===t.toLowerCase():"true"===t.toLowerCase())}function eA(t){const e=(t=QP(t)).indexOf("?");return-1===e?"":t.slice(e+1)}function iA(t,e){XP((e={decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,types:Object.create(null),...e}).arrayFormatSeparator);const i=function(t){let e;switch(t.arrayFormat){case"index":return(t,i,n)=>{e=/\[(\d*)]$/.exec(t),t=t.replace(/\[\d*]$/,""),e?(void 0===n[t]&&(n[t]={}),n[t][e[1]]=i):n[t]=i};case"bracket":return(t,i,n)=>{e=/(\[])$/.exec(t),t=t.replace(/\[]$/,""),e?void 0!==n[t]?n[t]=[...n[t],i]:n[t]=[i]:n[t]=i};case"colon-list-separator":return(t,i,n)=>{e=/(:list)$/.exec(t),t=t.replace(/:list$/,""),e?void 0!==n[t]?n[t]=[...n[t],i]:n[t]=[i]:n[t]=i};case"comma":case"separator":return(e,i,n)=>{const a="string"==typeof i&&i.includes(t.arrayFormatSeparator)?i.split(t.arrayFormatSeparator).map(e=>ZP(e,t)):null===i?i:ZP(i,t);n[e]=a};case"bracket-separator":return(e,i,n)=>{const a=/(\[])$/.test(e);if(e=e.replace(/\[]$/,""),!a)return void(n[e]=i?ZP(i,t):i);const s=null===i?[]:ZP(i,t).split(t.arrayFormatSeparator);void 0!==n[e]?n[e]=[...n[e],...s]:n[e]=s};default:return(t,e,i)=>{void 0!==i[t]?i[t]=[...[i[t]].flat(),e]:i[t]=e}}}(e),n=Object.create(null);if("string"!=typeof t)return n;if(!(t=t.trim().replace(/^[?#&]/,"")))return n;for(const a of t.split("&")){if(""===a)continue;const t=e.decode?a.replaceAll("+"," "):a;let[s,r]=KP(t,"=");void 0===s&&(s=t),r=void 0===r?null:["comma","separator","bracket-separator"].includes(e.arrayFormat)?r:ZP(r,e),i(ZP(s,e),r,n)}for(const[t,i]of Object.entries(n))if("object"==typeof i&&null!==i&&"string"!==e.types[t])for(const[n,a]of Object.entries(i)){const s=e.types[t],r="function"==typeof s?s:s?s.replace("[]",""):void 0;i[n]=tA(a,e,r)}else"object"==typeof i&&null!==i&&"string"===e.types[t]?n[t]=Object.values(i).join(e.arrayFormatSeparator):n[t]=tA(i,e,e.types[t]);return!1===e.sort?n:(!0===e.sort?Object.keys(n).sort():Object.keys(n).sort(e.sort)).reduce((t,e)=>{const i=n[e];return t[e]=Boolean(i)&&"object"==typeof i&&!Array.isArray(i)?JP(i):i,t},Object.create(null))}function nA(t,e){if(!t)return"";XP((e={encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:",",...e}).arrayFormatSeparator);const i=i=>e.skipNull&&zP(t[i])||e.skipEmptyString&&""===t[i],n=function(t){switch(t.arrayFormat){case"index":return e=>(i,n)=>{const a=i.length;return void 0===n||t.skipNull&&null===n||t.skipEmptyString&&""===n?i:null===n?[...i,[qP(e,t),"[",a,"]"].join("")]:[...i,[qP(e,t),"[",qP(a,t),"]=",qP(n,t)].join("")]};case"bracket":return e=>(i,n)=>void 0===n||t.skipNull&&null===n||t.skipEmptyString&&""===n?i:null===n?[...i,[qP(e,t),"[]"].join("")]:[...i,[qP(e,t),"[]=",qP(n,t)].join("")];case"colon-list-separator":return e=>(i,n)=>void 0===n||t.skipNull&&null===n||t.skipEmptyString&&""===n?i:null===n?[...i,[qP(e,t),":list="].join("")]:[...i,[qP(e,t),":list=",qP(n,t)].join("")];case"comma":case"separator":case"bracket-separator":{const e="bracket-separator"===t.arrayFormat?"[]=":"=";return i=>(n,a)=>void 0===a||t.skipNull&&null===a||t.skipEmptyString&&""===a?n:(a=null===a?"":a,0===n.length?[[qP(i,t),e,qP(a,t)].join("")]:[[n,qP(a,t)].join(t.arrayFormatSeparator)])}default:return e=>(i,n)=>void 0===n||t.skipNull&&null===n||t.skipEmptyString&&""===n?i:null===n?[...i,qP(e,t)]:[...i,[qP(e,t),"=",qP(n,t)].join("")]}}(e),a={};for(const[e,n]of Object.entries(t))i(e)||(a[e]=n);const s=Object.keys(a);return!1!==e.sort&&s.sort(e.sort),s.map(i=>{let a=t[i];if(e.replacer&&(a=e.replacer(i,a),void 0===a))return"";if(void 0===a)return"";if(null===a)return qP(i,e);if(Array.isArray(a)){if(0===a.length&&"bracket-separator"===e.arrayFormat)return qP(i,e)+"[]";let t=a;return e.replacer&&(t=a.map((t,n)=>e.replacer(`${i}[${n}]`,t)).filter(t=>void 0!==t)),t.reduce(n(i),[]).join("&")}return qP(i,e)+"="+qP(a,e)}).filter(t=>t.length>0).join("&")}function aA(t,e){e={decode:!0,...e};let[i,n]=KP(t,"#");return void 0===i&&(i=t),{url:i?.split("?")?.[0]??"",query:iA(eA(t),e),...e&&e.parseFragmentIdentifier&&n?{fragmentIdentifier:ZP(n,e)}:{}}}function sA(t,e){e={encode:!0,strict:!0,[YP]:!0,...e};const i=QP(t.url).split("?")[0]||"";let n=nA({...iA(eA(t.url),{sort:!1,...e}),...t.query},e);n&&=`?${n}`;let a=function(t){let e="";const i=t.indexOf("#");return-1!==i&&(e=t.slice(i)),e}(t.url);if("string"==typeof t.fragmentIdentifier){const n=new URL(i);n.hash=t.fragmentIdentifier,a=e[YP]?n.hash:`#${t.fragmentIdentifier}`}return`${i}${n}${a}`}function rA(t,e,i){i={parseFragmentIdentifier:!0,[YP]:!1,...i};const{url:n,query:a,fragmentIdentifier:s}=aA(t,i);return sA({url:n,query:VP(a,e),fragmentIdentifier:s},i)}function oA(t,e,i){const n=Array.isArray(e)?t=>!e.includes(t):(t,i)=>!e(t,i);return rA(t,n,i)}const lA=n,uA=()=>lA.parse(window.location.hash,{parseNumbers:!0,parseBooleans:!0,arrayFormat:"comma"}),hA=t=>`#${lA.stringify(t,{arrayFormat:"comma"})}`;var cA;!function(t){t.OpenDetails="openDetails",t.ClosePageAndPinOnMap="closePageAndPinOnMap"}(cA||(cA={}));const dA=({titleClickAction:t,panelId:e,onToggleOpen:i,feature:n,featureLayer:a,featureRegisterId:s,isLinkedFeature:r,children:o})=>{const{t:l,i18n:u}=JT(),h=mS(),c=(0,cT.useMemo)(()=>yw(l,n),[u.language,n]),d=(0,cT.useMemo)(()=>(t=>{const e="models"in t&&t.models.length>0;if(Zp(t)){if(im(t))return t.maisemanMuisti.length>0?kw("maiseman-muisti",e):kw("muinaisjaannos_kohde",e);if(nm(t))return kw("muinaisjaannos_alue",e);if(am(t))return kw("muu_kulttuuriperintokohde_kohde",e);if(sm(t))return kw("muu-kulttuuriperintokohde-alue",e);if(am(t))return kw("muu_kulttuuriperintokohde_kohde",e);if(sm(t))return kw("muu-kulttuuriperintokohde-alue",e);if(lm(t))return kw("rky_alue",e);if(um(t))return kw("rky_piste",e);if(hm(t))return kw("rky_viiva",e);if(dm(t))return kw("maailmanperinto_alue",e);if(cm(t))return kw("maailmanperinto_piste",e);if(om(t))return kw("rakennusperintorekisteri_alue",e);if(rm(t))return kw("rakennusperintorekisteri_rakennus",e);if(pm(t))return kw("vark_piste",e);if(mm(t))return kw("vark_alue",e);if(fm(t))return kw("loytopaikka_piste",e);if(gm(t))return kw("loytopaikka_alue",e);if(_m(t))return kw("muu_kohde_piste",e);if(ym(t))return kw("muu_kohde_alue",e);if(km(t))return kw("luonnonmuodostuma_piste",e);if(vm(t))return kw("luonnonmuodostuma_alue",e);if(wm(t))return kw("havaintokohde_piste",e);if(bm(t))return kw("havaintokohde_alue",e);if(Em(t))return kw("mahdollinen_muinaisjaannos_piste",e);if(Mm(t))return kw("mahdollinen_muinaisjaannos_alue",e);if(Tm(t))return kw("poistettu_kiintea_muinaisjaannos_piste",e);if(Sm(t))return kw("poistettu_kiintea_muinaisjaannos_alue",e);if(xm(t))return kw("alakohde_piste",e);if(r_(t))return kw("maalinnoitus-yksikko",!1);if(o_(t))switch(t.properties.kohdetyyppi){case a_.Asema:return kw("maalinnoitus-asema",!1);case a_.Luola:return kw("maalinnoitus-luola",!1);case a_.Tykkipatteri:return kw("maalinnoitus-tykkipatteri",!1);case a_.Tykkitie:return kw("maalinnoitus-tykkitie",!1)}if(l_(t))switch(t.properties.rajaustyyppi){case s_.Tukikohta:return kw("maalinnoitus-tukikohdan-raja",!1);case s_.Puolustusasema:return kw("maalinnoitus-puolustusaseman-raja",!1)}if(qp(t))return kw("maiseman-muisti",e);if(Om(t)){const{Is_Town:e,Is_Settlement:i,Is_Bridge:n,Is_Ferry:a,Is_Fair:s,Is_Toll:r,Is_Harbour:o}=t.properties;return kw(e?"viabundus-kaupunki":i?"viabundus-asuttu-paikka":n?"viabundus-silta":a?"viabundus-lossi":s?"viabundus-markkinat":r?"viabundus-tulli":o?"viabundus-satama":"viabundus-maantie")}if(Fm(t)){const{roadType:e,certainty:i}=t.properties;switch(e){case Am.winter:return kw("viabundus-talvitie");case Am.coast:return i===jm.Uncertain?kw("viabundus-vesivayla-epavarma"):kw("viabundus-vesivayla");case Am.land:default:return i===jm.Uncertain?kw("viabundus-maantie-epavarma"):kw("viabundus-maantie")}}if(Nm(t))return kw("viabundus-kaupungin-rajat")}else if(Zf(t))switch(t.layerName){case Bp.Fornminnen:return kw("ahvenanmaa_muinaisjaannos",e);case Bp.MaritimaFornminnen:return kw("ahvenanmaa_hylky",e)}throw new Error(`Tuntematon feature: ${JSON.stringify(t)}`)})(n),[n]),p=(0,cT.useMemo)(()=>{const e=(t=>{if(Zp(t)){if(Cm(t))return t.properties.kunta;if(qp(t))return t.properties.municipality}else if(Zf(t)&&t.layerName===Bp.Fornminnen)return t.attributes.Kommun})(n),i=((t,e)=>{if(Zp(e)){if(im(e)){const i=Sw(e);return[t("data.featureType.Kiinte muinaisjnns"),i[0]?t(`data.museovirasto.type.${i[0]}`,i[0]):void 0,e.maisemanMuisti.length>0?t("data.featureType.Valtakunnallisesti merkittv muinaisjnns"):void 0].filter(t=>!!t).join(", ")}if(nm(e))return t("data.featureType.Kiinte muinaisjnns (alue)");if(am(e))return t("data.featureType.Muu kulttuuriperintkohde");if(sm(e))return t("data.featureType.Muu kulttuuriperintkohde (alue)");if(lm(e)||um(e)||hm(e))return t("data.featureType.Rakennettu kulttuuriymprist");if(dm(e)||cm(e))return t("data.featureType.Maailmanperintkohde");if(om(e)||rm(e))return t("data.featureType.Rakennusperintkohde");if(pm(e))return t("data.featureType.varkPiste");if(mm(e))return t("data.featureType.varkAlue");if(fm(e))return t("data.featureType.lytpaikkaPiste");if(gm(e))return t("data.featureType.lytpaikkaAlue");if(_m(e))return t("data.featureType.muuKohdePiste");if(ym(e))return t("data.featureType.muuKohdeAlue");if(km(e))return t("data.featureType.luonnonmuodostumaPiste");if(vm(e))return t("data.featureType.luonnonmuodostumaAlue");if(wm(e))return t("data.featureType.havaintokohdePiste");if(bm(e))return t("data.featureType.havaintokohdeAlue");if(Em(e))return t("data.featureType.mahdollinenMuinaisjnnsPiste");if(Mm(e))return t("data.featureType.mahdollinenMuinaisjnnsAlue");if(xm(e))return t("data.featureType.alakohdePiste");if(r_(e))return`${t("data.featureType.maalinnoitus")}, ${t("data.helsinki.featureType.yksikk")}`;if(o_(e))return`${t("data.featureType.maalinnoitus")}, ${t("data.helsinki.featureType.kohde")}`;if(l_(e))return`${t("data.featureType.maalinnoitus")}, ${t("data.helsinki.featureType.rajaus")}`;if(qp(e))return`${t("data.featureType.Kiinte muinaisjnns")}, ${t("data.featureType.Valtakunnallisesti merkittv muinaisjnns")}`;if(Om(e)){const{Is_Town:i,Is_Settlement:n,Is_Bridge:a,Is_Fair:s,Is_Toll:r,Is_Ferry:o,Is_Harbour:l}=e.properties;if(i)return`${t("data.viabundus.place.town")}, ${t("data.featureType.viabundus")}`;if(n)return`${t("data.viabundus.place.settlement")}, ${t("data.featureType.viabundus")}`;if(a)return`${t("data.viabundus.place.bridge")}, ${t("data.featureType.viabundus")}`;if(s)return`${t("data.viabundus.place.fair")}, ${t("data.featureType.viabundus")}`;if(o)return`${t("data.viabundus.place.ferry")}, ${t("data.featureType.viabundus")}`;if(r)return`${t("data.viabundus.place.toll")}, ${t("data.featureType.viabundus")}`;if(l)return`${t("data.viabundus.place.harbour")}, ${t("data.featureType.viabundus")}`}if(Fm(e))return t("data.featureType.viabundus-tieverkko");if(Nm(e))return t("data.featureType.viabundus-kaupungin-rajat")}else if(Zf(e))switch(e.layerName){case Bp.Fornminnen:return t("data.featureType.Ahvenanmaan muinaisjnnsrekisterin kohde")??void 0;case Bp.MaritimaFornminnen:return t("data.featureType.Ahvenanmaan merellisen kulttuuriperintrekisterin kohde")??void 0}return""})(l,n);return i+(t===cA.ClosePageAndPinOnMap&&e?`, ${e}`:"")},[u.language,t,n]),m=(0,cT.useMemo)(()=>({coordinates:Ew(n),layer:a,id:s,name:c}),[n,a,s,c]),f=(0,cT.useMemo)(()=>{return t=m,hA({...uA(),x:t.coordinates[0],y:t.coordinates[1],linkedFeatureLayer:t.layer,linkedFeatureId:t.id,linkedFeatureName:t.name});var t},[u.language,m]),g=(0,cT.useCallback)(t=>{t.preventDefault(),h({type:Dm.SET_LINKED_FEATURE,linkedFeature:m}),h({type:Dm.SHOW_PAGE,pageId:void 0})},[h,m]);return cT.createElement(CP.Item,{eventKey:e},cT.createElement(CP.Header,{onClick:i,as:"div",className:r?"current-linked-feature-accordian-header":""},cT.createElement(GP,{className:"ps-0"},cT.createElement(PP,null,cT.createElement(xI,{xs:10},cT.createElement("h6",{className:"mb-0"},c),cT.createElement("div",null,cT.createElement("img",{className:"feature-icon",src:d}),cT.createElement("span",null,p))),cT.createElement(xI,{xs:2,className:"text-end align-self-center"},cT.createElement("a",{href:f,onClick:g,title:l("common.button.featureLocationLink")},cT.createElement("i",{className:"bi bi-geo-alt-fill","aria-hidden":"true",style:{fontSize:"2rem"}})))))),cT.createElement(CP.Body,null,cT.createElement("div",{className:"panel-body"},o)))},pA=({feature:t})=>{const{t:e}=JT(),[i,n]=(0,cT.useState)("");(0,cT.useEffect)(()=>{const e={type:"FeatureCollection",crs:{type:"EPSG",properties:{code:3067}},features:[mA(t)]},i=JSON.stringify(e,null,2),a=new Blob([i],{type:"application/geo+json"}),s=URL.createObjectURL(a);return n(s),()=>URL.revokeObjectURL(s)},[]);const a=`${yw(e,t)}-${xw(t)}.geojson`;return cT.createElement("a",{href:i,download:a,title:e("details.field.downloadGeometry")},cT.createElement("i",{className:"bi bi-download","aria-hidden":"true",style:{fontSize:"1.5rem"}}))},mA=t=>{if(Jp(t))return _w(t);if(qp(t))return t;if(Gm(t))return t;const{maisemanMuisti:e,models:i,...n}=t;return n},fA=({feature:t,...e})=>{const{t:i}=JT();return cT.createElement(dA,{feature:t,...e},cT.createElement(FI,null,cT.createElement(AP,{label:i("details.field.id"),value:t.attributes["Fornlmnings ID"],suffixColum:cT.createElement(pA,{feature:t})}),cT.createElement(AP,{label:i("details.field.name"),value:t.attributes.Namn}),cT.createElement(AP,{label:i("details.field.municipality"),value:t.attributes.Kommun}),cT.createElement(AP,{label:i("details.field.village"),value:t.attributes.By}),cT.createElement(jP,{feature:t}),cT.createElement(AP,{label:i("details.field.description"),value:t.attributes.Beskrivning}),cT.createElement(AP,{label:i("details.field.location"),value:t.attributes.Topografi}),e.isOpen&&cT.createElement(FP,{models:t.models})))},gA=({feature:t,...e})=>{const{t:i}=JT();return cT.createElement(dA,{feature:t,...e},cT.createElement(FI,null,cT.createElement(AP,{label:i("details.field.id"),value:t.attributes.MfornID,suffixColum:cT.createElement(pA,{feature:t})}),cT.createElement(AP,{label:i("details.field.name"),value:t.attributes.Namn}),cT.createElement(AP,{label:i("details.field.description"),value:t.attributes.Beskrivning}),cT.createElement(AP,{label:i("details.field.precision"),value:t.attributes.Precision}),cT.createElement(AP,{label:i("details.field.legislation"),value:t.attributes.Lagrum}),e.isOpen&&cT.createElement(FP,{models:t.models})))},_A=({url:t,registerName:e})=>cT.createElement(PP,{className:"mt-2"},cT.createElement(xI,null,cT.createElement(iP,{variant:"light"},cT.createElement($T,{i18nKey:"details.finnishHeritageAgencyMoreInfoLink",values:{url:t,registerName:e},components:{a:cT.createElement(iP.Link,null)}})))),yA=({feature:t})=>{const{t:e,i18n:i}=JT(),n=((t,e)=>{if(Zp(t)){if(Cm(t))return ww(t.properties.mjtunnus,e);if(lm(t)||um(t)||hm(t)){let i=t.properties.url;return e===Op.SV&&(i=i.replace("www.rky.fi","www.kulturmiljo.fi").replace("r_kohde_det.aspx","rsv_kohde_det.aspx")),i}if(dm(t)||cm(t))return((t,e)=>{let i=cm(t)?t.properties.url:t.properties.URL;const n=i.indexOf("#");let a="";return-1!==n&&(a=i.substring(n)),i.startsWith("http://www.nba.fi/fi/ajankohtaista/kansainvalinen_toiminta/maailmanperintokohteet_suomessa")&&(i="https://www.museovirasto.fi/fi/tietoa-meista/kansainvalinen-toiminta/maailmanperintokohteet-suomessa"+a),e===Op.SV&&(i="https://www.museovirasto.fi/sv/om-oss/internationell-verksamhet/varldsarvet-i-finland"+a),i})(t,e);if(om(t)||rm(t))return`https://www.kyppi.fi/palveluikkuna/rapea/read/asp/r_kohde_det.aspx?KOHDE_ID=${t.properties.KOHDEID}`;if(pm(t)||mm(t))return t.properties.Linkki}})(t,i.language),a=((t,e)=>{if(Zp(e)){if(Cm(e))return t("details.registerLink.fromMuinaisjaannos");if(lm(e)||um(e)||hm(e))return t("details.registerLink.fromRKY");if(dm(e)||cm(e))return t("details.registerLink.fromMaailmanperinto");if(om(e)||rm(e))return t("details.registerLink.fromRakennusperint");if(pm(e)||mm(e))return t("details.registerLink.fromVark")}return""})(e,t);return n?cT.createElement(_A,{url:n,registerName:a}):null},kA=({feature:t,...e})=>{const{t:i}=JT();return cT.createElement(dA,{feature:t,...e},cT.createElement(FI,null,cT.createElement(AP,{label:i("details.field.name"),value:cm(t)?t.properties.nimi:t.properties.Nimi,suffixColum:cT.createElement(pA,{feature:t})}),cT.createElement(yA,{feature:t})))},vA=({feature:t})=>cT.createElement(PP,{className:"mt-2"},cT.createElement(xI,null,cT.createElement(iP,{variant:"light"},cT.createElement($T,{i18nKey:"data.register.nameWithLink.maisemanMuisti",components:{a:cT.createElement(iP.Link,null)}}),":",cT.createElement("div",null,cT.createElement("img",{className:"feature-icon",src:"images/maiseman-muisti.png"}),cT.createElement("span",null,t.properties.name))))),xA=cT.forwardRef(({bsPrefix:t,bg:e="primary",pill:i=!1,text:n,className:a,as:s="span",...r},o)=>{const l=RS(t,"badge");return(0,MS.jsx)(s,{ref:o,...r,className:ES()(a,l,i&&"rounded-pill",n&&`text-${n}`,e&&`bg-${e}`)})});xA.displayName="Badge";const wA=xA,bA=({dating:t})=>{const{t:e,i18n:i}=JT(),n=`data.museovirasto.muinaisjnnsAjoitusTimespan.${t}`;return i.exists(n)?cT.createElement(wA,{bg:"secondary ms-1"},e(n)):null},EA=({dating:t})=>{const{t:e,i18n:i}=JT(),n=`data.museovirasto.varkAjoitusTimespan.${t}`;return i.exists(n)?cT.createElement(wA,{bg:"secondary ms-1"},e(n)):null},MA=({feature:t,models:e=[],...i})=>{const{t:n}=JT();return cT.createElement(dA,{feature:t,...i},cT.createElement("form",null,cT.createElement(AP,{label:n("details.field.featureName"),value:t.properties.registerName}),cT.createElement(AP,{label:n("details.field.municipality"),value:t.properties.municipality}),cT.createElement(AP,{label:n("details.field.region"),value:t.properties.region}),cT.createElement(AP,{label:n("details.field.dating")},cT.createElement("p",null,cT.createElement("span",null,Rw(t.properties.dating))," ",cT.createElement(bA,{dating:t.properties.dating}))),cT.createElement(AP,{label:n("details.field.type"),value:t.properties.type}),cT.createElement(AP,{label:n("details.field.subType"),value:t.properties.subtype}),cT.createElement(vA,{feature:t}),cT.createElement(_A,{url:`https://www.kyppi.fi/to.aspx?id=112.${t.properties.id}`,registerName:"Muinaisjnnsrekisterist"}),i.isOpen&&cT.createElement(FP,{models:e})))},TA=({feature:t,...e})=>{const{t:i}=JT(),{kohdenimi:n,kunta:a,mjtunnus:s}=t.properties;return cT.createElement(dA,{feature:t,...e},cT.createElement(FI,null,cT.createElement(AP,{label:i("details.field.name"),value:n,suffixColum:cT.createElement(pA,{feature:t})}),cT.createElement(AP,{label:i("details.field.municipality"),value:a}),cT.createElement(AP,{label:i("details.field.id"),value:String(s)}),cT.createElement(yA,{feature:t})))},SA=({text:t,url:e})=>e?cT.createElement("a",{href:e,target:"_blank"},t):cT.createElement("span",null,t),CA=({data:t,contentFn:e})=>0===t.length?null:1===t.length?e(t[0]):cT.createElement("ul",null,t.map(t=>cT.createElement("li",{key:String(t)},e(t)))),LA=({feature:t,...e})=>{const{t:i}=JT(),{kohdenimi:n,kunta:a,mjtunnus:s}=t.properties,r=(0,cT.useMemo)(()=>Sw(t),[t]),o=(0,cT.useMemo)(()=>Cw(t),[t]),l=(0,cT.useMemo)(()=>Lw(t),[t]);return cT.createElement(dA,{feature:t,...e},cT.createElement(FI,null,cT.createElement(AP,{label:i("details.field.featureName"),value:n,suffixColum:cT.createElement(pA,{feature:t})}),cT.createElement(AP,{label:i("details.field.municipality"),value:a}),cT.createElement(AP,{label:i("details.field.dating")},cT.createElement(CA,{data:l,contentFn:t=>{return cT.createElement("div",null,cT.createElement("span",null,i(`data.museovirasto.muinaisjnnsAjoitus.${t}`,t)),(e=t,Object.values(tm).includes(e)&&cT.createElement(bA,{dating:t})));var e}})),cT.createElement(AP,{label:i("details.field.type")},cT.createElement(CA,{data:r,contentFn:t=>Tw(t)?cT.createElement(SA,{text:i(`data.museovirasto.type.${t}`,t),url:LP(t)}):t})),cT.createElement(AP,{label:i("details.field.subType")},cT.createElement(CA,{data:o,contentFn:t=>cT.createElement(SA,{text:i(`data.museovirasto.subtype.${t}`,t),url:RP(t)})})),cT.createElement(AP,{label:i("details.field.id"),value:String(s)}),xm(t)&&cT.createElement(AP,{label:i("details.field.alakohdetunnus"),value:String(t.properties.alakohdetunnus)}),t.maisemanMuisti.length>0&&cT.createElement(vA,{feature:t.maisemanMuisti[0]}),cT.createElement(yA,{feature:t}),e.isOpen&&cT.createElement(FP,{models:t.models})))},RA=({feature:t,...e})=>{const{t:i}=JT();return cT.createElement(dA,{feature:t,...e},cT.createElement(FI,null,cT.createElement(AP,{label:i("details.field.featureName"),value:t.properties.kohdenimi,suffixColum:cT.createElement(pA,{feature:t})}),lm(t)&&cT.createElement(AP,{label:i("details.field.name"),value:t.properties.nimi}),cT.createElement(AP,{label:i("details.field.id"),value:String(t.properties.ID)}),cT.createElement(yA,{feature:t}),e.isOpen&&cT.createElement(FP,{models:t.models})))},IA=({feature:t,...e})=>{const{t:i}=JT();return cT.createElement(dA,{feature:t,...e},cT.createElement(FI,null,cT.createElement(AP,{label:i("details.field.featureName"),value:t.properties.kohdenimi,suffixColum:cT.createElement(pA,{feature:t})}),rm(t)&&cT.createElement(AP,{label:i("details.field.buildingName"),value:t.properties.rakennusnimi}),cT.createElement(AP,{label:i("details.field.municipality"),value:t.properties.kunta}),cT.createElement(AP,{label:i("details.field.protectionGroup"),value:t.properties.suojeluryhm}),cT.createElement(AP,{label:i("details.field.id"),value:String(t.properties.KOHDEID)}),cT.createElement(yA,{feature:t}),e.isOpen&&cT.createElement(FP,{models:t.models})))},PA=t=>{switch(t){case s_.Puolustusasema:case s_.Tukikohta:return"http://www.novision.fi/viapori/system.htm";default:return}},AA=t=>{switch(t){case a_.Asema:return"http://www.novision.fi/viapori/maarintama.htm";case a_.Tykkipatteri:return"http://www.novision.fi/viapori/tykkipatterit.htm";case a_.Tykkitie:return"http://www.novision.fi/viapori/liikenne.htm";case a_.Luola:return"http://www.novision.fi/viapori/luolat.htm";default:return}},jA=t=>{switch(t){case i_.Asema:return"http://www.novision.fi/viapori/maarintama.htm";case i_.Tykkipatteri:return"http://www.novision.fi/viapori/tykkipatterit.htm";case i_.Tykkitie:return"http://www.novision.fi/viapori/liikenne.htm";case i_.Muu:default:return}},OA=t=>{switch(t){case n_.Juoksuhauta:return"http://www.novision.fi/viapori/haudat.htm";case n_.Luola:return"http://www.novision.fi/viapori/luolat.htm";case n_.Suojahuone:return"http://www.novision.fi/viapori/suojahuoneet.htm";case n_.Tulipeske:return"http://www.novision.fi/viapori/asemat.htm";case n_.Tykkiasema:return"http://www.novision.fi/viapori/tykkipatterit.htm";case n_.Suojavalli:return"http://www.novision.fi/viapori/esteet.htm";case n_.Jalusta:case n_.Kuoppa:case n_.Rakenne:default:return}},FA=({feature:t,...e})=>{const{t:i}=JT(),{tukikohtanumero:n,kohdetyyppi:a,olotila:s,mittaustieto:r}=t.properties;return cT.createElement(dA,{feature:t,...e},cT.createElement(FI,null,cT.createElement(AP,{label:i("details.field.maalinnoitus.tukikohta"),value:n,suffixColum:cT.createElement(pA,{feature:t})}),cT.createElement(AP,{label:i("details.field.maalinnoitus.kohteenTyyppi")},cT.createElement(SA,{text:i(`data.helsinki.kohdetyyppi.${a}`,{defaultValue:a}),url:AA(a)})),cT.createElement(AP,{label:i("details.field.maalinnoitus.olotila"),value:s}),cT.createElement(AP,{label:i("details.field.maalinnoitus.mittaustieto"),value:r})))},NA=({feature:t,...e})=>{const{t:i}=JT(),{tukikohtanumero:n,lajinumero:a,rajaustyyppi:s}=t.properties;return cT.createElement(dA,{feature:t,...e},cT.createElement(FI,null,cT.createElement(AP,{label:i("details.field.maalinnoitus.tukikohta"),value:n,suffixColum:cT.createElement(pA,{feature:t})}),cT.createElement(AP,{label:i("details.field.maalinnoitus.puolustusasema"),value:a}),cT.createElement(AP,{label:i("details.field.maalinnoitus.rajauksenTyyppi")},cT.createElement(SA,{text:i(`data.helsinki.rajaustyyppi.${s}`,{defaultValue:s}),url:PA(s)}))))},GA=({feature:t,...e})=>{const{t:i}=JT(),{tukikohtanumero:n,lajinumero:a,laji:s,yksikko:r,yksikkonumero:o,ajoitus:l,ajoitushuom:u,rakennustapa:h,rakennushistoria:c}=t.properties;return cT.createElement(dA,{feature:t,...e},cT.createElement(FI,null,cT.createElement(AP,{label:i("details.field.maalinnoitus.tukikohta"),value:n,suffixColum:cT.createElement(pA,{feature:t})}),cT.createElement(AP,{label:i("details.field.maalinnoitus.puolustusasema"),value:a}),cT.createElement(AP,{label:i("details.field.maalinnoitus.yksiknTyyppi")},cT.createElement(SA,{text:i(`data.helsinki.yksikkoLaji.${s}`,{defaultValue:s}),url:jA(s)})),cT.createElement(AP,{label:i("details.field.maalinnoitus.yksikk")},cT.createElement(SA,{text:i(`data.helsinki.yksikko.${r}`,{defaultValue:r}),url:OA(r)})),cT.createElement(AP,{label:i("details.field.maalinnoitus.yksikknumero"),value:o}),cT.createElement(AP,{label:i("details.field.dating"),value:[l,u].filter(t=>!!t).join(", ")}),cT.createElement(AP,{label:i("details.field.maalinnoitus.rakennustapa"),value:h}),cT.createElement(AP,{label:i("details.field.maalinnoitus.rakennushistoria"),value:c})))},DA=({feature:t,...e})=>{const{t:i,i18n:n}=JT(),{VARK_ID:a,VARK_nimi:s,Kunta:r,Maakunta:o,Mj_kohde:l,Mj_tunnus:u}=t.properties,h=(0,cT.useMemo)(()=>Sw(t),[t]),c=(0,cT.useMemo)(()=>Cw(t),[t]),d=(0,cT.useMemo)(()=>Lw(t),[t]),p=(0,cT.useMemo)(()=>{const t=u.split(", ").filter(t=>!!t),e=l.split(", ").filter(t=>!!t);return t.map((t,i)=>[e[i],t])},[t]);return cT.createElement(dA,{feature:t,...e},cT.createElement(FI,null,cT.createElement(AP,{label:i("details.field.featureName"),value:s,suffixColum:cT.createElement(pA,{feature:t})}),cT.createElement(AP,{label:i("details.field.municipality"),value:r}),cT.createElement(AP,{label:i("details.field.region"),value:o}),cT.createElement(AP,{label:i("details.field.dating")},cT.createElement(CA,{data:d,contentFn:t=>{return cT.createElement("div",null,cT.createElement("span",null,i(`data.museovirasto.varkAjoitus.${t}`,t)),(e=t,Object.values(em).includes(e)&&cT.createElement(EA,{dating:t})));var e}})),cT.createElement(AP,{label:i("details.field.type")},cT.createElement(CA,{data:h,contentFn:t=>Tw(t)?cT.createElement(SA,{key:t,text:i(`data.museovirasto.type.${t}`,t),url:LP(t)}):t})),cT.createElement(AP,{label:i("details.field.subType")},cT.createElement(CA,{data:c,contentFn:t=>cT.createElement(SA,{text:i(`data.museovirasto.subtype.${t}`,t),url:RP(t)})})),cT.createElement(AP,{label:i("data.featureType.Kiinte muinaisjnns")},cT.createElement(CA,{data:p,contentFn:([t,e])=>cT.createElement(SA,{text:t,url:ww(e,n.language)})})),cT.createElement(AP,{label:i("details.field.varkId"),value:String(a)}),t.maisemanMuisti.length>0&&cT.createElement(vA,{feature:t.maisemanMuisti[0]}),cT.createElement(yA,{feature:t}),e.isOpen&&cT.createElement(FP,{models:t.models})))},WA=t=>t?.split(/\r\n/).map((t,e)=>cT.createElement(cT.Fragment,{key:e},t,cT.createElement("br",null))),HA=(t,e,i)=>t===Op.EN?i??e:e??i,UA=({feature:t})=>{const{t:e,i18n:i}=JT(),{Is_Settlement:n,Settlement_From:a,Settlement_To:s,Settlement_DescriptionFI:r,Settlement_DescriptionEN:o}=t.properties;if(n)return cT.createElement(cT.Fragment,null,cT.createElement("h4",null,e("data.viabundus.place.settlement")),(a||s)&&cT.createElement(AP,{label:e("details.field.dating"),value:`${a??""} - ${s??""}`}),cT.createElement(AP,{label:e("details.field.description")},WA(HA(i.language,r,o))))},BA=({feature:t})=>{const{t:e,i18n:i}=JT(),{Is_Town:n,Town_From:a,Town_To:s,Town_DescriptionFI:r,Town_DescriptionEN:o,population:l}=t.properties;if(n)return cT.createElement(cT.Fragment,null,cT.createElement("h4",null,e("data.viabundus.place.town")),(a||s)&&cT.createElement(AP,{label:e("details.field.dating"),value:`${a??""} - ${s??""}`}),l&&cT.createElement(AP,{label:e("details.field.asukasluku")},cT.createElement("table",{className:"table"},cT.createElement("thead",null,cT.createElement("tr",null,cT.createElement("th",null,e("data.viabundus.population.year")),cT.createElement("th",null,e("data.viabundus.population.inhabitants")))),cT.createElement("tbody",null,l.map(({year:t,inhabitants:e},i)=>cT.createElement("tr",{key:i},cT.createElement("td",null,t),cT.createElement("td",null,0===e?"<1000":`${e}000`)))))),cT.createElement(AP,{label:e("details.field.description")},WA(HA(i.language,r,o))))},VA=({feature:t})=>{const{t:e,i18n:i}=JT(),{Is_Bridge:n,Bridge_From:a,Bridge_To:s,Bridge_DescriptionFI:r,Bridge_DescriptionEN:o,Bridge_Literature:l}=t.properties;if(n)return cT.createElement(cT.Fragment,null,cT.createElement("h4",null,e("data.viabundus.place.bridge")),(a||s)&&cT.createElement(AP,{label:e("details.field.dating"),value:`${a??""} - ${s??""}`}),cT.createElement(AP,{label:e("details.field.description")},WA(HA(i.language,r,o))),l&&l.length>0&&cT.createElement(AP,{label:e("details.field.lhteet")},cT.createElement("ul",null,l.map((t,e)=>cT.createElement("li",{key:e},cT.createElement("cite",null,t))))))},KA=({feature:t})=>{const{t:e,i18n:i}=JT(),{Is_Fair:n,Fair_From:a,Fair_To:s,Fair_DescriptionFI:r,Fair_DescriptionEN:o,Fair_Literature:l,fairs:u}=t.properties;if(n)return cT.createElement(cT.Fragment,null,cT.createElement("h4",null,e("data.viabundus.place.fair")),(a||s)&&cT.createElement(AP,{label:e("details.field.dating"),value:`${a??""} - ${s??""}`}),cT.createElement(AP,{label:e("details.field.description")},WA(HA(i.language,r,o))),u&&u.length>0&&cT.createElement(AP,{label:e("details.field.markkinapivt")},cT.createElement("ul",null,u.map((t,e)=>cT.createElement("li",{key:e},cT.createElement("b",null,t.name,":"),cT.createElement("p",null,HA(i.language,r,t.descriptionEN)))))),l&&l.length>0&&cT.createElement(AP,{label:e("details.field.lhteet")},cT.createElement("ul",null,l.map((t,e)=>cT.createElement("li",{key:e},cT.createElement("cite",null,t))))))},zA=({feature:t})=>{const{t:e,i18n:i}=JT(),{Is_Toll:n,Toll_From:a,Toll_To:s,Toll_DescriptionFI:r,Toll_DescriptionEN:o,Toll_Literature:l}=t.properties;if(n)return cT.createElement(cT.Fragment,null,cT.createElement("h4",null,e("data.viabundus.place.toll")),(a||s)&&cT.createElement(AP,{label:e("details.field.dating"),value:`${a??""} - ${s??""}`}),cT.createElement(AP,{label:e("details.field.description")},WA(HA(i.language,r,o))),l&&l.length>0&&cT.createElement(AP,{label:e("details.field.lhteet")},cT.createElement("ul",null,l.map((t,e)=>cT.createElement("li",{key:e},cT.createElement("cite",null,t))))))},$A=({feature:t})=>{const{t:e,i18n:i}=JT(),{Is_Ferry:n,Ferry_From:a,Ferry_To:s,Ferry_DescriptionFI:r,Ferry_DescriptionEN:o,Ferry_Literature:l}=t.properties;if(n)return cT.createElement(cT.Fragment,null,cT.createElement("h4",null,e("data.viabundus.place.ferry")),(a||s)&&cT.createElement(AP,{label:e("details.field.dating"),value:`${a??""} - ${s??""}`}),cT.createElement(AP,{label:e("details.field.description")},WA(HA(i.language,r,o))),l&&l.length>0&&cT.createElement(AP,{label:e("details.field.lhteet")},cT.createElement("ul",null,l.map((t,e)=>cT.createElement("li",{key:e},cT.createElement("cite",null,t))))))},YA=({feature:t})=>{const{t:e}=JT(),{Is_Harbour:i,Harbour_From:n,Harbour_To:a,Harbour_DescriptionFI:s}=t.properties;if(i)return cT.createElement(cT.Fragment,null,cT.createElement("h4",null,e("data.viabundus.place.harbour")),(n||a)&&cT.createElement(AP,{label:e("details.field.dating"),value:`${n??""} - ${a??""}`}),cT.createElement(AP,{label:e("details.field.description"),value:s}))},XA=({feature:t})=>{const{t:e}=JT(),{Node_Literature:i}=t.properties;if(i&&0!==i.length)return cT.createElement(cT.Fragment,null,cT.createElement("h4",null,e("details.field.yleisetLhteet")),cT.createElement(AP,{label:e("details.field.lhteet")},cT.createElement("ul",null,i.map((t,e)=>cT.createElement("li",{key:e},cT.createElement("cite",null,t))))))},qA=({feature:t,...e})=>{const{t:i}=JT();return cT.createElement(dA,{feature:t,...e},cT.createElement(FI,null,cT.createElement(AP,{label:i("details.field.name"),value:t.properties.name,suffixColum:cT.createElement(pA,{feature:t})}),cT.createElement(UA,{feature:t}),cT.createElement(BA,{feature:t}),cT.createElement(VA,{feature:t}),cT.createElement(KA,{feature:t}),cT.createElement(zA,{feature:t}),cT.createElement($A,{feature:t}),cT.createElement(YA,{feature:t}),cT.createElement(XA,{feature:t})))},ZA=({feature:t,...e})=>{const{t:i,i18n:n}=JT(),{fromyear:a,toyear:s,descriptionFI:r,descriptionEN:o,certainty:l,literature:u}=t.properties;return cT.createElement(dA,{feature:t,...e},cT.createElement(FI,null,(a||s)&&cT.createElement(AP,{label:i("details.field.dating"),value:`${a??""} - ${s??""}`,suffixColum:cT.createElement(pA,{feature:t})}),cT.createElement(AP,{label:i("details.field.rekonstruktiotarkkuus"),value:i(`data.viabundus.roadCertainty.${l}`)}),cT.createElement(AP,{label:i("details.field.description")},(h=n.language===Op.EN?o??r:r??o,h?.split(/\r\n/).map((t,e)=>cT.createElement(cT.Fragment,{key:e},t,cT.createElement("br",null))))),u&&u.length>0&&cT.createElement(AP,{label:i("details.field.lhteet")},cT.createElement("ul",null,u.map((t,e)=>cT.createElement("li",{key:e},cT.createElement("cite",null,t)))))));var h},JA=({feature:t,...e})=>{const{t:i}=JT(),{name:n,fromyear:a,toyear:s}=t.properties;return cT.createElement(dA,{feature:t,...e},cT.createElement(FI,null,cT.createElement(AP,{label:i("details.field.name"),value:n,suffixColum:cT.createElement(pA,{feature:t})}),(a||s)&&cT.createElement(AP,{label:i("details.field.dating"),value:`${a??""} - ${s??""}`})))},QA=t=>{const e=bw(t),i=xw(t),n=(t=>{if(Zp(t)){if(Cm(t)||lm(t)||um(t)||hm(t)||dm(t)||cm(t)||om(t)||rm(t))return String(t.properties.OBJECTID);if(pm(t)||mm(t))return String(t.properties.VARK_ID);if(r_(t)||o_(t)||l_(t))return String(t.properties.id);if(qp(t))return String(t.properties.number);if(Om(t)||Fm(t))return`${t.properties.type}-${t.properties.id}`;if(Nm(t))return`${t.properties.type}-${t.properties.nodesid}`}else if(Zf(t))return String(t.attributes.OBJECTID);throw new Error(`Tuntematon feature: ${JSON.stringify(t)}`)})(t);return{feature:t,featureLayer:e,featureRegisterId:i,featureUniqueLayerId:n,panelId:`${e}-${i}-${n}`}},tj=({titleClickAction:t,features:e=[],models:i=[]})=>{const[n,a]=(0,cT.useState)(),s=_S(t=>t.linkedFeature),r=(0,cT.useCallback)(t=>a(n===t?"":t),[n,a]),o=(0,cT.useMemo)(()=>e.map(QA),[e]),l=(0,cT.useMemo)(()=>s?o.find(({featureLayer:t,featureRegisterId:e})=>t===s?.layer&&e===s.id):void 0,[s,o]);(0,cT.useEffect)(()=>{if(l)a(l.panelId);else if(1===e.length){const{panelId:t}=QA(e[0]);a(t)}});const u=({featureLayer:e,featureRegisterId:i,featureUniqueLayerId:a,panelId:s})=>({titleClickAction:t,isOpen:n===s,panelId:s,onToggleOpen:()=>r(s),openPanelId:n,featureLayer:e,featureRegisterId:i,featureUniqueLayerId:a,isLinkedFeature:l?.panelId===s});return cT.createElement(CP,{activeKey:n},o.map(t=>{const{feature:e,panelId:n}=t,a={key:n,...u(t)};if(Zp(e)){if(Lm(e))return cT.createElement(LA,{feature:e,...a});if(Rm(e))return cT.createElement(TA,{feature:e,...a});if(lm(e)||um(e)||hm(e))return cT.createElement(RA,{feature:e,...a});if(dm(e)||cm(e))return cT.createElement(kA,{feature:e,...a});if(om(e)||rm(e))return cT.createElement(IA,{feature:e,...a});if(r_(e))return cT.createElement(GA,{feature:e,...a});if(o_(e))return cT.createElement(FA,{feature:e,...a});if(l_(e))return cT.createElement(NA,{feature:e,...a});if(pm(e)||mm(e))return cT.createElement(DA,{feature:e,...a});if(qp(e))return cT.createElement(MA,{feature:e,...a,models:i?i.filter(t=>t.properties.registryItem.type===Up.Muinaisjaannokset_piste).filter(t=>t.properties.registryItem.id===e.properties.id):[]});if(Om(e))return cT.createElement(qA,{feature:e,...a});if(Fm(e))return cT.createElement(ZA,{feature:e,...a});if(Nm(e))return cT.createElement(JA,{feature:e,...a})}if(Zf(e))switch(e.layerName){case Bp.Fornminnen:return cT.createElement(fA,{feature:e,...a});case Bp.MaritimaFornminnen:return cT.createElement(gA,{feature:e,...a})}}))},ej=new WeakMap,ij=(t,e)=>{if(!t||!e)return;const i=ej.get(e)||new Map;ej.set(e,i);let n=i.get(t);return n||(n=e.matchMedia(t),n.refCount=0,i.set(n.media,n)),n};function nj(t,e=("undefined"==typeof window?void 0:window)){const i=ij(t,e),[n,a]=(0,cT.useState)(()=>!!i&&i.matches);return ER(()=>{let i=ij(t,e);if(!i)return a(!1);let n=ej.get(e);const s=()=>{a(i.matches)};return i.refCount++,i.addListener(s),s(),()=>{i.removeListener(s),i.refCount--,i.refCount<=0&&(null==n||n.delete(i.media)),i=void 0}},[t]),n}const aj=function(t){const e=Object.keys(t);function i(t,e){return t===e?e:t?`${t} and ${e}`:e}return function(n,a,s){let r;"object"==typeof n?(r=n,s=a,a=!0):(a=a||!0,r={[n]:a});let o=(0,cT.useMemo)(()=>Object.entries(r).reduce((n,[a,s])=>("up"!==s&&!0!==s||(n=i(n,function(e){let i=t[e];return"number"==typeof i&&(i=`${i}px`),`(min-width: ${i})`}(a))),"down"!==s&&!0!==s||(n=i(n,function(i){const n=function(t){return e[Math.min(e.indexOf(t)+1,e.length-1)]}(i);let a=t[n];return a="number"==typeof a?a-.2+"px":`calc(${a} - 0.2px)`,`(max-width: ${a})`}(a))),n),""),[JSON.stringify(r)]);return nj(o,s)}}({xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1400}),sj=aj;function rj(t){void 0===t&&(t=JL());try{var e=t.activeElement;return e&&e.nodeName?e:null}catch(e){return t.body}}function oj(t){return`data-rr-ui-${t}`}const lj=oj("modal-open"),uj=class{constructor({ownerDocument:t,handleContainerOverflow:e=!0,isRTL:i=!1}={}){this.handleContainerOverflow=e,this.isRTL=i,this.modals=[],this.ownerDocument=t}getScrollbarWidth(){return function(t=document){const e=t.defaultView;return Math.abs(e.innerWidth-t.documentElement.clientWidth)}(this.ownerDocument)}getElement(){return(this.ownerDocument||document).body}setModalAttributes(t){}removeModalAttributes(t){}setContainerStyle(t){const e={overflow:"hidden"},i=this.isRTL?"paddingLeft":"paddingRight",n=this.getElement();t.style={overflow:n.style.overflow,[i]:n.style[i]},t.scrollBarWidth&&(e[i]=`${parseInt(UR(n,i)||"0",10)+t.scrollBarWidth}px`),n.setAttribute(lj,""),UR(n,e)}reset(){[...this.modals].forEach(t=>this.remove(t))}removeContainerStyle(t){const e=this.getElement();e.removeAttribute(lj),Object.assign(e.style,t.style)}add(t){let e=this.modals.indexOf(t);return-1!==e||(e=this.modals.length,this.modals.push(t),this.setModalAttributes(t),0!==e||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state))),e}remove(t){const e=this.modals.indexOf(t);-1!==e&&(this.modals.splice(e,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(t))}isTopModal(t){return!!this.modals.length&&this.modals[this.modals.length-1]===t}},hj=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];let cj;const dj=(0,cT.forwardRef)((t,e)=>{let{show:i=!1,role:n="dialog",className:a,style:s,children:r,backdrop:o=!0,keyboard:l=!0,onBackdropClick:u,onEscapeKeyDown:h,transition:c,runTransition:d,backdropTransition:p,runBackdropTransition:m,autoFocus:f=!0,enforceFocus:g=!0,restoreFocus:_=!0,restoreFocusOptions:y,renderDialog:k,renderBackdrop:v=t=>(0,MS.jsx)("div",Object.assign({},t)),manager:x,container:w,onShow:b,onHide:E=()=>{},onExit:M,onExited:T,onExiting:S,onEnter:C,onEntering:L,onEntered:R}=t,I=function(t,e){if(null==t)return{};var i={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;i[n]=t[n]}return i}(t,hj);const P=rR(),A=lR(w),j=function(t){const e=rR(),i=t||function(t){return cj||(cj=new uj({ownerDocument:null==t?void 0:t.document})),cj}(e),n=(0,cT.useRef)({dialog:null,backdrop:null});return Object.assign(n.current,{add:()=>i.add(n.current),remove:()=>i.remove(n.current),isTopModal:()=>i.isTopModal(n.current),setDialogRef:(0,cT.useCallback)(t=>{n.current.dialog=t},[]),setBackdropRef:(0,cT.useCallback)(t=>{n.current.backdrop=t},[])})}(x),O=SC(),F=zI(i),[N,G]=(0,cT.useState)(!i),D=(0,cT.useRef)(null);(0,cT.useImperativeHandle)(e,()=>j,[j]),zL&&!F&&i&&(D.current=rj(null==P?void 0:P.document)),i&&N&&G(!1);const W=QL(()=>{if(j.add(),z.current=ZL(document,"keydown",V),K.current=ZL(document,"focus",()=>setTimeout(U),!0),b&&b(),f){var t,e;const i=rj(null!=(t=null==(e=j.dialog)?void 0:e.ownerDocument)?t:null==P?void 0:P.document);j.dialog&&i&&!iC(j.dialog,i)&&(D.current=i,j.dialog.focus())}}),H=QL(()=>{var t;j.remove(),null==z.current||z.current(),null==K.current||K.current(),_&&(null==(t=D.current)||null==t.focus||t.focus(y),D.current=null)});(0,cT.useEffect)(()=>{i&&A&&W()},[i,A,W]),(0,cT.useEffect)(()=>{N&&H()},[N,H]),function(t){const e=function(t){const e=(0,cT.useRef)(t);return e.current=t,e}(t);(0,cT.useEffect)(()=>()=>e.current(),[])}(()=>{H()});const U=QL(()=>{if(!g||!O()||!j.isTopModal())return;const t=rj(null==P?void 0:P.document);j.dialog&&t&&!iC(j.dialog,t)&&j.dialog.focus()}),B=QL(t=>{t.target===t.currentTarget&&(null==u||u(t),!0===o&&E())}),V=QL(t=>{l&&yC(t)&&j.isTopModal()&&(null==h||h(t),t.defaultPrevented||E())}),K=(0,cT.useRef)(),z=(0,cT.useRef)();if(!A)return null;const $=Object.assign({role:n,ref:j.setDialogRef,"aria-modal":"dialog"===n||void 0},I,{style:s,className:a,tabIndex:-1});let Y=k?k($):(0,MS.jsx)("div",Object.assign({},$,{children:cT.cloneElement(r,{role:"document"})}));Y=kR(c,d,{unmountOnExit:!0,mountOnEnter:!0,appear:!0,in:!!i,onExit:M,onExiting:S,onExited:(...t)=>{G(!0),null==T||T(...t)},onEnter:C,onEntering:L,onEntered:R,children:Y});let X=null;return o&&(X=v({ref:j.setBackdropRef,onClick:B}),X=kR(p,m,{in:!!i,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:X})),(0,MS.jsx)(MS.Fragment,{children:vC.createPortal((0,MS.jsxs)(MS.Fragment,{children:[X,Y]}),A)})});dj.displayName="Modal";const pj=Object.assign(dj,{Manager:uj}),mj=cT.forwardRef(({className:t,bsPrefix:e,as:i="div",...n},a)=>(e=RS(e,"offcanvas-body"),(0,MS.jsx)(i,{ref:a,className:ES()(t,e),...n})));mj.displayName="OffcanvasBody";const fj=mj,gj={[PR]:"show",[AR]:"show"},_j=cT.forwardRef(({bsPrefix:t,className:e,children:i,in:n=!1,mountOnEnter:a=!1,unmountOnExit:s=!1,appear:r=!1,...o},l)=>(t=RS(t,"offcanvas"),(0,MS.jsx)(XR,{ref:l,addEndListener:KR,in:n,mountOnEnter:a,unmountOnExit:s,appear:r,...o,childRef:kC(i),children:(n,a)=>cT.cloneElement(i,{...a,className:ES()(e,i.props.className,(n===PR||n===jR)&&`${t}-toggling`,gj[n])})})));_j.displayName="OffcanvasToggling";const yj=_j,kj=cT.createContext({onHide(){}}),vj=cT.forwardRef(({closeLabel:t="Close",closeVariant:e,closeButton:i=!1,onHide:n,children:a,...s},r)=>{const o=(0,cT.useContext)(kj),l=wR(()=>{null==o||o.onHide(),null==n||n()});return(0,MS.jsxs)("div",{ref:r,...s,children:[a,i&&(0,MS.jsx)(tP,{"aria-label":t,variant:e,onClick:l})]})});vj.displayName="AbstractModalHeader";const xj=vj,wj=cT.forwardRef(({bsPrefix:t,className:e,closeLabel:i="Close",closeButton:n=!1,...a},s)=>(t=RS(t,"offcanvas-header"),(0,MS.jsx)(xj,{ref:s,...a,className:ES()(e,t),closeLabel:i,closeButton:n})));wj.displayName="OffcanvasHeader";const bj=wj,Ej=UI("h5"),Mj=cT.forwardRef(({className:t,bsPrefix:e,as:i=Ej,...n},a)=>(e=RS(e,"offcanvas-title"),(0,MS.jsx)(i,{ref:a,className:ES()(t,e),...n})));Mj.displayName="OffcanvasTitle";const Tj=Mj;var Sj=Function.prototype.bind.call(Function.prototype.call,[].slice);function Cj(t,e){return Sj(t.querySelectorAll(e))}function Lj(t,e){return t.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}const Rj=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Ij=".sticky-top",Pj=".navbar-toggler";class Aj extends uj{adjustAndStore(t,e,i){const n=e.style[t];e.dataset[t]=n,UR(e,{[t]:`${parseFloat(UR(e,t))+i}px`})}restore(t,e){const i=e.dataset[t];void 0!==i&&(delete e.dataset[t],UR(e,{[t]:i}))}setContainerStyle(t){super.setContainerStyle(t);const e=this.getElement();var i,n;if(n="modal-open",(i=e).classList?i.classList.add(n):MR(i,n)||("string"==typeof i.className?i.className=i.className+" "+n:i.setAttribute("class",(i.className&&i.className.baseVal||"")+" "+n)),!t.scrollBarWidth)return;const a=this.isRTL?"paddingLeft":"paddingRight",s=this.isRTL?"marginLeft":"marginRight";Cj(e,Rj).forEach(e=>this.adjustAndStore(a,e,t.scrollBarWidth)),Cj(e,Ij).forEach(e=>this.adjustAndStore(s,e,-t.scrollBarWidth)),Cj(e,Pj).forEach(e=>this.adjustAndStore(s,e,t.scrollBarWidth))}removeContainerStyle(t){super.removeContainerStyle(t);const e=this.getElement();var i,n;n="modal-open",(i=e).classList?i.classList.remove(n):"string"==typeof i.className?i.className=Lj(i.className,n):i.setAttribute("class",Lj(i.className&&i.className.baseVal||"",n));const a=this.isRTL?"paddingLeft":"paddingRight",s=this.isRTL?"marginLeft":"marginRight";Cj(e,Rj).forEach(t=>this.restore(a,t)),Cj(e,Ij).forEach(t=>this.restore(s,t)),Cj(e,Pj).forEach(t=>this.restore(s,t))}}let jj;const Oj=Aj;function Fj(t){return(0,MS.jsx)(yj,{...t})}function Nj(t){return(0,MS.jsx)(JR,{...t})}const Gj=cT.forwardRef(({bsPrefix:t,className:e,children:i,"aria-labelledby":n,placement:a="start",responsive:s,show:r=!1,backdrop:o=!0,keyboard:l=!0,scroll:u=!1,onEscapeKeyDown:h,onShow:c,onHide:d,container:p,autoFocus:m=!0,enforceFocus:f=!0,restoreFocus:g=!0,restoreFocusOptions:_,onEntered:y,onExit:k,onExiting:v,onEnter:x,onEntering:w,onExited:b,backdropClassName:E,manager:M,renderStaticNode:T=!1,...S},C)=>{const L=(0,cT.useRef)();t=RS(t,"offcanvas");const[R,I]=(0,cT.useState)(!1),P=wR(d),A=sj(s||"xs","up");(0,cT.useEffect)(()=>{I(s?r&&!A:r)},[r,s,A]);const j=(0,cT.useMemo)(()=>({onHide:P}),[P]),O=(0,cT.useCallback)(e=>(0,MS.jsx)("div",{...e,className:ES()(`${t}-backdrop`,E)}),[E,t]),F=r=>(0,MS.jsx)("div",{...r,...S,className:ES()(e,s?`${t}-${s}`:t,`${t}-${a}`),"aria-labelledby":n,children:i});return(0,MS.jsxs)(MS.Fragment,{children:[!R&&(s||T)&&F({}),(0,MS.jsx)(kj.Provider,{value:j,children:(0,MS.jsx)(pj,{show:R,ref:C,backdrop:o,container:p,keyboard:l,autoFocus:m,enforceFocus:f&&!u,restoreFocus:g,restoreFocusOptions:_,onEscapeKeyDown:h,onShow:c,onHide:P,onEnter:(t,...e)=>{t&&(t.style.visibility="visible"),null==x||x(t,...e)},onEntering:w,onEntered:y,onExit:k,onExiting:v,onExited:(t,...e)=>{t&&(t.style.visibility=""),null==b||b(...e)},manager:M||(u?(L.current||(L.current=new Oj({handleContainerOverflow:!1})),L.current):(jj||(jj=new Aj(void 0)),jj)),transition:Fj,backdropTransition:Nj,renderBackdrop:O,renderDialog:F})})]})});Gj.displayName="Offcanvas";const Dj=Object.assign(Gj,{Body:fj,Header:bj,Title:Tj});const Wj=cT.createContext(null),Hj=["children","usePopper"],Uj=()=>{};function Bj(t={}){const e=(0,cT.useContext)(Wj),[i,n]=xC(),a=(0,cT.useRef)(!1),{flip:s,offset:r,rootCloseEvent:o,fixed:l=!1,placement:u,popperConfig:h={},enableEventListeners:c=!0,usePopper:d=!!e}=t,p=null==(null==e?void 0:e.show)?!!t.show:e.show;p&&!a.current&&(a.current=!0);const{placement:m,setMenu:f,menuElement:g,toggleElement:_}=e||{},y=KL(_,g,hR({placement:u||m||"bottom-start",enabled:d,enableEvents:null==c?p:c,offset:r,flip:s,fixed:l,arrowElement:i,popperConfig:h})),k=Object.assign({ref:f||Uj,"aria-labelledby":null==_?void 0:_.id},y.attributes.popper,{style:y.styles.popper}),v={show:p,placement:m,hasShown:a.current,toggle:null==e?void 0:e.toggle,popper:d?y:null,arrowProps:d?Object.assign({ref:n},y.attributes.arrow,{style:y.styles.arrow}):{}};return nR(g,t=>{null==e||e.toggle(!1,t)},{clickTrigger:o,disabled:!p}),[k,v]}function Vj(t){let{children:e,usePopper:i=!0}=t,n=function(t,e){if(null==t)return{};var i={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;i[n]=t[n]}return i}(t,Hj);const[a,s]=Bj(Object.assign({},n,{usePopper:i}));return(0,MS.jsx)(MS.Fragment,{children:e(a,s)})}Vj.displayName="DropdownMenu";const Kj=Vj,zj={prefix:String(Math.round(1e10*Math.random())),current:0},$j=cT.createContext(zj),Yj=cT.createContext(!1);Boolean("undefined"!=typeof window&&window.document&&window.document.createElement);let Xj=new WeakMap;const qj="function"==typeof cT.useId?function(t){let e=cT.useId(),[i]=(0,cT.useState)("function"==typeof cT.useSyncExternalStore?cT.useSyncExternalStore(Qj,Zj,Jj):(0,cT.useContext)(Yj));return t||`${i?"react-aria":`react-aria${zj.prefix}`}-${e}`}:function(t){let e=(0,cT.useContext)($j),i=function(t=!1){let e=(0,cT.useContext)($j),i=(0,cT.useRef)(null);if(null===i.current&&!t){var n,a;let t=null===(a=cT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED)||void 0===a||null===(n=a.ReactCurrentOwner)||void 0===n?void 0:n.current;if(t){let i=Xj.get(t);null==i?Xj.set(t,{id:e.current,state:t.memoizedState}):t.memoizedState!==i.state&&(e.current=i.id,Xj.delete(t))}i.current=++e.current}return i.current}(!!t),n=`react-aria${e.prefix}`;return t||`${n}-${i}`};function Zj(){return!1}function Jj(){return!0}function Qj(t){return()=>{}}const tO=t=>{var e;return"menu"===(null==(e=t.getAttribute("role"))?void 0:e.toLowerCase())},eO=()=>{};function iO(){const t=qj(),{show:e=!1,toggle:i=eO,setToggle:n,menuElement:a}=(0,cT.useContext)(Wj)||{},s=(0,cT.useCallback)(t=>{i(!e,t)},[e,i]),r={id:t,ref:n||eO,onClick:s,"aria-expanded":!!e};return a&&tO(a)&&(r["aria-haspopup"]=!0),[r,{show:e,toggle:i}]}function nO({children:t}){const[e,i]=iO();return(0,MS.jsx)(MS.Fragment,{children:t(e,i)})}nO.displayName="DropdownToggle";const aO=nO,sO=(t,e=null)=>null!=t?String(t):e||null,rO=cT.createContext(null),oO=cT.createContext(null);oO.displayName="NavContext";const lO=oO,uO=["eventKey","disabled","onClick","active","as"];function hO({key:t,href:e,active:i,disabled:n,onClick:a}){const s=(0,cT.useContext)(rO),r=(0,cT.useContext)(lO),{activeKey:o}=r||{},l=sO(t,e),u=null==i&&null!=t?sO(o)===l:i;return[{onClick:QL(t=>{n||(null==a||a(t),s&&!t.isPropagationStopped()&&s(l,t))}),"aria-disabled":n||void 0,"aria-selected":u,[oj("dropdown-item")]:""},{isActive:u}]}const cO=cT.forwardRef((t,e)=>{let{eventKey:i,disabled:n,onClick:a,active:s,as:r=WS}=t,o=function(t,e){if(null==t)return{};var i={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;i[n]=t[n]}return i}(t,uO);const[l]=hO({key:i,href:o.href,disabled:n,onClick:a,active:s});return(0,MS.jsx)(r,Object.assign({},o,{ref:e},l))});cO.displayName="DropdownItem";const dO=cO;function pO(){const t=function(){const[,t]=(0,cT.useReducer)(t=>t+1,0);return t}(),e=(0,cT.useRef)(null),i=(0,cT.useCallback)(i=>{e.current=i,t()},[t]);return[e,i]}function mO({defaultShow:t,show:e,onSelect:i,onToggle:n,itemSelector:a=`* [${oj("dropdown-item")}]`,focusFirstItemOnShow:s,placement:r="bottom-start",children:o}){const l=rR(),[u,h]=function(t,e,i){const n=(0,cT.useRef)(void 0!==t),[a,s]=(0,cT.useState)(e),r=void 0!==t,o=n.current;return n.current=r,!r&&o&&a!==e&&s(e),[r?t:a,(0,cT.useCallback)((...t)=>{const[e,...n]=t;let a=null==i?void 0:i(e,...n);return s(e),a},[i])]}(e,t,n),[c,d]=pO(),p=c.current,[m,f]=pO(),g=m.current,_=zI(u),y=(0,cT.useRef)(null),k=(0,cT.useRef)(!1),v=(0,cT.useContext)(rO),x=(0,cT.useCallback)((t,e,i=(null==e?void 0:e.type))=>{h(t,{originalEvent:e,source:i})},[h]),w=QL((t,e)=>{null==i||i(t,e),x(!1,e,"select"),e.isPropagationStopped()||null==v||v(t,e)}),b=(0,cT.useMemo)(()=>({toggle:x,placement:r,show:u,menuElement:p,toggleElement:g,setMenu:d,setToggle:f}),[x,r,u,p,g,d,f]);p&&_&&!u&&(k.current=p.contains(p.ownerDocument.activeElement));const E=QL(()=>{g&&g.focus&&g.focus()}),M=QL(()=>{const t=y.current;let e=s;if(null==e&&(e=!(!c.current||!tO(c.current))&&"keyboard"),!1===e||"keyboard"===e&&!/^key.+$/.test(t))return;const i=Cj(c.current,a)[0];i&&i.focus&&i.focus()});(0,cT.useEffect)(()=>{u?M():k.current&&(k.current=!1,E())},[u,k,E,M]),(0,cT.useEffect)(()=>{y.current=null});const T=(t,e)=>{if(!c.current)return null;const i=Cj(c.current,a);let n=i.indexOf(t)+e;return n=Math.max(0,Math.min(n,i.length)),i[n]};return function(t,e,i,n=!1){const a=QL(i);(0,cT.useEffect)(()=>{const i="function"==typeof t?t():t;return i.addEventListener(e,a,n),()=>i.removeEventListener(e,a,n)},[t])}((0,cT.useCallback)(()=>l.document,[l]),"keydown",t=>{var e,i;const{key:n}=t,a=t.target,s=null==(e=c.current)?void 0:e.contains(a),r=null==(i=m.current)?void 0:i.contains(a);if(/input|textarea/i.test(a.tagName)&&(" "===n||"Escape"!==n&&s||"Escape"===n&&"search"===a.type))return;if(!s&&!r)return;if(!("Tab"!==n||c.current&&u))return;y.current=t.type;const o={originalEvent:t,source:t.type};switch(n){case"ArrowUp":{const e=T(a,-1);return e&&e.focus&&e.focus(),void t.preventDefault()}case"ArrowDown":if(t.preventDefault(),u){const t=T(a,1);t&&t.focus&&t.focus()}else h(!0,o);return;case"Tab":qL(a.ownerDocument,"keyup",t=>{var e;("Tab"!==t.key||t.target)&&null!=(e=c.current)&&e.contains(t.target)||h(!1,o)},{once:!0});break;case"Escape":"Escape"===n&&(t.preventDefault(),t.stopPropagation()),h(!1,o)}}),(0,MS.jsx)(rO.Provider,{value:w,children:(0,MS.jsx)(Wj.Provider,{value:b,children:o})})}mO.displayName="Dropdown",mO.Menu=Kj,mO.Toggle=aO,mO.Item=dO;const fO=mO,gO=cT.createContext({});gO.displayName="DropdownContext";const _O=gO,yO=cT.forwardRef(({className:t,bsPrefix:e,as:i="hr",role:n="separator",...a},s)=>(e=RS(e,"dropdown-divider"),(0,MS.jsx)(i,{ref:s,className:ES()(t,e),role:n,...a})));yO.displayName="DropdownDivider";const kO=yO,vO=cT.forwardRef(({className:t,bsPrefix:e,as:i="div",role:n="heading",...a},s)=>(e=RS(e,"dropdown-header"),(0,MS.jsx)(i,{ref:s,className:ES()(t,e),role:n,...a})));vO.displayName="DropdownHeader";const xO=vO,wO=cT.forwardRef(({bsPrefix:t,className:e,eventKey:i,disabled:n=!1,onClick:a,active:s,as:r=XI,...o},l)=>{const u=RS(t,"dropdown-item"),[h,c]=hO({key:i,href:o.href,disabled:n,onClick:a,active:s});return(0,MS.jsx)(r,{...o,...h,ref:l,className:ES()(e,u,c.isActive&&"active",n&&"disabled")})});wO.displayName="DropdownItem";const bO=wO,EO=cT.forwardRef(({className:t,bsPrefix:e,as:i="span",...n},a)=>(e=RS(e,"dropdown-item-text"),(0,MS.jsx)(i,{ref:a,className:ES()(t,e),...n})));EO.displayName="DropdownItemText";const MO=EO,TO=cT.createContext(null);TO.displayName="InputGroupContext";const SO=TO,CO=cT.createContext(null);CO.displayName="NavbarContext";const LO=CO;function RO(t,e){return t}function IO(t,e,i){let n=t?i?"bottom-start":"bottom-end":i?"bottom-end":"bottom-start";return"up"===e?n=t?i?"top-start":"top-end":i?"top-end":"top-start":"end"===e?n=t?i?"left-end":"right-end":i?"left-start":"right-start":"start"===e?n=t?i?"right-end":"left-end":i?"right-start":"left-start":"down-centered"===e?n="bottom":"up-centered"===e&&(n="top"),n}const PO=cT.forwardRef(({bsPrefix:t,className:e,align:i,rootCloseEvent:n,flip:a=!0,show:s,renderOnMount:r,as:o="div",popperConfig:l,variant:u,...h},c)=>{let d=!1;const p=(0,cT.useContext)(LO),m=RS(t,"dropdown-menu"),{align:f,drop:g,isRTL:_}=(0,cT.useContext)(_O);i=i||f;const y=(0,cT.useContext)(SO),k=[];if(i)if("object"==typeof i){const t=Object.keys(i);if(t.length){const e=t[0],n=i[e];d="start"===n,k.push(`${m}-${e}-${n}`)}}else"end"===i&&(d=!0);const v=IO(d,g,_),[x,{hasShown:w,popper:b,show:E,toggle:M}]=Bj({flip:a,rootCloseEvent:n,show:s,usePopper:!p&&0===k.length,offset:[0,2],popperConfig:l,placement:v});if(x.ref=_C(RO(c),x.ref),ER(()=>{E&&(null==b||b.update())},[E]),!w&&!r&&!y)return null;"string"!=typeof o&&(x.show=E,x.close=()=>null==M?void 0:M(!1),x.align=i);let T=h.style;return null!=b&&b.placement&&(T={...h.style,...x.style},h["x-placement"]=b.placement),(0,MS.jsx)(o,{...h,...x,style:T,...(k.length||p)&&{"data-bs-popper":"static"},className:ES()(e,m,E&&"show",d&&`${m}-end`,u&&`${m}-${u}`,...k)})});PO.displayName="DropdownMenu";const AO=PO,jO=cT.forwardRef(({bsPrefix:t,split:e,className:i,childBsPrefix:n,as:a=US,...s},r)=>{const o=RS(t,"dropdown-toggle"),l=(0,cT.useContext)(Wj);void 0!==n&&(s.bsPrefix=n);const[u]=iO();return u.ref=_C(u.ref,RO(r)),(0,MS.jsx)(a,{className:ES()(i,o,e&&`${o}-split`,(null==l?void 0:l.show)&&"show"),...u,...s})});jO.displayName="DropdownToggle";const OO=jO,FO=cT.forwardRef((t,e)=>{const{bsPrefix:i,drop:n="down",show:a,className:s,align:r="start",onSelect:o,onToggle:l,focusFirstItemOnShow:u,as:h="div",navbar:c,autoClose:d=!0,...p}=fC(t,{show:"onToggle"}),m=(0,cT.useContext)(SO),f=RS(i,"dropdown"),g=AS(),_=wR((t,e)=>{var i,n;(null==(i=e.originalEvent)||null==(i=i.target)?void 0:i.classList.contains("dropdown-toggle"))&&"mousedown"===e.source||(e.originalEvent.currentTarget!==document||"keydown"===e.source&&"Escape"!==e.originalEvent.key||(e.source="rootClose"),n=e.source,(!1===d?"click"===n:"inside"===d?"rootClose"!==n:"outside"!==d||"select"!==n)&&(null==l||l(t,e)))}),y=IO("end"===r,n,g),k=(0,cT.useMemo)(()=>({align:r,drop:n,isRTL:g}),[r,n,g]),v={down:f,"down-centered":`${f}-center`,up:"dropup","up-centered":"dropup-center dropup",end:"dropend",start:"dropstart"};return(0,MS.jsx)(_O.Provider,{value:k,children:(0,MS.jsx)(fO,{placement:y,show:a,onSelect:o,onToggle:_,focusFirstItemOnShow:u,itemSelector:`.${f}-item:not(.disabled):not(:disabled)`,children:m?p.children:(0,MS.jsx)(h,{...p,ref:e,className:ES()(s,a&&"show",v[n])})})})});FO.displayName="Dropdown";const NO=Object.assign(FO,{Toggle:OO,Menu:AO,Item:bO,ItemText:MO,Divider:kO,Header:xO}),GO=({title:t})=>{const{t:e,i18n:i}=JT(),n=mS(),a=t=>()=>{i.changeLanguage(t),n({type:Dm.CHANGE_LANGUAGE,language:t})};return cT.createElement(GP,{className:"ps-0"},cT.createElement(PP,null,cT.createElement(xI,{xs:3,className:"text-start"},cT.createElement(NO,null,cT.createElement(NO.Toggle,{variant:"link",title:e("common.button.languageSelection")},i.language.toUpperCase()),cT.createElement(NO.Menu,null,cT.createElement(NO.Item,{as:"button",onClick:a(Op.FI)},"suomeksi (FI)"),cT.createElement(NO.Item,{as:"button",onClick:a(Op.SV)},"p svenska (SV)"),cT.createElement(NO.Item,{as:"button",onClick:a(Op.EN)},"in english (EN)")))),cT.createElement(xI,{xs:7,className:"text-center"},cT.createElement("h5",null,t))))},DO=({title:t,pageId:e,children:i})=>{const n=mS(),a=_S(t=>t.visiblePage),[s,r]=(0,cT.useState)(!1);(0,cT.useEffect)(()=>{r(a===e)},[a,s]);const o=(0,cT.useCallback)(()=>{n({type:Dm.SHOW_PAGE,pageId:void 0})},[n]);return cT.createElement(Dj,{placement:"end",show:s,onHide:o,scroll:!0,backdrop:!1},cT.createElement(Dj.Header,{closeButton:!0},cT.createElement(GO,{title:t})),cT.createElement(Dj.Body,null,cT.createElement(GP,{className:"ps-0 pe-0"},i)))},WO=()=>{const{t}=JT(),e=_S(t=>t.identifiedMapFeatures);return cT.createElement(DO,{title:t("details.title"),pageId:fM.Details},cT.createElement(tj,{titleClickAction:cA.OpenDetails,features:e?.features,models:e?.models}))},HO=()=>{const{t}=JT();return cT.createElement(CP.Item,{eventKey:"info.licences.title"},cT.createElement(CP.Header,{as:"div"},t("info.licences.title")),cT.createElement(CP.Body,null,cT.createElement("h6",null,t("common.organization.Museovirasto")),cT.createElement("p",null,cT.createElement($T,{i18nKey:"info.licences.museovirasto",components:{a:cT.createElement("a",null)}})),cT.createElement("h6",null,t("common.organization.Ahvenanmaan paikallishallinto")),cT.createElement("p",null,cT.createElement($T,{i18nKey:"info.licences.ahvenanmaa",components:{a:cT.createElement("a",null)}})),cT.createElement("h6",null,t("common.organization.Maanmittauslaitos")),cT.createElement("p",null,cT.createElement($T,{i18nKey:"info.licences.maanmittauslaitos",components:{a:cT.createElement("a",null)}})),cT.createElement("p",null,cT.createElement($T,{i18nKey:"info.licences.maanmittauslaitosPaituli",components:{a:cT.createElement("a",null)}})),cT.createElement("h6",null,t("common.organization.Geologian tutkimuskeskus")),cT.createElement("p",null,cT.createElement($T,{i18nKey:"info.licences.gtk",components:{a:cT.createElement("a",null)}})),cT.createElement("h6",null,t("common.organization.Helsingin kaupunki")),cT.createElement("p",null,cT.createElement($T,{i18nKey:"info.licences.helsinki",components:{a:cT.createElement("a",null)}})),cT.createElement("h6",null,t("common.organization.viabundus")),cT.createElement("p",null,cT.createElement($T,{i18nKey:"info.licences.viabundus",components:{a:cT.createElement("a",null)}})),cT.createElement("h6",null,t("common.organization.Maannousu.info")),cT.createElement("p",null,cT.createElement($T,{i18nKey:"info.licences.maannousuInfo",components:{a:cT.createElement("a",null)}})),cT.createElement("h6",null,t("settings.maisemanMuisti.title")),cT.createElement("p",null,cT.createElement($T,{i18nKey:"info.licences.maisemanmuisti",components:{a:cT.createElement("a",null)}})),cT.createElement("h6",null,t("settings.3Dmodels.title")),cT.createElement("p",null,cT.createElement($T,{i18nKey:"info.licences.3DModels",components:{a:cT.createElement("a",null)}})),cT.createElement("p",null,cT.createElement($T,{i18nKey:"info.licences.sourceCode",components:{a:cT.createElement("a",null)}}))))},UO=()=>{const{t}=JT();return cT.createElement(CP.Item,{eventKey:"info.dataUpdates.title"},cT.createElement(CP.Header,{as:"div"},t("info.dataUpdates.title")),cT.createElement(CP.Body,null,cT.createElement($T,{i18nKey:"info.dataUpdates.description"}),cT.createElement("ul",null,cT.createElement("li",null,cT.createElement("b",null,t("common.organization.Maanmittauslaitos"),":")," ",t("info.dataUpdates.mml")),cT.createElement("li",null,cT.createElement("b",null,t("common.organization.Museovirasto"),":")," ",t("info.dataUpdates.museovirasto")),cT.createElement("li",null,cT.createElement("b",null,t("common.organization.Ahvenanmaan paikallishallinto"),":")," ",t("info.dataUpdates.ahvenanmaa")),cT.createElement("li",null,cT.createElement("b",null,t("common.organization.Geologian tutkimuskeskus"),":")," ",t("info.dataUpdates.gtk")),cT.createElement("li",null,cT.createElement("b",null,t("common.organization.Helsingin kaupunki"),":")," ",t("info.dataUpdates.helsinki")),cT.createElement("li",null,cT.createElement("b",null,t("common.organization.viabundus"),":")," ",t("info.dataUpdates.viabundus")),cT.createElement("li",null,cT.createElement("b",null,t("common.organization.Maannousu.info"),":")," ",t("info.dataUpdates.Maannousu.info")))))},BO=()=>{const{t}=JT();return cT.createElement(CP.Item,{eventKey:"info.symbols"},cT.createElement(CP.Header,{as:"div"},t("info.symbols")),cT.createElement(CP.Body,null,cT.createElement("h6",null,cT.createElement($T,{i18nKey:"data.register.nameWithLink.Valtakunnallisesti merkittvt rakennetut kulttuuriympristt",components:{a:cT.createElement("a",null)}})),cT.createElement("div",{className:"mb-3"},cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/rky_piste.png"}),cT.createElement("span",null,t("common.features.Kohde"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/rky_viiva.png"}),cT.createElement("span",null,t("common.features.Viiva"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/rky_alue.png"}),cT.createElement("span",null,t("common.features.Alue")))),cT.createElement("h6",null,cT.createElement($T,{i18nKey:"data.register.nameWithLink.Maailmanperintkohteet",components:{a:cT.createElement("a",null)}})),cT.createElement("div",{className:"mb-3"},cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/maailmanperinto_piste.png"}),cT.createElement("span",null,t("common.features.Kohde"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/maailmanperinto_alue.png"}),cT.createElement("span",null,t("common.features.Alue")))),cT.createElement("h6",null,cT.createElement($T,{i18nKey:"data.register.nameWithLink.Rakennusperintrekisteri",components:{a:cT.createElement("a",null)}})),cT.createElement("div",{className:"mb-3"},cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/rakennusperintorekisteri_rakennus.png"}),cT.createElement("span",null,t("common.features.Rakennus"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/rakennusperintorekisteri_alue.png"}),cT.createElement("span",null,t("common.features.Alue")))),cT.createElement("h6",null,cT.createElement($T,{i18nKey:"data.register.nameWithLink.Muinaisjnnsrekisteri",components:{a:cT.createElement("a",null)}})),cT.createElement("div",{className:"mb-3"},cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/muinaisjaannos_kohde.png"}),cT.createElement("span",null,t("data.featureType.Kiinte muinaisjnns"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/muinaisjaannos_alue.png"}),cT.createElement("span",null,t("data.featureType.Kiinte muinaisjnns (alue)"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/muu_kulttuuriperintokohde_kohde.png"}),cT.createElement("span",null,t("data.featureType.Muu kulttuuriperintkohde"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/muu-kulttuuriperintokohde-alue.png"}),cT.createElement("span",null,t("data.featureType.Muu kulttuuriperintkohde (alue)"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/loytopaikka_piste.png"}),cT.createElement("span",null,t("data.featureType.lytpaikkaPiste"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/loytopaikka_alue.png"}),cT.createElement("span",null,t("data.featureType.lytpaikkaAlue"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/havaintokohde_piste.png"}),cT.createElement("span",null,t("data.featureType.havaintokohdePiste"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/havaintokohde_alue.png"}),cT.createElement("span",null,t("data.featureType.havaintokohdeAlue"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/luonnonmuodostuma_piste.png"}),cT.createElement("span",null,t("data.featureType.luonnonmuodostumaPiste"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/luonnonmuodostuma_alue.png"}),cT.createElement("span",null,t("data.featureType.luonnonmuodostumaAlue"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/muu_kohde_piste.png"}),cT.createElement("span",null,t("data.featureType.muuKohdePiste"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/muu_kohde_alue.png"}),cT.createElement("span",null,t("data.featureType.muuKohdeAlue"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/mahdollinen_muinaisjaannos_piste.png"}),cT.createElement("span",null,t("data.featureType.mahdollinenMuinaisjnnsPiste"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/mahdollinen_muinaisjaannos_alue.png"}),cT.createElement("span",null,t("data.featureType.mahdollinenMuinaisjnnsAlue"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/poistettu_kiintea_muinaisjaannos_piste.png"}),cT.createElement("span",null,t("data.featureType.poistettuKiinteMuijaisjnnsPiste"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/poistettu_kiintea_muinaisjaannos_alue.png"}),cT.createElement("span",null,t("data.featureType.poistettuKiinteMuijaisjnnsAlue"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/alakohde_piste.png"}),cT.createElement("span",null,t("data.featureType.alakohdePiste")))),cT.createElement("h6",null,cT.createElement($T,{i18nKey:"data.register.nameWithLink.vark",components:{a:cT.createElement("a",null)}})),cT.createElement("div",{className:"mb-3"},cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/vark_piste.png"}),cT.createElement("span",null,t("common.features.keskipisteet"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/vark_alue.png"}),cT.createElement("span",null,t("common.features.aluerajaukset")))),cT.createElement("h6",null,cT.createElement($T,{i18nKey:"data.register.nameWithLink.Ahvenanmaan muinaisjnnsrekisteri",components:{a:cT.createElement("a",null)}})),cT.createElement("div",{className:"mb-3"},cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/ahvenanmaa_muinaisjaannos.png"}),cT.createElement("span",null,t("common.features.Kohde")))),cT.createElement("h6",null,cT.createElement($T,{i18nKey:"data.register.nameWithLink.Ahvenanmaan merellinen kulttuuriperintrekisteri",components:{a:cT.createElement("a",null)}})),cT.createElement("div",{className:"mb-3"},cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/ahvenanmaa_hylky.png"}),cT.createElement("span",null,t("common.features.Kohde")))),cT.createElement("h6",null,cT.createElement($T,{i18nKey:"data.register.nameWithLink.maalinnoitus",components:{a:cT.createElement("a",null)}})),cT.createElement("div",{className:"mb-3"},cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/maalinnoitus-asema.png"}),cT.createElement("span",null,t("data.helsinki.feature.asema"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/maalinnoitus-luola.png"}),cT.createElement("span",null,t("data.helsinki.feature.luola"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/maalinnoitus-tykkitie.png"}),cT.createElement("span",null,t("data.helsinki.feature.tykkitie"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/maalinnoitus-tykkipatteri.png"}),cT.createElement("span",null,t("data.helsinki.feature.tykkipatteri"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/maalinnoitus-puolustusaseman-raja.png"}),cT.createElement("span",null,t("data.helsinki.feature.puolustusasemanRaja"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/maalinnoitus-tukikohdan-raja.png"}),cT.createElement("span",null,t("data.helsinki.feature.tukikohdanRaja")))),cT.createElement("h6",null,cT.createElement($T,{i18nKey:"data.register.nameWithLink.viabundus",components:{a:cT.createElement("a",null)}})),cT.createElement("div",{className:"mb-3"},cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/viabundus-kaupunki.png"}),cT.createElement("span",null,t("data.viabundus.place.town"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/viabundus-asuttu-paikka.png"}),cT.createElement("span",null,t("data.viabundus.place.settlement"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/viabundus-silta.png"}),cT.createElement("span",null,t("data.viabundus.place.bridge"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/viabundus-satama.png"}),cT.createElement("span",null,t("data.viabundus.place.harbour"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/viabundus-lossi.png"}),cT.createElement("span",null,t("data.viabundus.place.ferry"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/viabundus-tulli.png"}),cT.createElement("span",null,t("data.viabundus.place.toll"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/viabundus-maantie.png"}),cT.createElement("span",null,t("data.viabundus.road.land"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/viabundus-maantie-epavarma.png"}),cT.createElement("span",null,t("data.viabundus.road.landUncertain"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/viabundus-talvitie.png"}),cT.createElement("span",null,t("data.viabundus.road.winter"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/viabundus-vesivayla.png"}),cT.createElement("span",null,t("data.viabundus.road.coast"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/viabundus-vesivayla-epavarma.png"}),cT.createElement("span",null,t("data.viabundus.road.coastUncertain"))),cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/viabundus-kaupungin-rajat.png"}),cT.createElement("span",null,t("data.viabundus.townOutline")))),cT.createElement("h6",null,cT.createElement($T,{i18nKey:"data.register.nameWithLink.3Dmodels",components:{a:cT.createElement("a",null)}})),cT.createElement("div",{className:"mb-3"},cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/3d_malli_circle.png"}),cT.createElement("img",{className:"feature-icon",src:"images/3d_malli_square.png"}),cT.createElement("span",null,t("common.features.3D-malli")))),cT.createElement("h6",null,cT.createElement($T,{i18nKey:"data.register.nameWithLink.maisemanMuisti",components:{a:cT.createElement("a",null)}})),cT.createElement("div",{className:"mb-3"},cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:"images/maiseman-muisti.png"}),cT.createElement("span",null,t("common.features.Valtakunnallisesti merkittv muinaisjnns"))))))},VO=()=>{const{t}=JT();return cT.createElement(CP.Item,{eventKey:"info.siteInfo.title"},cT.createElement(CP.Header,{as:"div"},t("info.siteInfo.title")),cT.createElement(CP.Body,null,cT.createElement("p",null,t("info.siteInfo.registerInfo"),":"),cT.createElement("h6",null,t("common.organization.Museovirasto")),cT.createElement("ul",null,cT.createElement("li",null,cT.createElement("a",{href:"https://www.kyppi.fi/palveluikkuna/mjreki/read/asp/r_default.aspx",target:"_blank"},t("data.register.name.Muinaisjnnsrekisteri"))),cT.createElement("li",null,cT.createElement("a",{href:"https://www.kyppi.fi/palveluikkuna/rapea/read/asp/r_default.aspx",target:"_blank"},t("data.register.name.Rakennusperintrekisteri"))),cT.createElement("li",null,cT.createElement("a",{href:"https://www.museovirasto.fi/fi/tietoa-meista/kansainvalinen-toiminta/maailmanperintokohteet-suomessa",target:"_blank"},t("data.register.name.Maailmanperintkohteet"))),cT.createElement("li",null,cT.createElement("a",{href:"http://www.rky.fi/",target:"_blank"},t("data.register.name.Valtakunnallisesti merkittvt rakennetut kulttuuriympristt"))),cT.createElement("li",null,cT.createElement("a",{href:"https://www.kyppi.fi/palveluikkuna/VARKL/asp/v_default.aspx",target:"_blank"},t("data.register.name.vark")))),cT.createElement("h6",null,t("common.organization.Ahvenanmaan paikallishallinto")),cT.createElement("ul",null,cT.createElement("li",null,cT.createElement("a",{href:"https://hub.arcgis.com/datasets/aland::fornminnen-1/",target:"_blank"},t("data.register.name.Ahvenanmaan muinaisjnnsrekisteri"))),cT.createElement("li",null,cT.createElement("a",{href:"https://hub.arcgis.com/datasets/aland::maritimt-kulturarv-vrak-1/",target:"_blank"},t("data.register.name.Ahvenanmaan merellinen kulttuuriperintrekisteri")))),cT.createElement("h6",null,t("common.organization.Geologian tutkimuskeskus")),cT.createElement("ul",null,cT.createElement("li",null,cT.createElement("a",{href:"https://tupa.gtk.fi/paikkatieto/meta/ancient_shorelines.html",target:"_blank"},t("data.register.name.muinaisrannat")))),cT.createElement("h6",null,t("common.organization.Helsingin kaupunki")),cT.createElement("ul",null,cT.createElement("li",null,cT.createElement("a",{href:"https://hri.fi/data/fi/dataset/helsingin-ensimmaisen-maailmansodan-aikaiset-maalinnoitukset",target:"_blank"},t("data.register.name.maalinnoitus")))),cT.createElement("h6",null,t("common.organization.viabundus")),cT.createElement("ul",null,cT.createElement("li",null,cT.createElement("a",{href:"https://www.landesgeschichte.uni-goettingen.de/handelsstrassen/info.php?lang=fin",target:"_blank"},t("data.register.name.viabundus")))),cT.createElement("p",null,t("info.siteInfo.info1")),cT.createElement("p",null,cT.createElement($T,{i18nKey:"info.siteInfo.info2",components:{i:cT.createElement("i",null)}})),cT.createElement("h6",null,cT.createElement($T,{i18nKey:"data.register.nameWithLink.3Dmodels",components:{a:cT.createElement("a",null)}})),cT.createElement("p",null,cT.createElement($T,{i18nKey:"info.siteInfo.3DModelsInfo",components:{a:cT.createElement("a",null)}})),cT.createElement("h6",null,t("info.siteInfo.positioningTitle")),cT.createElement("p",null,cT.createElement($T,{i18nKey:"info.siteInfo.positioningInfo",components:{i:cT.createElement("i",null)}})),cT.createElement("h6",null,t("info.siteInfo.searchTitle")),cT.createElement("p",null,cT.createElement($T,{i18nKey:"info.siteInfo.searchInfo",components:{i:cT.createElement("i",null),img:cT.createElement("img",null)}})),cT.createElement("h6",null,t("info.siteInfo.settingsTitle")),cT.createElement("p",null,cT.createElement($T,{i18nKey:"info.siteInfo.settingsInfo",components:{i:cT.createElement("i",null)}})),cT.createElement("h6",null,t("info.siteInfo.feedbackTitle")),cT.createElement("p",null,cT.createElement($T,{i18nKey:"info.siteInfo.feedbackInfo",components:{a:cT.createElement("a",null)}})),cT.createElement("h6",null,t("info.siteInfo.developersTitle")),cT.createElement("p",null,cT.createElement($T,{i18nKey:"info.siteInfo.developersInfo",components:{br:cT.createElement("br",null)}}))))},KO=()=>{const{t}=JT();return cT.createElement(CP.Item,{eventKey:"Versiohistoria"},cT.createElement(CP.Header,{as:"div"},t("info.versionHistory.title")),cT.createElement(CP.Body,null,cT.createElement("h6",null,"10/2025"),cT.createElement($T,{i18nKey:"info.versionHistory.2025-10",components:{a:cT.createElement("a",null)}}),cT.createElement("h6",null,"09/2025"),cT.createElement($T,{i18nKey:"info.versionHistory.2025-09",components:{a:cT.createElement("a",null)}}),cT.createElement("h6",null,"5/2025"),cT.createElement($T,{i18nKey:"info.versionHistory.2025-05",components:{a:cT.createElement("a",null)}}),cT.createElement("h6",null,"4/2025"),cT.createElement($T,{i18nKey:"info.versionHistory.2025-04",components:{a:cT.createElement("a",null)}}),cT.createElement("h6",null,"1/2024"),cT.createElement($T,{i18nKey:"info.versionHistory.2024-01",components:{a:cT.createElement("a",null)}}),cT.createElement("h6",null,"12/2023"),cT.createElement($T,{i18nKey:"info.versionHistory.2023-12",components:{a:cT.createElement("a",null)}}),cT.createElement("h6",null,"4/2022"),cT.createElement($T,{i18nKey:"info.versionHistory.2022-04",components:{a:cT.createElement("a",null)}}),cT.createElement("h6",null,"3/2021"),cT.createElement($T,{i18nKey:"info.versionHistory.2021-03",components:{a:cT.createElement("a",null)}}),cT.createElement("h6",null,"2/2021"),cT.createElement($T,{i18nKey:"info.versionHistory.2021-02",components:{a:cT.createElement("a",null)}}),cT.createElement("h6",null,"1/2021"),cT.createElement($T,{i18nKey:"info.versionHistory.2021-01",components:{a:cT.createElement("a",null)}}),cT.createElement("h6",null,"11/2020"),cT.createElement($T,{i18nKey:"info.versionHistory.2020-11",components:{a:cT.createElement("a",null),img:cT.createElement("img",null)}}),cT.createElement("h6",null,"4/2020"),cT.createElement($T,{i18nKey:"info.versionHistory.2020-04",components:{a:cT.createElement("a",null),img:cT.createElement("img",null)}}),cT.createElement("h6",null,"2/2020"),cT.createElement($T,{i18nKey:"info.versionHistory.2020-02",components:{a:cT.createElement("a",null)}}),cT.createElement("h6",null,"8/2019"),cT.createElement($T,{i18nKey:"info.versionHistory.2019-08",components:{a:cT.createElement("a",null)}}),cT.createElement("h6",null,"12/2018"),cT.createElement($T,{i18nKey:"info.versionHistory.2018-12",components:{a:cT.createElement("a",null)}}),cT.createElement("h6",null,"11/2017"),cT.createElement($T,{i18nKey:"info.versionHistory.2017-11",components:{a:cT.createElement("a",null)}}),cT.createElement("h6",null,"10/2015"),cT.createElement($T,{i18nKey:"info.versionHistory.2015-10",components:{a:cT.createElement("a",null)}})))},zO=()=>{const{t}=JT();return cT.createElement(DO,{title:t("info.title"),pageId:fM.Info},cT.createElement(CP,{alwaysOpen:!0},cT.createElement(UO,null),cT.createElement(VO,null),cT.createElement(BO,null),cT.createElement(HO,null),cT.createElement(KO,null)))},$O=cT.forwardRef(({className:t,bsPrefix:e,as:i="span",...n},a)=>(e=RS(e,"input-group-text"),(0,MS.jsx)(i,{ref:a,className:ES()(t,e),...n})));$O.displayName="InputGroupText";const YO=$O,XO=cT.forwardRef(({bsPrefix:t,size:e,hasValidation:i,className:n,as:a="div",...s},r)=>{t=RS(t,"input-group");const o=(0,cT.useMemo)(()=>({}),[]);return(0,MS.jsx)(SO.Provider,{value:o,children:(0,MS.jsx)(a,{ref:r,...s,className:ES()(n,t,e&&`${t}-${e}`,i&&"has-validation")})})});XO.displayName="InputGroup";const qO=Object.assign(XO,{Text:YO,Radio:t=>(0,MS.jsx)(YO,{children:(0,MS.jsx)(uI,{type:"radio",...t})}),Checkbox:t=>(0,MS.jsx)(YO,{children:(0,MS.jsx)(uI,{type:"checkbox",...t})})}),ZO=({searchResult:t})=>{const{t:e}=JT();if(!t)return null;const{features:i}=t;return cT.createElement(cT.Fragment,null,cT.createElement(PP,null,cT.createElement(xI,{className:"gy-3"},cT.createElement("h6",null,cT.createElement("span",null,e("search.searchResultTitle")),cT.createElement("small",null," ","(",i.length," ",e("search.resultCount"),")")))),cT.createElement(tj,{titleClickAction:cA.ClosePageAndPinOnMap,features:i,models:[]}))},JO=()=>{const{t}=JT(),e=mS(),[i,n]=(0,cT.useState)(""),[a,s]=(0,cT.useState)(!1),r=(0,cT.useRef)(null),o=_S(t=>t.search),l=_S(t=>t.visiblePage);(0,cT.useEffect)(()=>{l===fM.Search&&setTimeout(()=>r.current?.focus(),500)},[l]);const u=(0,cT.useCallback)(t=>{t.stopPropagation(),t.preventDefault(),i.trim().length<3?s(!0):(s(!1),e({type:Dm.SEARCH_FEATURES,searchText:i}))},[e,i]);return cT.createElement(DO,{title:t("search.title"),pageId:fM.Search},cT.createElement(PP,null,cT.createElement(xI,null,cT.createElement(FI,{onSubmit:u},a&&cT.createElement(iP,{variant:"danger"},t("search.error")),cT.createElement(FI.Label,null,t("search.info")),cT.createElement(qO,null,cT.createElement(FI.Control,{type:"text",ref:r,placeholder:t("search.placeholder")??void 0,value:i,onChange:t=>n(t.target.value)}),cT.createElement(US,{type:"submit",variant:"outline-secondary"},t("search.searchButton")))))),cT.createElement(ZO,{searchResult:o}))},QO=function(t,e){return e.includes(t)?e.filter(e=>e!==t):[...e,t]},tF=t=>{const{label:e,layer:i,selectedLayers:n,onSelectLayer:a,showIcon:s=!0,disabled:r,children:o}=t,l=n.includes(i);return cT.createElement(FI.Check,{type:"checkbox",className:"ms-3",id:e,onChange:()=>a(i),checked:l,disabled:r,label:cT.createElement(cT.Fragment,null,s?vw(i).map((t,e)=>cT.createElement("img",{className:"feature-icon",key:e,src:t})):null,cT.createElement("span",null,e),o)})},eF=({opacity:t,layerGroup:e,disabled:i})=>{const n=mS(),a=Number(100*(1-t)).toFixed(0),s=(0,cT.useCallback)(t=>{let i=Number(t.target.value);i>100&&(i=100);const a=Number((1-i/100).toFixed(2));n({type:Dm.CHANGE_LAYER_OPACITY,opacity:a,layerGroup:e})},[n,a,e]);return cT.createElement(cT.Fragment,null,cT.createElement("h6",null,cT.createElement($T,{i18nKey:"settings.common.transparency",values:{transparency:a}})),cT.createElement(FI.Group,null,cT.createElement(FI.Range,{min:"0",max:"100",disabled:i,onChange:s,value:a})))},iF=()=>{const{t}=JT(),e=mS(),{selectedLayers:i,enabled:n,opacity:a}=_S(t=>t.ahvenanmaa),s=(0,cT.useCallback)(t=>e({type:Dm.SELECT_VISIBLE_LAYERS,layerGroup:Fp.Ahvenanmaa,layers:QO(t,i)}),[e,i]),r=(0,cT.useCallback)(t=>e({type:Dm.ENABLE_LAYER_GROUP,layerGroup:Fp.Ahvenanmaa,enabled:t}),[e]),o=t("settings.ahvenanmaa.title");return cT.createElement(CP.Item,{eventKey:Fp.Ahvenanmaa},cT.createElement(CP.Header,{as:"div"},cT.createElement(FI.Check,{type:"switch",id:o,checked:n,onClick:t=>t.stopPropagation(),onChange:()=>r(!n)}),o),cT.createElement(CP.Body,null,cT.createElement(FI,null,cT.createElement("h6",null,cT.createElement($T,{i18nKey:"data.register.nameWithLink.Ahvenanmaan muinaisjnnsrekisteri",components:{a:cT.createElement("a",null)}})),cT.createElement(FI.Group,{className:"mb-3"},cT.createElement(tF,{label:t("common.features.Kohde"),layer:Bp.Fornminnen,selectedLayers:i,onSelectLayer:s,disabled:!n})),cT.createElement("h6",null,cT.createElement($T,{i18nKey:"data.register.nameWithLink.Ahvenanmaan merellinen kulttuuriperintrekisteri",components:{a:cT.createElement("a",null)}})),cT.createElement(FI.Group,{className:"mb-3"},cT.createElement(tF,{label:t("common.features.Kohde"),layer:Bp.MaritimaFornminnen,selectedLayers:i,onSelectLayer:s,disabled:!n})),cT.createElement(eF,{opacity:a,layerGroup:Fp.Ahvenanmaa,disabled:!n}),cT.createElement(FI.Text,null,cT.createElement($T,{i18nKey:"settings.ahvenanmaa.licence",components:{a:cT.createElement("a",null)}})))))},nF=({iconPath:t,label:e})=>cT.createElement("div",{className:"ms-3"},cT.createElement("img",{className:"feature-icon",src:t}),cT.createElement("span",null,e)),aF=()=>{const{t}=JT(),e=mS(),{enabled:i,opacity:n,selectedLayers:a}=_S(t=>t.gtk),s=(0,cT.useCallback)(t=>e({type:Dm.ENABLE_LAYER_GROUP,layerGroup:Fp.GTK,enabled:t}),[e]),r=(0,cT.useCallback)(t=>e({type:Dm.SELECT_VISIBLE_LAYERS,layerGroup:Fp.GTK,layers:[t]}),[e]),o=t("settings.gtk.title");return cT.createElement(CP.Item,{eventKey:Fp.GTK},cT.createElement(CP.Header,{as:"div"},cT.createElement(FI.Check,{type:"switch",id:o,checked:i,onClick:t=>t.stopPropagation(),onChange:()=>s(!i)}),o),cT.createElement(CP.Body,null,cT.createElement(FI,null,cT.createElement("div",{className:"h6"},cT.createElement(FI.Check,{type:"radio",name:"GtkLayer",id:zp.muinaisrannat,onChange:()=>r(zp.muinaisrannat),checked:a.includes(zp.muinaisrannat),label:cT.createElement($T,{i18nKey:`data.gtk.layer.${zp.muinaisrannat}`,components:{a:cT.createElement("a",null)}}),disabled:!i})),cT.createElement(FI.Group,{className:"mb-4"},cT.createElement(nF,{iconPath:"images/muinaisrannat_supra_akvaattinen.png",label:t("data.gtk.feature.supra-akvaattinen")}),cT.createElement(nF,{iconPath:"images/muinaisrannat_yoldia.png",label:t("data.gtk.feature.yoldia")}),cT.createElement(nF,{iconPath:"images/muinaisrannat_litorina.png",label:t("data.gtk.feature.litorina")})),cT.createElement("div",{className:"h6"},cT.createElement(FI.Check,{type:"radio",name:"GtkLayer",id:zp.maapera_200k_maalaji,onChange:()=>r(zp.maapera_200k_maalaji),checked:a.includes(zp.maapera_200k_maalaji),label:t(`data.gtk.layer.${zp.maapera_200k_maalaji}`),disabled:!i})),cT.createElement(FI.Group,{className:"mb-4"},cT.createElement(nF,{iconPath:"images/maalajit_kalliopaljastuma.png",label:t("data.gtk.feature.maalajit_kalliopaljastuma")}),cT.createElement(nF,{iconPath:"images/maalajit_kalliomaa.png",label:t("data.gtk.feature.maalajit_kalliomaa")}),cT.createElement(nF,{iconPath:"images/maalajit_rakka.png",label:t("data.gtk.feature.maalajit_rakka")}),cT.createElement(nF,{iconPath:"images/maalajit_kivia.png",label:t("data.gtk.feature.maalajit_kivia")}),cT.createElement(nF,{iconPath:"images/maalajit_sekalajitteinen_maalaji.png",label:t("data.gtk.feature.maalajit_sekalajitteinen_maalaji")}),cT.createElement(nF,{iconPath:"images/maalajit_karkearakenteinen_maalaaji.png",label:t("data.gtk.feature.maalajit_karkearakenteinen_maalaaji")}),cT.createElement(nF,{iconPath:"images/maalajit_hienorakenteinen_maalaji.png",label:t("data.gtk.feature.maalajit_hienorakenteinen_maalaji")}),cT.createElement(nF,{iconPath:"images/maalajit_liejuinen_hienorakenteinen_maalaji.png",label:t("data.gtk.feature.maalajit_liejuinen_hienorakenteinen_maalaji")}),cT.createElement(nF,{iconPath:"images/maalajit_savi.png",label:t("data.gtk.feature.maalajit_savi")}),cT.createElement(nF,{iconPath:"images/maalajit_lieju.png",label:t("data.gtk.feature.maalajit_lieju")}),cT.createElement(nF,{iconPath:"images/maalajit_paksu_turvekerros.png",label:t("data.gtk.feature.maalajit_paksu_turvekerros")}),cT.createElement(nF,{iconPath:"images/maalajit_taytemaa.png",label:t("data.gtk.feature.maalajit_taytemaa")}),cT.createElement(nF,{iconPath:"images/maalajit_kartoittamaton.png",label:t("data.gtk.feature.maalajit_kartoittamaton")}),cT.createElement(nF,{iconPath:"images/maalajit_vesi.png",label:t("data.gtk.feature.maalajit_vesi")}),cT.createElement(nF,{iconPath:"images/maalajit_soistuma.png",label:t("data.gtk.feature.maalajit_soistuma")}),cT.createElement(nF,{iconPath:"images/maalajit_ohut_turvekerros.png",label:t("data.gtk.feature.maalajit_ohut_turvekerros")})),cT.createElement(eF,{opacity:n,layerGroup:Fp.GTK,disabled:!i}),cT.createElement(FI.Text,null,t("settings.gtk.licence")))))},sF=({allValues:t,selectedValues:e,onSelectValues:i,disabled:n,children:a})=>{const s=(0,cT.useMemo)(()=>t.join("-"),[t]),r=(0,cT.useMemo)(()=>t.every(t=>e.includes(t)),[t,e]);return cT.createElement(FI.Check,{type:"checkbox",id:s,onChange:()=>i(r?e.filter(e=>!t.includes(e)):[...e,...t]),checked:r,disabled:n,label:a})},rF=({layer:t})=>{const{t:e}=JT();switch(t){case $p.Maalinnoitus_kohteet:return cT.createElement(cT.Fragment,null,cT.createElement(nF,{iconPath:"images/maalinnoitus-asema.png",label:e("data.helsinki.feature.asema")}),cT.createElement(nF,{iconPath:"images/maalinnoitus-luola.png",label:e("data.helsinki.feature.luola")}),cT.createElement(nF,{iconPath:"images/maalinnoitus-tykkitie.png",label:e("data.helsinki.feature.tykkitie")}),cT.createElement(nF,{iconPath:"images/maalinnoitus-tykkipatteri.png",label:e("data.helsinki.feature.tykkipatteri")}));case $p.Maalinnoitus_rajaukset:return cT.createElement(cT.Fragment,null,cT.createElement(nF,{iconPath:"images/maalinnoitus-puolustusaseman-raja.png",label:e("data.helsinki.feature.puolustusasemanRaja")}),cT.createElement(nF,{iconPath:"images/maalinnoitus-tukikohdan-raja.png",label:e("data.helsinki.feature.tukikohdanRaja")}));default:return null}},oF=()=>{const{t}=JT(),e=mS(),{selectedLayers:i,enabled:n,opacity:a}=_S(t=>t.helsinki),s=(0,cT.useCallback)(t=>{e({type:Dm.SELECT_VISIBLE_LAYERS,layerGroup:Fp.Helsinki,layers:QO(t,i)})},[e,i]),r=(0,cT.useCallback)(t=>e({type:Dm.ENABLE_LAYER_GROUP,layerGroup:Fp.Helsinki,enabled:t}),[e]),o=(0,cT.useCallback)(t=>e({type:Dm.SELECT_VISIBLE_LAYERS,layerGroup:Fp.Helsinki,layers:t}),[e]),l=(0,cT.useMemo)(()=>Object.values($p).sort((e,i)=>t(`data.helsinki.layer.${e}`).localeCompare(t(`data.helsinki.layer.${i}`))).map(e=>cT.createElement(tF,{key:e,label:t(`data.helsinki.layer.${e}`),layer:e,selectedLayers:i,onSelectLayer:s,showIcon:!1,disabled:!n},cT.createElement(rF,{layer:e}))),[i,s,n]),u=t("settings.helsinki.title");return cT.createElement(CP.Item,{eventKey:Fp.Helsinki},cT.createElement(CP.Header,{as:"div"},cT.createElement(FI.Check,{type:"switch",id:u,checked:n,onClick:t=>t.stopPropagation(),onChange:()=>r(!n)}),u),cT.createElement(CP.Body,null,cT.createElement(FI,null,cT.createElement("h6",null,cT.createElement(sF,{allValues:Object.values($p),selectedValues:i,onSelectValues:o,disabled:!n},cT.createElement($T,{i18nKey:"data.register.nameWithLink.maalinnoitus",components:{a:cT.createElement("a",null)}}))),cT.createElement(FI.Group,{className:"mb-3"},l),cT.createElement(eF,{opacity:a,layerGroup:Fp.Helsinki,disabled:!n}),cT.createElement(FI.Text,null,cT.createElement($T,{i18nKey:"settings.helsinki.licence",components:{a:cT.createElement("a",null)}})))))},lF=()=>{const{t}=JT(),e=mS(),{enabled:i,opacity:n,placement:a}=_S(t=>t.maannousuInfo),s=(0,cT.useCallback)(t=>e({type:Dm.ENABLE_LAYER_GROUP,layerGroup:Fp.MaannousuInfo,enabled:t}),[e]),r=(0,cT.useCallback)(t=>e({type:Dm.MOVE_MAANNOUSU_LAYER,placement:t}),[e]),o=t("settings.maannousuInfo.title"),l=fy();return cT.createElement(CP.Item,{eventKey:Fp.MaannousuInfo},cT.createElement(CP.Header,{as:"div"},cT.createElement(FI.Check,{type:"switch",id:o,checked:i,onClick:t=>t.stopPropagation(),onChange:()=>s(!i),disabled:!l}),o),cT.createElement(CP.Body,null,!l&&cT.createElement(iP,{variant:"danger"},cT.createElement($T,{i18nKey:"settings.maannousuInfo.webGLError"})),cT.createElement(FI,null,cT.createElement("h6",null,cT.createElement($T,{i18nKey:"data.register.nameWithLink.MaannousuInfo",components:{a:cT.createElement("a",null)}})),cT.createElement("p",null,cT.createElement($T,{i18nKey:"settings.maannousuInfo.info",components:{a:cT.createElement("a",null)}})),cT.createElement("p",null,cT.createElement($T,{i18nKey:"settings.maannousuInfo.info2"})),cT.createElement(FI.Group,{className:"mb-3"},cT.createElement(FI.Switch,{checked:a===Hp.Top,onChange:()=>r(a===Hp.Bottom?Hp.Top:Hp.Bottom),disabled:!i||!l,label:t("settings.maannousuInfo.placementSwitch")})),cT.createElement(eF,{opacity:n,layerGroup:Fp.MaannousuInfo,disabled:!i||!l}),cT.createElement(FI.Text,null,cT.createElement($T,{i18nKey:"settings.maannousuInfo.licence",components:{a:cT.createElement("a",null)}})))))},uF=({layer:t,label:e})=>cT.createElement("div",{className:"ms-3"},vw(t).map((t,e)=>cT.createElement("img",{className:"feature-icon",key:e,src:t})),cT.createElement("span",null,e)),hF=()=>{const{t}=JT(),e=mS(),{enabled:i}=_S(t=>t.maisemanMuisti),n=(0,cT.useCallback)(t=>e({type:Dm.ENABLE_LAYER_GROUP,layerGroup:Fp.MaisemanMuisti,enabled:t}),[e]),a=t("settings.maisemanMuisti.title");return cT.createElement(CP.Item,{eventKey:Fp.MaisemanMuisti},cT.createElement(CP.Header,{as:"div"},cT.createElement(FI.Check,{type:"switch",id:a,checked:i,onClick:t=>t.stopPropagation(),onChange:()=>n(!i)}),a),cT.createElement(CP.Body,null,cT.createElement(FI,null,cT.createElement("h6",null,cT.createElement($T,{i18nKey:"data.register.nameWithLink.maisemanMuisti",components:{a:cT.createElement("a",null)}})),cT.createElement(FI.Group,{className:"mb-3"},cT.createElement(uF,{layer:Kp.MaisemanMuisti,label:t("common.features.Valtakunnallisesti merkittv muinaisjnns")})))))},cF=[Gp.Venlinen_topografinen_kartta_1870_1944,Gp.Venlinen_topografinen_kartta_1871_1919,Gp.Venlinen_topografinen_kartta_1916_1917,Gp.Venlinen_topografinen_kartta_192x],dF=[Gp.Yleiskartta_1863_1879,Gp.Yleiskartta_1880_1899,Gp.Yleiskartta_1900_1919,Gp.Yleiskartta_1920_1939,Gp.Yleiskartta_1940_1972,Gp.Yleiskartta_1954_1975,Gp.Yleiskartta_1983_1992,Gp.Yleiskartta_1996,Gp.Yleiskartta_2000],pF=[Gp.Pitjkartta_1912_1968],mF=[Gp.Taloudellinen_kartta_1911_1970],fF=[Gp.Maasto_perus_topografinen_kartta_100k_1928_1947,Gp.Maasto_perus_topografinen_kartta_100k_1948_1989,Gp.Maasto_perus_topografinen_kartta_20k_1924_1948,Gp.Maasto_perus_topografinen_kartta_20k_1947_1959,Gp.Maasto_perus_topografinen_kartta_20k_1960_1969,Gp.Maasto_perus_topografinen_kartta_20k_1970_1979,Gp.Maasto_perus_topografinen_kartta_20k_1980_1997,Gp.Maasto_perus_topografinen_kartta_50k_1922_1946,Gp.Maasto_perus_topografinen_kartta_50k_1964_2006,Gp.Maasto_perus_topografinen_kartta_50k_2005_2020],gF=()=>{const{t}=JT(),e=mS(),{basemap:i,vanhatKartat:n}=_S(t=>t.maanmittauslaitos),a=(0,cT.useCallback)(t=>{e({type:Dm.SELECT_VISIBLE_LAYERS,layerGroup:Fp.MMLPohjakartta,layer:t})},[e]),s=(0,cT.useCallback)(t=>e({type:Dm.SELECT_VISIBLE_LAYERS,layerGroup:Fp.MMLVanhatKartat,layers:[t]}),[e]),r=(0,cT.useCallback)(t=>{e({type:Dm.ENABLE_LAYER_GROUP,layerGroup:Fp.MMLPohjakartta,enabled:t}),t||e({type:Dm.ENABLE_LAYER_GROUP,layerGroup:Fp.MMLVanhatKartat,enabled:t})},[e]),o=(0,cT.useCallback)(t=>e({type:Dm.ENABLE_LAYER_GROUP,layerGroup:Fp.MMLPohjakartta,enabled:t}),[e]),l=(0,cT.useCallback)(t=>e({type:Dm.ENABLE_LAYER_GROUP,layerGroup:Fp.MMLVanhatKartat,enabled:t}),[e]),u=t("settings.mml.title"),h=i.enabled||n.enabled;return cT.createElement(CP.Item,{eventKey:Fp.MMLPohjakartta},cT.createElement(CP.Header,{as:"div"},cT.createElement(FI.Check,{type:"switch",id:u,checked:h,onClick:t=>t.stopPropagation(),onChange:()=>r(!h)}),u),cT.createElement(CP.Body,null,cT.createElement(FI,null,cT.createElement(FI.Group,{className:"mb-3"},cT.createElement("div",{className:"h5"},cT.createElement(FI.Check,{type:"checkbox",id:"settings.mml.basemap.title",checked:i.enabled,onChange:()=>o(!i.enabled),label:t("settings.mml.basemap.title")})),cT.createElement("div",{className:"ms-3"},Object.values(Np).map(e=>cT.createElement(FI.Check,{type:"radio",className:"ms-3",name:"MMLPohjakarttaLayer",id:e,key:e,onChange:()=>a(e),checked:e===i.selectedLayer,label:t(`settings.mml.basemap.layer.${e}`),disabled:!i.enabled})))),cT.createElement(FI.Group,{className:"mb-3"},cT.createElement("div",{className:"h5"},cT.createElement(FI.Check,{type:"checkbox",id:"settings.mml.vanhatKartat.title",checked:n.enabled,onChange:()=>l(!n.enabled),label:t("settings.mml.vanhatKartat.title")})),cT.createElement("div",{className:"ms-3"},cT.createElement("h6",null,cT.createElement($T,{i18nKey:"settings.mml.vanhatKartat.section.topografisetKartat",components:{a:cT.createElement("a",null)}})),cF.map(e=>cT.createElement(FI.Check,{type:"radio",className:"ms-3",name:"MMLVanhatKartatLayer",id:e,key:e,onChange:()=>s(e),checked:n.selectedLayers.includes(e),label:t(`settings.mml.vanhatKartat.layer.${e}`),disabled:!n.enabled})),cT.createElement("h6",null,cT.createElement($T,{i18nKey:"settings.mml.vanhatKartat.section.yleiskartta",components:{a:cT.createElement("a",null)}})),dF.map(e=>cT.createElement(FI.Check,{type:"radio",className:"ms-3",name:"MMLVanhatKartatLayer",id:e,key:e,onChange:()=>s(e),checked:n.selectedLayers.includes(e),label:t(`settings.mml.vanhatKartat.layer.${e}`),disabled:!n.enabled})),cT.createElement("h6",null,cT.createElement($T,{i18nKey:"settings.mml.vanhatKartat.section.pitjnkartasto",components:{a:cT.createElement("a",null)}})),pF.map(e=>cT.createElement(FI.Check,{type:"radio",className:"ms-3",name:"MMLVanhatKartatLayer",id:e,key:e,onChange:()=>s(e),checked:n.selectedLayers.includes(e),label:t(`settings.mml.vanhatKartat.layer.${e}`),disabled:!n.enabled})),cT.createElement("h6",null,cT.createElement($T,{i18nKey:"settings.mml.vanhatKartat.section.taloudellinenKartta",components:{a:cT.createElement("a",null)}})),mF.map(e=>cT.createElement(FI.Check,{type:"radio",className:"ms-3",name:"MMLVanhatKartatLayer",id:e,key:e,onChange:()=>s(e),checked:n.selectedLayers.includes(e),label:t(`settings.mml.vanhatKartat.layer.${e}`),disabled:!n.enabled})),cT.createElement("h6",null,cT.createElement($T,{i18nKey:"settings.mml.vanhatKartat.section.maastokartat",components:{a:cT.createElement("a",null)}})),fF.map(e=>cT.createElement(FI.Check,{type:"radio",className:"ms-3",name:"MMLVanhatKartatLayer",id:e,key:e,onChange:()=>s(e),checked:n.selectedLayers.includes(e),label:t(`settings.mml.vanhatKartat.layer.${e}`),disabled:!n.enabled})),cT.createElement(eF,{opacity:n.opacity,layerGroup:Fp.MMLVanhatKartat,disabled:!n.enabled}))),cT.createElement(FI.Text,null,cT.createElement($T,{i18nKey:"settings.mml.licence",components:{a:cT.createElement("a",null)}})))))},_F=()=>{const{t}=JT(),e=mS(),{enabled:i}=_S(t=>t.models),n=(0,cT.useCallback)(t=>e({type:Dm.ENABLE_LAYER_GROUP,layerGroup:Fp.Models,enabled:t}),[e]),a=t("settings.3Dmodels.title");return cT.createElement(CP.Item,{eventKey:Fp.Models},cT.createElement(CP.Header,{as:"div"},cT.createElement(FI.Check,{type:"switch",id:a,checked:i,onClick:t=>t.stopPropagation(),onChange:()=>n(!i)}),a),cT.createElement(CP.Body,null,cT.createElement(FI,null,cT.createElement("h6",null,cT.createElement($T,{i18nKey:"data.register.nameWithLink.3Dmodels",components:{a:cT.createElement("a",null)}})),cT.createElement(FI.Group,{className:"mb-3"},cT.createElement(uF,{layer:Vp.ModelLayer,label:t("common.features.3D-malli")})))))},yF=[Up.RKY_alue,Up.RKY_viiva,Up.RKY_piste],kF=[Up.Maailmanperinto_alue,Up.Maailmanperinto_piste],vF=[Up.Suojellut_rakennukset_alue,Up.Suojellut_rakennukset_piste],xF=[Up.VARK_pisteet,Up.VARK_alueet],wF=[Up.Muinaisjaannokset_alue,Up.Muu_kulttuuriperintokohde_alue,Up.Muinaisjaannokset_piste,Up.Muu_kulttuuriperintokohde_piste,Up.Lytpaikka_piste,Up.Lytpaikka_alue,Up.Havaintokohde_piste,Up.Havaintokohde_alue,Up.Luonnonmuodostuma_piste,Up.Luonnonmuodostuma_alue,Up.Mahdollinen_muinaisjnns_piste,Up.Mahdollinen_muinaisjnns_alue,Up.Muu_kohde_piste,Up.Muu_kohde_alue,Up.PoistettuKiinteMuijaisjnnsPiste,Up.PoistettuKiinteMuijaisjnnsAlue,Up.Alakohde_piste],bF=()=>{const{t}=JT(),e=mS(),{selectedLayers:i,enabled:n,opacity:a}=_S(t=>t.museovirasto),s=(0,cT.useCallback)(t=>e({type:Dm.SELECT_VISIBLE_LAYERS,layerGroup:Fp.Museovirasto,layers:QO(t,i)}),[e,i]),r=(0,cT.useCallback)(t=>e({type:Dm.ENABLE_LAYER_GROUP,layerGroup:Fp.Museovirasto,enabled:t}),[e]),o=(0,cT.useCallback)(t=>e({type:Dm.SELECT_VISIBLE_LAYERS,layerGroup:Fp.Museovirasto,layers:t}),[e]),l=t("settings.museovirasto.title");return cT.createElement(CP.Item,{eventKey:Fp.Museovirasto},cT.createElement(CP.Header,{as:"div"},cT.createElement(FI.Check,{type:"switch",id:l,checked:n,onClick:t=>t.stopPropagation(),onChange:()=>r(!n)}),l),cT.createElement(CP.Body,null,cT.createElement(FI,null,cT.createElement("h6",null,cT.createElement(sF,{allValues:yF,selectedValues:i,onSelectValues:o,disabled:!n},cT.createElement($T,{i18nKey:"data.register.nameWithLink.Valtakunnallisesti merkittvt rakennetut kulttuuriympristt",components:{a:cT.createElement("a",null)}}))),cT.createElement(FI.Group,{className:"mb-3"},cT.createElement(tF,{label:t("common.features.Alue"),layer:Up.RKY_alue,selectedLayers:i,onSelectLayer:s,disabled:!n}),cT.createElement(tF,{label:t("common.features.Viiva"),layer:Up.RKY_viiva,selectedLayers:i,onSelectLayer:s,disabled:!n}),cT.createElement(tF,{label:t("common.features.Rakennus"),layer:Up.RKY_piste,selectedLayers:i,onSelectLayer:s,disabled:!n})),cT.createElement("h6",null,cT.createElement(sF,{allValues:kF,selectedValues:i,onSelectValues:o,disabled:!n},cT.createElement($T,{i18nKey:"data.register.nameWithLink.Maailmanperintkohteet",components:{a:cT.createElement("a",null)}}))),cT.createElement(FI.Group,{className:"mb-3"},cT.createElement(tF,{label:t("common.features.Alue"),layer:Up.Maailmanperinto_alue,selectedLayers:i,onSelectLayer:s,disabled:!n}),cT.createElement(tF,{label:t("common.features.Kohde"),layer:Up.Maailmanperinto_piste,selectedLayers:i,onSelectLayer:s,disabled:!n})),cT.createElement("h6",null,cT.createElement(sF,{allValues:vF,selectedValues:i,onSelectValues:o,disabled:!n},cT.createElement($T,{i18nKey:"data.register.nameWithLink.Rakennusperintrekisteri",components:{a:cT.createElement("a",null)}}))),cT.createElement(FI.Group,{className:"mb-3"},cT.createElement(tF,{label:t("common.features.Rakennettu alue"),layer:Up.Suojellut_rakennukset_alue,selectedLayers:i,onSelectLayer:s,disabled:!n}),cT.createElement(tF,{label:t("common.features.Rakennus"),layer:Up.Suojellut_rakennukset_piste,selectedLayers:i,onSelectLayer:s,disabled:!n})),cT.createElement("h6",null,cT.createElement(sF,{allValues:wF,selectedValues:i,onSelectValues:o,disabled:!n},cT.createElement($T,{i18nKey:"data.register.nameWithLink.Muinaisjnnsrekisteri",components:{a:cT.createElement("a",null)}}))),cT.createElement(FI.Group,{className:"mb-3"},cT.createElement(tF,{label:t("data.featureType.Kiinte muinaisjnns (alue)"),layer:Up.Muinaisjaannokset_alue,selectedLayers:i,onSelectLayer:s,disabled:!n}),cT.createElement(tF,{label:t("data.featureType.Muu kulttuuriperintkohde (alue)"),layer:Up.Muu_kulttuuriperintokohde_alue,selectedLayers:i,onSelectLayer:s,disabled:!n}),cT.createElement(tF,{label:t("data.featureType.Kiinte muinaisjnns"),layer:Up.Muinaisjaannokset_piste,selectedLayers:i,onSelectLayer:s,disabled:!n}),cT.createElement(tF,{label:t("data.featureType.Muu kulttuuriperintkohde"),layer:Up.Muu_kulttuuriperintokohde_piste,selectedLayers:i,onSelectLayer:s,disabled:!n}),cT.createElement(tF,{label:t("data.featureType.lytpaikkaPiste"),layer:Up.Lytpaikka_piste,selectedLayers:i,onSelectLayer:s,disabled:!n}),cT.createElement(tF,{label:t("data.featureType.lytpaikkaAlue"),layer:Up.Lytpaikka_alue,selectedLayers:i,onSelectLayer:s,disabled:!n}),cT.createElement(tF,{label:t("data.featureType.havaintokohdePiste"),layer:Up.Havaintokohde_piste,selectedLayers:i,onSelectLayer:s,disabled:!n}),cT.createElement(tF,{label:t("data.featureType.havaintokohdeAlue"),layer:Up.Havaintokohde_alue,selectedLayers:i,onSelectLayer:s,disabled:!n}),cT.createElement(tF,{label:t("data.featureType.luonnonmuodostumaPiste"),layer:Up.Luonnonmuodostuma_piste,selectedLayers:i,onSelectLayer:s,disabled:!n}),cT.createElement(tF,{label:t("data.featureType.luonnonmuodostumaAlue"),layer:Up.Luonnonmuodostuma_alue,selectedLayers:i,onSelectLayer:s,disabled:!n}),cT.createElement(tF,{label:t("data.featureType.muuKohdePiste"),layer:Up.Muu_kohde_piste,selectedLayers:i,onSelectLayer:s,disabled:!n}),cT.createElement(tF,{label:t("data.featureType.muuKohdeAlue"),layer:Up.Muu_kohde_alue,selectedLayers:i,onSelectLayer:s,disabled:!n}),cT.createElement(tF,{label:t("data.featureType.mahdollinenMuinaisjnnsPiste"),layer:Up.Mahdollinen_muinaisjnns_piste,selectedLayers:i,onSelectLayer:s,disabled:!n}),cT.createElement(tF,{label:t("data.featureType.mahdollinenMuinaisjnnsAlue"),layer:Up.Mahdollinen_muinaisjnns_alue,selectedLayers:i,onSelectLayer:s,disabled:!n}),cT.createElement(tF,{label:t("data.featureType.poistettuKiinteMuijaisjnnsPiste"),layer:Up.PoistettuKiinteMuijaisjnnsPiste,selectedLayers:i,onSelectLayer:s,disabled:!n}),cT.createElement(tF,{label:t("data.featureType.poistettuKiinteMuijaisjnnsAlue"),layer:Up.PoistettuKiinteMuijaisjnnsAlue,selectedLayers:i,onSelectLayer:s,disabled:!n}),cT.createElement(tF,{label:t("data.featureType.alakohdePiste"),layer:Up.Alakohde_piste,selectedLayers:i,onSelectLayer:s,disabled:!n})),cT.createElement("h6",null,cT.createElement(sF,{allValues:xF,selectedValues:i,onSelectValues:o,disabled:!n},cT.createElement($T,{i18nKey:"data.register.nameWithLink.vark",components:{a:cT.createElement("a",null)}}))),cT.createElement(FI.Group,{className:"mb-3"},cT.createElement(tF,{label:t("common.features.aluerajaukset"),layer:Up.VARK_alueet,selectedLayers:i,onSelectLayer:s,disabled:!n}),cT.createElement(tF,{label:t("common.features.keskipisteet"),layer:Up.VARK_pisteet,selectedLayers:i,onSelectLayer:s,disabled:!n})),cT.createElement(eF,{opacity:a,layerGroup:Fp.Museovirasto,disabled:!n}),cT.createElement(FI.Text,null,cT.createElement($T,{i18nKey:"settings.museovirasto.licence",components:{a:cT.createElement("a",null)}}))),cT.createElement(TF,null)))},EF=({type:t,selectedMuinaisjaannosTypes:e,onSelectType:i,disabled:n})=>{const{t:a}=JT(),s=e.includes(t);return cT.createElement(FI.Check,{type:"checkbox",className:"ms-3",id:a(`data.museovirasto.type.${t}`),onChange:()=>i(t),checked:s,disabled:n,label:a(`data.museovirasto.type.${t}`)})},MF=({dating:t,selectedMuinaisjaannosDatings:e,onSelectDating:i,disabled:n})=>{const{t:a}=JT(),s=e.includes(t);return cT.createElement(FI.Check,{type:"checkbox",className:"ms-3",id:a(`data.museovirasto.muinaisjnnsAjoitus.${t}`),onChange:()=>i(t),checked:s,disabled:n,label:a(`data.museovirasto.muinaisjnnsAjoitus.${t}`)})},TF=()=>{const{t,i18n:e}=JT(),i=mS(),{selectedMuinaisjaannosTypes:n,selectedMuinaisjaannosDatings:a,enabled:s}=_S(t=>t.museovirasto),r=(0,cT.useCallback)(t=>i({type:Dm.SELECT_VISIBLE_MUINAISJNNS_TYPE,types:QO(t,n)}),[i,n]),o=(0,cT.useCallback)(t=>i({type:Dm.SELECT_VISIBLE_MUINAISJNNS_TYPE,types:t}),[i]),l=(0,cT.useCallback)(t=>i({type:Dm.SELECT_VISIBLE_MUINAISJNNS_DATING,datings:QO(t,a)}),[i,a]),u=(0,cT.useCallback)(t=>i({type:Dm.SELECT_VISIBLE_MUINAISJNNS_DATING,datings:t}),[i]),h=(0,cT.useMemo)(()=>Object.values(Qp).map(t=>cT.createElement(EF,{key:t,type:t,selectedMuinaisjaannosTypes:n,onSelectType:r,disabled:!s})),[n,e.language,s]),c=(0,cT.useMemo)(()=>Object.values(tm).map(t=>cT.createElement(MF,{key:t,dating:t,selectedMuinaisjaannosDatings:a,onSelectDating:l,disabled:!s})),[a,e.language,s]);return cT.createElement(cT.Fragment,null,cT.createElement("h5",{className:"mt-4"},t("settings.museovirasto.filters.title")),cT.createElement(FI,null,cT.createElement(iP,{variant:"light"},cT.createElement($T,{i18nKey:"settings.museovirasto.filters.info",components:{img:cT.createElement("img",null)}})),cT.createElement("h6",null,cT.createElement(sF,{allValues:Object.values(Qp),selectedValues:n,onSelectValues:o,disabled:!s},t("settings.museovirasto.filters.type"))),cT.createElement(FI.Group,{className:"mb-3"},h),cT.createElement("h6",null,cT.createElement(sF,{allValues:Object.values(tm),selectedValues:a,onSelectValues:u,disabled:!s},t("settings.museovirasto.filters.dating"))),cT.createElement(FI.Group,{className:"mb-3"},c)))},SF=()=>{const{t}=JT(),e=mS(),{enabled:i,opacity:n,selectedYear:a}=_S(t=>t.viabundus),s=(0,cT.useCallback)(t=>e({type:Dm.ENABLE_LAYER_GROUP,layerGroup:Fp.Viabundus,enabled:t}),[e]),r=(0,cT.useCallback)(t=>{const i=Number(t.target.value);e({type:Dm.SELECT_VIABUNDUS_YEAR,year:i})},[e]),o=t("settings.viabundus.title");return cT.createElement(CP.Item,{eventKey:Fp.Viabundus},cT.createElement(CP.Header,{as:"div"},cT.createElement(FI.Check,{type:"switch",id:o,checked:i,onClick:t=>t.stopPropagation(),onChange:()=>s(!i)}),o),cT.createElement(CP.Body,null,cT.createElement(FI,null,cT.createElement("h6",null,cT.createElement($T,{i18nKey:"data.register.nameWithLink.viabundus",components:{a:cT.createElement("a",null)}})),cT.createElement(FI.Group,{className:"mb-4"},cT.createElement(nF,{iconPath:"images/viabundus-kaupunki.png",label:t("data.viabundus.place.town")}),cT.createElement(nF,{iconPath:"images/viabundus-asuttu-paikka.png",label:t("data.viabundus.place.settlement")}),cT.createElement(nF,{iconPath:"images/viabundus-silta.png",label:t("data.viabundus.place.bridge")}),cT.createElement(nF,{iconPath:"images/viabundus-satama.png",label:t("data.viabundus.place.harbour")}),cT.createElement(nF,{iconPath:"images/viabundus-lossi.png",label:t("data.viabundus.place.ferry")}),cT.createElement(nF,{iconPath:"images/viabundus-tulli.png",label:t("data.viabundus.place.toll")}),cT.createElement(nF,{iconPath:"images/viabundus-maantie.png",label:t("data.viabundus.road.land")}),cT.createElement(nF,{iconPath:"images/viabundus-maantie-epavarma.png",label:t("data.viabundus.road.landUncertain")}),cT.createElement(nF,{iconPath:"images/viabundus-talvitie.png",label:t("data.viabundus.road.winter")}),cT.createElement(nF,{iconPath:"images/viabundus-vesivayla.png",label:t("data.viabundus.road.coast")}),cT.createElement(nF,{iconPath:"images/viabundus-vesivayla-epavarma.png",label:t("data.viabundus.road.coastUncertain")}),cT.createElement(nF,{iconPath:"images/viabundus-kaupungin-rajat.png",label:t("data.viabundus.townOutline")})),cT.createElement("h6",null,cT.createElement($T,{i18nKey:"settings.viabundus.year",values:{selectedYear:a}})),cT.createElement(FI.Range,{min:"1350",max:"1650",disabled:!i,onChange:r,value:a}),cT.createElement(eF,{opacity:n,layerGroup:Fp.Viabundus,disabled:!i}),cT.createElement(FI.Text,null,cT.createElement($T,{i18nKey:"settings.viabundus.licence",components:{a:cT.createElement("a",null)}})))))},CF=()=>{const{t}=JT();return cT.createElement(DO,{title:t("settings.title"),pageId:fM.Settings},cT.createElement(CP,{alwaysOpen:!0},cT.createElement(gF,null),cT.createElement(aF,null),cT.createElement(lF,null),cT.createElement(bF,null),cT.createElement(iF,null),cT.createElement(oF,null),cT.createElement(SF,null),cT.createElement(_F,null),cT.createElement(hF,null)))},LF=()=>{document.fullscreenElement?document.fullscreenElement&&document.exitFullscreen():document.body.requestFullscreen()},RF={concurrentPendingJobsCounter:0,showLoadingAnimation:!1,visiblePage:void 0,linkedFeature:void 0,identifiedMapFeatures:void 0,search:void 0,mapZoom:8,mapCenterCoordinates:void 0,language:(()=>{const t=navigator.language?.substring(0,2);return Object.values(Op).some(e=>e===t)?t:Op.FI})(),maanmittauslaitos:{basemap:{selectedLayer:Np.Taustakartta,url:{WMTSCapabilities:"https://avoin-karttakuva.maanmittauslaitos.fi/avoin/wmts/1.0.0/WMTSCapabilities.xml"},apiKey:"0593cc3c-e12f-489c-b8d6-c9a6965b4bfe",enabled:!0},vanhatKartat:{selectedLayers:[Gp.Venlinen_topografinen_kartta_1870_1944],url:{wms:"https://paituli.csc.fi/geoserver/paituli/wms"},opacity:1,enabled:!1}},maannousuInfo:{selectedLayer:Dp.Vuosi6000eaa,url:{geotiff:"https://maannousu.info/api/v2"},placement:Hp.Bottom,opacity:1,enabled:!1},museovirasto:{selectedLayers:[Up.Muinaisjaannokset_piste,Up.Muinaisjaannokset_alue,Up.Suojellut_rakennukset_piste,Up.Suojellut_rakennukset_alue,Up.RKY_alue,Up.RKY_piste,Up.RKY_viiva,Up.Maailmanperinto_piste,Up.Maailmanperinto_alue,Up.Muu_kulttuuriperintokohde_alue,Up.Muu_kulttuuriperintokohde_piste,Up.VARK_alueet,Up.VARK_pisteet,Up.Lytpaikka_piste,Up.Lytpaikka_alue],selectedMuinaisjaannosTypes:Object.values(Qp),selectedMuinaisjaannosDatings:Object.values(tm),url:{wms:"https://museovirasto-wms-proxy.muinaismuistot.info/geoserver/ows",wfs:"https://geoserver.museovirasto.fi/geoserver/ows"},opacity:.7,enabled:!0},ahvenanmaa:{selectedLayers:Object.values(Bp),url:{export:"https://kartor.regeringen.ax/arcgis/rest/services/Kulturarv/Fornminnen/MapServer",identify:"https://kartor.regeringen.ax/arcgis/rest/services/Kulturarv/Fornminnen/MapServer/identify",find:"https://kartor.regeringen.ax/arcgis/rest/services/Kulturarv/Fornminnen/MapServer/find",typeAndDating:"https://opendata.arcgis.com/datasets/4fa828b46a0740b18960cf3e91d35431_2.geojson"},opacity:.7,enabled:!0},models:{url:{geojson:"./3d/3d.json"},enabled:!0},maisemanMuisti:{url:{geojson:"./maisemanmuisti/maisemanmuisti.json"},enabled:!0},viabundus:{selectedYear:1650,url:{geojson:"./viabundus/Viabundus-finland.geojson"},opacity:1,enabled:!1},gtk:{selectedLayers:[zp.muinaisrannat],url:{export:"https://gtkdata.gtk.fi/arcgis/rest/services/Rajapinnat/GTK_Maapera_WMS/MapServer"},opacity:.7,enabled:!1},helsinki:{selectedLayers:Object.values([$p.Maalinnoitus_karttatekstit,$p.Maalinnoitus_kohteet,$p.Maalinnoitus_yksikot]),url:{wms:"https://kartta.hel.fi/ws/geoserver/avoindata/wms"},opacity:.8,enabled:!0}},IF="none",PF=(t,e,i,n)=>0===e.length&&0===i.length||e.length>0&&e.every(t=>i.includes(t))?{...t,old:{...t.old,[n]:void 0}}:{...t,next:{...t.next,[n]:i.length>0?i:[IF]}},AF=(t,e,i,n)=>e===i?{...t,old:{...t.old,[n]:void 0}}:{...t,next:{...t.next,[n]:i}},jF={predicate:t=>{switch(t.type){case Dm.CHANGE_LANGUAGE:case Dm.CHANGE_LAYER_OPACITY:case Dm.SELECT_VISIBLE_LAYERS:case Dm.ENABLE_LAYER_GROUP:case Dm.SELECT_VISIBLE_MUINAISJNNS_TYPE:case Dm.SELECT_VISIBLE_MUINAISJNNS_DATING:case Dm.MOVE_MAANNOUSU_LAYER:case Dm.SELECT_VIABUNDUS_YEAR:case Dm.SET_LINKED_FEATURE:case Dm.ZOOM_CHANGED:case Dm.MAP_CENTER_CHANGED:return!0;default:return!1}},effect:Fw()((t,e)=>{const i=window.onhashchange;window.onhashchange=null,((t,e)=>{let i={next:{},old:uA()};i=AF(i,t.linkedFeature?.coordinates[0],e.linkedFeature?.coordinates[0],"x"),i=AF(i,t.linkedFeature?.coordinates[1],e.linkedFeature?.coordinates[1],"y"),i=AF(i,t.linkedFeature?.layer,e.linkedFeature?.layer,"linkedFeatureLayer"),i=AF(i,t.linkedFeature?.id,e.linkedFeature?.id,"linkedFeatureId"),i=AF(i,t.linkedFeature?.name,e.linkedFeature?.name,"linkedFeatureName"),i=AF(i,t.language,e.language,"lang"),i=AF(i,t.mapZoom,e.mapZoom,"zoom"),i=AF(i,t.mapCenterCoordinates,e.mapCenterCoordinates,"center"),i=AF(i,t.maanmittauslaitos.basemap.selectedLayer,e.maanmittauslaitos.basemap.selectedLayer,"mmlLayer"),i=AF(i,t.maanmittauslaitos.basemap.enabled,e.maanmittauslaitos.basemap.enabled,"mmlLayerEnabled"),i=PF(i,t.maanmittauslaitos.vanhatKartat.selectedLayers,e.maanmittauslaitos.vanhatKartat.selectedLayers,"mmlVanhatKartatLayer"),i=AF(i,t.maanmittauslaitos.vanhatKartat.opacity,e.maanmittauslaitos.vanhatKartat.opacity,"mmlVanhatKartatOpacity"),i=AF(i,t.maanmittauslaitos.vanhatKartat.enabled,e.maanmittauslaitos.vanhatKartat.enabled,"mmlVanhatKartatEnabled"),i=AF(i,t.gtk.opacity,e.gtk.opacity,"gtkOpacity"),i=AF(i,t.gtk.enabled,e.gtk.enabled,"gtkEnabled"),i=AF(i,t.gtk.selectedLayers,e.gtk.selectedLayers,"gtktLayer"),i=AF(i,t.maannousuInfo.selectedLayer,e.maannousuInfo.selectedLayer,"maannousuLayer"),i=AF(i,t.maannousuInfo.opacity,e.maannousuInfo.opacity,"maannousuOpacity"),i=AF(i,t.maannousuInfo.enabled,e.maannousuInfo.enabled,"maannousuEnabled"),i=AF(i,t.maannousuInfo.placement,e.maannousuInfo.placement,"maannousuIndex"),i=PF(i,t.museovirasto.selectedLayers,e.museovirasto.selectedLayers,"museovirastoLayer"),i=AF(i,t.museovirasto.opacity,e.museovirasto.opacity,"museovirastoOpacity"),i=AF(i,t.museovirasto.enabled,e.museovirasto.enabled,"museovirastoEnabled"),i=PF(i,t.museovirasto.selectedMuinaisjaannosTypes,e.museovirasto.selectedMuinaisjaannosTypes,"muinaisjaannosTypes"),i=PF(i,t.museovirasto.selectedMuinaisjaannosDatings,e.museovirasto.selectedMuinaisjaannosDatings,"muinaisjaannosDatings"),i=PF(i,t.ahvenanmaa.selectedLayers,e.ahvenanmaa.selectedLayers,"ahvenanmaaLayer"),i=AF(i,t.ahvenanmaa.opacity,e.ahvenanmaa.opacity,"ahvenanmaaOpacity"),i=AF(i,t.ahvenanmaa.enabled,e.ahvenanmaa.enabled,"ahvenanmaaEnabled"),i=PF(i,t.helsinki.selectedLayers,e.helsinki.selectedLayers,"helsinkiLayer"),i=AF(i,t.helsinki.opacity,e.helsinki.opacity,"helsinkiOpacity"),i=AF(i,t.helsinki.enabled,e.helsinki.enabled,"helsinkiEnabled"),i=AF(i,t.viabundus.selectedYear,e.viabundus.selectedYear,"viabundusYear"),i=AF(i,t.viabundus.opacity,e.viabundus.opacity,"viabundusOpacity"),i=AF(i,t.viabundus.enabled,e.viabundus.enabled,"viabundusEnabled"),i=AF(i,t.models.enabled,e.models.enabled,"modelsEnabled"),i=AF(i,t.maisemanMuisti.enabled,e.maisemanMuisti.enabled,"maisemanMuistiEnabled"),window.location.hash=hA({...i.old,...i.next})})(RF,e.getState()),window.setTimeout(()=>{window.onhashchange=i},100)},300)},OF=(t,e)=>Object.values(t).some(t=>t===e),FF=(t,e,i,n)=>i===IF?n(t,[]):OF(e,i)?n(t,[i]):Array.isArray(i)&&((t,e)=>e.every(e=>OF(t,e)))(e,i)?n(t,i):t,NF=()=>{let t=RF;const{x:e,y:i,linkedFeatureLayer:n,linkedFeatureId:a,linkedFeatureName:s,zoom:r,center:o,lang:l,mmlLayer:u,mmlLayerEnabled:h,mmlVanhatKartatLayer:c,mmlVanhatKartatOpacity:d,mmlVanhatKartatEnabled:p,gtkOpacity:m,gtkEnabled:f,gtktLayer:g,maannousuLayer:_,maannousuOpacity:y,maannousuEnabled:k,maannousuIndex:v,museovirastoLayer:x,museovirastoOpacity:w,museovirastoEnabled:b,muinaisjaannosTypes:E,muinaisjaannosDatings:M,ahvenanmaaLayer:T,ahvenanmaaOpacity:S,ahvenanmaaEnabled:C,helsinkiLayer:L,helsinkiOpacity:R,helsinkiEnabled:I,viabundusYear:P,viabundusOpacity:A,viabundusEnabled:j,modelsEnabled:O,maisemanMuistiEnabled:F}=uA();var N;return void 0!==e&&void 0!==i&&(t=XE(t,{coordinates:[e,i],layer:n&&(N=n,Xp.includes(N))?n:void 0,id:a?String(a):void 0,name:s})),void 0!==r&&(t={...t,mapZoom:r}),void 0!==o&&Array.isArray(o)&&2===o.length&&(t={...t,mapCenterCoordinates:[o[0],o[1]]}),void 0!==l&&OF(Op,l)&&(t=gM(t,l)),u&&OF(Np,u)&&(t=qE(t,u)),void 0!==h&&(t=ZE(t,h)),c&&(t=FF(t,Gp,c,JE)),void 0!==d&&(t=QE(t,d)),void 0!==p&&(t=tM(t,p)),void 0!==m&&(t=VE(t,m)),void 0!==f&&(t=KE(t,f)),g&&(t=FF(t,zp,g,BE)),_&&OF(Dp,_)&&(t=eM(t,_)),void 0!==y&&(t=iM(t,y)),void 0!==k&&(t=nM(t,k)),v&&OF(Hp,v)&&(t=aM(t,v)),x&&(t=FF(t,Up,x,oM)),void 0!==w&&(t=lM(t,w)),void 0!==b&&(t=uM(t,b)),E&&(t=FF(t,Qp,E,hM)),M&&(t=FF(t,tm,M,cM)),T&&(t=FF(t,Bp,T,WE)),void 0!==S&&(t=HE(t,S)),void 0!==C&&(t=UE(t,C)),L&&(t=FF(t,$p,L,zE)),void 0!==R&&(t=$E(t,R)),void 0!==I&&(t=YE(t,I)),void 0!==P&&(t=mM(t,P)),void 0!==A&&(t=dM(t,A)),void 0!==j&&(t=pM(t,j)),void 0!==O&&(t=rM(t,O)),void 0!==F&&(t=sM(t,F)),t},GF=(WF=NF(),kM=GE(),yM=rE({reducer:_M,preloadedState:WF,middleware:t=>t().prepend(kM.middleware)}),yM),DF=new class{constructor(t){this.tileLoadingCounter=0,this.setMapLocation=t=>{this.view.setCenter(t)},this.geolocationChanged=()=>{const t=this.geolocation.getPosition();t&&this.positionAndSelectedLocation.addCurrentPositionMarker(t)},this.centerToCurrentPositions=()=>{const t=this.geolocation.getPosition();t&&this.view.setCenter(t)},this.firstGeolocationDetetcted=t=>{const e=this.geolocation.getPosition();var i;e&&(!t.linkedFeature&&(i=this.view.getCenter())&&i[0]===tb[0]&&i[1]===tb[1]&&this.view.setCenter(e),this.positionAndSelectedLocation.addCurrentPositionMarker(e))},this.mapUpdaterStoreListener={predicate:()=>!0,effect:async(t,e)=>{const i=e.getState();switch(t.type){case Dm.FIRST_USER_LOCATION_DETECTION_COMPLETE:this.firstGeolocationDetetcted(i);break;case Dm.ZOOM:this.zoom("in"===t.zoomDirection?1:-1);break;case Dm.ZOOM_CHANGED:this.maannousuInfoTileLayerGroup.onZoomChanged(i);break;case Dm.CENTER_MAP_TO_CURRENT_POSITION:this.centerToCurrentPositions();break;case Dm.SET_LINKED_FEATURE:const{linkedFeature:e}=t;e?(this.setMapLocation(e.coordinates),this.positionAndSelectedLocation.showLinkedFeatureMarker(e.coordinates)):this.positionAndSelectedLocation.hideLinkedFeatureMarker();break;case Dm.CENTER_MAP_TO_LINKED_FEATURE:i.linkedFeature&&this.setMapLocation(i.linkedFeature.coordinates);break;case Dm.IDENTIFY_MAP_FEATURES_ON_COORDINATE:this.indentifyFeaturesOnCoordinate(t.coordinates,t.requestTimestamp);break;case Dm.CHANGE_LAYER_OPACITY:this.layerOpacityChanged(t.layerGroup,i);break;case Dm.ENABLE_LAYER_GROUP:this.layerGroupVisibilityChanged(t.layerGroup,i);break;case Dm.SELECT_VISIBLE_LAYERS:this.layerGroupSelectedLayersChanged(t.layerGroup,i);break;case Dm.SELECT_VISIBLE_MUINAISJNNS_TYPE:this.museovirastoTileLayer.selectedMuinaisjaannosTypesChanged(i);break;case Dm.SELECT_VISIBLE_MUINAISJNNS_DATING:this.museovirastoTileLayer.selectedMuinaisjaannosDatingsChanged(i);break;case Dm.SEARCH_FEATURES:{const e=await this.searchFeaturesFromMapLayers(t.searchText,i);this.store.dispatch({type:Dm.SEARCH_FEATURES_COMPLETE,searchResultFeatures:e});break}case Dm.MOVE_MAANNOUSU_LAYER:this.moveMaannousuLayers(t.placement);break;case Dm.SELECT_VIABUNDUS_YEAR:this.viabundusLayer.yearChanged(t.year)}}},this.moveMaannousuLayers=t=>{const e=this.map.getLayers(),i=e.getArray(),n=this.maannousuInfoTileLayerGroup.getLayerGroup(),a=this.maannousuInfoGlacialTileLayerGroup.getLayerGroup();e.remove(n),e.remove(a);const s=(()=>{switch(t){case Hp.Bottom:return i.indexOf(this.ahvenanmaaTileLayer.getLayer());case Hp.Top:return i.indexOf(this.positionAndSelectedLocation.getLayer())}})();e.insertAt(s,a),e.insertAt(s,n)},this.updateTileLoadingStatus=t=>{const e=this.tileLoadingCounter;t?this.tileLoadingCounter++:this.tileLoadingCounter>0&&this.tileLoadingCounter--,0===e&&1===this.tileLoadingCounter?this.showLoadingAnimationInUI(!0):1===e&&0===this.tileLoadingCounter&&this.showLoadingAnimationInUI(!1)},this.showLoadingAnimationInUI=t=>{this.store.dispatch({type:Dm.SHOW_LOADING_ANIMATION,show:t})},this.indentifyFeaturesOnCoordinate=(t,e)=>{this.showLoadingAnimationInUI(!0);const i=this.map.getSize();if(!i)return;const n=this.map.getPixelFromCoordinate(t),a=this.store.getState(),s=this.ahvenanmaaTileLayer.identifyFeaturesAt(t,i,this.map.getView().calculateExtent(i),a),r=this.museovirastoTileLayer.identifyFeaturesAt(t,this.view.getResolution(),this.view.getProjection(),a),o=this.helsinkiLayer.identifyFeaturesAt(t,this.view.getResolution(),this.view.getProjection(),a),l=a.models.enabled?this.getFeaturesAtPixelAtGeoJsonLayer(n,this.modelsLayer.getLayer()).filter(t=>jp(t)):[],u=a.maisemanMuisti.enabled?this.getFeaturesAtPixelAtGeoJsonLayer(n,this.maisemanMuistiLayer.getLayer()).filter(t=>qp(t)):[],h=a.viabundus.enabled?this.viabundusLayer.removeDuplicateRoadFeatures(this.getFeaturesAtPixelAtGeoJsonLayer(n,this.viabundusLayer.getLayer()).filter(t=>Gm(t))):[];Promise.all([s,r,o]).then(([t,i,n])=>{this.showLoadingAnimationInUI(!1);const a=[...t.results,...i.features,...n,...h].map(t=>this.modelsLayer.addModelsToFeature(t)).map(t=>this.maisemanMuistiLayer.addMaisemanMuistiFeaturesToFeature(t)),s=u.filter(t=>!a.some(e=>Zp(e)&&im(e)&&e.properties.mjtunnus===t.properties?.id));this.store.dispatch({type:Dm.MAP_FEATURE_IDENTIFICATION_COMPLETE,identifiedMapFeatures:{requestTimestamp:e,features:[...a,...s],models:l}})})},this.zoom=t=>{const e=this.view.getZoom();e&&this.view.animate({zoom:e+t,duration:250})},this.layerGroupSelectedLayersChanged=(t,e)=>{switch(t){case Fp.MMLPohjakartta:this.maanmittauslaitosTileLayer.selectedMaanmittauslaitosLayerChanged(e),this.maannousuInfoTileLayerGroup.onMaanmittauslaitosSelectedLayerChange(e);break;case Fp.MMLVanhatKartat:this.maanmittauslaitosVanhatKartatTileLayer.selectedMaanmittauslaitosVanhatKartatLayerChanged(e);break;case Fp.GTK:this.gtkLayer.selectedGTKLayersChanged(e);break;case Fp.MaannousuInfo:this.maannousuInfoTileLayerGroup.onYearChange(e),this.maannousuInfoGlacialTileLayerGroup.onYearChange(e);break;case Fp.Museovirasto:this.museovirastoTileLayer.selectedFeatureLayersChanged(e);break;case Fp.Ahvenanmaa:this.ahvenanmaaTileLayer.selectedFeatureLayersChanged(e);break;case Fp.Helsinki:this.helsinkiLayer.selectedFeatureLayersChanged(e)}},this.searchFeaturesFromMapLayers=async(t,e)=>{this.showLoadingAnimationInUI(!0);const i=this.ahvenanmaaTileLayer.findFeatures(t,e),n=this.museovirastoTileLayer.findFeatures(t,e),[a,s]=await Promise.all([i,n]);return this.showLoadingAnimationInUI(!1),[...a.results,...s.features,...this.viabundusLayer.findFeatures(t,e)].map(t=>this.modelsLayer.addModelsToFeature(t)).map(t=>this.maisemanMuistiLayer.addMaisemanMuistiFeaturesToFeature(t))},this.layerOpacityChanged=(t,e)=>{switch(t){case Fp.MMLVanhatKartat:this.maanmittauslaitosVanhatKartatTileLayer.opacityChanged(e);break;case Fp.GTK:this.gtkLayer.opacityChanged(e);break;case Fp.MaannousuInfo:this.maannousuInfoTileLayerGroup.opacityChanged(e),this.maannousuInfoGlacialTileLayerGroup.opacityChanged(e);break;case Fp.Museovirasto:this.museovirastoTileLayer.opacityChanged(e);break;case Fp.Ahvenanmaa:this.ahvenanmaaTileLayer.opacityChanged(e);break;case Fp.Helsinki:this.helsinkiLayer.opacityChanged(e);break;case Fp.Viabundus:this.viabundusLayer.opacityChanged(e)}},this.layerGroupVisibilityChanged=(t,e)=>{switch(t){case Fp.MMLPohjakartta:this.maanmittauslaitosTileLayer.updateLayerVisibility(e);break;case Fp.MMLVanhatKartat:this.maanmittauslaitosVanhatKartatTileLayer.updateLayerVisibility(e);break;case Fp.GTK:this.gtkLayer.updateLayerVisibility(e);break;case Fp.MaannousuInfo:this.maannousuInfoTileLayerGroup.updateLayerVisibility(e),this.maannousuInfoGlacialTileLayerGroup.updateLayerVisibility(e);break;case Fp.Museovirasto:this.museovirastoTileLayer.updateLayerVisibility(e);break;case Fp.Ahvenanmaa:this.ahvenanmaaTileLayer.updateLayerVisibility(e);break;case Fp.Helsinki:this.helsinkiLayer.updateLayerVisibility(e);break;case Fp.Models:this.modelsLayer.updateLayerVisibility(e);break;case Fp.MaisemanMuisti:this.maisemanMuistiLayer.updateLayerVisibility(e);break;case Fp.Viabundus:this.viabundusLayer.updateLayerVisibility(e)}},this.store=t;const e=t.getState();Ap.defs(Qw,"+proj=utm +zone=35 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"),function(t){mh=t;const e=Object.keys(t.defs),i=e.length;let n,a;for(n=0;n<i;++n){const i=e[n];if(!pe(i)){const e=t.defs(i);let n=e.units;n||"longlat"!==e.projName||(n="degrees"),$e(new te({code:i,axisOrientation:e.axis,metersPerUnit:e.to_meter,units:n}))}}for(n=0;n<i;++n){const s=e[n],r=pe(s);for(a=0;a<i;++a){const i=e[a],n=pe(i);if(!ge(s,i))if(t.defs[s]===t.defs[i])qe([r,n]);else{const e=t(s,i);Qe(r,n,pi(r,n,e.forward),pi(n,r,e.inverse))}}}}(Ap),Ye(Qw)?.setExtent([50199.4814,6582464.0358,761274.6247,7799839.8902]),this.view=new _a({center:e.mapCenterCoordinates??tb,projection:Qw,zoom:e.mapZoom,enableRotation:!1});const i=new Mu({units:"metric"});this.map=new xu({target:"map",view:this.view,controls:new U([i])}),this.maanmittauslaitosTileLayer=new ey(e,this.updateTileLoadingStatus),this.gtkLayer=new qg(e,this.updateTileLoadingStatus),this.ahvenanmaaTileLayer=new Jf(e,this.updateTileLoadingStatus),this.maanmittauslaitosVanhatKartatTileLayer=new iy(e,this.updateTileLoadingStatus),this.maannousuInfoTileLayerGroup=new sw({settings:e,onMapRenderCompleteOnce:t=>this.map.once("rendercomplete",()=>t()),updateTileLoadingStatus:this.updateTileLoadingStatus}),this.maannousuInfoGlacialTileLayerGroup=new ew({settings:e,onMapRenderCompleteOnce:t=>this.map.once("rendercomplete",()=>t())}),this.museovirastoTileLayer=new jw(e,this.updateTileLoadingStatus),this.helsinkiLayer=new u_(e,this.updateTileLoadingStatus),this.maisemanMuistiLayer=new Iw(e),this.modelsLayer=new Pw(e),this.viabundusLayer=new Nw(e,this.updateTileLoadingStatus),this.positionAndSelectedLocation=new $g(e),this.map.addLayer(this.maanmittauslaitosTileLayer.getLayer()),this.map.addLayer(this.gtkLayer.getLayer()),this.map.addLayer(this.maanmittauslaitosVanhatKartatTileLayer.getLayer()),this.map.addLayer(this.ahvenanmaaTileLayer.getLayer()),this.map.addLayer(this.museovirastoTileLayer.getLayer()),this.map.addLayer(this.helsinkiLayer.getLayer()),this.map.addLayer(this.viabundusLayer.getLayer()),this.map.addLayer(this.maisemanMuistiLayer.getLayer()),this.map.addLayer(this.modelsLayer.getLayer()),this.map.addLayer(this.positionAndSelectedLocation.getLayer()),this.moveMaannousuLayers(e.maannousuInfo.placement),this.map.on("singleclick",t=>this.indentifyFeaturesOnCoordinate(t.coordinate,Date.now())),this.geolocation=new Pn({projection:this.view.getProjection(),tracking:!0,trackingOptions:{enableHighAccuracy:!0}}),this.geolocation.once("change:position",()=>t.dispatch({type:Dm.FIRST_USER_LOCATION_DETECTION_COMPLETE})),this.geolocation.on("change:position",this.geolocationChanged),e.linkedFeature&&this.view.setCenter(e.linkedFeature.coordinates),this.map.on("moveend",()=>{const e=this.view.getZoom();void 0!==e&&t.dispatch({type:Dm.ZOOM_CHANGED,zoom:e});const i=this.view.getCenter();i&&t.dispatch({type:Dm.MAP_CENTER_CHANGED,coordinates:[i[0],i[1]]})})}getFeaturesAtPixelAtGeoJsonLayer(t,e){const i=new Qu,n=this.map.getFeaturesAtPixel(t,{layerFilter:t=>t===e,hitTolerance:10}).filter(t=>t instanceof K);return i.writeFeaturesObject(n).features}}(GF);var WF;vM(DF.mapUpdaterStoreListener),(t=>{hT.use(VT).init({resources:{fi:{translation:kS},sv:{translation:vS},en:{translation:yS}},lng:t.getState().language,supportedLngs:Object.values(Op),fallbackLng:Op.FI,defaultNS:"translation",interpolation:{escapeValue:!1}});const e=document.getElementById("ui");if(!e)throw new Error("UI:n elementti puuttuu DOMista");(0,dT.createRoot)(e).render(cT.createElement(lS,{store:t},cT.createElement(FS,null),cT.createElement(aP,null),cT.createElement(sP,null),cT.createElement(BS,null),cT.createElement(WI,null),cT.createElement(DI,null),cT.createElement(HI,null),cT.createElement(nI,null),cT.createElement(VS,{onClick:LF,fullscreenPossible:document.fullscreenEnabled}),cT.createElement(GI,null),cT.createElement(nP,null),cT.createElement(WO,null),cT.createElement(JO,null),cT.createElement(zO,null),cT.createElement(CF,null)))})(GF),vM(jF),window.onhashchange=()=>{const{linkedFeature:t}=NF();GF.dispatch({type:Dm.SET_LINKED_FEATURE,linkedFeature:t})}},5372:t=>{"use strict";t.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 12 12%27 width=%2712%27 height=%2712%27 fill=%27none%27 stroke=%27%23dc3545%27%3e%3ccircle cx=%276%27 cy=%276%27 r=%274.5%27/%3e%3cpath stroke-linejoin=%27round%27 d=%27M5.8 3.6h.4L6 6.5z%27/%3e%3ccircle cx=%276%27 cy=%278.2%27 r=%27.6%27 fill=%27%23dc3545%27 stroke=%27none%27/%3e%3c/svg%3e"},5419:t=>{"use strict";t.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 20 20%27%3e%3cpath fill=%27none%27 stroke=%27%23fff%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%273%27 d=%27m6 10 3 3 6-6%27/%3e%3c/svg%3e"},5531:t=>{"use strict";t.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27%3e%3cpath fill=%27none%27 stroke=%27%23343a40%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%272%27 d=%27m2 5 6 6 6-6%27/%3e%3c/svg%3e"},5556:(t,e,i)=>{t.exports=i(2694)()},5782:t=>{"use strict";t.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27%2386b7fe%27/%3e%3c/svg%3e"},5967:t=>{"use strict";t.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23000%27%3e%3cpath d=%27M.293.293a1 1 0 0 1 1.414 0L8 6.586 14.293.293a1 1 0 1 1 1.414 1.414L9.414 8l6.293 6.293a1 1 0 0 1-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 0 1-1.414-1.414L6.586 8 .293 1.707a1 1 0 0 1 0-1.414%27/%3e%3c/svg%3e"},6244:(t,e,i)=>{"use strict";i.d(e,{A:()=>o});var n=i(1601),a=i.n(n),s=i(6314),r=i.n(s)()(a());r.push([t.id,"html,\nbody,\n#map {\n  margin: 0;\n  padding: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n}\n\n#map {\n  z-index: 10;\n  position: absolute;\n  left: 0px;\n  top: 0px;\n}\n\n#loading-animation {\n  /* Bootstrap Offcanvas Z-index is 1045. This must be larger for loading animation. */\n  z-index: 2000;\n  position: absolute;\n  top: 15px;\n  right: 20px;\n}\n\n#linked-feature-popover {\n  /* Bootstrap Popover default Z-index is 1070. Drop it below Offcanvas. */\n  z-index: 1040;\n}\n\n.map-button {\n  z-index: 15;\n  position: absolute;\n}\n\n#map-button-zoom-in {\n  top: 10px;\n  left: 10px;\n}\n\n#map-button-zoom-out {\n  top: 50px;\n  left: 10px;\n}\n\n#map-button-position {\n  top: 90px;\n  left: 10px;\n}\n\n#map-button-search {\n  top: 130px;\n  left: 10px;\n}\n\n#map-button-info {\n  top: 170px;\n  left: 10px;\n}\n\n#map-button-settings {\n  top: 210px;\n  left: 10px;\n}\n\n#map-button-linked-feature {\n  top: 250px;\n  left: 10px;\n}\n\n#map-button-fullscreen {\n  bottom: 10px;\n  right: 10px;\n}\n\n#maannnousu-info-year-buttons {\n  bottom: 10px;\n  left: 50%;\n  transform: translateX(-50%);\n  display: flex;\n}\n\n#webgl-global-error-message {\n  z-index: 15;\n  position: absolute;\n  top: 0px;\n  width: 100%;\n}\n\n@media (width < 576px) {\n  .offcanvas {\n    --bs-offcanvas-width: 100%;\n  }\n}\n\n@media (width >= 576px) {\n  .offcanvas {\n    --bs-offcanvas-width: 576px;\n  }\n}\n\n@media (width >= 768px) {\n  .offcanvas {\n    --bs-offcanvas-width: 700px;\n  }\n}\n\n.feature-icon {\n  margin-right: 5px;\n}\n\n/* Asetetaan Bootstrap warning-buttonin vri linkitetyille kohteille */\n#linked-feature-popover .popover-header,\n.current-linked-feature-accordian-header button,\n.current-linked-feature-accordian-header .accordion-button:not(.collapsed) {\n  background-color: #ffc107;\n}\n\n.ol-scale-line {\n  background: rgba(255, 255, 255, 0.9);\n}\n\n.ol-scale-line-inner {\n  border: 2px solid black;\n  border-top: none;\n  color: black;\n  font-size: 13px;\n}\n\n.ol-full-screen {\n  top: initial;\n  bottom: 0.5em;\n}\n",""]);const o=r},6314:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var i="",n=void 0!==e[5];return e[4]&&(i+="@supports (".concat(e[4],") {")),e[2]&&(i+="@media ".concat(e[2]," {")),n&&(i+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),i+=t(e),n&&(i+="}"),e[2]&&(i+="}"),e[4]&&(i+="}"),i}).join("")},e.i=function(t,i,n,a,s){"string"==typeof t&&(t=[[null,t,void 0]]);var r={};if(n)for(var o=0;o<this.length;o++){var l=this[o][0];null!=l&&(r[l]=!0)}for(var u=0;u<t.length;u++){var h=[].concat(t[u]);n&&r[h[0]]||(void 0!==s&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=s),i&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=i):h[2]=i),a&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=a):h[4]="".concat(a)),e.push(h))}},e}},6366:t=>{"use strict";t.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 30 30%27%3e%3cpath stroke=%27rgba%28255, 255, 255, 0.55%29%27 stroke-linecap=%27round%27 stroke-miterlimit=%2710%27 stroke-width=%272%27 d=%27M4 7h22M4 15h22M4 23h22%27/%3e%3c/svg%3e"},6504:()=>{},6540:(t,e,i)=>{"use strict";t.exports=i(9869)},6580:()=>{},6675:t=>{function e(t,e){const i=new RegExp(e,"g"),n=t.match(i);return n?n.length:0}t.exports=e,t.exports.default=e},6925:t=>{"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},6942:(t,e)=>{var i;!function(){"use strict";var n={}.hasOwnProperty;function a(){for(var t="",e=0;e<arguments.length;e++){var i=arguments[e];i&&(t=r(t,s(i)))}return t}function s(t){if("string"==typeof t||"number"==typeof t)return t;if("object"!=typeof t)return"";if(Array.isArray(t))return a.apply(null,t);if(t.toString!==Object.prototype.toString&&!t.toString.toString().includes("[native code]"))return t.toString();var e="";for(var i in t)n.call(t,i)&&t[i]&&(e=r(e,i));return e}function r(t,e){return e?t?t+" "+e:t+e:t}t.exports?(a.default=a,t.exports=a):void 0===(i=function(){return a}.apply(e,[]))||(t.exports=i)}()},7115:t=>{"use strict";t.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27%3e%3cpath fill=%27none%27 stroke=%27%23dee2e6%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%272%27 d=%27m2 5 6 6 6-6%27/%3e%3c/svg%3e"},7154:t=>{"use strict";t.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27rgba%280, 0, 0, 0.25%29%27/%3e%3c/svg%3e"},7334:t=>{function e(t,e=100,i={}){if("function"!=typeof t)throw new TypeError(`Expected the first parameter to be a function, got \`${typeof t}\`.`);if(e<0)throw new RangeError("`wait` must not be negative.");const{immediate:n}="boolean"==typeof i?{immediate:i}:i;let a,s,r,o,l;function u(){const e=a,i=s;return a=void 0,s=void 0,l=t.apply(e,i),l}function h(){const t=Date.now()-o;t<e&&t>=0?r=setTimeout(h,e-t):(r=void 0,n||(l=u()))}const c=function(...t){if(a&&this!==a&&Object.getPrototypeOf(this)===Object.getPrototypeOf(a))throw new Error("Debounced method called with different contexts of the same prototype.");a=this,s=t,o=Date.now();const i=n&&!r;return r||(r=setTimeout(h,e)),i&&(l=u()),l};return Object.defineProperty(c,"isPending",{get:()=>void 0!==r}),c.clear=()=>{r&&(clearTimeout(r),r=void 0)},c.flush=()=>{r&&c.trigger()},c.trigger=()=>{l=u(),c.clear()},c}t.exports.debounce=e,t.exports=e},7379:t=>{function e(t,e,i){const n=i&&i.debug||!1;n&&console.log("[xml-utils] getting "+e+" in "+t);const a="object"==typeof t?t.outer:t,s=a.slice(0,a.indexOf(">")+1),r=['"',"'"];for(let t=0;t<r.length;t++){const i=r[t],a=e+"\\="+i+"([^"+i+"]*)"+i;n&&console.log("[xml-utils] pattern:",a);const o=new RegExp(a).exec(s);if(n&&console.log("[xml-utils] match:",o),o)return o[1]}}t.exports=e,t.exports.default=e},7659:t=>{"use strict";var e={};t.exports=function(t,i){var n=function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}e[t]=i}return e[t]}(t);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(i)}},7825:t=>{"use strict";t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(i){!function(t,e,i){var n="";i.supports&&(n+="@supports (".concat(i.supports,") {")),i.media&&(n+="@media ".concat(i.media," {"));var a=void 0!==i.layer;a&&(n+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),n+=i.css,a&&(n+="}"),i.media&&(n+="}"),i.supports&&(n+="}");var s=i.sourceMap;s&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleTagTransform(n,t,e.options)}(e,t,i)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},8418:(t,e,i)=>{"use strict";t.exports=i(5160)},8493:(t,e,i)=>{"use strict";var n=i(6540),a="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e},s=n.useState,r=n.useEffect,o=n.useLayoutEffect,l=n.useDebugValue;function u(t){var e=t.getSnapshot;t=t.value;try{var i=e();return!a(t,i)}catch(t){return!0}}var h="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(t,e){return e()}:function(t,e){var i=e(),n=s({inst:{value:i,getSnapshot:e}}),a=n[0].inst,h=n[1];return o(function(){a.value=i,a.getSnapshot=e,u(a)&&h({inst:a})},[t,i,e]),r(function(){return u(a)&&h({inst:a}),t(function(){u(a)&&h({inst:a})})},[t]),l(i),i};e.useSyncExternalStore=void 0!==n.useSyncExternalStore?n.useSyncExternalStore:h},8556:(t,e,i)=>{const n=i(3614),a=i(8694),s=i(6675);function r(t,e,i){const r=i&&i.debug||!1,o=!(i&&!1===typeof i.nested),l=i&&i.startIndex||0;r&&console.log("[xml-utils] starting findTagByName with",e," and ",i);const u=n(t,`<${e}[ \n>/]`,l);if(r&&console.log("[xml-utils] start:",u),-1===u)return;const h=t.slice(u+e.length);let c=a(h,"^[^<]*[ /]>",0);const d=-1!==c&&"/"===h[c-1];if(r&&console.log("[xml-utils] selfClosing:",d),!1===d)if(o){let t=0,i=1,n=0;for(;-1!==(c=a(h,"[ /]"+e+">",t));){const a=h.substring(t,c+1);if(i+=s(a,"<"+e+"[ \n\t>]"),n+=s(a,"</"+e+">"),n>=i)break;t=c}}else c=a(h,"[ /]"+e+">",0);const p=u+e.length+c+1;if(r&&console.log("[xml-utils] end:",p),-1===p)return;const m=t.slice(u,p);let f;return f=d?null:m.slice(m.indexOf(">")+1,m.lastIndexOf("<")),{inner:f,outer:m,start:u,end:p}}t.exports=r,t.exports.default=r},8622:(t,e,i)=>{"use strict";i.d(e,{$:()=>n,AC:()=>u,Hm:()=>d,NZ:()=>s,S3:()=>c,TZ:()=>h,s$:()=>o,ub:()=>l});const n={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},a={};for(const t in n)n.hasOwnProperty(t)&&(a[n[t]]=parseInt(t,10));const s=[a.BitsPerSample,a.ExtraSamples,a.SampleFormat,a.StripByteCounts,a.StripOffsets,a.StripRowCounts,a.TileByteCounts,a.TileOffsets,a.SubIFDs],r={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},o={};for(const t in r)r.hasOwnProperty(t)&&(o[r[t]]=parseInt(t,10));const l={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},u={Unspecified:0,Assocalpha:1,Unassalpha:2},h={Version:0,AddCompression:1},c={None:0,Deflate:1,Zstandard:2},d={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"},p={};for(const t in d)d.hasOwnProperty(t)&&(p[d[t]]=parseInt(t,10))},8625:()=>{},8661:t=>{"use strict";t.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 8 8%27%3e%3cpath fill=%27%23198754%27 d=%27M2.3 6.73.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1%27/%3e%3c/svg%3e"},8694:t=>{function e(t,e,i){const n=new RegExp(e).exec(t.slice(i));return n?i+n.index+n[0].length-1:-1}t.exports=e,t.exports.default=e},8734:t=>{"use strict";t.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27rgba%28255, 255, 255, 0.25%29%27/%3e%3c/svg%3e"},9698:(t,e)=>{"use strict";var i=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function a(t,e,n){var a=null;if(void 0!==n&&(a=""+n),void 0!==e.key&&(a=""+e.key),"key"in e)for(var s in n={},e)"key"!==s&&(n[s]=e[s]);else n=e;return e=n.ref,{$$typeof:i,type:t,key:a,ref:void 0!==e?e:null,props:n}}e.Fragment=n,e.jsx=a,e.jsxs=a},9771:t=>{"use strict";t.exports=function(){}},9869:(t,e)=>{"use strict";var i=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),m=Symbol.iterator,f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,_={};function y(t,e,i){this.props=t,this.context=e,this.refs=_,this.updater=i||f}function k(){}function v(t,e,i){this.props=t,this.context=e,this.refs=_,this.updater=i||f}y.prototype.isReactComponent={},y.prototype.setState=function(t,e){if("object"!=typeof t&&"function"!=typeof t&&null!=t)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},y.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},k.prototype=y.prototype;var x=v.prototype=new k;x.constructor=v,g(x,y.prototype),x.isPureReactComponent=!0;var w=Array.isArray;function b(){}var E={H:null,A:null,T:null,S:null},M=Object.prototype.hasOwnProperty;function T(t,e,n){var a=n.ref;return{$$typeof:i,type:t,key:e,ref:void 0!==a?a:null,props:n}}function S(t){return"object"==typeof t&&null!==t&&t.$$typeof===i}var C=/\/+/g;function L(t,e){return"object"==typeof t&&null!==t&&null!=t.key?(i=""+t.key,n={"=":"=0",":":"=2"},"$"+i.replace(/[=:]/g,function(t){return n[t]})):e.toString(36);var i,n}function R(t,e,a,s,r){var o=typeof t;"undefined"!==o&&"boolean"!==o||(t=null);var l,u,h=!1;if(null===t)h=!0;else switch(o){case"bigint":case"string":case"number":h=!0;break;case"object":switch(t.$$typeof){case i:case n:h=!0;break;case d:return R((h=t._init)(t._payload),e,a,s,r)}}if(h)return r=r(t),h=""===s?"."+L(t,0):s,w(r)?(a="",null!=h&&(a=h.replace(C,"$&/")+"/"),R(r,e,a,"",function(t){return t})):null!=r&&(S(r)&&(l=r,u=a+(null==r.key||t&&t.key===r.key?"":(""+r.key).replace(C,"$&/")+"/")+h,r=T(l.type,u,l.props)),e.push(r)),1;h=0;var c,p=""===s?".":s+":";if(w(t))for(var f=0;f<t.length;f++)h+=R(s=t[f],e,a,o=p+L(s,f),r);else if("function"==typeof(f=null===(c=t)||"object"!=typeof c?null:"function"==typeof(c=m&&c[m]||c["@@iterator"])?c:null))for(t=f.call(t),f=0;!(s=t.next()).done;)h+=R(s=s.value,e,a,o=p+L(s,f++),r);else if("object"===o){if("function"==typeof t.then)return R(function(t){switch(t.status){case"fulfilled":return t.value;case"rejected":throw t.reason;default:switch("string"==typeof t.status?t.then(b,b):(t.status="pending",t.then(function(e){"pending"===t.status&&(t.status="fulfilled",t.value=e)},function(e){"pending"===t.status&&(t.status="rejected",t.reason=e)})),t.status){case"fulfilled":return t.value;case"rejected":throw t.reason}}throw t}(t),e,a,s,r);throw e=String(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.")}return h}function I(t,e,i){if(null==t)return t;var n=[],a=0;return R(t,n,"","",function(t){return e.call(i,t,a++)}),n}function P(t){if(-1===t._status){var e=t._result;(e=e()).then(function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)},function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)}),-1===t._status&&(t._status=0,t._result=e)}if(1===t._status)return t._result.default;throw t._result}var A="function"==typeof reportError?reportError:function(t){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof t&&null!==t&&"string"==typeof t.message?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if("object"==typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",t);console.error(t)},j={map:I,forEach:function(t,e,i){I(t,function(){e.apply(this,arguments)},i)},count:function(t){var e=0;return I(t,function(){e++}),e},toArray:function(t){return I(t,function(t){return t})||[]},only:function(t){if(!S(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};e.Activity=p,e.Children=j,e.Component=y,e.Fragment=a,e.Profiler=r,e.PureComponent=v,e.StrictMode=s,e.Suspense=h,e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=E,e.__COMPILER_RUNTIME={__proto__:null,c:function(t){return E.H.useMemoCache(t)}},e.cache=function(t){return function(){return t.apply(null,arguments)}},e.cacheSignal=function(){return null},e.cloneElement=function(t,e,i){if(null==t)throw Error("The argument must be a React element, but you passed "+t+".");var n=g({},t.props),a=t.key;if(null!=e)for(s in void 0!==e.key&&(a=""+e.key),e)!M.call(e,s)||"key"===s||"__self"===s||"__source"===s||"ref"===s&&void 0===e.ref||(n[s]=e[s]);var s=arguments.length-2;if(1===s)n.children=i;else if(1<s){for(var r=Array(s),o=0;o<s;o++)r[o]=arguments[o+2];n.children=r}return T(t.type,a,n)},e.createContext=function(t){return(t={$$typeof:l,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider=t,t.Consumer={$$typeof:o,_context:t},t},e.createElement=function(t,e,i){var n,a={},s=null;if(null!=e)for(n in void 0!==e.key&&(s=""+e.key),e)M.call(e,n)&&"key"!==n&&"__self"!==n&&"__source"!==n&&(a[n]=e[n]);var r=arguments.length-2;if(1===r)a.children=i;else if(1<r){for(var o=Array(r),l=0;l<r;l++)o[l]=arguments[l+2];a.children=o}if(t&&t.defaultProps)for(n in r=t.defaultProps)void 0===a[n]&&(a[n]=r[n]);return T(t,s,a)},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:u,render:t}},e.isValidElement=S,e.lazy=function(t){return{$$typeof:d,_payload:{_status:-1,_result:t},_init:P}},e.memo=function(t,e){return{$$typeof:c,type:t,compare:void 0===e?null:e}},e.startTransition=function(t){var e=E.T,i={};E.T=i;try{var n=t(),a=E.S;null!==a&&a(i,n),"object"==typeof n&&null!==n&&"function"==typeof n.then&&n.then(b,A)}catch(t){A(t)}finally{null!==e&&null!==i.types&&(e.types=i.types),E.T=e}},e.unstable_useCacheRefresh=function(){return E.H.useCacheRefresh()},e.use=function(t){return E.H.use(t)},e.useActionState=function(t,e,i){return E.H.useActionState(t,e,i)},e.useCallback=function(t,e){return E.H.useCallback(t,e)},e.useContext=function(t){return E.H.useContext(t)},e.useDebugValue=function(){},e.useDeferredValue=function(t,e){return E.H.useDeferredValue(t,e)},e.useEffect=function(t,e){return E.H.useEffect(t,e)},e.useEffectEvent=function(t){return E.H.useEffectEvent(t)},e.useId=function(){return E.H.useId()},e.useImperativeHandle=function(t,e,i){return E.H.useImperativeHandle(t,e,i)},e.useInsertionEffect=function(t,e){return E.H.useInsertionEffect(t,e)},e.useLayoutEffect=function(t,e){return E.H.useLayoutEffect(t,e)},e.useMemo=function(t,e){return E.H.useMemo(t,e)},e.useOptimistic=function(t,e){return E.H.useOptimistic(t,e)},e.useReducer=function(t,e,i){return E.H.useReducer(t,e,i)},e.useRef=function(t){return E.H.useRef(t)},e.useState=function(t){return E.H.useState(t)},e.useSyncExternalStore=function(t,e,i){return E.H.useSyncExternalStore(t,e,i)},e.useTransition=function(){return E.H.useTransition()},e.version="19.2.0"},9888:(t,e,i)=>{"use strict";t.exports=i(8493)},9982:(t,e,i)=>{"use strict";t.exports=i(4477)}},a={};function s(t){var e=a[t];if(void 0!==e)return e.exports;var i=a[t]={id:t,exports:{}};return n[t](i,i.exports,s),i.exports}s.m=n,t=[],s.O=(e,i,n,a)=>{if(!i){var r=1/0;for(h=0;h<t.length;h++){for(var[i,n,a]=t[h],o=!0,l=0;l<i.length;l++)(!1&a||r>=a)&&Object.keys(s.O).every(t=>s.O[t](i[l]))?i.splice(l--,1):(o=!1,a<r&&(r=a));if(o){t.splice(h--,1);var u=n();void 0!==u&&(e=u)}}return e}a=a||0;for(var h=t.length;h>0&&t[h-1][2]>a;h--)t[h]=t[h-1];t[h]=[i,n,a]},s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},s.d=(t,e)=>{for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},s.f={},s.e=t=>Promise.all(Object.keys(s.f).reduce((e,i)=>(s.f[i](t,e),e),[])),s.u=t=>t+"-"+{30:"9f38289016b871048dc3",121:"5abba5d2997b6eac69c8",148:"5bdd26dbe1764be2b1f2",414:"642978cd93314b97f824",424:"568b1140c98aa0841aa8",457:"fc4635378720ce44aaa8",568:"35536e7084a0b80c9c3c",651:"7162b67a1a7d46aeb02e",764:"cc3e48187e28a0badc05"}[t]+".js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),e={},i="muinaismuistot:",s.l=(t,n,a,r)=>{if(e[t])e[t].push(n);else{var o,l;if(void 0!==a)for(var u=document.getElementsByTagName("script"),h=0;h<u.length;h++){var c=u[h];if(c.getAttribute("src")==t||c.getAttribute("data-webpack")==i+a){o=c;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",s.nc&&o.setAttribute("nonce",s.nc),o.setAttribute("data-webpack",i+a),o.src=t),e[t]=[n];var d=(i,n)=>{o.onerror=o.onload=null,clearTimeout(p);var a=e[t];if(delete e[t],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach(t=>t(n)),i)return i(n)},p=setTimeout(d.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=d.bind(null,o.onerror),o.onload=d.bind(null,o.onload),l&&document.head.appendChild(o)}},s.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;s.g.importScripts&&(t=s.g.location+"");var e=s.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var i=e.getElementsByTagName("script");if(i.length)for(var n=i.length-1;n>-1&&(!t||!/^http(s?):/.test(t));)t=i[n--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=t})(),(()=>{s.b="undefined"!=typeof document&&document.baseURI||self.location.href;var t={524:0};s.f.j=(e,i)=>{var n=s.o(t,e)?t[e]:void 0;if(0!==n)if(n)i.push(n[2]);else{var a=new Promise((i,a)=>n=t[e]=[i,a]);i.push(n[2]=a);var r=s.p+s.u(e),o=new Error;s.l(r,i=>{if(s.o(t,e)&&(0!==(n=t[e])&&(t[e]=void 0),n)){var a=i&&("load"===i.type?"missing":i.type),r=i&&i.target&&i.target.src;o.message="Loading chunk "+e+" failed.\n("+a+": "+r+")",o.name="ChunkLoadError",o.type=a,o.request=r,n[1](o)}},"chunk-"+e,e)}},s.O.j=e=>0===t[e];var e=(e,i)=>{var n,a,[r,o,l]=i,u=0;if(r.some(e=>0!==t[e])){for(n in o)s.o(o,n)&&(s.m[n]=o[n]);if(l)var h=l(s)}for(e&&e(i);u<r.length;u++)a=r[u],s.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return s.O(h)},i=self.webpackChunkmuinaismuistot=self.webpackChunkmuinaismuistot||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})(),s.nc=void 0;var r=s.O(void 0,[587,470,547],()=>s(5190));r=s.O(r)})();